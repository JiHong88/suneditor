(()=>{var t={cfbI:function(t){var e,i;e="undefined"!=typeof window?window:this,i=function(t,e){const i={code:"en",align:"Align",alignBottom:"Align bottom",alignCenter:"Align center",alignJustify:"Align justify",alignLeft:"Align left",alignMiddle:"Align middle",alignRight:"Align right",alignTop:"Align top",asBlock:"As a block",asLink:"As a link",audio:"Audio",audio_modal_file:"Select from files",audio_modal_title:"Insert Audio",audio_modal_url:"Audio URL",autoSize:"Auto size",backgroundColor:"Background color",basic:"Basic",blockStyle:"Block style",bold:"Bold",border:"Border",border_all:"Border all",border_inside:"Border inside",border_horizontal:"Border horizontal",border_vertical:"Border vertical",border_outside:"Border outside",border_left:"Border left",border_top:"Border top",border_right:"Border right",border_bottom:"Border bottom",border_none:"Border none",bulletedList:"Bulleted list",cancel:"Cancel",caption:"Insert description",cellProperties:"Cell properties",center:"Center",close:"Close",codeView:"Code view",color:"Color",colorPicker:"Color picker",column:"Column",comment:"Comments",commentAdd:"Add comment",commentShow:"Show comments",copy:"Copy",copyFormatting:"Copy formatting",cut:"Cut",default:"Default",deleteColumn:"Delete column",deleteRow:"Delete row",dir_ltr:"Left to right",dir_rtl:"Right to left",download:"Download",drag:"Drag",edit:"Edit",exportPdf:"Export to PDF",exportWord:"Export to Word",find:"Find",decrease:"Decrease",increase:"Increase",fileUpload:"File upload",fixedColumnWidth:"Fixed column width",font:"Font",fontColor:"Font color",fontSize:"Size",formats:"Formats",fullScreen:"Full screen",height:"Height",horizontalLine:"Horizontal line",horizontalSplit:"Horizontal split",hr_dashed:"Dashed",hr_dotted:"Dotted",hr_solid:"Solid",image:"Image",imageGallery:"Image gallery",image_modal_altText:"Alternative text",image_modal_file:"Select from files",image_modal_title:"Insert image",image_modal_url:"Image URL",importWord:"Import from Word",indent:"Indent",inlineStyle:"Inline style",insertColumnAfter:"Insert column after",insertColumnBefore:"Insert column before",insertRowAbove:"Insert row above",insertRowBelow:"Insert row below",insertLine:"Insert line",italic:"Italic",layout:"Layout",left:"Left",lineHeight:"Line height",link:"Link",link_modal_bookmark:"Bookmark",link_modal_downloadLinkCheck:"Download link",link_modal_newWindowCheck:"Open in new window",link_modal_text:"Text to display",link_modal_title:"Insert Link",link_modal_url:"URL to link",link_modal_relAttribute:"Rel attribute",list:"List",math:"Math",math_modal_fontSizeLabel:"Font Size",math_modal_inputLabel:"Mathematical Notation",math_modal_previewLabel:"Preview",math_modal_title:"Math",maxSize:"Max size",mention:"Mention",menu_bordered:"Bordered",menu_code:"Code",menu_neon:"Neon",menu_shadow:"Shadow",menu_spaced:"Spaced",menu_translucent:"Translucent",mergeCells:"Merge cells",minSize:"Min size",mirrorHorizontal:"Mirror, Horizontal",mirrorVertical:"Mirror, Vertical",newDocument:"New document",numberedList:"Numbered list",outdent:"Outdent",pageBreak:"Page break",paragraphStyle:"Paragraph style",preview:"Preview",print:"print",proportion:"Constrain proportions",ratio:"Ratio",redo:"Redo",remove:"Remove",removeFormat:"Remove Format",replace:"Replace",replaceAll:"Replace all",resize100:"Zoom 100%",resize25:"Zoom 25%",resize50:"Zoom 50%",resize75:"Zoom 75%",resize:"Resize",revert:"Revert",revisionHistory:"Revision History",right:"Right",rotateLeft:"Rotate left",rotateRight:"Rotate right",row:"Row",save:"Save",search:"Search",selectAll:"Select All",showBlocks:"Show blocks",size:"Size",splitCells:"Split Cells",strike:"Strike",submitButton:"Submit",subscript:"Subscript",superscript:"Superscript",table:"Table",tableHeader:"Table header",tableProperties:"Table properties",tags:"Tags",tag_blockquote:"Quote",tag_div:"Normal (DIV)",tag_h:"Header",tag_p:"Paragraph",tag_pre:"Code",template:"Template",textStyle:"Text style",title:"Title",underline:"Underline",undo:"Undo",unlink:"Unlink",verticalSplit:"Vertical split",video:"Video",video_modal_file:"Select from files",video_modal_title:"Insert Video",video_modal_url:"Media embed URL, YouTube/Vimeo",width:"Width"};return void 0===e&&(t.SUNEDITOR_LANG||Object.defineProperty(t,"SUNEDITOR_LANG",{enumerable:!0,writable:!1,configurable:!1,value:{}}),Object.defineProperty(t.SUNEDITOR_LANG,"en",{enumerable:!0,writable:!0,configurable:!0,value:i})),i},"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("SUNEDITOR_LANG a window with a document");return i(t)}:i(e)},JybH:(t,e,i)=>{"use strict";i.r(e)},"+qkj":(t,e,i)=>{"use strict";i.r(e)}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";const t=window,e=document,s=Symbol("noEventHandler"),n=Symbol("onOverComponent"),o=t.navigator.userAgent.toLowerCase();function l(t){return"string"==typeof t?t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase())):t.map((function(t){return l(t)}))}const r="function"==typeof ResizeObserver,a=navigator.appVersion.includes("Edge"),h=/(Mac|iPhone|iPod|iPad)/.test(navigator.platform),c=o.includes("chrome/")&&!o.includes("edge/"),d=!!o.match(/gecko\/\d+/),u=!!window.chrome,p=o.includes("applewebkit/")&&!o.includes("chrome"),g=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(o)||"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,m=o.includes("android"),f={_w:t,_d:e,NO_EVENT:s,ON_OVER_COMPONENT:n,getValues:function(t){return t?Object.keys(t).map((function(e){return t[e]})):[]},camelToKebabCase:l,kebabToCamelCase:function(t){return"string"==typeof t?t.replace(/-[a-zA-Z]/g,(t=>t.replace("-","").toUpperCase())):t.map((function(t){return l(t)}))},getXMLHttpRequest:function(){return new XMLHttpRequest},getPageStyle:function(t){let i="";const s=(t||e).styleSheets;for(let t,e=0,n=s.length;e<n;e++){try{t=s[e].cssRules}catch(t){continue}if(t)for(let e=0,s=t.length;e<s;e++)i+=t[e].cssText}return i},getIncludePath:function(t,i){let s="";const n=[],o="js"===i?"script":"link",l="js"===i?"src":"href";let r="(?:";for(let e=0,i=t.length;e<i;e++)r+=t[e]+(e<i-1?"|":")");const a=new RegExp(`(^|.*[\\/])${r}(\\.[^\\/]+)?.${i}(?:\\?.*|;.*)?$`,"i"),h=new RegExp(`.+\\.${i}(?:\\?.*|;.*)?$`,"i");for(let t=e.getElementsByTagName(o),i=0;i<t.length;i++)h.test(t[i][l])&&n.push(t[i]);for(let t=0;t<n.length;t++){const e=n[t][l].match(a);if(e){s=e[0];break}}if(""===s&&(s=n.length>0?n[0][l]:""),s.includes(":/")||"//"===s.slice(0,2)||(s=0===s.includes("/")?location.href.match(/^.*?:\/\/[^/]*/)[0]+s:location.href.match(/^[^?]*\/(?:)/)[0]+s),!s)throw"[SUNEDITOR.helper.env.getIncludePath.fail] The SUNEDITOR installation path could not be automatically detected. (path: +"+s+", extension: "+i+")";return s},isResizeObserverSupported:r,isEdge:a,isBlink:c,isGecko:d,isChromium:u,isSafari:p,isOSX_IOS:h,isAndroid:m,isMobile:g,cmdIcon:h?"⌘":"CTRL",shiftIcon:h?"⇧":"+SHIFT",_allowedEmptyNodeList:".se-component, pre, blockquote, hr, li, table, img, iframe, video, audio, canvas, details"},_=8203,b=String.fromCharCode(_),v=new RegExp(String.fromCharCode(_),"g"),y=new RegExp("^"+String.fromCharCode(_)+"+$"),w={"xx-small":1,"x-small":2,small:3,medium:4,large:5,"x-large":6,"xx-large":7,"xxx-large":8};function C(t){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(t)}const x={htmlToEntity:function(t){const e={"&":"&amp;"," ":"&nbsp;","'":"&apos;",'"':"&quot;","<":"&lt;",">":"&gt;"};return t.replace(/&|\u00A0|'|"|<|>/g,(t=>"string"==typeof e[t]?e[t]:t))},entityToHTML:function(t){const e={"&amp;":"&","&nbsp;":" ","&apos;":"'","&quot;":'"',"&lt;":"<","&gt;":">"};return t.replace(/&amp;|&nbsp;|&apos;|&quot;|\$lt;|\$gt;/g,(t=>"string"==typeof e[t]?e[t]:t))},debounce:function(e,i){let s;return function(...n){t.clearTimeout(s),s=setTimeout((()=>{t.clearTimeout(s),e(...n)}),i)}},fontSize:function(t,e){const i=e.match(/(\d+(?:\.\d+)?)(.+)/),s=i?1*i[1]:w[e],n=i?i[2]:"rem";let o=s;switch(/em/.test(n)?o=Math.round(s/.0625):"pt"===n?o=Math.round(1.333*s):"%"===n&&(o=s/100),t){case"em":case"rem":return(.0625*o).toFixed(2)+t;case"%":return 100*(.0625*o).toFixed(2)+t;case"pt":return Math.floor(o/1.333)+t;default:return o+t}},nodeListToArray:function(t){return t?Array.prototype.slice.call(t):[]},swapKeyValue:function(t){const e={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[t[i]]=i);return e},createElementWhitelist:function(t){return new RegExp(`<\\/?\\b(?!\\b${(t||"").replace(/\|/g,"\\b|\\b")}\\b)[^>]*>`,"gi")},createElementBlacklist:function(t){return new RegExp(`<\\/?\\b(?:\\b${(t||"^").replace(/\|/g,"\\b|\\b")}\\b)[^>]*>`,"gi")},isHexColor:C,rgb2hex:function(t){if(C(t)||!t)return t;const e=t.match(/^rgba?[\s+]?\(([\d]+)[\s+]?,[\s+]?([\d]+)[\s+]?,[\s+]?([\d]+)[\s+]?/i);if(e&&e.length>=4){const i=("0"+parseInt(e[1],10).toString(16)).slice(-2),s=("0"+parseInt(e[2],10).toString(16)).slice(-2),n=("0"+parseInt(e[3],10).toString(16)).slice(-2);let o="";if(t.includes("rgba")){const e=t.match(/[\s+]?([\d]+\.?[\d]*)[\s+]?/i);e&&(o=("0"+Math.round(255*parseFloat(e[1])).toString(16)).slice(-2))}return`#${i}${s}${n}${o}`}return""},getWidthInPercentage:function(e,i){const s=i||e.parentElement,n=t.getComputedStyle(s),o=t.parseFloat(n.paddingLeft),l=t.parseFloat(n.paddingRight),r=s.offsetWidth-s.clientWidth,a=s.offsetWidth-o-l-r;return e.offsetWidth/a*100},_setDefaultOptionStyle:function(t,e){let i="";t.get("height")&&(i+="height:"+t.get("height")+";"),t.get("minHeight")&&(i+="min-height:"+t.get("minHeight")+";"),t.get("maxHeight")&&(i+="max-height:"+t.get("maxHeight")+";"),t.get("width")&&(i+="width:"+t.get("width")+";"),t.get("minWidth")&&(i+="min-width:"+t.get("minWidth")+";"),t.get("maxWidth")&&(i+="max-width:"+t.get("maxWidth")+";");let s="",n="",o="";const l=(e=i+e).split(";");for(let e,i=0,r=l.length;i<r;i++)e=l[i].trim(),e&&(/^(min-|max-)?width\s*:/.test(e)||/^(z-index|position|display)\s*:/.test(e)?s+=e+";":/^(min-|max-)?height\s*:/.test(e)?(/^height/.test(e)&&"auto"===e.split(":")[1].trim()&&t.set("height","auto"),n+=e+";"):o+=e+";");return{top:s,frame:n,editor:o}},_setIframeStyleLinks:function(t){let i="";if(t)for(let s,n=0,o=t.length;n<o;n++){if(s=[],/(^https?:\/\/)|(^data:text\/css,)/.test(t[n]))s.push(t[n]);else{const i=new RegExp(`(^|.*[\\/])${t[n]}(\\..+)?.css((\\??.+?)|\\b)$`,"i");for(let t,n=e.getElementsByTagName("link"),o=0,l=n.length;o<l;o++)t=n[o].href.match(i),t&&s.push(t[0])}if(!s||0===s.length)throw'[SUNEDITOR.constructor.iframe.fail] The suneditor CSS files installation path could not be automatically detected. Please set the option property "iframe_cssFileName" before creating editor instances.';for(let t=0,e=s.length;t<e;t++)i+='<link href="'+s[t]+'" rel="stylesheet">'}return i},_setAutoHeightStyle:function(t){return"auto"===t?"<style>\n/** Iframe height auto */\nbody{height: min-content; overflow: hidden;}\n</style>":""}};function S(t){return null!=t&&("string"!=typeof t&&(t=t.textContent),""===t||y.test(t))}function E(t,i,s){const n=e.createElement(t);if(i)for(const t in i)void 0!==i[t]&&null!==i[t]&&n.setAttribute(t,i[t]);return s&&("string"==typeof s?n.innerHTML=s:"object"==typeof s&&n.appendChild(s)),n}function T(t){let e=0;for(;t=t.previousSibling;)e+=1;return e}function k(t,e,i){const s=[];let n=!0;return M(t,(t=>{if(t===e&&(n=!1),n&&!O(t)){if(i&&3===t.nodeType){let e=null,s=null;i.s=i.e=0;let n=t.previousSibling;for(;3===n?.nodeType;)s=n.textContent.replace(v,""),i.s+=s.length,t.textContent=s+t.textContent,e=n,n=n.previousSibling,V(e);let o=t.nextSibling;for(;3===o?.nodeType;)s=o.textContent.replace(v,""),i.e+=s.length,t.textContent+=s,e=o,o=o.nextSibling,V(e)}s.push(t)}return!1})),s.map(T).reverse()}function N(t,e){let i,s=e;for(let e=0,n=t.length;e<n&&(i=s.childNodes,0!==i.length);e++)s=i.length<=t[e]?i[i.length-1]:i[t[e]];return s}function H(t,e){const i=[];return t&&0!==t.childNodes.length?(e=e||function(){return!0},function s(n){t!==n&&e(n)&&i.push(n);for(let t=0,e=n.childNodes.length;t<e;t++)s(n.childNodes[t])}(t),i):i}function L(t){if(!t||O(t))return-1;let e=0;for(t=t.parentNode;t&&!O(t);)e+=1,t=t.parentNode;return e}function M(t,e){let i;if("function"==typeof e)i=e;else if("object"==typeof e)i=function(t){return t===e};else{let t;/^\./.test(e)?(t="className",e="(\\s|^)"+e.split(".")[1]+"(\\s|$)"):/^#/.test(e)?(t="id",e="^"+e.split("#")[1]+"$"):/^:/.test(e)?(t="name",e="^"+e.split(":")[1]+"$"):(t="nodeName",e="^"+e+"$");const s=new RegExp(e,"i");i=function(e){return s.test(e[t])}}for(;t&&!i(t);){if(O(t))return null;t=t.parentNode}return t}function B(t,e){let i=-1;for(let s=0,n=t.length;s<n;s++)if(t[s]===e){i=s;break}return i}function A(t,e,i){if(e.style.cssText){const i=e.style;for(let e=0,s=i.length;e<s;e++)t.style[i[e]]=i[i[e]]}const s=e.attributes;for(let e,n=0,o=s.length;n<o;n++)e=s[n].name.toLowerCase(),i?.includes(e)||!s[n].value?t.removeAttribute(e):"style"!==e&&t.setAttribute(s[n].name,s[n].value)}function V(t){t&&("function"==typeof t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t))}function I(t,e){if(t)return new RegExp(`(\\s|^)${e}(\\s|$)`).test(t.className)}function R(t,e){if(!t)return;const i=t instanceof HTMLCollection||t instanceof NodeList||t instanceof Array?t:[t],s=e.split("|");for(const t of i)if(t&&1===t.nodeType)for(const e of s)e&&t.classList.add(e)}function z(t,e){if(!t)return;const i=t instanceof HTMLCollection||t instanceof NodeList||t instanceof Array?t:[t],s=e.split("|");for(const t of i)if(t&&1===t.nodeType)for(const e of s)e&&t.classList.remove(e)}function O(t){return 1===t?.nodeType&&(I(t,"se-wrapper-wysiwyg|sun-editor-carrier-wrapper")||/^BODY$/i.test(t.nodeName))}function $(t){return 1===t?.nodeType&&"false"===t.getAttribute("contenteditable")}function P(t){return/^LI$/i.test("string"==typeof t?t:t?.nodeName)}function D(t){return/^BR$/i.test("string"==typeof t?t:t?.nodeName)}function F(t){return t.hasAttribute("data-important-disabled")}function W(t=e){return{w:t.documentElement.clientWidth,h:t.documentElement.clientHeight}}const U={isZeroWith:S,createElement:E,createTextNode:function(t){return e.createTextNode(t||"")},getIframeDocument:function(t){let e=t.contentWindow||t.contentDocument;return e.document&&(e=e.document),e},getAttributesToString:function(t,e){if(!t.attributes)return"";const i=t.attributes;let s="";for(let t=0,n=i.length;t<n;t++)e?.includes(i[t].name)||(s+=i[t].name+'="'+i[t].value+'" ');return s},getPositionIndex:T,getNodePath:k,getNodeFromPath:N,getListChildren:function(t,e){const i=[];return t&&t.children&&0!==t.children.length?(e=e||function(){return!0},function s(n){if(t!==n&&e(n)&&i.push(n),n.children)for(let t=0,e=n.children.length;t<e;t++)s(n.children[t])}(t),i):i},getListChildNodes:H,getNodeDepth:L,sortNodeByDepth:function(t,e){const i=e?1:-1,s=-1*i;t.sort((function(t,e){return P(t)&&P(e)?(t=L(t))>(e=L(e))?i:t<e?s:0:0}))},compareElements:function(t,e){let i=t,s=e;for(;i&&s&&i.parentNode!==s.parentNode;)i=i.parentNode,s=s.parentNode;if(!i||!s)return{ancestor:null,a:t,b:e,result:0};const n=i.parentNode.childNodes,o=B(n,i),l=B(n,s);return{ancestor:i.parentNode,a:i,b:s,result:o>l?1:o<l?-1:0}},getParentElement:M,getParentElements:function(t,e){let i;if("function"==typeof e)i=e;else if("object"==typeof e)i=function(t){return t===e};else{let t;/^\./.test(e)?(t="className",e="(\\s|^)"+e.split(".")[1]+"(\\s|$)"):/^#/.test(e)?(t="id",e="^"+e.split("#")[1]+"$"):/^:/.test(e)?(t="name",e="^"+e.split(":")[1]+"$"):(t="nodeName",e="^"+e+"$");const s=new RegExp(e,"i");i=function(e){return s.test(e[t])}}const s=[];for(;t&&!O(t);)i(t)&&s.push(t),t=t.parentNode;return s},getCommandTarget:function(t){for(;!/^(UL|DIV)$/i.test(t.tagName);){if(t.hasAttribute("data-command"))return t;t=t.parentNode}return null},getEdgeChild:function(t,e,i){let s;if("function"==typeof e)s=e;else if("object"==typeof e)s=function(t){return t===e};else{let t;/^\./.test(e)?(t="className",e="(\\s|^)"+e.split(".")[1]+"(\\s|$)"):/^#/.test(e)?(t="id",e="^"+e.split("#")[1]+"$"):/^:/.test(e)?(t="name",e="^"+e.split(":")[1]+"$"):(t="nodeName",e="^"+("text"===e?"#"+e:e)+"$");const i=new RegExp(e,"i");s=function(e){return i.test(e[t])}}const n=H(t,(t=>s(t)));return n[i?n.length-1:0]},getEdgeChildNodes:function(t,e){if(t){for(e||(e=t);t&&1===t.nodeType&&t.childNodes.length>0&&!D(t);)t=t.firstChild;for(;e&&1===e.nodeType&&e.childNodes.length>0&&!D(e);)e=e.lastChild;return{sc:t,ec:e||t}}},getArrayItem:function(t,e,i){if(!t||0===t.length)return null;e=e||function(){return!0};const s=[];for(let n,o=0,l=t.length;o<l;o++)if(n=t[o],e(n)){if(!i)return n;s.push(n)}return i?s:null},arrayIncludes:function(t,e){for(let i=0;i<t.length;i++)if(t[i]===e)return!0;return!1},getArrayIndex:B,nextIndex:function(t,e){const i=B(t,e);return-1===i?-1:i+1},prevIndex:function(t,e){const i=B(t,e);return-1===i?-1:i-1},copyTagAttributes:A,copyFormatAttributes:function(t,e){(e=e.cloneNode(!1)).className=e.className.replace(/(\s|^)__se__format__[^\s]+/g,""),A(t,e)},isSameAttributes:function(t,e){if(3===t.nodeType&&3===e.nodeType)return!0;if(3===t.nodeType||3===e.nodeType)return!1;const i=t.style,s=e.style;let n=0;for(let t=0,e=i.length;t<e;t++)i[i[t]]===s[i[t]]&&n++;const o=t.classList,l=e.classList,r=RegExp;let a=0;for(let t=0,e=o.length;t<e;t++)r("(s|^)"+o[t]+"(s|$)").test(l.value)&&a++;return n===s.length&&n===i.length&&a===l.length&&a===o.length},removeItem:V,changeElement:function(t,e){if(t)if("string"==typeof e)if(t.outerHTML)t.outerHTML=e;else{const i=E("DIV");i.innerHTML=e,e=i.firstChild,t.parentNode.replaceChild(e,t)}else 1===e?.nodeType&&t.parentNode.replaceChild(e,t)},changeTxt:function(t,e){t&&e&&(t.textContent=e)},setStyle:function(t,e,i){for(let s,n=0,o=(t=Array.isArray(t)?t:[t]).length;n<o;n++)s=t[n],s.style[e]=i,i||s.style.cssText||s.removeAttribute("style")},setDisabled:function(t,e,i){for(let s=0,n=t.length;s<n;s++){const n=t[s];!i&&F(n)||(n.disabled=e),i&&(e?n.setAttribute("data-important-disabled",""):n.removeAttribute("data-important-disabled"))}},hasClass:I,addClass:R,removeClass:z,toggleClass:function(t,e){if(!t)return;if(1!==t.nodeType)return;let i=!1;const s=new RegExp(`(\\s|^)${e}(\\s|$)`);return s.test(t.className)?t.className=t.className.replace(s," ").trim():(t.className+=" "+e,i=!0),t.className.trim()||t.removeAttribute("class"),i},isEdgePoint:function(t,e,i){return"end"!==i&&0===e||(!i||"front"!==i)&&!t.nodeValue&&1===e||(!i||"end"===i)&&t.nodeValue&&e===t.nodeValue.length},isWysiwygFrame:O,isNonEditable:$,isList:function(t){return/^(OL|UL)$/i.test("string"==typeof t?t:t?.nodeName)},isListCell:P,isTable:function(t){return/^TABLE$/i.test("string"==typeof t?t:t?.nodeName)},isTableElements:function(t){return/^(TABLE|THEAD|TBODY|TR|TH|TD|COL)$/i.test("string"==typeof t?t:t?.nodeName)},isTableCell:function(t){return/^(TD|TH)$/i.test("string"==typeof t?t:t?.nodeName)},isTableRow:function(t){return/^TR$/i.test("string"==typeof t?t:t?.nodeName)},isBreak:D,isAnchor:function(t){return/^A$/i.test("string"==typeof t?t:t?.nodeName)},isMedia:function(t){return/^(IMG|IFRAME|AUDIO|VIDEO|CANVAS)$/i.test("string"==typeof t?t:t?.nodeName)},isFigure:function(t){return/^FIGURE$/i.test("string"==typeof t?t:t?.nodeName)},isInputElement:function(t){return 1===t?.nodeType&&/^(INPUT|TEXTAREA|SELECT|OPTION)$/i.test(t.nodeName)},isEmptyLine:function(t){return!t?.parentNode||!t.querySelector("IMG, IFRAME, AUDIO, VIDEO, CANVAS, TABLE")&&0===t.children.length&&S(t.textContent)},isSpanWithoutAttr:function(t){return 1===t?.nodeType&&/^SPAN$/i.test(t.nodeName)&&!t.className&&!t.style.cssText},isUneditable:function(t){return I(t,"__se__uneditable")},isImportantDisabled:F,isExcludeFormat:function(t){return/(\s|^)(katex|se-exclude-format)(\s|$)/.test(t?.className)},getScrollParent:function t(e){return!e||/^(body|html)$/i.test(e.nodeName)?null:e.scrollHeight>e.clientHeight?e:t(e.parentNode)},getClientSize:W,getViewportSize:function(){return"visualViewport"in t?{top:t.visualViewport.pageTop,left:t.visualViewport.pageLeft,scale:t.visualViewport.scale}:{top:0,left:0,scale:1}},getPreviousDeepestNode:function(t,e){let i=t.previousSibling;if(!i){for(let s=t.parentNode;s;s=s.parentNode){if(s===e)return null;if(s.previousSibling){i=s.previousSibling;break}}if(!i)return null}if($(i))return i;for(;i.lastChild;)i=i.lastChild;return i},getNextDeepestNode:function(t,e){let i=t.nextSibling;if(!i){for(let s=t.parentNode;s;s=s.parentNode){if(s===e)return null;if(s.nextSibling){i=s.nextSibling;break}}if(!i)return null}if($(i))return i;for(;i.firstChild;)i=i.firstChild;return i},applyInlineStylesAll:function(i,s,n){if(!i)return console.warn('"parentTarget" is not exist'),null;const o=e.createElement("DIV");if(o.style.display="none",/body/i.test(i.nodeName)){const t=e.createElement("DIV"),s=i.attributes;for(let e=0,i=s.length;e<i;e++)t.setAttribute(s[e].name,s[e].value);t.innerHTML=i.innerHTML,i=t}else i=i.cloneNode(!0);o.appendChild(i),e.body.appendChild(o);const l=i.querySelectorAll("*");for(let e,i=s?0:1;e=l[i];i++){const i=t.getComputedStyle(e);for(const t of n||i)e.style[t]=i.getPropertyValue(t)||""}return e.body.removeChild(o),i}};function Z(t,e){if(!t)return 0;let i=(t+"").match(/-?\d+(\.\d+)?/);return i&&i[0]?(i=i[0],e<0?1*i:0===e?Math.round(1*i):1*(1*i).toFixed(e)):0}const q=f,G={zeroWidthSpace:b,zeroWidthRegExp:v,onlyZeroWidthRegExp:y,escapeStringRegexp:function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},Y=x,X=U,j={is:function(t){return/^-?\d+(\.\d+)?$/.test(t+"")},get:Z,getOverlapRangeAtIndex:function(t,e,i,s){if(t<=s?e<i:e>i)return 0;const n=(t>i?t:i)-(e<s?e:s);return(n<0?-1*n:n)+1},isEven:function(t){return!(1&t)},isOdd:function(t){return!(1&~t)}},K={env:q,unicode:G,converter:Y,domUtils:X,numbers:j},J={redo:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z" /></svg>',undo:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" /></svg>',bold:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.76 15.75"><g><path d="M6.4,3.76V19.5h6.76a5.55,5.55,0,0,0,2-.32,4.93,4.93,0,0,0,1.52-1,4.27,4.27,0,0,0,1.48-3.34,3.87,3.87,0,0,0-.69-2.37,5.74,5.74,0,0,0-.71-.83,3.44,3.44,0,0,0-1.1-.65,3.6,3.6,0,0,0,1.58-1.36,3.66,3.66,0,0,0,.53-1.93,3.7,3.7,0,0,0-1.21-2.87,4.65,4.65,0,0,0-3.25-1.1H6.4Zm2.46,6.65V5.57h3.52a4.91,4.91,0,0,1,1.36.15,2.3,2.3,0,0,1,.85.45,2.06,2.06,0,0,1,.74,1.71,2.3,2.3,0,0,1-.78,1.92,2.54,2.54,0,0,1-.86.46,4.7,4.7,0,0,1-1.32.15H8.86Zm0,7.27V12.15H12.7a4.56,4.56,0,0,1,1.38.17,3.43,3.43,0,0,1,.95.49,2.29,2.29,0,0,1,.92,2,2.73,2.73,0,0,1-.83,2.1,2.66,2.66,0,0,1-.83.58,3.25,3.25,0,0,1-1.26.2H8.86Z" transform="translate(-6.4 -3.75)"/></g></svg>',underline:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9.78 15.74"><g><path d="M14.64,3.76h2.52v7.72a4.51,4.51,0,0,1-.59,2.31,3.76,3.76,0,0,1-1.71,1.53,6.12,6.12,0,0,1-2.64.53,5,5,0,0,1-3.57-1.18,4.17,4.17,0,0,1-1.27-3.24V3.76H9.9v7.3a3,3,0,0,0,.55,2,2.3,2.3,0,0,0,1.83.65,2.26,2.26,0,0,0,1.8-.65,3.09,3.09,0,0,0,.55-2V3.76Zm2.52,13.31V19.5H7.39V17.08h9.77Z" transform="translate(-7.38 -3.76)"/></g></svg>',italic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.49 15.76"><g><path d="M17.16,3.79l.37,0-.06.38-.14.52A10,10,0,0,1,16.21,5a9.37,9.37,0,0,0-1,.32,6.68,6.68,0,0,0-.25.89c-.06.31-.11.59-.14.85-.3,1.36-.52,2.41-.68,3.14l-.61,3.18L13.1,15l-.43,2.4-.12.46a.62.62,0,0,0,0,.28c.44.1.85.17,1.23.22l.68.11a4.51,4.51,0,0,1-.08.6l-.09.42a.92.92,0,0,0-.23,0l-.43,0a1.37,1.37,0,0,1-.29,0c-.13,0-.63-.08-1.49-.16l-2,0c-.28,0-.87,0-1.78.12L7,19.5l.17-.88.8-.2A6.61,6.61,0,0,0,9.19,18,2.62,2.62,0,0,0,9.61,17l.28-1.41.58-2.75.12-.66c.05-.3.11-.58.17-.86s.12-.51.17-.69l.12-.48.12-.43.31-1.6.15-.65.31-1.91V5.14a3.86,3.86,0,0,0-1.48-.29l-.38,0,.2-1.06,3.24.14.75,0c.45,0,1.18,0,2.18-.09.23,0,.46,0,.71,0Z" transform="translate(-7.04 -3.76)"/></g></svg>',strike:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 14.9"><g><path d="M12.94,13a4.27,4.27,0,0,1,1.32.58,1.46,1.46,0,0,1,.55,1.2,1.87,1.87,0,0,1-.88,1.64,4.17,4.17,0,0,1-2.35.59,4.44,4.44,0,0,1-2.74-.71,2.72,2.72,0,0,1-1-2.17H5.57a4.56,4.56,0,0,0,1.55,3.7,7,7,0,0,0,4.47,1.23,6,6,0,0,0,4.07-1.3,4.24,4.24,0,0,0,1.52-3.37,4,4,0,0,0-.26-1.4h-4ZM6.37,10.24A3.27,3.27,0,0,1,6,8.68a4,4,0,0,1,1.48-3.3,5.92,5.92,0,0,1,3.88-1.21,5.58,5.58,0,0,1,3.91,1.24,4.36,4.36,0,0,1,1.45,3.17H14.44a2.12,2.12,0,0,0-.91-1.81,4.45,4.45,0,0,0-2.44-.55,3.69,3.69,0,0,0-2,.51A1.64,1.64,0,0,0,8.3,8.22a1.3,1.3,0,0,0,.48,1.11,7,7,0,0,0,2.1.78l.28.06.28.08H6.37Zm13.09.68a.73.73,0,0,1,.49.21.66.66,0,0,1,.2.48.64.64,0,0,1-.2.48.71.71,0,0,1-.49.19H5.1a.67.67,0,0,1-.49-.19.66.66,0,0,1-.2-.48.64.64,0,0,1,.2-.48.73.73,0,0,1,.49-.21H19.46Z" transform="translate(-4.41 -4.17)"/></g></svg>',subscript:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.75 14.61"><g><path d="M15.38,4.33H12.74L11.19,7c-.28.46-.51.87-.69,1.21L10.07,9h0l-.44-.8c-.22-.4-.45-.81-.71-1.23L7.34,4.33H4.68L8.26,10,4.4,16.08H7.1l1.69-2.83c.38-.63.72-1.22,1-1.78l.25-.46h0l.49.92c.24.45.48.89.74,1.32L13,16.08h2.61L11.84,10l1.77-2.84,1.77-2.85Zm4.77,13.75H17v-.15c0-.4.05-.64.16-.72a4.42,4.42,0,0,1,1.16-.31,3.3,3.3,0,0,0,1.54-.56A1.84,1.84,0,0,0,20.15,15a1.78,1.78,0,0,0-.44-1.41A2.8,2.8,0,0,0,18,13.25a2.71,2.71,0,0,0-1.69.37,1.83,1.83,0,0,0-.44,1.43v.23H17v-.23q0-.63.18-.78a1.62,1.62,0,0,1,.88-.15,1.59,1.59,0,0,1,.88.15q.18.15.18.75t-.18.75a3.58,3.58,0,0,1-1.18.33,3.33,3.33,0,0,0-1.52.51,1.57,1.57,0,0,0-.32,1.18v1.15h4.27v-.86Z" transform="translate(-4.4 -4.33)"/></g></svg>',superscript:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.75 15.42"><g><path d="M12,13.14l3.61-5.81H12.94L11.33,10c-.28.46-.51.88-.69,1.25l-.45.83h0l-.45-.85c-.22-.41-.45-.82-.71-1.24L7.4,7.33H4.68l3.66,5.81L4.4,19.33H7.14l1.74-2.87q.58-1,1-1.83l.25-.48h0l.51.94.75,1.37,1.72,2.87h2.67l-1.92-3.09c-1.12-1.8-1.76-2.83-1.92-3.1Zm4.84-4.41h0l0,.15h3.27v.86H15.77V8.58a1.66,1.66,0,0,1,.33-1.22,3.51,3.51,0,0,1,1.56-.51,3.68,3.68,0,0,0,1.21-.34c.13-.1.19-.36.19-.77S19,5.07,18.87,5A1.63,1.63,0,0,0,18,4.8a1.58,1.58,0,0,0-.91.17c-.13.11-.19.38-.19.8V6H15.78V5.76a1.87,1.87,0,0,1,.45-1.47A2.84,2.84,0,0,1,18,3.91a2.8,2.8,0,0,1,1.72.38,1.84,1.84,0,0,1,.45,1.44,1.91,1.91,0,0,1-.34,1.35,3.24,3.24,0,0,1-1.58.57A3.69,3.69,0,0,0,17,8c-.12.1-.17.35-.17.76Z" transform="translate(-4.4 -3.91)"/></g></svg>',remove_color:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.65,20.87L18.3,18.5L12,12.23L8.44,8.66L7,7.25L4.27,4.5L3,5.77L5.78,8.55C3.23,11.69 3.42,16.31 6.34,19.24C7.9,20.8 9.95,21.58 12,21.58C13.79,21.58 15.57,21 17.03,19.8L19.73,22.5L21,21.23L20.65,20.87M12,19.59C10.4,19.59 8.89,18.97 7.76,17.83C6.62,16.69 6,15.19 6,13.59C6,12.27 6.43,11 7.21,10L12,14.77V19.59M12,5.1V9.68L19.25,16.94C20.62,14 20.09,10.37 17.65,7.93L12,2.27L8.3,5.97L9.71,7.38L12,5.1Z" /></svg>',remove_format:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6,5V5.18L8.82,8H11.22L10.5,9.68L12.6,11.78L14.21,8H20V5H6M3.27,5L2,6.27L8.97,13.24L6.5,19H9.5L11.07,15.34L16.73,21L18,19.73L3.55,5.27L3.27,5Z" /></svg>',indent:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 12.36"><g><path d="M4.68,14.45a.27.27,0,0,1-.19-.08.3.3,0,0,1-.08-.21V9.1a.27.27,0,0,1,.08-.19.28.28,0,0,1,.2-.08.25.25,0,0,1,.19.07l2.54,2.54a.29.29,0,0,1,0,.4L4.88,14.36a.24.24,0,0,1-.2.09Zm15.19,1.12a.27.27,0,0,1,.19.08.25.25,0,0,1,.08.19v1.69a.27.27,0,0,1-.08.19.25.25,0,0,1-.19.08H4.68a.27.27,0,0,1-.19-.08.25.25,0,0,1-.08-.19V15.84a.27.27,0,0,1,.27-.27H19.87Zm0-3.38a.27.27,0,0,1,.19.08.28.28,0,0,1,.08.21v1.68a.32.32,0,0,1-.08.21.25.25,0,0,1-.19.08H10.31a.27.27,0,0,1-.19-.08.3.3,0,0,1-.08-.21V12.48a.32.32,0,0,1,.08-.21.24.24,0,0,1,.19-.08h9.56Zm0-3.37a.27.27,0,0,1,.19.08.25.25,0,0,1,.08.19v1.69a.27.27,0,0,1-.08.19.25.25,0,0,1-.19.08H10.31a.27.27,0,0,1-.27-.27V9.1a.27.27,0,0,1,.27-.27h9.56Zm.2-3.29a.28.28,0,0,1,.08.2V7.41a.32.32,0,0,1-.08.21.25.25,0,0,1-.19.08H4.68a.27.27,0,0,1-.19-.08.3.3,0,0,1-.08-.21V5.73a.32.32,0,0,1,.08-.21.25.25,0,0,1,.19-.08H19.87a.28.28,0,0,1,.2.09Z" transform="translate(-4.41 -5.44)"/></g></svg>',outdent:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 12.36"><g><path d="M19.87,15.57a.27.27,0,0,1,.19.08.25.25,0,0,1,.08.19v1.69a.27.27,0,0,1-.08.19.25.25,0,0,1-.19.08H4.68a.27.27,0,0,1-.19-.08.25.25,0,0,1-.08-.19V15.84a.27.27,0,0,1,.27-.27H19.87ZM7.5,14.45a.25.25,0,0,1-.2-.09L4.76,11.84a.29.29,0,0,1,0-.4L7.3,8.9a.29.29,0,0,1,.4,0,.31.31,0,0,1,.07.2v5.06a.32.32,0,0,1-.08.21.26.26,0,0,1-.19.08ZM19.87,8.82a.27.27,0,0,1,.19.08.25.25,0,0,1,.08.19v1.69a.27.27,0,0,1-.08.19.25.25,0,0,1-.19.08H10.31a.27.27,0,0,1-.27-.27V9.1a.27.27,0,0,1,.27-.27h9.56Zm0,3.37a.27.27,0,0,1,.19.08.28.28,0,0,1,.08.21v1.68a.32.32,0,0,1-.08.21.25.25,0,0,1-.19.08H10.31a.27.27,0,0,1-.19-.08.3.3,0,0,1-.08-.21V12.48a.32.32,0,0,1,.08-.21.24.24,0,0,1,.19-.08h9.56Zm.2-6.66a.28.28,0,0,1,.08.2V7.41a.32.32,0,0,1-.08.21.25.25,0,0,1-.19.08H4.68a.27.27,0,0,1-.19-.08.3.3,0,0,1-.08-.21V5.73a.32.32,0,0,1,.08-.21.25.25,0,0,1,.19-.08H19.87a.28.28,0,0,1,.2.09Z" transform="translate(-4.41 -5.44)"/></g></svg>',expansion:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.74"><g><path d="M11.8,13.06l-5.1,5.1H9.51V19.5H4.41V14.4H5.75v2.81L8.3,14.66q2.25-2.23,2.55-2.55Zm8.35-9.3v5.1H18.81V6.05l-5.1,5.1-1-1,5.1-5.1H15.05V3.76Z" transform="translate(-4.41 -3.76)"/></g></svg>',reduction:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.74"><g><path d="M14.91,10h2.87v1.38H12.55V6.12h1.38V9l5.24-5.24.48.49.49.48ZM6.77,11.92H12v5.23H10.62V14.26L5.37,19.5l-1-1L9.63,13.3H6.77Z" transform="translate(-4.4 -3.76)"/></g></svg>',code_view:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.73 11.8"><g><path d="M8.09,7.94a.76.76,0,0,1,.53.22.72.72,0,0,1,.21.52.76.76,0,0,1-.22.54L6.18,11.63l2.43,2.44a.69.69,0,0,1,.2.51.66.66,0,0,1-.21.51.75.75,0,0,1-.51.22.63.63,0,0,1-.51-.21h0L4.63,12.15a.7.7,0,0,1-.22-.53.67.67,0,0,1,.25-.55L7.57,8.16a.82.82,0,0,1,.52-.22Zm12.05,3.69a.7.7,0,0,1-.23.52L17,15.1h0a.66.66,0,0,1-.51.21.73.73,0,0,1-.51-.22.75.75,0,0,1-.22-.51.63.63,0,0,1,.21-.51l2.43-2.44L15.92,9.22a.73.73,0,0,1-.22-.53A.74.74,0,0,1,17,8.18h0l2.91,2.91a.67.67,0,0,1,.27.54Zm-5.9-5.9a.73.73,0,0,1,.61.32.71.71,0,0,1,.07.68L11,17a1,1,0,0,1-.22.32.6.6,0,0,1-.35.16.75.75,0,0,1-.69-.26.69.69,0,0,1-.12-.72L13.56,6.23a.75.75,0,0,1,.26-.35.74.74,0,0,1,.42-.15Z" transform="translate(-4.41 -5.73)"/></g></svg>',preview:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.65 15.66"><g><path d="M16.19,14.43l2.49,2.49a.73.73,0,0,1,.21.52.67.67,0,0,1-.22.51.7.7,0,0,1-.52.22.69.69,0,0,1-.51-.21l-2.49-2.48a5.17,5.17,0,0,1-1.34.69,4.64,4.64,0,0,1-1.48.24,4.78,4.78,0,1,1,0-9.56,4.79,4.79,0,0,1,1.84.36,4.9,4.9,0,0,1,1.56,1,4.77,4.77,0,0,1,.46,6.18ZM10,14a3.3,3.3,0,0,0,2.34.93A3.37,3.37,0,0,0,14.7,14a3.3,3.3,0,0,0-1.08-5.41,3.47,3.47,0,0,0-2.56,0A3,3,0,0,0,10,9.28,3.31,3.31,0,0,0,10,14ZM16,4a3.86,3.86,0,0,1,2.77,1.14A3.9,3.9,0,0,1,20,7.85v4a.77.77,0,0,1-.22.53.7.7,0,0,1-.52.21.72.72,0,0,1-.74-.74v-4a2.46,2.46,0,0,0-.72-1.73A2.37,2.37,0,0,0,16,5.45H8.53A2.42,2.42,0,0,0,6.08,7.89v7.52a2.41,2.41,0,0,0,.71,1.73,2.46,2.46,0,0,0,1.74.72h4.08a.73.73,0,0,1,0,1.46H8.53a3.85,3.85,0,0,1-2.78-1.14A3.93,3.93,0,0,1,4.6,15.4V7.87A3.94,3.94,0,0,1,5.76,5.09,3.88,3.88,0,0,1,8.54,4H16Z" transform="translate(-4.45 -3.8)"/></g></svg>',print:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.05 16.04"><g><path d="M19.76,15.84a1.29,1.29,0,0,0,.39-.92V8.35A2.05,2.05,0,0,0,19.57,7a1.93,1.93,0,0,0-1.38-.57H6.37a1.95,1.95,0,0,0-2,2v6.56a1.23,1.23,0,0,0,.38.92,1.35,1.35,0,0,0,.93.38h2V14.9l-2,0V8.35a.67.67,0,0,1,.18-.47.62.62,0,0,1,.48-.19H18.18a.6.6,0,0,1,.46.19.66.66,0,0,1,.18.47V14.9h-2v1.32h2A1.35,1.35,0,0,0,19.76,15.84ZM17.52,7.69V5.06a1.31,1.31,0,0,0-.38-.92,1.34,1.34,0,0,0-.94-.38H8.34A1.3,1.3,0,0,0,7,5.06V7.69H8.34V5.06h7.87V7.69h1.31ZM8.34,12.93h7.87l0,5.26H8.34V12.93Zm7.87,5.26v0Zm.65,1.31a.6.6,0,0,0,.46-.19.72.72,0,0,0,.2-.47V12.29a.74.74,0,0,0-.2-.47.6.6,0,0,0-.46-.19H7.68a.6.6,0,0,0-.46.19.72.72,0,0,0-.2.47v6.55a.74.74,0,0,0,.2.47.6.6,0,0,0,.46.19h9.18ZM16.67,9.28a.7.7,0,0,0-.94,0,.63.63,0,0,0-.18.46.67.67,0,0,0,.18.47.68.68,0,0,0,.94,0,.66.66,0,0,0,.18-.47A.58.58,0,0,0,16.67,9.28Z" transform="translate(-4.25 -3.61)"/></g></svg>',template:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.27 15.64"><g><path d="M18.18,19.16a1,1,0,0,0,1-1V5.73a1,1,0,0,0-1-1h-2v1h2V18.19H6.37V5.73h2v-1h-2A.94.94,0,0,0,5.68,5a1,1,0,0,0-.29.7V18.18a.94.94,0,0,0,.29.69,1,1,0,0,0,.69.29H18.18ZM9.82,10.31h4.92a.49.49,0,0,0,.35-.15.47.47,0,0,0,.15-.35.49.49,0,0,0-.15-.35.47.47,0,0,0-.35-.15H9.82a.49.49,0,0,0-.35.15.47.47,0,0,0-.15.35.49.49,0,0,0,.15.35.47.47,0,0,0,.35.15Zm5.9,4.92H8.83a.49.49,0,0,0-.35.15.47.47,0,0,0-.15.35.49.49,0,0,0,.15.35.47.47,0,0,0,.35.15h6.89a.49.49,0,0,0,.35-.15.47.47,0,0,0,.15-.35.51.51,0,0,0-.5-.5ZM7.36,12.77a.49.49,0,0,0,.15.35.47.47,0,0,0,.35.15h8.85a.49.49,0,0,0,.35-.15.47.47,0,0,0,.15-.35.49.49,0,0,0-.15-.35.47.47,0,0,0-.35-.15H7.85a.49.49,0,0,0-.35.15.52.52,0,0,0-.14.35Z" transform="translate(-5.14 -3.77)"/><path d="M14.24,6.71a1,1,0,0,0,1-1,1,1,0,0,0-1-1,1,1,0,0,0-1-1h-2a.94.94,0,0,0-.69.28,1,1,0,0,0-.29.7A.94.94,0,0,0,9.62,5a.91.91,0,0,0-.29.69,1,1,0,0,0,.29.7,1,1,0,0,0,.69.29h3.93Z" transform="translate(-5.14 -3.77)"/></g></svg>',layout:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="5 5 36 36"><path d="M12.5 34.05h11v-3h-11Zm6-8.55h11v-3h-11Zm6-8.55h11v-3h-11ZM9 42q-1.2 0-2.1-.9Q6 40.2 6 39V9q0-1.2.9-2.1Q7.8 6 9 6h30q1.2 0 2.1.9.9.9.9 2.1v30q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h30V9H9v30ZM9 9v30V9Z"/></svg>',new_document:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12.78 15.75"><g><path d="M14.73,3.76,18.67,7.7v9.84a2,2,0,0,1-2,2H7.84a1.89,1.89,0,0,1-1.38-.58,2,2,0,0,1-.57-1.39V5.73a1.93,1.93,0,0,1,.57-1.38,2,2,0,0,1,1.38-.58h6.62l.26,0v0Zm2.95,4.92h-2a1.93,1.93,0,0,1-1.38-.57,2,2,0,0,1-.58-1.4V6.17c0-.36,0-.84,0-1.43H7.85a1,1,0,0,0-.7.29,1,1,0,0,0-.29.7V17.54a1,1,0,0,0,.29.69,1,1,0,0,0,.69.29h8.85a1,1,0,0,0,.71-.29.92.92,0,0,0,.28-.69Zm0-1L14.73,4.74v2A1,1,0,0,0,15,7.4a1,1,0,0,0,.69.29Z" transform="translate(-5.89 -3.76)"/></g></svg>',select_all:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z" /></svg>',line_height:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.76 13.56"><g><path d="M4.4,4.88V8.26a2,2,0,0,0,.5.39s.1,0,.18-.12a.62.62,0,0,0,.17-.28c.06-.19.13-.44.21-.74s.14-.52.19-.66a.58.58,0,0,1,.21-.3,2.41,2.41,0,0,1,.63-.21,3.83,3.83,0,0,1,.88-.12,9.15,9.15,0,0,1,1.31.06.16.16,0,0,1,.11,0,.26.26,0,0,1,.06.14,4,4,0,0,1,0,.49v2l.05,3.77c0,1.41,0,2.68-.05,3.81a1.79,1.79,0,0,1-.11.49,10.68,10.68,0,0,1-1.4.45,1.12,1.12,0,0,0-.69.43v.31l0,.22.61,0c.85-.08,1.54-.12,2.06-.12a19.76,19.76,0,0,1,2.09.08,15.08,15.08,0,0,0,1.64.08,1.4,1.4,0,0,0,.29,0,1.58,1.58,0,0,0,0-.26l-.05-.43a2.26,2.26,0,0,0-.43-.17l-.77-.22-.15,0a2.55,2.55,0,0,1-.78-.28,2.56,2.56,0,0,1-.11-.75l0-1.29,0-3.15V7.53a10.51,10.51,0,0,1,.06-1.2,3.83,3.83,0,0,1,.6,0l1.88,0a2.18,2.18,0,0,1,.38,0,.45.45,0,0,1,.23.17.9.9,0,0,1,.05.25c0,.16.06.35.1.58a3.33,3.33,0,0,0,.14.55A6.39,6.39,0,0,0,15,9a2.91,2.91,0,0,0,.6-.15,2.77,2.77,0,0,0,0-.46l0-.51,0-2.95-.25,0-.38,0L15,4.94a.71.71,0,0,1-.18.15.45.45,0,0,1-.25.07l-.29,0H8.75l-.15,0H7.45a17,17,0,0,1-1.86,0L5.36,5l-.25-.13ZM19.75,16.14h-.69v-9h.69A.4.4,0,0,0,20.13,7c.06-.11,0-.24-.1-.39L18.92,5.15a.52.52,0,0,0-.86,0L17,6.58c-.12.15-.16.28-.1.39s.18.16.38.16h.69v9h-.69a.4.4,0,0,0-.38.16c-.06.11,0,.24.1.39l1.11,1.43a.52.52,0,0,0,.86,0L20,16.69c.12-.15.16-.28.1-.39a.4.4,0,0,0-.38-.16Z" transform="translate(-4.4 -4.86)"/></g></svg>',paragraph_style:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.81 15.74"><g><path d="M18.18,3.76v2h-2V19.5h-2V5.73h-2V19.5h-2V11.63a3.94,3.94,0,0,1,0-7.87h7.87Z" transform="translate(-6.37 -3.76)"/></g></svg>',text_style:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,3H16V6H11V18H8V6H3V3M12,7H14V9H12V7M15,7H17V9H15V7M18,7H20V9H18V7M12,10H14V12H12V10M12,13H14V15H12V13M12,16H14V18H12V16M12,19H14V21H12V19Z" /></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.74"><g><path d="M18.53,19.5l.2-.05A1.78,1.78,0,0,0,20.13,18l0-.09V7.14a2,2,0,0,0-.28-.64A3.18,3.18,0,0,0,19.43,6c-.5-.52-1-1-1.55-1.54A2.59,2.59,0,0,0,17.37,4a1.83,1.83,0,0,0-.61-.25H6l-.21,0a1.78,1.78,0,0,0-1.4,1.49l0,.1V17.87a2.49,2.49,0,0,0,.09.37,1.79,1.79,0,0,0,1.44,1.23l.09,0Zm-6.25-.6H6.92a.61.61,0,0,1-.68-.48.78.78,0,0,1,0-.22V12.3a.62.62,0,0,1,.69-.68H17.64a.62.62,0,0,1,.69.69V18.2a.64.64,0,0,1-.71.69H12.28ZM12,9.81H8.15a.63.63,0,0,1-.72-.71v-4a.64.64,0,0,1,.72-.72h7.66a.64.64,0,0,1,.72.72v4a.65.65,0,0,1-.74.72ZM13.5,5V9.18h1.78V5Z" transform="translate(-4.41 -3.76)"/></g></svg>',blockquote:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 475.082 475.081"><g><path d="M164.45,219.27h-63.954c-7.614,0-14.087-2.664-19.417-7.994c-5.327-5.33-7.994-11.801-7.994-19.417v-9.132c0-20.177,7.139-37.401,21.416-51.678c14.276-14.272,31.503-21.411,51.678-21.411h18.271c4.948,0,9.229-1.809,12.847-5.424c3.616-3.617,5.424-7.898,5.424-12.847V54.819c0-4.948-1.809-9.233-5.424-12.85c-3.617-3.612-7.898-5.424-12.847-5.424h-18.271c-19.797,0-38.684,3.858-56.673,11.563c-17.987,7.71-33.545,18.132-46.68,31.267c-13.134,13.129-23.553,28.688-31.262,46.677C3.855,144.039,0,162.931,0,182.726v200.991c0,15.235,5.327,28.171,15.986,38.834c10.66,10.657,23.606,15.985,38.832,15.985h109.639c15.225,0,28.167-5.328,38.828-15.985c10.657-10.663,15.987-23.599,15.987-38.834V274.088c0-15.232-5.33-28.168-15.994-38.832C192.622,224.6,179.675,219.27,164.45,219.27z"/><path d="M459.103,235.256c-10.656-10.656-23.599-15.986-38.828-15.986h-63.953c-7.61,0-14.089-2.664-19.41-7.994c-5.332-5.33-7.994-11.801-7.994-19.417v-9.132c0-20.177,7.139-37.401,21.409-51.678c14.271-14.272,31.497-21.411,51.682-21.411h18.267c4.949,0,9.233-1.809,12.848-5.424c3.613-3.617,5.428-7.898,5.428-12.847V54.819c0-4.948-1.814-9.233-5.428-12.85c-3.614-3.612-7.898-5.424-12.848-5.424h-18.267c-19.808,0-38.691,3.858-56.685,11.563c-17.984,7.71-33.537,18.132-46.672,31.267c-13.135,13.129-23.559,28.688-31.265,46.677c-7.707,17.987-11.567,36.879-11.567,56.674v200.991c0,15.235,5.332,28.171,15.988,38.834c10.657,10.657,23.6,15.985,38.828,15.985h109.633c15.229,0,28.171-5.328,38.827-15.985c10.664-10.663,15.985-23.599,15.985-38.834V274.088C475.082,258.855,469.76,245.92,459.103,235.256z"/></g></svg>',arrow_down:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.73 8.67"><g><path d="M18.79,7.52a.8.8,0,0,1,.56-.23.82.82,0,0,1,.79.79.8.8,0,0,1-.23.56l-7.07,7.07a.79.79,0,0,1-.57.25.77.77,0,0,1-.57-.25h0L4.64,8.65a.8.8,0,0,1-.23-.57.82.82,0,0,1,.79-.79.8.8,0,0,1,.56.23L12.28,14l3.26-3.26,3.25-3.26Z" transform="translate(-4.41 -7.29)"/></g></svg>',align_justify:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 13.77"><g><path d="M4.41,4.74v2H20.15v-2H4.41Zm0,5.9H20.15v-2H4.41v2Zm0,3.94H20.15v-2H4.41v2Zm0,3.93h7.87v-2H4.41v2Z" transform="translate(-4.41 -4.74)"/></g></svg>',align_left:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 13.77"><g><path d="M4.41,4.74v2H20.15v-2H4.41Zm11.8,3.94H4.41v2H16.22v-2Zm-11.8,5.9H18.18v-2H4.41v2Zm0,3.93h9.84v-2H4.41v2Z" transform="translate(-4.41 -4.74)"/></g></svg>',align_right:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 13.77"><g><path d="M4.41,4.74v2H20.15v-2H4.41Zm3.93,5.9H20.15v-2H8.34v2Zm-2,3.94H20.14v-2H6.37v2Zm3.94,3.93h9.84v-2H10.31v2Z" transform="translate(-4.41 -4.74)"/></g></svg>',align_center:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 13.77"><g><path d="M4.41,4.74v2H20.15v-2H4.41Zm2,3.94v2H18.18v-2H6.37Zm-1,5.9H19.16v-2H5.39v2Zm2,3.93H17.2v-2H7.36v2Z" transform="translate(-4.41 -4.74)"/></g></svg>',align_top:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8,11H11V21H13V11H16L12,7L8,11M4,3V5H20V3H4Z" /></svg>',align_middle:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8,19H11V23H13V19H16L12,15L8,19M16,5H13V1H11V5H8L12,9L16,5M4,11V13H20V11H4Z" /></svg>',align_bottom:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,13H13V3H11V13H8L12,17L16,13M4,19V21H20V19H4Z" /></svg>',format_float_none:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,7H9V13H3V7M3,3H21V5H3V3M21,11V13H11V11H21M3,15H17V17H3V15M3,19H21V21H3V19Z" /></svg>',format_float_left:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,7H9V13H3V7M3,3H21V5H3V3M21,7V9H11V7H21M21,11V13H11V11H21M3,15H17V17H3V15M3,19H21V21H3V19Z" /></svg>',format_float_right:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15,7H21V13H15V7M3,3H21V5H3V3M13,7V9H3V7H13M9,11V13H3V11H9M3,15H17V17H3V15M3,19H21V21H3V19Z" /></svg>',format_float_center:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,7H15V13H9V7M3,3H21V5H3V3M3,15H21V17H3V15M3,19H17V21H3V19Z" /></svg>',font_color:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 14.61"><g><path d="M18.5,15.57,14.28,4.32h-3.4L6.65,15.57h3l.8-2.26h4.23l.8,2.26h3ZM14,11.07H11.14L12.54,7,13.25,9c.41,1.18.64,1.86.7,2ZM4.41,16.69v2.24H20.15V16.69H4.41Z" transform="translate(-4.41 -4.32)"/></g></svg>',background_color:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.66 15.74"><g><path d="M12.32,9.31,13.38,13H11.21l.52-1.83q.46-1.61.54-1.83ZM4.44,3.76H20.1V19.5H4.44V3.76ZM14.71,17.32h2.63L13.7,6H10.89L7.26,17.32H9.89l.63-2.24h3.55l.32,1.12c.18.65.29,1,.32,1.12Z" transform="translate(-4.44 -3.76)"/></g></svg>',list_bulleted:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 12.37"><g><path d="M7.77,16.12a1.59,1.59,0,0,0-.49-1.18,1.62,1.62,0,0,0-1.19-.49,1.68,1.68,0,1,0,0,3.36,1.67,1.67,0,0,0,1.68-1.69Zm0-4.48A1.67,1.67,0,0,0,6.09,10,1.68,1.68,0,0,0,4.9,12.82a1.62,1.62,0,0,0,1.19.49,1.67,1.67,0,0,0,1.68-1.67Zm12.38,3.64a.27.27,0,0,0-.08-.19.28.28,0,0,0-.2-.09H9.19a.28.28,0,0,0-.2.08.29.29,0,0,0-.08.19V17a.27.27,0,0,0,.28.28H19.87a.27.27,0,0,0,.19-.08.24.24,0,0,0,.08-.2V15.28ZM7.77,7.13a1.63,1.63,0,0,0-.49-1.2,1.61,1.61,0,0,0-1.19-.49,1.61,1.61,0,0,0-1.19.49,1.71,1.71,0,0,0,0,2.4,1.62,1.62,0,0,0,1.19.49,1.61,1.61,0,0,0,1.19-.49,1.63,1.63,0,0,0,.49-1.2Zm12.38,3.66a.28.28,0,0,0-.08-.2.29.29,0,0,0-.19-.08H9.19a.27.27,0,0,0-.28.28v1.69a.27.27,0,0,0,.08.19.24.24,0,0,0,.2.08H19.87a.27.27,0,0,0,.19-.08.25.25,0,0,0,.08-.19V10.79Zm0-4.5a.27.27,0,0,0-.08-.19A.25.25,0,0,0,19.88,6H9.19A.28.28,0,0,0,9,6.1a.26.26,0,0,0-.08.19V8A.27.27,0,0,0,9,8.17a.24.24,0,0,0,.2.08H19.87a.27.27,0,0,0,.19-.08A.25.25,0,0,0,20.14,8V6.29Z" transform="translate(-4.41 -5.44)"/></g></svg>',list_numbered:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.69 15.74"><g><path d="M7.66,18a1.24,1.24,0,0,0-.26-.78,1.17,1.17,0,0,0-.72-.42l.85-1V15H4.58v1.34h.94v-.46l.85,0h0c-.11.11-.22.23-.32.35s-.23.27-.37.47L5.39,17l.23.51c.61-.05.92.11.92.49a.42.42,0,0,1-.18.37.79.79,0,0,1-.45.12A1.41,1.41,0,0,1,5,18.15l-.51.77A2.06,2.06,0,0,0,6,19.5a1.8,1.8,0,0,0,1.2-.41A1.38,1.38,0,0,0,7.66,18Zm0-5.54H6.75V13H5.63A.72.72,0,0,1,6,12.51a5.45,5.45,0,0,1,.66-.45,2.71,2.71,0,0,0,.67-.57,1.19,1.19,0,0,0,.31-.81,1.29,1.29,0,0,0-.45-1,1.86,1.86,0,0,0-2-.11,1.51,1.51,0,0,0-.62.7l.74.52A.87.87,0,0,1,6,10.28a.51.51,0,0,1,.35.12.42.42,0,0,1,.13.33.55.55,0,0,1-.21.4,3,3,0,0,1-.5.38c-.19.13-.39.27-.58.42a2,2,0,0,0-.5.6,1.63,1.63,0,0,0-.21.81,3.89,3.89,0,0,0,.05.48h3.2V12.44Zm12.45,2.82a.27.27,0,0,0-.08-.19.28.28,0,0,0-.21-.08H9.1a.32.32,0,0,0-.21.08.24.24,0,0,0-.08.2V17a.27.27,0,0,0,.08.19.3.3,0,0,0,.21.08H19.83a.32.32,0,0,0,.21-.08.25.25,0,0,0,.08-.19V15.26ZM7.69,7.32h-1V3.76H5.8L4.6,4.88l.63.68a1.85,1.85,0,0,0,.43-.48h0l0,2.24H4.74V8.2h3V7.32Zm12.43,3.42a.27.27,0,0,0-.08-.19.28.28,0,0,0-.21-.08H9.1a.32.32,0,0,0-.21.08.24.24,0,0,0-.08.2v1.71a.27.27,0,0,0,.08.19.3.3,0,0,0,.21.08H19.83a.32.32,0,0,0,.21-.08.25.25,0,0,0,.08-.19V10.74Zm0-4.52A.27.27,0,0,0,20,6,.28.28,0,0,0,19.83,6H9.1A.32.32,0,0,0,8.89,6a.24.24,0,0,0-.08.19V7.93a.27.27,0,0,0,.08.19.32.32,0,0,0,.21.08H19.83A.32.32,0,0,0,20,8.12a.26.26,0,0,0,.08-.2V6.22Z" transform="translate(-4.43 -3.76)"/></g></svg>',table:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.74"><g><path d="M4.41,8.05V3.76H8.7V8.05H4.41Zm5.71,0V3.76h4.3V8.05h-4.3Zm5.74-4.29h4.29V8.05H15.86V3.76Zm-11.45,10V9.48H8.7v4.3H4.41Zm5.71,0V9.48h4.3v4.3h-4.3Zm5.74,0V9.48h4.29v4.3H15.86ZM4.41,19.5V15.21H8.7V19.5H4.41Zm5.71,0V15.21h4.3V19.5h-4.3Zm5.74,0V15.21h4.29V19.5H15.86Z" transform="translate(-4.41 -3.76)"/></g></svg>',table_header:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.75 15.74"><g><path d="M17,19.5v-.78H15.5v.78H17Zm-3,0v-.78H12.5v.78H14Zm-3,0v-.78H9.53v.78H11Zm-3,0v-.78H6.53v.78H8Zm10.55,0a1.73,1.73,0,0,0,.85-.35,1.67,1.67,0,0,0,.56-.76l-.71-.31a1.21,1.21,0,0,1-.35.4,1.34,1.34,0,0,1-.53.23l.08.38c.06.24.09.38.1.41Zm-13.7-.63.55-.55A.77.77,0,0,1,5.25,18a1.31,1.31,0,0,1-.06-.38v-.38H4.41v.38a2,2,0,0,0,.12.68,1.6,1.6,0,0,0,.35.57Zm15.27-2.12V15.26h-.78v1.49h.78Zm-15-1V14.23H4.41v1.49h.78Zm15-2V12.26h-.78v1.49h.78Zm-15-1V11.22H4.41v1.51h.78Zm15-2V9.26h-.78v1.51h.78Zm-15-1V8.17H4.41V9.74h.78Zm15-2V6.28h-.78V7.77h.78Zm-15-1.11V5.33L4.48,5.1a.77.77,0,0,0-.07.27,2.72,2.72,0,0,0,0,.28v1h.79ZM19.21,5l.63-.4A1.62,1.62,0,0,0,19.16,4a1.94,1.94,0,0,0-.91-.22v.78a1.31,1.31,0,0,1,.56.12.88.88,0,0,1,.4.36ZM6,4.54H7.78V3.76H6a.82.82,0,0,0-.28.06l.12.35c.07.21.1.33.11.36Zm10.8,0V3.76H15.28v.78h1.49Zm-3,0V3.76H12.28v.78h1.49Zm-3,0V3.76H9.28v.78h1.51ZM6,10.84h12.6V6.91H6Z" transform="translate(-4.4 -3.76)"/></g></svg>',table_properties:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7,22H9V24H7V22M11,22H13V24H11V22M15,22H17V24H15V22M5,4H19A2,2 0 0,1 21,6V18A2,2 0 0,1 19,20H5A2,2 0 0,1 3,18V6A2,2 0 0,1 5,4M5,8V12H11V8H5M13,8V12H19V8H13M5,14V18H11V14H5M13,14V18H19V14H13Z" /></svg>',cell_properties:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7,22H9V24H7V22M11,22H13V24H11V22M15,22H17V24H15V22M5,4H19A2,2 0 0,1 21,6V18A2,2 0 0,1 19,20H5A2,2 0 0,1 3,18V6A2,2 0 0,1 5,4M5,8V12H11V8H5M13,8V12H19V8H13M5,14V18H11V14H5M13,14V18H19V14H13Z" /></svg>',table_column:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8,2H16A2,2 0 0,1 18,4V20A2,2 0 0,1 16,22H8A2,2 0 0,1 6,20V4A2,2 0 0,1 8,2M8,10V14H16V10H8M8,16V20H16V16H8M8,4V8H16V4H8Z" /></svg>',table_row:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,14A2,2 0 0,1 20,16H4A2,2 0 0,1 2,14V10A2,2 0 0,1 4,8H20A2,2 0 0,1 22,10V14M4,14H8V10H4V14M10,14H14V10H10V14M16,14H20V10H16V14Z" /></svg>',color_palette:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z" /></svg>',border_all:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,11H13V5H19M19,19H13V13H19M11,11H5V5H11M11,19H5V13H11M3,21H21V3H3V21Z" /></svg>',border_inside:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,17H21V15H19M19,21H21V19H19M13,3H11V11H3V13H11V21H13V13H21V11H13M15,21H17V19H15M19,5H21V3H19M19,9H21V7H19M17,3H15V5H17M5,3H3V5H5M9,3H7V5H9M3,17H5V15H3M5,7H3V9H5M7,21H9V19H7M3,21H5V19H3V21Z" /></svg>',border_horizontal:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,21H21V19H19M15,21H17V19H15M11,17H13V15H11M19,9H21V7H19M19,5H21V3H19M3,13H21V11H3M11,21H13V19H11M19,17H21V15H19M13,3H11V5H13M13,7H11V9H13M17,3H15V5H17M9,3H7V5H9M5,3H3V5H5M7,21H9V19H7M3,17H5V15H3M5,7H3V9H5M3,21H5V19H3V21Z" /></svg>',border_vertical:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15,13H17V11H15M15,21H17V19H15M15,5H17V3H15M19,9H21V7H19M19,5H21V3H19M19,13H21V11H19M19,21H21V19H19M11,21H13V3H11M19,17H21V15H19M7,5H9V3H7M3,17H5V15H3M3,21H5V19H3M3,13H5V11H3M7,13H9V11H7M7,21H9V19H7M3,5H5V3H3M3,9H5V7H3V9Z" /></svg>',border_outside:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,11H7V13H9M13,15H11V17H13M19,19H5V5H19M3,21H21V3H3M17,11H15V13H17M13,11H11V13H13M13,7H11V9H13V7Z" /></svg>',border_left:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15,5H17V3H15M15,13H17V11H15M19,21H21V19H19M19,13H21V11H19M19,5H21V3H19M19,17H21V15H19M15,21H17V19H15M19,9H21V7H19M3,21H5V3H3M7,13H9V11H7M7,5H9V3H7M7,21H9V19H7M11,13H13V11H11M11,9H13V7H11M11,5H13V3H11M11,17H13V15H11M11,21H13V19H11V21Z" /></svg>',border_top:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15,13H17V11H15M19,21H21V19H19M11,9H13V7H11M15,21H17V19H15M19,17H21V15H19M3,5H21V3H3M19,13H21V11H19M19,9H21V7H19M11,17H13V15H11M3,9H5V7H3M3,13H5V11H3M3,21H5V19H3M3,17H5V15H3M11,21H13V19H11M11,13H13V11H11M7,13H9V11H7M7,21H9V19H7V21Z" /></svg>',border_right:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11,5H13V3H11M15,5H17V3H15M15,21H17V19H15M19,21H21V3H19M3,9H5V7H3M3,17H5V15H3M3,13H5V11H3M11,21H13V19H11M3,21H5V19H3M7,5H9V3H7M3,5H5V3H3M7,21H9V19H7V21Z" /></svg>',border_bottom:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5,15H3V17H5M3,21H21V19H3M5,11H3V13H5M19,9H21V7H19M19,5H21V3H19M5,7H3V9H5M19,17H21V15H19M19,13H21V11H19M17,3H15V5H17M13,3H11V5H13M5,3H3V5H5M9,3H7V5H9" /></svg>',border_none:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15,5H17V3H15M15,13H17V11H15M15,21H17V19H15M11,5H13V3H11M19,5H21V3H19M11,9H13V7H11M19,9H21V7H19M19,21H21V19H19M19,13H21V11H19M19,17H21V15H19M11,13H13V11H11M3,5H5V3H3M3,9H5V7H3M3,13H5V11H3M3,17H5V15H3M3,21H5V19H3M11,21H13V19H11M11,17H13V15H11M7,21H9V19H7M7,13H9V11H7M7,5H9V3H7V5Z" /></svg>',horizontal_line:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 2.24"><g><path d="M20.15,12.75V10.51H4.41v2.24H20.15Z" transform="translate(-4.41 -10.51)"/></g></svg>',show_blocks:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.66 15.67"><g><path d="M19.72,5.58a1.64,1.64,0,0,0-1.64-1.64H6.23a1.62,1.62,0,0,0-1.16.48,1.63,1.63,0,0,0-.48,1.16V9.63a1.6,1.6,0,0,0,.48,1.16,1.62,1.62,0,0,0,1.16.47H18.09a1.67,1.67,0,0,0,1.16-.47,1.62,1.62,0,0,0,.48-1.16V5.58Zm-.94,4.05a.68.68,0,0,1-.7.7H6.23a.66.66,0,0,1-.48-.2.74.74,0,0,1-.21-.5V5.58a.66.66,0,0,1,.2-.48.71.71,0,0,1,.48-.21H18.08a.74.74,0,0,1,.5.21.66.66,0,0,1,.2.48ZM6.48,7.72a.21.21,0,0,0,.17-.07.22.22,0,0,0,.07-.17V7.06a1.27,1.27,0,0,1,.11-.52.37.37,0,0,1,.36-.23H8.77A.25.25,0,0,0,9,6.17a.19.19,0,0,0,0-.23.27.27,0,0,0-.2-.12H7.19a.88.88,0,0,0-.72.39,1.51,1.51,0,0,0-.23.85v.42a.24.24,0,0,0,.24.24Zm-.19.81a.21.21,0,0,0,.17-.07.26.26,0,0,0,.07-.17.24.24,0,0,0-.24-.24.2.2,0,0,0-.16.09.2.2,0,0,0-.07.16.22.22,0,0,0,.07.17.23.23,0,0,0,.16.06Zm8.46,5.1a1.63,1.63,0,0,0-.47-1.16A1.61,1.61,0,0,0,13.12,12H6.23a1.6,1.6,0,0,0-1.16.46,1.62,1.62,0,0,0-.48,1.16v4.05a1.64,1.64,0,0,0,1.64,1.64h6.89a1.6,1.6,0,0,0,1.16-.48,1.62,1.62,0,0,0,.47-1.16Zm-.94,4a.7.7,0,0,1-.2.49.65.65,0,0,1-.5.2H6.23a.66.66,0,0,1-.48-.2.75.75,0,0,1-.21-.49v-4a.74.74,0,0,1,.21-.5.66.66,0,0,1,.48-.2h6.89a.68.68,0,0,1,.7.7v4Zm6.15,0v-4a1.6,1.6,0,0,0-.48-1.16A1.67,1.67,0,0,0,18.32,12H17.1a1.63,1.63,0,0,0-1.16.47,1.61,1.61,0,0,0-.47,1.16v4a1.67,1.67,0,0,0,.47,1.16,1.62,1.62,0,0,0,1.16.48h1.22A1.64,1.64,0,0,0,20,17.68Zm-.94-4v4a.75.75,0,0,1-.21.49.62.62,0,0,1-.48.2H17.11a.69.69,0,0,1-.5-.2.7.7,0,0,1-.2-.49v-4a.68.68,0,0,1,.7-.7h1.22a.66.66,0,0,1,.48.2.72.72,0,0,1,.21.5Z" transform="translate(-4.44 -3.79)"/></g></svg>',cancel:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>',selection_remove:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 20V17H22V20C22 21.11 21.1 22 20 22H17V20H20M2 20V17H4V20H7V22H4C2.9 22 2 21.1 2 20M10 20H14V22H10V20M14.59 8L12 10.59L9.41 8L8 9.41L10.59 12L8 14.59L9.41 16L12 13.41L14.59 16L16 14.59L13.41 12L16 9.41L14.59 8M20 10H22V14H20V10M2 10H4V14H2V10M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.9 22 4M10 2H14V4H10V2Z" /></svg>',image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.75 15.77"><g><path d="M8.77,8.72a.88.88,0,0,1-.61-.27.82.82,0,0,1-.25-.61.89.89,0,0,1,.25-.62A.82.82,0,0,1,8.77,7a.81.81,0,0,1,.61.25.83.83,0,0,1,.27.62.81.81,0,0,1-.25.61.91.91,0,0,1-.63.27Zm9.62-5a1.74,1.74,0,0,1,1.76,1.76V17.76a1.74,1.74,0,0,1-1.76,1.76H6.16A1.74,1.74,0,0,1,4.4,17.76V5.51A1.74,1.74,0,0,1,6.16,3.75H18.39Zm0,1.75H6.16v8L8.53,11.8a.94.94,0,0,1,.54-.17.86.86,0,0,1,.54.2L11.09,13l3.64-4.55a.78.78,0,0,1,.34-.25.85.85,0,0,1,.42-.07.89.89,0,0,1,.39.12.78.78,0,0,1,.28.29l2.24,3.67V5.51Zm0,12.24V15.6L15.3,10.53,11.89,14.8a.89.89,0,0,1-.59.32.82.82,0,0,1-.64-.18L9,13.62,6.16,15.74v2Z" transform="translate(-4.4 -3.75)"/></g></svg>',video:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 14.55"><g><path d="M20.15,10.26V18.9l-3.94-1.57v1.2H4.41V10.66H16.22v1.23l2-.81,2-.82ZM14.64,17h0V12.54h0v-.31H6V17h8.67Zm3.94-.37v-4l-2.37,1v2l1.18.48,1.19.48ZM7.94,9.86A2.77,2.77,0,0,1,5.19,7.11a2.76,2.76,0,0,1,5.51,0A2.78,2.78,0,0,1,7.94,9.86Zm0-3.93a1.21,1.21,0,0,0-.83.35,1.15,1.15,0,0,0-.34.84A1.09,1.09,0,0,0,7.11,8,1.15,1.15,0,0,0,8,8.28,1.13,1.13,0,0,0,9.11,7.12,1.16,1.16,0,0,0,7.94,5.93Zm5.9,3.93a2.34,2.34,0,0,1-1.67-.68,2.3,2.3,0,0,1-.68-1.67,2.35,2.35,0,0,1,4-1.67,2.37,2.37,0,0,1,0,3.34,2.33,2.33,0,0,1-1.68.68Zm0-3.14a.75.75,0,1,0,.55.22.73.73,0,0,0-.55-.22Z" transform="translate(-4.41 -4.35)"/></g></svg>',link:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.72"><g><path d="M13.05,13.63a.24.24,0,0,1,.15.22L13.42,16a.19.19,0,0,1-.08.18l-2.12,2.14a4.08,4.08,0,0,1-1.29.85A4,4,0,0,1,4.71,17a3.92,3.92,0,0,1-.3-1.52A4,4,0,0,1,4.71,14a3.91,3.91,0,0,1,.87-1.3L7.7,10.56a.25.25,0,0,1,.2-.06l2.17.22a.21.21,0,0,1,.19.15.24.24,0,0,1,0,.25L7.12,14.23a1.81,1.81,0,0,0,0,2.58,1.78,1.78,0,0,0,1.29.52,1.74,1.74,0,0,0,1.28-.52L12.8,13.7a.24.24,0,0,1,.25-.07ZM19,4.92a4,4,0,0,1,0,5.66L16.86,12.7a.25.25,0,0,1-.17.08l-2.2-.23a.21.21,0,0,1-.19-.15.22.22,0,0,1,0-.25L17.44,9a1.81,1.81,0,0,0,0-2.58,1.78,1.78,0,0,0-1.29-.52,1.74,1.74,0,0,0-1.28.52L11.76,9.57a.21.21,0,0,1-.25,0,.24.24,0,0,1-.16-.21l-.22-2.17a.19.19,0,0,1,.08-.18l2.12-2.14a4.08,4.08,0,0,1,1.29-.85,4.05,4.05,0,0,1,3.06,0,3.85,3.85,0,0,1,1.3.85ZM5.84,9.82a.25.25,0,0,1-.18-.08.19.19,0,0,1-.07-.19l.11-.77a.2.2,0,0,1,.11-.17.24.24,0,0,1,.2,0l2.5.72a.25.25,0,0,1,.15.27.22.22,0,0,1-.23.21l-2.59,0Zm4.12-2-.73-2.5a.27.27,0,0,1,0-.2A.21.21,0,0,1,9.41,5L10.19,5a.25.25,0,0,1,.19,0,.23.23,0,0,1,.08.18l-.05,2.61a.2.2,0,0,1-.19.23h0A.22.22,0,0,1,10,7.85Zm8.76,5.58a.25.25,0,0,1,.18.08.23.23,0,0,1,.06.2l-.11.77a.25.25,0,0,1-.11.17.21.21,0,0,1-.12,0l-.08,0L16,14a.25.25,0,0,1-.15-.27.22.22,0,0,1,.22-.21l1.29,0,1.33,0Zm-4.12,2,.74,2.51a.28.28,0,0,1,0,.2.23.23,0,0,1-.18.11l-.8.11a.23.23,0,0,1-.17-.07.25.25,0,0,1-.08-.18l0-2.61a.22.22,0,0,1,.22-.22.21.21,0,0,1,.26.15Z" transform="translate(-4.41 -3.77)"/></g></svg>',link_rel:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 1C1.89 1 1 1.89 1 3V14C1 15.11 1.89 16 3 16H14C15.11 16 16 15.11 16 14V11H14V14H3V3H14V5H16V3C16 1.89 15.11 1 14 1M9 7C7.89 7 7 7.89 7 9V12H9V9H20V20H9V18H7V20C7 21.11 7.89 22 9 22H20C21.11 22 22 21.11 22 20V9C22 7.89 21.11 7 20 7H9" /></svg>',math:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.81 15.73"><g><path d="M17.19,5.73a1,1,0,0,0,.71-.29,1,1,0,0,0,.28-.7,1,1,0,0,0-1-1H7.35a1,1,0,0,0-1,1,.77.77,0,0,0,.13.47h0l4.58,6.43L6.68,17.81a1.25,1.25,0,0,0-.29.71.94.94,0,0,0,.28.7.92.92,0,0,0,.69.28H17.2a1,1,0,0,0,.71-.28,1,1,0,0,0,0-1.39.92.92,0,0,0-.71-.29H9.26l3.87-5.43a.86.86,0,0,0,0-.95L9.26,5.73h7.93Z" transform="translate(-6.38 -3.77)"/></g></svg>',unlink:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.72"><g><path d="M19,18.32a4,4,0,0,0,0-5.68L15.85,9.5l-1.17,1.55L17.57,14a2,2,0,0,1,.61,1.47,2.08,2.08,0,0,1-2.09,2.09,2,2,0,0,1-1.47-.61l-.38-.37-1.74,1,.8.78a4,4,0,0,0,5.68,0ZM8,9.77a2,2,0,0,1-1.27-1,1.89,1.89,0,0,1-.21-1.57A2.1,2.1,0,0,1,7.45,6,2,2,0,0,1,9,5.76L12.27,7.2l.49-2L9.48,3.9a4,4,0,0,0-3.06.41A3.82,3.82,0,0,0,4.56,6.73a3.8,3.8,0,0,0,.4,3A3.78,3.78,0,0,0,7.39,11.6l5.38,2,.49-2-2.64-.94L8,9.77Z" transform="translate(-4.41 -3.76)"/></g></svg>',merge_cell:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>table-merge-cells</title><path d="M5,10H3V4H11V6H5V10M19,18H13V20H21V14H19V18M5,18V14H3V20H11V18H5M21,4H13V6H19V10H21V4M8,13V15L11,12L8,9V11H3V13H8M16,11V9L13,12L16,15V13H21V11H16Z" /></svg>',split_cell:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>table-split-cell</title><path d="M19 14H21V20H3V14H5V18H19V14M3 4V10H5V6H19V10H21V4H3M11 11V13H8V15L5 12L8 9V11H11M16 11V9L19 12L16 15V13H13V11H16Z" /></svg>',caption:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 13.79"><g><path d="M4.41,18.52H20.15v-2H4.41ZM20,4.73H18.07V6h.65v.65H20V4.73ZM17,6V4.73H14.55V6H17ZM13.49,6V4.73H11V6h2.47ZM10,6V4.73H7.5V6H10ZM5.79,6h.65V4.73H4.5V6.67H5.8V6ZM4.5,11.34H5.79V8.48H4.5ZM6.44,13.8H5.79v-.65H4.5v1.94H6.44ZM17,15.09V13.8H14.55v1.29H17Zm-3.52,0V13.8H11v1.29h2.47Zm-3.53,0V13.8H7.5v1.29H10ZM20,13.16H18.72v.65h-.65V15.1H20Zm-1.29-1.82H20V8.48h-1.3v2.86Z" transform="translate(-4.41 -4.73)"/></g></svg>',edit:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.73"><g><path d="M7.51,5.68h6l1.52-1.57H6.94a2.4,2.4,0,0,0-1.79.82A2.8,2.8,0,0,0,4.41,6.8V17a2.55,2.55,0,0,0,.75,1.8A2.48,2.48,0,0,0,7,19.5H17.22a2.57,2.57,0,0,0,1.83-.74,2.52,2.52,0,0,0,.77-1.8V8.83l-1.58,1.54v6a1.54,1.54,0,0,1-1.53,1.53H7.51A1.54,1.54,0,0,1,6,16.41V7.21A1.52,1.52,0,0,1,7.51,5.68Zm5.63,7.47h0L10.7,10.74l-1,3.38,1.71-.48,1.7-.49Zm.34-.34h0l5.36-5.32L16.4,5.08,11,10.4l1.23,1.21,1.21,1.2ZM19.93,6.4a.82.82,0,0,0,.22-.48A.54.54,0,0,0,20,5.47L18.45,4A.67.67,0,0,0,18,3.77a.7.7,0,0,0-.48.21l-.74.72,2.44,2.43.37-.37.35-.36Z" transform="translate(-4.41 -3.77)"/></g></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.73 15.74"><g><path d="M19.16,6.71a.94.94,0,0,0,.69-.28.91.91,0,0,0,.29-.68A1,1,0,0,0,19.85,5a.93.93,0,0,0-.69-.3H14.24A.94.94,0,0,0,14,4.06a.92.92,0,0,0-.7-.3h-2a1,1,0,0,0-.7.3.93.93,0,0,0-.28.68H5.39A.92.92,0,0,0,4.7,5a1,1,0,0,0-.29.71.91.91,0,0,0,.29.68,1,1,0,0,0,.69.28H19.16Zm-12.79,1a1,1,0,0,0-.7.3.94.94,0,0,0-.28.69v8.85A1.88,1.88,0,0,0,6,18.93a1.9,1.9,0,0,0,1.39.57H17.2a1.87,1.87,0,0,0,1.39-.58,1.91,1.91,0,0,0,.58-1.39V8.68A1,1,0,0,0,18.88,8a.89.89,0,0,0-.7-.29,1,1,0,0,0-.69.29.92.92,0,0,0-.29.68v7.87a1,1,0,0,1-1,1H8.34a.94.94,0,0,1-.69-.28,1,1,0,0,1-.29-.71V8.68a1,1,0,0,0-1-1Z" transform="translate(-4.41 -3.76)"/></g></svg>',revert:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.76 14.69"><g><path d="M18.26,15V12.3l1.89-2V15a2.58,2.58,0,0,1-.24,1c-.2.58-.75.92-1.65,1H7.56v2L4.41,15.63,7.56,13v2h10.7ZM6.3,8.28V11L4.41,13V8.28a2.58,2.58,0,0,1,.24-1c.2-.58.75-.92,1.65-1H17v-2l3.15,3.34L17,10.3v-2H6.3Z" transform="translate(-4.4 -4.28)"/></g></svg>',auto_size:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 15.74"><g><path d="M6.71,17.19,6.89,16l1.21-.15A6,6,0,0,1,6.81,13.9a5.78,5.78,0,0,1-.45-2.27A6,6,0,0,1,8.1,7.45a5.83,5.83,0,0,1,4.17-1.73l1-1-1-1A7.89,7.89,0,0,0,5,14.64a7.73,7.73,0,0,0,1.71,2.55Zm5.57,2.31h0A7.86,7.86,0,0,0,17.85,6.07L17.67,7.3l-1.21.15a5.9,5.9,0,0,1,1.29,1.92,5.81,5.81,0,0,1,.45,2.26,5.91,5.91,0,0,1-5.9,5.9l-1,1,.49.49.47.5Z" transform="translate(-4.41 -3.76)"/></g></svg>',resize:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23,15H21V17H23V15M23,11H21V13H23V11M23,19H21V21C22,21 23,20 23,19M15,3H13V5H15V3M23,7H21V9H23V7M21,3V5H23C23,4 22,3 21,3M3,21H11V15H1V19A2,2 0 0,0 3,21M3,7H1V9H3V7M15,19H13V21H15V19M19,3H17V5H19V3M19,19H17V21H19V19M3,3C2,3 1,4 1,5H3V3M3,11H1V13H3V11M11,3H9V5H11V3M7,3H5V5H7V3Z" /></svg>',insert_row_below:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.8 15.8"><g><path d="M15.7,1.3c-0.1-0.1-0.1-0.2-0.2-0.2L15.3,1H0.4L0.3,1.1c0,0-0.1,0.1-0.1,0.1c0,0-0.1,0.1-0.1,0.1L0,1.4v7.7l0.1,0.1c0,0.1,0.1,0.1,0.2,0.2l0.1,0.1h2.3V9.3l0.1-0.5L3,8.5l0.1-0.2c-0.1,0-0.2,0-0.3,0H1.2v-6h13.3v6h-1.6c-0.1,0-0.2,0-0.3,0l0.1,0.2l0.2,0.4C12.9,9,13,9.2,13,9.3v0.1h2.3l0.2-0.1c0.1,0,0.1-0.1,0.2-0.2l0.1-0.1V1.4L15.7,1.3z"/><path d="M10.5,7.5C9.9,7.1,9.3,6.8,8.6,6.7c-0.2,0-0.5-0.1-0.7,0c-0.2,0-0.5,0-0.7,0C6.6,6.7,6.1,6.9,5.6,7.3C5.2,7.6,4.7,8,4.4,8.4C4.3,8.6,4.2,8.8,4.2,8.9C4.1,9.1,4,9.3,3.9,9.4C3.9,9.6,3.8,9.7,3.8,9.9c0,0.2-0.1,0.3-0.1,0.5v-0.1c-0.1,0.8,0.1,1.6,0.5,2.4c0.4,0.7,1,1.3,1.7,1.7c0.3,0.2,0.6,0.3,0.9,0.3c0.3,0.1,0.7,0.1,1,0.1c0.3,0,0.7,0,1-0.1c0.3-0.1,0.6-0.2,0.9-0.3c0.5-0.3,0.9-0.6,1.3-1c0.3-0.4,0.6-0.8,0.8-1.3c0.1-0.4,0.2-0.9,0.2-1.4c0-0.5-0.1-1-0.3-1.4C11.5,8.6,11.1,8,10.5,7.5z M10.1,11.3H8.5v1.6H8H7.9H7.3v0v-0.1v-1.4H5.7v-0.4v-0.2v-0.6h0h1.5V8.5h1.2v1.6h1.6V11.3z"/></g></svg>',insert_row_above:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.8 15.8"><g><path d="M0.1,14.5c0.1,0.1,0.1,0.2,0.2,0.2l0.1,0.1h14.9l0.1-0.1c0,0,0.1-0.1,0.1-0.1c0,0,0.1-0.1,0.1-0.1l0.1-0.1V6.7l-0.1-0.1c0-0.1-0.1-0.1-0.2-0.2l-0.1-0.1h-2.3v0.1l-0.1,0.5l-0.2,0.4l-0.1,0.2c0.1,0,0.2,0,0.3,0h1.6v6H1.3v-6h1.6c0.1,0,0.2,0,0.3,0L3.1,7.3L2.9,6.9C2.8,6.8,2.8,6.6,2.7,6.5V6.3H0.4L0.3,6.4c-0.1,0-0.1,0.1-0.2,0.2L0,6.7v7.7L0.1,14.5z"/><path d="M5.3,8.3c0.6,0.5,1.2,0.8,1.9,0.9c0.2,0,0.5,0.1,0.7,0c0.2,0,0.5,0,0.7,0c0.6-0.1,1.1-0.3,1.6-0.6c0.5-0.3,0.9-0.7,1.2-1.2c0.1-0.2,0.2-0.3,0.3-0.5c0.1-0.2,0.2-0.4,0.2-0.5c0.1-0.1,0.1-0.3,0.1-0.4C12,5.8,12,5.6,12,5.4v0.1c0.1-0.8-0.1-1.6-0.5-2.4c-0.4-0.7-1-1.3-1.7-1.7C9.5,1.3,9.2,1.2,8.9,1.1C8.5,1,8.2,1,7.9,1c-0.3,0-0.7,0-1,0.1C6.6,1.2,6.3,1.3,6,1.4C5.5,1.7,5.1,2,4.7,2.4C4.4,2.8,4.1,3.3,3.9,3.8C3.8,4.2,3.7,4.7,3.7,5.2c0,0.5,0.1,1,0.3,1.4C4.3,7.2,4.7,7.8,5.3,8.3z M5.7,4.5h1.6V2.9h0.5h0.1h0.6v0v0.1v1.4H10v0.4v0.2v0.6h0H8.5v1.6H7.3V5.7H5.7V4.5z"/></g></svg>',insert_column_left:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.8 15.8"><g><path d="M14.5,15.7c0.1-0.1,0.2-0.1,0.2-0.2l0.1-0.1V0.4l-0.1-0.1c0,0-0.1-0.1-0.1-0.1c0,0-0.1-0.1-0.1-0.1L14.4,0H6.7L6.6,0.1c-0.1,0-0.1,0.1-0.2,0.2L6.3,0.4v2.3h0.1l0.5,0.1L7.3,3l0.2,0.1c0-0.1,0-0.2,0-0.3V1.2h6v13.3h-6v-1.6c0-0.1,0-0.2,0-0.3l-0.2,0.1l-0.4,0.2C6.7,12.9,6.6,13,6.4,13H6.3v2.3l0.1,0.2c0,0.1,0.1,0.1,0.2,0.2l0.1,0.1h7.7L14.5,15.7z"/><path d="M8.3,10.5C8.7,10,9,9.3,9.1,8.6c0-0.2,0.1-0.5,0-0.7c0-0.2,0-0.5,0-0.7C9,6.7,8.8,6.1,8.5,5.7C8.2,5.2,7.8,4.8,7.3,4.5C7.2,4.4,7,4.3,6.9,4.2C6.7,4.1,6.5,4,6.4,4C6.2,3.9,6.1,3.9,5.9,3.8c-0.2,0-0.3-0.1-0.5-0.1h0.1C4.7,3.7,3.8,3.9,3.1,4.3C2.4,4.7,1.8,5.3,1.4,6C1.3,6.3,1.2,6.6,1.1,6.9C1,7.2,1,7.6,1,7.9c0,0.3,0,0.7,0.1,1c0.1,0.3,0.2,0.6,0.3,0.9c0.3,0.5,0.6,0.9,1,1.3c0.4,0.3,0.8,0.6,1.3,0.8C4.2,12,4.7,12.1,5.1,12c0.5,0,1-0.1,1.4-0.3C7.2,11.5,7.8,11.1,8.3,10.5zM4.5,10.1V8.5H2.9V8V7.9V7.3h0H3h1.4V5.7h0.4h0.2h0.6v0v1.5h1.6v1.2H5.7v1.6H4.5z"/></g></svg>',insert_column_right:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.8 15.8"><g><path d="M1.3,0.1C1.2,0.2,1.1,0.2,1.1,0.3L1,0.4v14.9l0.1,0.1c0,0,0.1,0.1,0.1,0.1c0,0,0.1,0.1,0.1,0.1l0.1,0.1h7.7l0.1-0.1c0.1,0,0.1-0.1,0.2-0.2l0.1-0.1v-2.3H9.3l-0.5-0.1l-0.4-0.2l-0.2-0.1c0,0.1,0,0.2,0,0.3v1.6h-6V1.3h6v1.6c0,0.1,0,0.2,0,0.3l0.2-0.1l0.4-0.2C9,2.9,9.2,2.8,9.3,2.8h0.1V0.5L9.4,0.3c0-0.1-0.1-0.1-0.2-0.2L9.1,0H1.4L1.3,0.1z"/><path d="M7.5,5.3C7,5.8,6.7,6.5,6.6,7.2c0,0.2-0.1,0.5,0,0.7c0,0.2,0,0.5,0,0.7c0.1,0.6,0.3,1.1,0.6,1.6c0.3,0.5,0.7,0.9,1.2,1.2c0.2,0.1,0.3,0.2,0.5,0.3c0.2,0.1,0.4,0.2,0.5,0.2c0.1,0.1,0.3,0.1,0.4,0.1c0.2,0,0.3,0.1,0.5,0.1h-0.1c0.8,0.1,1.6-0.1,2.4-0.5c0.7-0.4,1.3-1,1.7-1.7c0.2-0.3,0.3-0.6,0.3-0.9c0.1-0.3,0.1-0.7,0.1-1c0-0.3,0-0.7-0.1-1c-0.1-0.3-0.2-0.6-0.3-0.9c-0.3-0.5-0.6-0.9-1-1.3C13,4.4,12.5,4.2,12,4c-0.4-0.1-0.9-0.2-1.4-0.2c-0.5,0-1,0.1-1.4,0.2C8.5,4.3,7.9,4.7,7.5,5.3z M11.3,5.7v1.6h1.6v0.5v0.1v0.6h0h-0.1h-1.4v1.6h-0.4h-0.2h-0.6v0V8.5H8.5V7.3h1.6V5.7H11.3z"/></g></svg>',delete_row:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.75 13.83"><g><path d="M4.7,18.46l.12.08H19.73l.12-.08a.58.58,0,0,0,.22-.22l.08-.12,0-7.69-.08-.11a.77.77,0,0,0-.18-.18l-.11-.08-2.31,0-.08.28-.1.29a1.58,1.58,0,0,1-.12.29l-.14.34s0,0,.18,0H18.9v6H5.64v-6H7.35c.14,0,.2,0,.18,0l-.14-.34a2.85,2.85,0,0,1-.12-.29l-.1-.29-.07-.27-2.31,0-.11.08a.77.77,0,0,0-.18.18l-.08.11,0,7.69.08.12a.47.47,0,0,0,.09.12l.13.09ZM12.11,13a4,4,0,0,0,1.46-.21,4.51,4.51,0,0,0,1.31-.71A4,4,0,0,0,16.26,10a4.32,4.32,0,0,0-.08-2.54,4.34,4.34,0,0,0-1-1.52,4.15,4.15,0,0,0-1.54-1,4.34,4.34,0,0,0-1.35-.22A4.07,4.07,0,0,0,11,4.93,3.94,3.94,0,0,0,9.24,6.07,3.92,3.92,0,0,0,8.15,8.88a3.91,3.91,0,0,0,.12.95A4.16,4.16,0,0,0,12.11,13Zm2.35-4.14v.58H10.09V8.27h4.37v.58Z" transform="translate(-4.4 -4.71)"/></g></svg>',delete_column:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13.81 15.74"><g><path d="M5.66,19.42l.12.08,7.69,0,.11-.08a.77.77,0,0,0,.18-.18l.08-.11,0-2.32-.15,0-.45-.15-.42-.18-.17-.07a1,1,0,0,0,0,.27v1.63h-6V5h6V6.62a.9.9,0,0,0,0,.26l.17-.07.42-.17a3.91,3.91,0,0,1,.45-.15l.15,0,0-2.32L13.75,4a.77.77,0,0,0-.18-.18l-.11-.08H5.79l-.13.07a.63.63,0,0,0-.21.22l-.08.12V19.08l.08.12a.47.47,0,0,0,.09.12.35.35,0,0,0,.12.1Zm9-3.67a4.16,4.16,0,0,0,2.36-.51,4.08,4.08,0,0,0,1.67-1.72,4,4,0,0,0,.35-.91,3.79,3.79,0,0,0,.1-1,4.71,4.71,0,0,0-.11-1,5,5,0,0,0-.3-.87,4.25,4.25,0,0,0-1-1.25,4.49,4.49,0,0,0-1.34-.81A4.26,4.26,0,0,0,15,7.48a3.88,3.88,0,0,0-1.41.25A4.32,4.32,0,0,0,11.86,9,4,4,0,0,0,11,10.94a4.4,4.4,0,0,0-.05.68,4.5,4.5,0,0,0,.05.68,3.93,3.93,0,0,0,.61,1.57,4.22,4.22,0,0,0,1.18,1.2,4.59,4.59,0,0,0,.48.27c.2.1.37.17.5.22a2.44,2.44,0,0,0,.45.12,4.61,4.61,0,0,0,.5.07Zm2.54-4.12v.58H12.87V11h4.37v.59Z" transform="translate(-5.37 -3.76)"/></g></svg>',fixed_column_width:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5,8H19A2,2 0 0,1 21,10V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V10A2,2 0 0,1 5,8M5,12V15H11V12H5M13,12V15H19V12H13M5,17V20H11V17H5M13,17V20H19V17H13M11,2H21V6H19V4H13V6H11V2Z" /></svg>',rotate_left:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z" /></svg>',rotate_right:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z" /></svg>',mirror_horizontal:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.75 15.74"><g><path d="M13.75,3.76l5.9,15.74h-5.9V3.76ZM4.9,19.5,10.8,3.76V19.5H4.9Z" transform="translate(-4.9 -3.76)"/></g></svg>',mirror_vertical:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 14.75"><g><path d="M20.15,13.1,4.41,19V13.1H20.15ZM4.41,4.25l15.74,5.9H4.41V4.25Z" transform="translate(-4.41 -4.25)"/></g></svg>',checked:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.75 12.1"><g><path d="M4.59,12.23l.12.18L9.43,17.5a.58.58,0,0,0,.84,0L20,7.45h0a.58.58,0,0,0,0-.84l-.85-.85a.58.58,0,0,0-.84,0H18.2l-8.12,8.41a.29.29,0,0,1-.42,0l-3.4-3.63a.58.58,0,0,0-.84,0l-.85.85a.6.6,0,0,0-.14.21.51.51,0,0,0,0,.44c.05.06.1.13.16.19Z" transform="translate(-4.38 -5.58)"/></g></svg>',line_break:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6a1,1,0,0,0-1,1v4a1,1,0,0,1-1,1H7.41l1.3-1.29A1,1,0,0,0,7.29,9.29l-3,3a1,1,0,0,0-.21.33,1,1,0,0,0,0,.76,1,1,0,0,0,.21.33l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L7.41,14H17a3,3,0,0,0,3-3V7A1,1,0,0,0,19,6Z"/></svg>',audio:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z" /></svg>',image_gallery:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="30 30 150 150"><g><path d="M152.775,120.548V51.651c0-12.271-9.984-22.254-22.254-22.254H43.727c-12.271,0-22.254,9.983-22.254,22.254v68.896c0,12.27,9.983,22.254,22.254,22.254h86.795C142.791,142.802,152.775,132.817,152.775,120.548z M36.394,51.651c0-4.042,3.291-7.333,7.333-7.333h86.795c4.042,0,7.332,3.291,7.332,7.333v23.917l-14.938-17.767c-1.41-1.678-3.487-2.649-5.68-2.658h-0.029c-2.184,0-4.255,0.954-5.674,2.613L76.709,98.519l-9.096-9.398c-1.427-1.474-3.392-2.291-5.448-2.273c-2.052,0.025-4.004,0.893-5.396,2.4L36.394,111.32V51.651z M41.684,127.585l20.697-22.416l9.312,9.622c1.461,1.511,3.489,2.334,5.592,2.27c2.101-0.066,4.075-1.013,5.44-2.612l34.436-40.308l20.693,24.613v21.794c0,4.042-3.29,7.332-7.332,7.332H43.727C43.018,127.88,42.334,127.775,41.684,127.585z M182.616,152.5V75.657c0-4.12-3.34-7.46-7.461-7.46c-4.119,0-7.46,3.34-7.46,7.46V152.5c0,4.112-3.347,7.46-7.461,7.46h-94c-4.119,0-7.46,3.339-7.46,7.459c0,4.123,3.341,7.462,7.46,7.462h94C172.576,174.881,182.616,164.841,182.616,152.5z"/></g></svg>',bookmark:'<svg class="se-mdi" viewBox="0 0 24 24"><path d="M17,3H7A2,2 0 0,0 5,5V21L12,18L19,21V5C19,3.89 18.1,3 17,3Z" /></svg>',download:'<svg class="se-mdi" viewBox="0 0 24 24"><path d="M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 15L17.55 9.54L16.13 8.13L13 11.25V2H11V11.25L7.88 8.13L6.46 9.55L12 15Z" /></svg>',dir_ltr:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M9 4v4c-1.1 0-2-.9-2-2s.9-2 2-2m8-2H9C6.79 2 5 3.79 5 6s1.79 4 4 4v5h2V4h2v11h2V4h2V2zm0 12v3H5v2h12v3l4-4-4-4z"/></svg>',dir_rtl:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 4v4c-1.1 0-2-.9-2-2s.9-2 2-2m8-2h-8C7.79 2 6 3.79 6 6s1.79 4 4 4v5h2V4h2v11h2V4h2V2zM8 14l-4 4 4 4v-3h12v-2H8v-3z"/></svg>',file_upload:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14,2L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2H14M18,20V9H13V4H6V20H18M12,12L16,16H13.5V19H10.5V16H8L12,12Z" /></svg>',file_plus:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.81 22H6C4.89 22 4 21.11 4 20V4C4 2.9 4.89 2 6 2H14L20 8V13.09C19.67 13.04 19.34 13 19 13S18.33 13.04 18 13.09V9H13V4H6V20H13.09C13.21 20.72 13.46 21.39 13.81 22M23 18H20V15H18V18H15V20H18V23H20V20H23V18Z" /></svg>',upload_tray:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>tray-arrow-up</title><path d="M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 2L6.46 7.46L7.88 8.88L11 5.75V15H13V5.75L16.13 8.88L17.55 7.45L12 2Z" /></svg>',folder:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z" /></svg>',plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" /></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,13H5V11H19V13Z" /></svg>',selection:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2,4C2,2.89 2.9,2 4,2H7V4H4V7H2V4M22,4V7H20V4H17V2H20A2,2 0 0,1 22,4M20,20V17H22V20C22,21.11 21.1,22 20,22H17V20H20M2,20V17H4V20H7V22H4A2,2 0 0,1 2,20M10,2H14V4H10V2M10,20H14V22H10V20M20,10H22V14H20V10M2,10H4V14H2V10Z" /></svg>',copy:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></svg>',cut:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,3L13,9L15,11L22,4V3M12,12.5A0.5,0.5 0 0,1 11.5,12A0.5,0.5 0 0,1 12,11.5A0.5,0.5 0 0,1 12.5,12A0.5,0.5 0 0,1 12,12.5M6,20A2,2 0 0,1 4,18C4,16.89 4.9,16 6,16A2,2 0 0,1 8,18C8,19.11 7.1,20 6,20M6,8A2,2 0 0,1 4,6C4,4.89 4.9,4 6,4A2,2 0 0,1 8,6C8,7.11 7.1,8 6,8M9.64,7.64C9.87,7.14 10,6.59 10,6A4,4 0 0,0 6,2A4,4 0 0,0 2,6A4,4 0 0,0 6,10C6.59,10 7.14,9.87 7.64,9.64L10,12L7.64,14.36C7.14,14.13 6.59,14 6,14A4,4 0 0,0 2,18A4,4 0 0,0 6,22A4,4 0 0,0 10,18C10,17.41 9.87,16.86 9.64,16.36L12,14L19,21H22V20L9.64,7.64Z" /></svg>',pdf:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M9.5 11.5C9.5 12.3 8.8 13 8 13H7V15H5.5V9H8C8.8 9 9.5 9.7 9.5 10.5V11.5M14.5 13.5C14.5 14.3 13.8 15 13 15H10.5V9H13C13.8 9 14.5 9.7 14.5 10.5V13.5M18.5 10.5H17V11.5H18.5V13H17V15H15.5V9H18.5V10.5M12 10.5H13V13.5H12V10.5M7 10.5H8V11.5H7V10.5Z" /></svg>',alert_outline:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z" /></svg>',more_text:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 180 180"><g><path d="M49.711,142.188h49.027c2.328,0.002,4.394,1.492,5.129,3.699l9.742,29.252c0.363,1.092,1.385,1.828,2.537,1.83l15.883,0.01c0.859,0,1.667-0.412,2.17-1.109s0.641-1.594,0.37-2.41l-16.625-50.045L86.503,28.953c-0.36-1.097-1.383-1.839-2.537-1.842H64.532c-1.153-0.001-2.178,0.736-2.542,1.831L13.847,173.457c-0.271,0.816-0.135,1.713,0.369,2.412c0.503,0.697,1.311,1.109,2.171,1.109h15.872c1.151,0,2.173-0.736,2.537-1.828l9.793-29.287C45.325,143.66,47.39,142.18,49.711,142.188L49.711,142.188z M53.493,119.098l15.607-46.9c0.744-2.196,2.806-3.674,5.125-3.674s4.381,1.478,5.125,3.674l15.607,46.904c0.537,1.621,0.263,3.402-0.736,4.789c-1.018,1.408-2.649,2.24-4.386,2.24H58.615c-1.736,0-3.368-0.832-4.386-2.24C53.23,122.504,52.956,120.721,53.493,119.098L53.493,119.098z M190.465,63.32c0-2.919-1.015-5.396-3.059-7.428c-2.029-2.031-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.016-7.388,3.047c-2.029,2.032-3.056,4.498-3.056,7.386c0,2.889,1.026,5.354,3.056,7.385c2.032,2.032,4.499,3.059,7.388,3.059c2.887,0,5.354-1.026,7.383-3.059C189.45,68.633,190.465,66.178,190.465,63.32L190.465,63.32z M190.465,101.994c0-2.858-1.015-5.313-3.059-7.333c-2.029-2.042-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.005-7.388,3.047c-2.029,2.021-3.056,4.486-3.056,7.376c0,2.887,1.026,5.352,3.056,7.395c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,107.389,190.465,104.914,190.465,101.994L190.465,101.994z M190.465,140.76c0-2.918-1.015-5.395-3.059-7.438c-2.029-2.041-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.006-7.388,3.047c-2.029,2.043-3.056,4.52-3.056,7.438c0,2.922,1.026,5.398,3.056,7.439c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,146.158,190.465,143.682,190.465,140.76L190.465,140.76z"/></g></svg>',more_paragraph:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 180 180"><g><path d="M128.39,28.499H63.493c-25.558,0-46.354,20.796-46.354,46.354c0,25.559,20.796,46.353,46.354,46.353h9.271v55.625h18.542V47.04h9.271V176.83h18.543V47.04h9.271V28.499z M72.764,102.664h-9.271c-15.337,0-27.813-12.475-27.813-27.812c0-15.336,12.476-27.813,27.813-27.813h9.271V102.664z M190.465,63.32c0-2.919-1.015-5.396-3.059-7.428c-2.029-2.031-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.016-7.388,3.047c-2.029,2.032-3.056,4.498-3.056,7.386c0,2.889,1.026,5.354,3.056,7.385c2.032,2.032,4.499,3.059,7.388,3.059c2.887,0,5.354-1.026,7.383-3.059C189.45,68.633,190.465,66.178,190.465,63.32L190.465,63.32z M190.465,101.994c0-2.858-1.015-5.313-3.059-7.333c-2.029-2.042-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.005-7.388,3.047c-2.029,2.021-3.056,4.486-3.056,7.376c0,2.887,1.026,5.352,3.056,7.395c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,107.389,190.465,104.914,190.465,101.994L190.465,101.994z M190.465,140.76c0-2.918-1.015-5.395-3.059-7.438c-2.029-2.041-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.006-7.388,3.047c-2.029,2.043-3.056,4.52-3.056,7.438c0,2.922,1.026,5.398,3.056,7.439c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,146.158,190.465,143.682,190.465,140.76L190.465,140.76z"/></g></svg>',more_plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="35 30 140 140"><g><path d="M137.215,102.045c0,3.498-2.835,6.332-6.333,6.332H24.549c-3.498,0-6.334-2.834-6.334-6.332l0,0c0-3.498,2.836-6.333,6.334-6.333h106.333C134.38,95.711,137.215,98.547,137.215,102.045L137.215,102.045z M77.715,161.545c-3.498,0-6.333-2.836-6.333-6.334V48.878c0-3.498,2.836-6.333,6.333-6.333l0,0c3.498,0,6.334,2.835,6.334,6.333v106.333C84.049,158.709,81.213,161.545,77.715,161.545L77.715,161.545z M190.465,63.32c0-2.919-1.015-5.396-3.059-7.428c-2.029-2.031-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.016-7.388,3.047c-2.029,2.032-3.056,4.498-3.056,7.386c0,2.889,1.026,5.354,3.056,7.385c2.032,2.032,4.499,3.059,7.388,3.059c2.887,0,5.354-1.026,7.383-3.059C189.45,68.632,190.465,66.177,190.465,63.32L190.465,63.32z M190.465,101.993c0-2.858-1.015-5.313-3.059-7.333c-2.029-2.042-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.005-7.388,3.047c-2.029,2.021-3.056,4.486-3.056,7.376c0,2.888,1.026,5.353,3.056,7.396c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,107.389,190.465,104.914,190.465,101.993L190.465,101.993z M190.465,140.76c0-2.918-1.015-5.395-3.059-7.438c-2.029-2.041-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.006-7.388,3.047c-2.029,2.043-3.056,4.52-3.056,7.438c0,2.922,1.026,5.398,3.056,7.439c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,146.158,190.465,143.682,190.465,140.76L190.465,140.76z"/></g></svg>',more_horizontal:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.76 3.58"><g><path d="M4.64,10.73a1.84,1.84,0,0,1,.65-.65,1.76,1.76,0,0,1,1.79,0A1.79,1.79,0,0,1,8,11.63a1.84,1.84,0,0,1-.25.9,1.69,1.69,0,0,1-.65.65,1.8,1.8,0,0,1-2.69-1.55A2.08,2.08,0,0,1,4.64,10.73Zm6.09,0a1.84,1.84,0,0,1,.65-.65,1.78,1.78,0,0,1,2.67,1.55,1.73,1.73,0,0,1-.24.9,1.84,1.84,0,0,1-.65.65,1.76,1.76,0,0,1-1.79,0,1.79,1.79,0,0,1-.64-2.44Zm6.08,0a1.69,1.69,0,0,1,.65-.65,1.76,1.76,0,0,1,1.79,0,1.79,1.79,0,0,1,.9,1.54,1.73,1.73,0,0,1-.24.9,1.84,1.84,0,0,1-.65.65,1.8,1.8,0,0,1-2.69-1.55A2,2,0,0,1,16.81,10.73Z" transform="translate(-4.39 -9.84)"/></g></svg>',more_vertical:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3.94 15.75"><g><path d="M12.28,7.69a1.92,1.92,0,0,1-1.39-.58,2,2,0,0,1-.58-1.39,1.92,1.92,0,0,1,.58-1.39,2,2,0,0,1,1.39-.58,1.92,1.92,0,0,1,1.39.58,2,2,0,0,1,.58,1.39,1.92,1.92,0,0,1-.58,1.39,2,2,0,0,1-1.39.58Zm0,2a1.92,1.92,0,0,1,1.39.58,2,2,0,0,1,.58,1.39A1.92,1.92,0,0,1,13.67,13a2,2,0,0,1-1.39.58A1.92,1.92,0,0,1,10.89,13a2,2,0,0,1-.58-1.39,2,2,0,0,1,2-2Zm0,5.9a1.92,1.92,0,0,1,1.39.58,2,2,0,0,1,.58,1.39,1.92,1.92,0,0,1-.58,1.39,2,2,0,0,1-1.39.58,1.92,1.92,0,0,1-1.39-.58,2,2,0,0,1-.58-1.39,1.92,1.92,0,0,1,.58-1.39,1.94,1.94,0,0,1,1.39-.58Z" transform="translate(-10.31 -3.75)"/></g></svg>',component_inline:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8,7L13,17H3L8,7M3,3H21V5H3V3M21,15V17H14V15H21M3,19H21V21H3V19Z" /></svg>',component_outline:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 18H2V20H21V18M19 10V14H4V10H19M20 8H3C2.45 8 2 8.45 2 9V15C2 15.55 2.45 16 3 16H20C20.55 16 21 15.55 21 15V9C21 8.45 20.55 8 20 8M21 4H2V6H21V4Z" /></svg>',erase:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.74 13.76"><g><path d="M13.69,17.2h6.46v1.31H8.56L4.41,14.37,14,4.75l6.06,6.06L16.89,14l-3.2,3.19Zm-4.61,0h2.77L14.09,15,9.88,10.75,6.25,14.38l1.41,1.41c.84.82,1.31,1.29,1.42,1.41Z" transform="translate(-4.41 -4.75)"/></g></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.7 15.62"><g><path d="M12.05,12.42a2.93,2.93,0,1,1,2.07-5A2.88,2.88,0,0,1,15,9.49a3,3,0,0,1-.86,2.07,2.89,2.89,0,0,1-2.07.86Zm0-5.36a2.43,2.43,0,0,0-1.72,4.16,2.48,2.48,0,0,0,1.72.72,2.44,2.44,0,0,0,0-4.88Zm0-3.3A5.84,5.84,0,0,1,17.9,9.62a9.94,9.94,0,0,1-1.73,5A33.59,33.59,0,0,1,12.84,19a1.52,1.52,0,0,1-.23.2,1,1,0,0,1-.55.2h0a1,1,0,0,1-.55-.2,1.52,1.52,0,0,1-.23-.2,33.59,33.59,0,0,1-3.33-4.32,9.93,9.93,0,0,1-1.72-5,5.84,5.84,0,0,1,5.85-5.86ZM12,18.34l.08.05.06-.06a35.58,35.58,0,0,0,3.06-3.93,9.35,9.35,0,0,0,1.74-4.77,4.88,4.88,0,0,0-4.88-4.88A4.79,4.79,0,0,0,8.6,6.17,4.84,4.84,0,0,0,7.17,9.62,9.29,9.29,0,0,0,8.91,14.4,36,36,0,0,0,12,18.34Z" transform="translate(-6.2 -3.76)"/></g></svg>',magic_stick:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.73 15.75"><g><path d="M19.86,19.21a1,1,0,0,0,.28-.68,1,1,0,0,0-.28-.7L13,10.93a1,1,0,0,0-.7-.28,1,1,0,0,0-.68,1.65l6.9,6.9a1,1,0,0,0,.69.29.93.93,0,0,0,.69-.28ZM9.19,8.55a3,3,0,0,0,1.68,0,14.12,14.12,0,0,0,1.41-.32A11.26,11.26,0,0,0,10.8,7.06c-.56-.36-.86-.56-.91-.58S10,5.91,10,5.11s0-1.26-.15-1.37a4.35,4.35,0,0,0-1.19.71c-.53.4-.81.62-.87.68a9,9,0,0,0-2-.6,6.84,6.84,0,0,0-.76-.09s0,.27.08.77a8.6,8.6,0,0,0,.61,2q-.09.09-.69.87a3.59,3.59,0,0,0-.68,1.17c.12.17.57.23,1.36.15S7,9.26,7.15,9.23s.21.36.57.91a10.49,10.49,0,0,0,1.14,1.48c0-.1.14-.57.31-1.4a3,3,0,0,0,0-1.67Z" transform="translate(-4.41 -3.74)"/></g></svg>',open_in_new:'<svg class="se-mdi" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" /></svg>'};var Q=i("cfbI"),tt=i.n(Q);const et=function(t,e,i,s,n,o,l){const r=new Map([["key",l],["options",t.options],["originElement",t.target],["topArea",e],["container",e.querySelector(".se-container")],["wrapper",e.querySelector(".se-wrapper")],["wysiwygFrame",i],["wysiwyg",i],["codeWrapper",s],["code",n],["codeNumbers",s?.querySelector(".se-code-view-line")],["lineBreaker_t",e.querySelector(".se-line-breaker-component-t")],["lineBreaker_b",e.querySelector(".se-line-breaker-component-b")],["_stickyDummy",e.querySelector(".se-toolbar-sticky-dummy")],["_toolbarShadow",e.querySelector(".se-toolbar-shadow")],["_minHeight",Z(i.style.minHeight||"65",0)],["isCodeView",!1],["isFullScreen",!1],["isReadOnly",!1],["isDisabled",!1],["isChanged",-1],["historyIndex",-1],["savedIndex",-1]]);o&&it(o,r);const a=e.querySelector(".se-placeholder");return a&&r.set("placeholder",a),r},it=function(t,e){t?e.set("statusbar",t):e.delete("statusbar");const i=t?t.querySelector(".se-navigation"):null,s=t?t.querySelector(".se-char-counter-wrapper"):null,n=t?t.querySelector(".se-char-counter-wrapper .se-char-counter"):null;i?e.set("navigation",i):e.delete("navigation"),s?e.set("charWrapper",s):e.delete("charWrapper"),n?e.set("charCounter",n):e.delete("charCounter")},st=function(t,e,i,s,n){const o=new Map([["menuTray",i],["toolbar.main",t],["toolbar.buttonTray",t.querySelector(".se-btn-tray")],["toolbar._arrow",t.querySelector(".se-arrow")]]);return s&&(o.set("toolbar.sub.main",s),o.set("toolbar.sub.buttonTray",s.querySelector(".se-btn-tray")),o.set("toolbar.sub._arrow",s.querySelector(".se-arrow")),o.set("toolbar.sub._wrapper",s.parentElement.parentElement)),e&&(o.set("toolbar._wrapper",e.querySelector(".sun-editor")),o.set("_stickyDummy",e.querySelector(".se-toolbar-sticky-dummy"))),n&&o.set("statusbar._wrapper",n.querySelector(".sun-editor")),o},nt=q._d,ot=[["undo","redo"],["bold","underline","italic","strike","subscript","superscript"],["removeFormat"],["outdent","indent"],["fullScreen","showBlocks","codeView"],["preview","print"]],lt=["px","pt","em","rem"],rt={script:!1,style:!1,meta:!1,link:!1,"[a-z]+:[a-z]+":!1},at={"table|th|td":"border|border-[a-z]+|background-color|text-align|float|font-weight|text-decoration|font-style","ol|ul":"list-style-type"},ht="font-family|font-size|color|background-color",ct=["repeat","always","none"],dt=["mode","externalLibs","keepStyleOnDelete","iframe","convertTextTags","textStyleTags","fontSizeUnits","spanStyles","lineStyles","tagStyles","reverseCommands","shortcutsDisable","shortcuts","buttonList","subToolbar","toolbar_container","statusbar_container","elementWhitelist","elementBlacklist","attributeWhitelist","attributeBlacklist","defaultLine","formatClosureBrLine","formatBrLine","formatLine","formatClosureBlock","formatBlock","__defaultElementWhitelist","__defaultAttributeWhitelist","__listCommonStyle","icons","lang","codeMirror"];function ut(t,e,i,s,n,o){if(!i||i.length<2)return;const l=e.querySelector(".se-tooltip-text");for(let h,c,d,u,p,g=0;g<i.length;g+=2)h=i[g],c=/^s/i.test(h),u=j.get(h)+(c?1e3:0),s.has(u)||(p=n.indexOf(t),p=-1===p?"":j.isOdd(p)?n[p+1]:n[p-1],p&&o.push(u),s.set(u,{c:t,r:p,t:e.getAttribute("data-type"),e})),(d=i[g+1])&&l&&(r=c,a=d,l.appendChild(X.createElement("SPAN",{class:"se-shortcut"},q.cmdIcon+(r?q.shiftIcon:"")+'+<span class="se-shortcut-key">'+a+"</span>")));var r,a}function pt(t,e){return[t,e].reduce(((t,e)=>{for(const i in e)t[i]=(e[i]||"").toLowerCase();return t}),{})}function gt(t,e){const i=t.buttonList||ot,s=new Map;if(e.length>1&&!t.toolbar_container&&!/inline|balloon/i.test(t.mode))throw Error('[SUNEDITOR.create.fail] In multi root, The "mode" option cannot be "classic" without using the "toolbar_container" option.');const n=!1!==t.strictMode;s.set("strictMode",{tagFilter:n,formatFilter:n,classFilter:n,styleNodeFilter:n,attrFilter:n,styleFilter:n,...t.strictMode}),s.set("mode",t.mode||"classic"),s.set("externalLibs",t.externalLibs||{}),s.set("keepStyleOnDelete",!!t.keepStyleOnDelete),s.set("fontSizeUnits",Array.isArray(t.fontSizeUnits)&&t.fontSizeUnits.length>0?t.fontSizeUnits.map((t=>t.toLowerCase())):lt),s.set("allowedClassName",new RegExp((t.allowedClassName&&"string"==typeof t.allowedClassName?t.allowedClassName+"|":"")+"^__se__|^se-|^katex"));let o=t.retainStyleMode;"string"!=typeof o||ct.includes(o)||(console.error(`Invalid retainStyleMode: ${o}. Valid options are ${ct.join(", ")}. Using default 'once'.`),o="repeat"),s.set("retainStyleMode",o);const l={...rt,...t.allowedExtraTags,"-":!0},r=Object.keys(l),a=r.filter((t=>l[t])).join("|"),h=r.filter((t=>!l[t])).join("|");s.set("_allowedExtraTag",a),s.set("_disallowedExtraTag",h),s.set("events",t.events||{}),s.set("textStyleTags",("string"==typeof t.__textStyleTags?t.__textStyleTags:"strong|span|font|b|var|i|em|u|ins|s|strike|del|sub|sup|mark|a|label|code|summary")+(t.textStyleTags?"|"+t.textStyleTags:""));const c=pt({bold:"strong",underline:"u",italic:"em",strike:"del",subscript:"sub",superscript:"sup"},t.convertTextTags||{});s.set("convertTextTags",c),s.set("_textStyleTags",Object.values(c).concat(["span","li"])),s.set("tagStyles",[{...at,...t.__tagStyles||{}},t.tagStyles||{}].reduce(((t,e)=>{for(const i in e)t[i]=e[i];return t}),{})),s.set("_textStylesRegExp",new RegExp(`\\s*[^-a-zA-Z](${ht}${t.spanStyles?"|"+t.spanStyles:""})\\s*:[^;]+(?!;)*`,"gi")),s.set("_lineStylesRegExp",new RegExp(`\\s*[^-a-zA-Z](text-align|margin-left|margin-right|line-height${t.lineStyles?"|"+t.lineStyles:""})\\s*:[^;]+(?!;)*`,"gi")),s.set("_defaultStyleTagMap",{strong:c.bold,b:c.bold,u:c.underline,ins:c.underline,em:c.italic,i:c.italic,del:c.strike,strike:c.strike,s:c.strike,sub:c.subscript,sup:c.superscript}),s.set("_styleCommandMap",pt(Y.swapKeyValue(c),{strong:"bold",b:"bold",u:"underline",ins:"underline",em:"italic",i:"italic",del:"strike",strike:"strike",s:"strike",sub:"subscript",sup:"superscript"})),s.set("_defaultTagCommand",{bold:c.bold,underline:c.underline,italic:c.italic,strike:c.strike,subscript:c.sub,superscript:c.sup}),s.set("textDirection","string"!=typeof t.textDirection?"ltr":t.textDirection),s.set("_rtl","rtl"===s.get("textDirection")),s.set("reverseCommands",["indent-outdent"].concat(t.reverseButtons||[])),s.set("_reverseCommandArray",("-"+s.get("reverseCommands").join("-")).split("-")),j.isEven(s.get("_reverseCommandArray").length)&&console.warn('[SUNEDITOR.create.warning] The "reverseCommands" option is invalid, Shortcuts key may not work properly.'),s.set("historyStackDelayTime","number"==typeof t.historyStackDelayTime?t.historyStackDelayTime:400),s.set("_editableClass","sun-editor-editable"+(s.get("_rtl")?" se-rtl":"")),s.set("lineAttrReset",["id"].concat(t.lineAttrReset&&"string"==typeof t.lineAttrReset?t.lineAttrReset.toLowerCase().split("|"):[])),s.set("printClass","string"==typeof t.printClass?t.printClass:null),s.set("defaultLine","string"==typeof t.defaultLine&&t.defaultLine.length>0?t.defaultLine:"p");const d=("string"==typeof t.elementWhitelist?t.elementWhitelist:"").toLowerCase();s.set("elementWhitelist",d+(d?"|":"")+s.get("_allowedExtraTag"));const u=(p=("string"==typeof t.elementBlacklist?t.elementBlacklist:"").toLowerCase(),g=(g=s.get("defaultLine")).toLowerCase(),p.split("|").filter((function(t){return t!==g||(console.warn(`[SUNEDITOR.constructor.createBlacklist.warn] defaultLine("<${g}>") cannot be included in the blacklist and will be removed.`),!1)})).join("|"));var p,g;if(s.set("elementBlacklist",u+(u?"|":"")+s.get("_disallowedExtraTag")),s.set("attributeWhitelist",t.attributeWhitelist&&"object"==typeof t.attributeWhitelist?t.attributeWhitelist:null),s.set("attributeBlacklist",t.attributeBlacklist&&"object"==typeof t.attributeBlacklist?t.attributeBlacklist:null),s.set("formatClosureBrLine",vt(t.formatClosureBrLine,(t.__defaultFormatClosureBrLine="string"==typeof t.__defaultFormatClosureBrLine?t.__defaultFormatClosureBrLine:"").toLowerCase(),s.get("elementBlacklist"))),s.set("formatBrLine",vt((t.formatBrLine||"")+"|"+s.get("formatClosureBrLine").str,(t.__defaultFormatBrLine="string"==typeof t.__defaultFormatBrLine?t.__defaultFormatBrLine:"PRE").toLowerCase(),s.get("elementBlacklist"))),s.set("formatLine",vt("div|"+(t.formatLine||"")+"|"+s.get("formatBrLine").str,(t.__defaultFormatLine="string"==typeof t.__defaultFormatLine?t.__defaultFormatLine:"P|H[1-6]|LI|TH|TD|DETAILS").toLowerCase(),s.get("elementBlacklist"))),!s.get("formatLine").reg.test(s.get("defaultLine")))throw Error(`[SUNEDITOR.create.fail] The "defaultLine(${s.get("defaultLine")})" option must be included in the "formatLine(${s.get("formatLine").str})" option.`);s.set("formatClosureBlock",vt(t.formatClosureBlock,(t.__defaultFormatClosureBlock="string"==typeof t.__defaultFormatClosureBlock?t.__defaultFormatClosureBlock:"TH|TD").toLowerCase(),s.get("elementBlacklist"))),s.set("formatBlock",vt((t.formatBlock||"")+"|"+s.get("formatClosureBlock").str,(t.__defaultFormatBlock="string"==typeof t.__defaultFormatBlock?t.__defaultFormatBlock:"BLOCKQUOTE|OL|UL|FIGCAPTION|TABLE|THEAD|TBODY|TR|CAPTION|DETAILS").toLowerCase(),s.get("elementBlacklist"))),s.set("__defaultElementWhitelist","br|div|"+("string"==typeof t.__defaultElementWhitelist?t.__defaultElementWhitelist:"p|pre|blockquote|h1|h2|h3|h4|h5|h6|ol|ul|li|hr|figure|figcaption|img|iframe|audio|video|source|table|thead|tbody|tr|th|td|caption|a|b|strong|var|i|em|u|ins|s|span|strike|del|sub|sup|code|svg|path|details|summary").toLowerCase()),s.set("__defaultAttributeWhitelist",("string"==typeof t.__defaultAttributeWhitelist?t.__defaultAttributeWhitelist:"contenteditable|target|href|title|download|rel|src|alt|class|type|controls|colspan|rowspan").toLowerCase()),s.set("_editorElementWhitelist","*"===s.get("elementWhitelist")?"*":function(t){const e=t.get("elementBlacklist").split("|");return(t.get("__defaultElementWhitelist")+"|"+t.get("elementWhitelist")+"|"+t.get("formatLine").str+"|"+t.get("formatBrLine").str+"|"+t.get("formatClosureBlock").str+"|"+t.get("formatClosureBrLine").str).replace(/(^\||\|$)/g,"").split("|").filter(((t,i,s)=>t&&s.indexOf(t)===i&&!e.includes(t))).join("|")}(s)),s.set("toolbar_width",t.toolbar_width?j.is(t.toolbar_width)?t.toolbar_width+"px":t.toolbar_width:"auto"),s.set("toolbar_container",t.toolbar_container&&!/inline/i.test(s.get("mode"))?"string"==typeof t.toolbar_container?nt.querySelector(t.toolbar_container):t.toolbar_container:null),s.set("toolbar_sticky",/balloon/i.test(s.get("mode"))?-1:void 0===t.toolbar_sticky?0:/^\d+/.test(t.toolbar_sticky)?j.get(t.toolbar_sticky,0):-1),s.set("toolbar_hide",!!t.toolbar_hide);let m=null;const f=t.subToolbar;f?.buttonList?.length>0&&(/balloon/.test(s.get("mode"))?console.warn('[SUNEDITOR.create.subToolbar.fail] When the "mode" option is "balloon-*", the "subToolbar" option is omitted.'):(s.set("_subMode",f.mode||"balloon"),s.set("toolbar.sub_width",f.width?j.is(f.width)?f.width+"px":f.width:"auto"),m=s.get("_rtl")?f.buttonList.reverse():f.buttonList));for(let i=0,s=e.length;i<s;i++)ft(e[i].options||{},t,e[i].options=new Map);s.set("tabDisable",!!t.tabDisable),s.set("shortcutsHint",void 0===t.shortcutsHint||!!t.shortcutsHint);const _=void 0===t.shortcutsDisable||t.shortcutsDisable?[{selectAll:["65","A"],bold:["66","B"],strike:["s83","S"],underline:["85","U"],italic:["73","I"],redo:["89","Y","s90","Z"],undo:["90","Z"],indent:["221","]"],outdent:["219","["],sup:["187","="],sub:["s187","="],save:["83","S"],link:["75","K"]},t.shortcuts||{}].reduce(((t,e)=>{for(const i in e)t[i]=e[i];return t}),{}):{};s.set("shortcuts",_),s.set("fullScreenOffset",void 0===t.fullScreenOffset?0:/^\d+/.test(t.fullScreenOffset)?j.get(t.fullScreenOffset,0):0),s.set("previewTemplate","string"==typeof t.previewTemplate?t.previewTemplate:null),s.set("printTemplate","string"==typeof t.printTemplate?t.printTemplate:null),s.set("mediaAutoSelect",void 0===t.mediaAutoSelect||!!t.mediaAutoSelect),s.set("defaultUrlProtocol","string"==typeof t.defaultUrlProtocol?t.defaultUrlProtocol:null);const b=s.get("externalLibs").codeMirror;b&&(s.set("codeMirror",b),b.EditorView?s.set("codeMirror6Editor",!0):b.src?s.set("codeMirror5Editor",!0):(console.warn("[SUNEDITOR.options.externalLibs.codeMirror.fail] The codeMirror option is set incorrectly."),s.set("codeMirror",null))),s.set("__listCommonStyle",t.__listCommonStyle||["fontSize","color","fontFamily","fontWeight","fontStyle"]);const v=t.icons&&"object"==typeof t.icons?[J,t.icons].reduce(((t,e)=>{for(const i in e)t[i]=e[i];return t}),{}):J;s.set("icons",v);const y=new Set("background|background-clip|background-color|border|border-bottom|border-collapse|border-color|border-image|border-left-width|border-radius|border-right-width|border-spacing|border-style|border-top|border-width|box-shadow|box-sizing|caption-side|color|content|direction|display|float|font|font-family|font-size|font-style|font-weight|height|left|letter-spacing|line-height|list-style-position|list-style-type|margin|margin-block-end|margin-block-start|margin-bottom|margin-inline-end|margin-inline-start|margin-left|margin-right|margin-top|max-width|min-width|outline|overflow|position|padding|padding-bottom|padding-inline-start|padding-left|padding-right|padding-top|rotate|rotateX|rotateY|table-layout|text-align|text-decoration|text-shadow|text-transform|top|text-indent|text-rendering|vertical-align|visibility|white-space|width|word-break|word-wrap".split("|")),w=t.spanStyles?.split("|")||[],C=s.get("__listCommonStyle"),x=ht.split("|");for(let t=0,e=x.length;t<e;t++)y.add(x[t]);for(const t of Object.values(s.get("tagStyles"))){const e=t.split("|");for(let t=0,i=e.length;t<i;t++)y.add(e[t])}for(let t=0,e=w.length;t<e;t++)y.add(w[t]);for(let t=0,e=C.length;t<e;t++)y.add(C[t]);const S=("string"==typeof t.allUsedStyles?t.allUsedStyles.split("|"):t.allUsedStyles)||[];for(let t=0,e=S.length;t<e;t++)y.add(S[t]);return s.set("allUsedStyles",y),{o:s,i:v,l:t.lang||tt(),v:t.value="string"==typeof t.value?t.value:null,buttons:s.get("_rtl")?i.reverse():i,subButtons:m,statusbarContainer:"string"==typeof t.statusbar_container?nt.querySelector(t.statusbar_container):t.statusbar_container}}function mt(t,e){let i=null,s=null,n=null;if(t.get("statusbar")&&(i=(e=e||X.createElement("DIV",{class:"se-status-bar sun-editor-common"})).querySelector(".se-navigation")||X.createElement("DIV",{class:"se-navigation sun-editor-common"}),e.appendChild(i),t.get("charCounter"))){if(s=e.querySelector(".se-char-counter-wrapper")||X.createElement("DIV",{class:"se-char-counter-wrapper"}),t.get("charCounter_label")){const e=s.querySelector(".se-char-label")||X.createElement("SPAN",{class:"se-char-label"});e.textContent=t.get("charCounter_label"),s.appendChild(e)}if(n=s.querySelector(".se-char-counter")||X.createElement("SPAN",{class:"se-char-counter"}),n.textContent="0",s.appendChild(n),t.get("charCounter_max")>0){const e=s.querySelector(".se-char-max")||X.createElement("SPAN",{class:"se-char-max"});e.textContent=" / "+t.get("charCounter_max"),s.appendChild(e)}e.appendChild(s)}return{statusbar:e,navigation:i,charWrapper:s,charCounter:n}}function ft(t,e,i){i.set("_origin",t);const s=e.statusbar_container,n=void 0===t.value?e.value:t.value,o=void 0===t.placeholder?e.placeholder:t.placeholder,l=void 0===t.editableFrameAttributes?e.editableFrameAttributes:t.editableFrameAttributes,r=void 0===t.width?e.width:t.width,a=void 0===t.minWidth?e.minWidth:t.minWidth,h=void 0===t.maxWidth?e.maxWidth:t.maxWidth,c=void 0===t.height?e.height:t.height,d=void 0===t.minHeight?e.minHeight:t.minHeight,u=void 0===t.maxHeight?e.maxHeight:t.maxHeight,p=void 0===t.editorStyle?e.editorStyle:t.editorStyle,g=void 0===t.iframe?e.iframe:t.iframe,m=void 0===t.iframe_fullPage?e.iframe_fullPage:t.iframe_fullPage,f=void 0===t.iframe_attributes?e.iframe_attributes:t.iframe_attributes,_=void 0===t.iframe_cssFileName?e.iframe_cssFileName:t.iframe_cssFileName,b=s||void 0===t.statusbar?e.statusbar:t.statusbar,v=s||void 0===t.statusbar_showPathLabel?e.statusbar_showPathLabel:t.statusbar_showPathLabel,y=!s&&(void 0===t.statusbar_resizeEnable?e.statusbar_resizeEnable:t.statusbar_resizeEnable),w=s||void 0===t.charCounter?e.charCounter:t.charCounter,C=s||void 0===t.charCounter_max?e.charCounter_max:t.charCounter_max,x=s||void 0===t.charCounter_label?e.charCounter_label:t.charCounter_label,S=s||void 0===t.charCounter_type?e.charCounter_type:t.charCounter_type;i.set("value",n),i.set("placeholder",o),i.set("editableFrameAttributes",l||{}),i.set("width",r?j.is(r)?r+"px":r:"100%"),i.set("minWidth",(j.is(a)?a+"px":a)||""),i.set("maxWidth",(j.is(h)?h+"px":h)||""),i.set("height",c?j.is(c)?c+"px":c:"auto"),i.set("minHeight",(j.is(d)?d+"px":d)||""),i.set("maxHeight",(j.is(u)?u+"px":u)||""),i.set("_defaultStyles",Y._setDefaultOptionStyle(i,"string"==typeof p?p:"")),i.set("iframe",!(!m&&!g)),i.set("iframe_fullPage",!!m),i.set("iframe_attributes",f||{}),i.set("iframe_cssFileName",g?"string"==typeof _?[_]:_||["suneditor"]:null);const E=void 0===b||!!b;i.set("statusbar",E),i.set("statusbar_showPathLabel",!!E&&("boolean"!=typeof v||v)),i.set("statusbar_resizeEnable",!(!E||void 0!==y&&!y)),i.set("charCounter",C>0||"boolean"==typeof w&&w),i.set("charCounter_max",j.is(C)&&C>-1?1*C:null),i.set("charCounter_label","string"==typeof x?x.trim():null),i.set("charCounter_type","string"==typeof S?S:"char")}function _t(t,e,i,s){const n=s.get("_defaultStyles");i.style.cssText=n.top;const o=X.createElement(s.get("iframe")?"IFRAME":"DIV",{class:"se-wrapper-inner se-wrapper-wysiwyg","data-root-key":t});if(s.get("iframe")){const t=s.get("iframe_attributes");for(const e in t)o.setAttribute(e,t[e]);o.allowFullscreen=!0,o.frameBorder=0,o.style.cssText=n.frame}else o.setAttribute("contenteditable",!0),o.setAttribute("scrolling","auto"),o.className+=" "+e.get("_editableClass"),o.style.cssText=n.frame+n.editor;const l=X.createElement("TEXTAREA",{class:"se-wrapper-inner se-code-viewer",style:n.frame});let r=null;return s.get("placeholder")&&(r=X.createElement("SPAN",{class:"se-placeholder"}),r.innerText=s.get("placeholder")),{bottomBar:mt(s,null),wysiwygFrame:o,codeView:l,placeholder:r}}function bt(t,e,i){let s=null,n=!1;if(t.get("codeMirror6Editor")){const o=t.get("codeMirror"),l=i.style.cssText,r=new o.EditorView({parent:i.parentElement,extensions:o.extensions,state:o.state});e.set("codeMirror6Editor",r),s=r.dom,s.style.cssText=l,n=!0}else if(t.get("codeMirror5Editor")){const o=t.get("codeMirror"),l=[{mode:"htmlmixed",htmlMode:!0,lineNumbers:!0,lineWrapping:!0},o.options||{}].reduce(((t,e)=>{for(const i in e)t[i]=e[i];return t}),{});"auto"===e.get("height")&&(l.viewportMargin=1/0,l.height="auto");const r=i.style.cssText,a=o.src.fromTextArea(i,l);e.set("codeMirror5Editor",a),s=a.display.wrapper,s.style.cssText=r,n=!0}return t.set("hasCodeMirror",n),s?(X.removeItem(i),s.className+=" se-code-viewer-mirror",s):i}function vt(t,e,i){const s=i.split("|"),n=(e+"|"+("string"==typeof t?t.toLowerCase():"")).replace(/^\||\|$/g,"").split("|").filter((t=>t&&!s.includes(t))).join("|");return{reg:new RegExp(`^(${n})$`,"i"),str:n}}function yt(){const t=X.createElement("UL",{class:"se-menu-list"});return{div:X.createElement("DIV",{class:"se-btn-module se-btn-module-border"},t),ul:t}}function wt(t,e,i,s,n,o,l){const r=X.createElement("LI"),a=e||"",h=X.createElement(/^INPUT|FIELD$/i.test(s)?"DIV":"BUTTON",{type:"button",class:"se-toolbar-btn se-btn se-tooltip"+(t?" "+t:""),"data-command":i,"data-type":s,"aria-label":a.replace(/<span .+<\/span>/,""),tabindex:"-1"});return/^default\./i.test(n)&&(n=l[n.replace(/^default\./i,"")]),/^text\./i.test(n)&&(n=n.replace(/^text\./i,""),h.className+=" se-btn-more-text"),o&&h.setAttribute("disabled",!0),/^FIELD$/i.test(s)&&X.addClass(r,"se-toolbar-hidden-btn"),a&&(n+=Ct(a)),n&&(h.innerHTML=n),r.appendChild(h),{li:r,button:h}}function Ct(t){return`<span class="se-tooltip-inner"><span class="se-tooltip-text">${t}</span></span>`}function xt(t,e,i,s){if(!t)return;const n=!1===e.inner;if(t.innerHTML=n?"":(e.inner||i[e.icon]||e.icon||'<span class="se-icon-text">!</span>')+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+(s[e.title]||e.title)+"</span></span>",t.setAttribute("aria-label",e.title),e.type&&t.setAttribute("data-type",e.type),e.className&&(t.className+=" "+e.className),e.afterButton&&(X.addClass(e.afterButton,"se-toolbar-btn"),t.parentElement.appendChild(e.afterButton),X.addClass(t,"se-side-btn-a"),X.addClass(e.afterButton,"se-side-btn-after")),e.beforeButton&&(X.addClass(e.beforeButton,"se-toolbar-btn"),t.parentElement.insertBefore(e.beforeButton,t),e.afterButton?(X.addClass(t,"se-side-btn"),X.removeClass(t,"se-side-btn-a")):X.addClass(t,"se-side-btn-b"),X.addClass(e.beforeButton,"se-side-btn-before")),e.replaceButton&&(t.parentElement.appendChild(e.replaceButton),t.style.display="none"),!e.replaceButton&&/^INPUT$/i.test(t.getAttribute("data-type"))){const e=t.querySelector("input");e&&(X.addClass(e,"se-toolbar-btn"),e.setAttribute("data-command",t.getAttribute("data-command")),e.setAttribute("data-type",t.getAttribute("data-type")),t.hasAttribute("disabled")&&e.setAttribute("disabled",!0))}}function St(t,e,i,s,n,o){t=JSON.parse(JSON.stringify(t));const l=function(t,e,i){const s=t.get("_rtl");return{bold:["",i.bold,"bold","",e.bold],underline:["",i.underline,"underline","",e.underline],italic:["",i.italic,"italic","",e.italic],strike:["",i.strike,"strike","",e.strike],subscript:["",i.subscript,"subscript","",e.subscript],superscript:["",i.superscript,"superscript","",e.superscript],removeFormat:["",i.removeFormat,"removeFormat","",e.remove_format],indent:["se-icon-flip-rtl",i.indent,"indent","",s?e.outdent:e.indent],outdent:["se-icon-flip-rtl",i.outdent,"outdent","",s?e.indent:e.outdent],fullScreen:["se-code-view-enabled se-component-enabled",i.fullScreen,"fullScreen","",e.expansion],showBlocks:["",i.showBlocks,"showBlocks","",e.show_blocks],codeView:["se-code-view-enabled se-component-enabled",i.codeView,"codeView","",e.code_view],undo:["se-component-enabled",i.undo,"undo","",e.undo],redo:["se-component-enabled",i.redo,"redo","",e.redo],preview:["se-component-enabled",i.preview,"preview","",e.preview],print:["se-component-enabled",i.print,"print","",e.print],dir:["",i[s?"dir_ltr":"dir_rtl"],"dir","",e[s?"dir_ltr":"dir_rtl"]],dir_ltr:["",i.dir_ltr,"dir_ltr","",e.dir_ltr],dir_rtl:["",i.dir_rtl,"dir_rtl","",e.dir_rtl],save:["se-component-enabled",i.save,"save","",e.save],newDocument:["se-component-enabled",i.newDocument,"newDocument","",e.new_document],selectAll:["se-component-enabled",i.selectAll,"selectAll","",e.select_all]}}(i,s,n),r={},a=[],h=[];let c=null,d=null,u=null,p=null,g=null,m=!1;const f=X.createElement("DIV",{class:"se-toolbar-more-layer"}),_=X.createElement("DIV",{class:"se-btn-tray"}),b=X.createElement("DIV",{class:"se-toolbar-separator-vertical"});t:for(let i,v,y,w,C,x=0;x<t.length;x++)if(i=!1,C="",w=t[x],p=yt(),"object"==typeof w){for(let m,_=0;_<w.length;_++){if(d=w[_],m=!1,u=e[d],/^%\d+/.test(d)&&0===_){w[0]=d.replace(/[^\d]/g,""),a.push(w),t.splice(x--,1);continue t}if("function"==typeof u)c=[u.className,u.title,d,u.type,u.innerHTML,u._disabled];else if("object"==typeof u){const t=u.constructor;c=[u.className||t.className,u.title||t.title,d,u.type||t.type,u.innerHTML||t.innerHTML,u._disabled||t._disabled]}else{if(/^-/.test(d)){C=d.substr(1),p.div.className+=" module-float-"+C;continue}if(/^#/.test(d)){"fix"===d.substr(1)&&(p.ul.className+=" se-menu-dir-fix");continue}if(/^:/.test(d)){m=!0;const t=d.match(/^:([^-]+)-([^-]+)/);y="__se__more_"+x;const e=t[1].trim(),i=t[2].trim();c=["se-btn-more",/^lang\./i.test(e)?n[e.replace(/^lang\./i,"")]:e,y,"MORE",i]}else c=l[d];if(!c){if(!u)throw Error(`[SUNEDITOR.create.toolbar.fail] The button name of a plugin that does not exist. [${d}]`);u="object"==typeof u?u.constructor:u,c=[u.className,u.title,u.key,u.type,u.innerHTML,u._disabled]}}g=wt(c[0],c[1],c[2],c[3],c[4],c[5],s),(i?v:p.ul).appendChild(g.li),u&&(r[d]?r[d].push(g.button):r[d]=[g.button],o&&h.push({button:g.button,plugin:u,key:d})),m&&(i=!0,v=X.createElement("DIV"),v.className="se-more-layer "+y,v.setAttribute("data-ref",y),v.innerHTML='<div class="se-more-form"><ul class="se-menu-list"'+(C?' style="float: '+C+';"':"")+"></ul></div>",f.appendChild(v),v=v.firstElementChild.firstElementChild)}if(m){const t=b.cloneNode(!1);_.appendChild(t)}_.appendChild(p.div),m=!0}else if(/^\/$/.test(w)){const t=X.createElement("DIV",{class:"se-btn-module-enter"});_.appendChild(t),m=!1}switch(_.children.length){case 0:_.style.display="none";break;case 1:X.removeClass(_.firstElementChild,"se-btn-module-border")}f.children.length>0&&_.appendChild(f),a.length>0&&a.unshift(t);const v=X.createElement("DIV",{class:"se-toolbar sun-editor-common"+(i.get("shortcutsHint")?"":" se-shortcut-hide")},_);return i.get("toolbar_hide")&&(v.style.display="none"),{element:v,pluginCallButtons:r,responsiveButtons:a,buttonTray:_,updateButtons:h}}const{NO_EVENT:Et}=q,Tt={bold:["font-weight"],underline:["text-decoration"],italic:["font-style"],strike:["text-decoration"]},kt=["bold","underline","italic","strike","subscript","superscript","indent","outdent"],Nt=kt.concat(["undo","redo","save","fullScreen","showBlocks","codeView","dir","dir_ltr","dir_rtl"]);const Ht=function(t){this.editor=t,this.eventManager=t.eventManager,this.history=t.history,this.events=t.events,this.triggerEvent=t.triggerEvent,this.carrierWrapper=t.carrierWrapper,this.plugins=t.plugins,this.status=t.status,this.context=t.context,this.options=t.options,this.icons=t.icons,this.lang=t.lang,this._w=t._w,this._d=t._d,this._shadowRoot=t._shadowRoot},Lt=new Map([["__figureInst",null],["__dragInst",null],["__dragHandler",null],["__dragContainer",null],["__dragCover",null],["__dragMove",null],["__overInfo",null]]),{isMobile:Mt}=q;function Bt(t){let e=t.target;this.editor.isSubBalloon&&!this.context.get("toolbar.sub.main")?.contains(e)&&this._hideToolbar_sub();const i=X.isInputElement(e);if(this.menu._bindControllersOff&&t.stopPropagation(),i?this.editor._antiBlur=!1:this.editor.frameContext.get("wysiwyg").contains(this.selection.getNode())||this.editor.focus(),X.getParentElement(e,".se-dropdown"))t.stopPropagation(),this.editor._notHideToolbar=!0;else{let s=e.getAttribute("data-command"),n=e.className;for(;e&&!s&&!/(se-menu-list|sun-editor-common|se-menu-tray)/.test(n);)e=e.parentNode,s=e.getAttribute("data-command"),n=e.className;if(i&&/^INPUT$/i.test(e?.getAttribute("data-type"))){this.editor._antiBlur=this._inputFocus=!0,this.status.hasFocus||this.applyTagEffect();const e=t.target;if(!X.isInputElement(e)||e.disabled)return;const i=this.plugins[s];if(this.__inputBlurEvent&&this.__removeInput(),"function"==typeof i.onInputChange&&(this.__inputPlugin={obj:i,target:e,value:e.value}),this.__inputBlurEvent=this.addEvent(e,"blur",(t=>{if(!i.isInputActive)try{const s=e.value.trim();"function"==typeof i.onInputChange&&s!==this.__inputPlugin.value&&i.onInputChange({target:e,value:s,event:t})}finally{this._w.setTimeout((()=>this._inputFocus=!1),0),this.__removeInput()}})),!i)return;"function"==typeof i.onInputKeyDown&&(this.__inputKeyEvent=this.addEvent(e,"keydown",(t=>{i.onInputKeyDown({target:e,event:t})})))}else{if(this.__inputBlurEvent&&this.__inputPlugin){const e=this.__inputPlugin.target.value.trim();return e!==this.__inputPlugin.value&&this.__inputPlugin.obj.onInputChange({target:this.__inputPlugin.target,value:e,event:t}),void this.__removeInput()}this.editor.frameContext.get("isCodeView")||(Mt?this.editor._antiBlur=!0:(t.preventDefault(),q.isGecko&&s&&this._injectActiveEvent(e)))}s!==this.menu.currentDropdownName&&s!==this.editor._containerName||t.stopPropagation()}}function At(t){const e=X.getCommandTarget(t.target);if(!e)return;let i=e,s="";for(;i&&!/se-menu-tray/.test(i.className)&&!s;)i=i.parentElement,s=i.getAttribute("data-key");if(!s)return;const n=this.plugins[s];n&&"function"==typeof n.action&&(t.stopPropagation(),n.action(e))}function Vt(t){this.editor.runFromTarget(t.target)}const{_w:It}=q;function Rt(t,e){t.get("isReadOnly")||X.isNonEditable(t.get("wysiwyg"))||(this.format._isExcludeSelectionElement(e.target)?e.preventDefault():(this._setSelectionSync(),this._w.setTimeout(this.selection._init.bind(this.selection),0),!1!==this.triggerEvent("onMouseDown",{frameContext:t,event:e})&&!1!==this._callPluginEvent("onMouseDown",{frameContext:t,event:e})&&(this.editor.isBalloon?this._hideToolbar():this.editor.isSubBalloon&&this._hideToolbar_sub(),/FIGURE/i.test(e.target.nodeName)&&e.preventDefault())))}function zt(t,e){!1!==this.triggerEvent("onMouseUp",{frameContext:t,event:e})&&this._callPluginEvent("onMouseUp",{frameContext:t,event:e})}function Ot(t,e){const i=e.target;if(t.get("isReadOnly"))return e.preventDefault(),X.isAnchor(i)&&It.open(i.href,i.target),!1;if(X.isNonEditable(t.get("wysiwyg")))return;if(!1===this.triggerEvent("onClick",{frameContext:t,event:e}))return;if(!1===this._callPluginEvent("onClick",{frameContext:t,event:e}))return;const s=this.component.get(i);if(s)return e.preventDefault(),void this.component.select(s.target,s.pluginName,!1);if(this.selection._init(),3===e.detail){let t=this.selection.getRange();this.format.isLine(t.endContainer)&&0===t.endOffset&&(t=this.selection.setRange(t.startContainer,t.startOffset,t.startContainer,t.startContainer.length),this.selection._rangeInfo(t,this.selection.get()))}const n=this.selection.getNode(),o=this.format.getLine(n,null),l=this.format.getBlock(n,null);if(!o&&!X.isNonEditable(i)&&!X.isList(l)){const t=this.selection.getRange();if(this.format.getLine(t.startContainer)===this.format.getLine(t.endContainer))if(X.isList(l)){e.preventDefault();const t=n.nextElementSibling,i=X.createElement("LI",null,n);l.insertBefore(i,t),this.editor.focus()}else X.isWysiwygFrame(n)||this.component.is(n)||X.isTableElements(n)&&!X.isTableCell(n)||null===this._setDefaultLine(this.format.isBlock(l)?"DIV":this.options.get("defaultLine"))||(e.preventDefault(),this.editor.focus())}(this.editor.isBalloon||this.editor.isSubBalloon)&&this._w.setTimeout(this._toggleToolbarBalloon.bind(this),0)}function $t(t,e){if(t.get("isReadOnly")||t.get("isDisabled"))return!1;!1!==Lt.get("__overInfo")&&this._overComponentSelect(e.target),this._callPluginEvent("onMouseMove",{frameContext:t,event:e})}function Pt(t,e){!1!==this.triggerEvent("onMouseLeave",{frameContext:t,event:e})&&this._callPluginEvent("onMouseLeave",{frameContext:t,event:e})}const{_w:Dt,isOSX_IOS:Ft}=q,Wt=/^(8|3[2-9]|40|46)$/,Ut=/^(3[7-9]|40)$/,Zt=/^(8|46)$/,qt=/^(8|13|1[6-9]|20|27|3[3-9]|40|45|46|11[2-9]|12[0-3]|144|145|229)$/,Gt=/^(1[6-9]|20|27|3[3-9]|40|45|11[2-9]|12[0-3]|144|145|229)$/,Yt=new RegExp(G.zeroWidthSpace+"+","");let Xt=null;function jt(t,e){if(t.get("isReadOnly")||t.get("isDisabled"))return e.preventDefault(),e.stopPropagation(),!1;this.selection._init();const i=(null===e.data?"":void 0===e.data?" ":e.data)||"";if(!this.char.test(i,!0))return e.preventDefault(),e.stopPropagation(),!1;!1!==this.triggerEvent("onInput",{frameContext:t,event:e,data:i})&&!1!==this._callPluginEvent("onInput",{frameContext:t,event:e,data:i})&&this.history.push(!0)}function Kt(t,e){if(this.editor.selectMenuOn||!e.isTrusted)return;let i=this.selection.getNode();if(X.isInputElement(i))return;if(this.menu.currentDropdownName)return;const s=e.keyCode,n=e.shiftKey,o=e.ctrlKey||e.metaKey||91===s||92===s||224===s,l=e.altKey;if(this.isComposing=229===s,!o&&t.get("isReadOnly")&&!Wt.test(s))return e.preventDefault(),!1;if(this.menu.dropdownOff(),this.editor.isBalloon?this._hideToolbar():this.editor.isSubBalloon&&this._hideToolbar_sub(),!1===this.triggerEvent("onKeyDown",{frameContext:t,event:e}))return;if(o&&this.shortcuts.command(s,n))return this._onShortcutKey=!0,e.preventDefault(),e.stopPropagation(),!1;this._onShortcutKey&&(this._onShortcutKey=!1);const r=this.selection.getRange(),a=!r.collapsed||r.startContainer!==r.endContainer;let h=this.format.getLine(i,null)||i,c=this.format.getBlock(h,null);if(!1===this._callPluginEvent("onKeyDown",{frameContext:t,event:e,range:r,line:h}))return;switch(s){case 8:{if(this.component.deselect(),Xt=this.__cacheStyleNodes,a&&this._hardDelete()){e.preventDefault(),e.stopPropagation();break}if(!this.format.isLine(h)&&!t.get("wysiwyg").firstElementChild&&!this.component.is(i)&&null!==this._setDefaultLine(this.options.get("defaultLine")))return e.preventDefault(),e.stopPropagation(),!1;if(!a&&!h.previousElementSibling&&0===r.startOffset&&!i.previousSibling&&!X.isListCell(h)&&this.format.isLine(h)&&(!this.format.isBrLine(h)||this.format.isClosureBrLine(h))){if(this.format.isClosureBlock(h.parentNode))return e.preventDefault(),e.stopPropagation(),!1;if(X.isWysiwygFrame(h.parentNode)&&h.childNodes.length<=1&&(!h.firstChild||X.isZeroWith(h.textContent))){if(e.preventDefault(),e.stopPropagation(),h.nodeName.toUpperCase()===this.options.get("defaultLine").toUpperCase()){h.innerHTML="<br>";const t=h.attributes;for(;t[0];)h.removeAttribute(t[0].name)}else h.parentElement.replaceChild(X.createElement(this.options.get("defaultLine"),null,"<br>"),h);return this.editor._nativeFocus(),!1}}const s=r.startContainer;if(h&&!h.previousElementSibling&&0===r.startOffset&&3===s.nodeType&&X.isZeroWith(s)){let t=s.parentNode.previousSibling;const e=s.parentNode.nextSibling;t||(e?t=e:(t=X.createElement("BR"),h.appendChild(t)));let i=s;for(;h.contains(i)&&!i.previousSibling;)i=i.parentNode;if(!h.contains(i)){s.textContent="",this.nodeTransform.removeAllParents(s,null,h);break}}if(!a&&h&&(0===r.startOffset||i===h)){const t=i===h?this._isUneditableNode(r,!0):X.isEdgePoint(r.startContainer,r.startOffset)?X.getPreviousDeepestNode(r.startContainer):null;if(this.component.is(t)){const i=this.component.get(t);if(i){e.preventDefault(),e.stopPropagation(),!1===this.component.select(i.target,i.pluginName,!1)&&this.editor.blur();break}}}if(this._isUneditableNode(r,!0)){e.preventDefault(),e.stopPropagation();break}!a&&this.format.isEdgeLine(r.startContainer,r.startOffset,"start")&&this.format.isLine(h.previousElementSibling)&&(this._formatAttrsTemp=h.previousElementSibling.attributes);const n=r.commonAncestorContainer;if(h=this.format.getLine(r.startContainer,null),c=this.format.getBlock(h,null),c&&h&&!X.isTableCell(c)&&!/^FIGCAPTION$/i.test(c.nodeName)){if(X.isListCell(h)&&X.isList(c)&&(X.isListCell(c.parentNode)||h.previousElementSibling)&&(i===h||3===i.nodeType&&(!i.previousSibling||X.isList(i.previousSibling)))&&(this.format.getLine(r.startContainer,null)!==this.format.getLine(r.endContainer,null)?c.contains(r.startContainer):0===r.startOffset&&r.collapsed)){if(r.startContainer!==r.endContainer)e.preventDefault(),this.html.remove(),3===r.startContainer.nodeType&&this.selection.setRange(r.startContainer,r.startContainer.textContent.length,r.startContainer,r.startContainer.textContent.length),this.history.push(!0);else{let t=h.previousElementSibling||c.parentNode;if(X.isListCell(t)){e.preventDefault();let i=t;if(!t.contains(h)&&X.isListCell(i)&&X.isList(i.lastElementChild)){for(i=i.lastElementChild.lastElementChild;X.isListCell(i)&&X.isList(i.lastElementChild);)i=i.lastElementChild&&i.lastElementChild.lastElementChild;t=i}let s=t===c.parentNode?c.previousSibling:t.lastChild;s||(s=X.createTextNode(G.zeroWidthSpace),c.parentNode.insertBefore(s,c.parentNode.firstChild));const n=3===s.nodeType?s.textContent.length:1,o=h.childNodes;let l=s,r=o[0];for(;r=o[0];)t.insertBefore(r,l.nextSibling),l=r;X.removeItem(h),0===c.children.length&&X.removeItem(c),this.selection.setRange(s,n,s,n),this.history.push(!0)}}break}if(!a&&0===r.startOffset){let t=!0,i=n;for(;i&&i!==c&&!X.isWysiwygFrame(i);){if(i.previousSibling&&(1===i.previousSibling.nodeType||!X.isZeroWith(i.previousSibling.textContent.trim()))){t=!1;break}i=i.parentNode}if(t&&c.parentNode){e.preventDefault(),this.format.removeBlock(c,X.isListCell(h)?[h]:null,null,!1,!1),this.history.push(!0);break}}}if(!a&&h&&(0===r.startOffset||i===h&&h.childNodes[r.startOffset])){const t=i===h?h.childNodes[r.startOffset]:i,s=h.previousSibling,o=(3===n.nodeType||X.isBreak(n))&&!n.previousSibling&&0===r.startOffset;if(t&&!t.previousSibling&&(n&&this.component.is(n.previousSibling)||o&&this.component.is(s))){const t=this.component.get(s);t?(e.preventDefault(),e.stopPropagation(),0===h.textContent.length&&X.removeItem(h),!1===this.component.select(t.target,t.pluginName,!1)&&this.editor.blur()):this.component.is(s)&&(e.preventDefault(),e.stopPropagation(),X.removeItem(s));break}if(t&&X.isNonEditable(t.previousSibling)){e.preventDefault(),e.stopPropagation(),X.removeItem(t.previousSibling);break}}break}case 46:if(this.component.deselect(),Xt=this.__cacheStyleNodes,a&&this._hardDelete()){e.preventDefault(),e.stopPropagation();break}if(!a&&h&&(r.endOffset===r.endContainer.textContent.length||i===h)){const t=i===h?this._isUneditableNode(r,!1):X.isEdgePoint(r.endContainer,r.endOffset)?X.getNextDeepestNode(r.endContainer,null):null;if(this.component.is(t)){const i=this.component.get(t);if(i){e.preventDefault(),e.stopPropagation(),X.isZeroWith(h.textContent)&&X.removeItem(h),!1===this.component.select(i.target,i.pluginName,!1)&&this.editor.blur();break}}}if(this._isUneditableNode(r,!1)){e.preventDefault(),e.stopPropagation();break}if((this.format.isLine(i)||null===i.nextSibling||X.isZeroWith(i.nextSibling)&&null===i.nextSibling.nextSibling)&&r.startOffset===i.textContent.length){const t=h.nextElementSibling;if(!t)break;if(this.component.is(t)){if(e.preventDefault(),X.isZeroWith(h)&&(X.removeItem(h),X.isTable(t))){let e=X.getEdgeChild(t,X.isTableCell,!1);e=e.firstElementChild||e,this.selection.setRange(e,0,e,0);break}const i=this.component.get(t);i?(e.stopPropagation(),!1===this.component.select(i.target,i.pluginName,!1)&&this.editor.blur()):this.component.is(t)&&(e.stopPropagation(),X.removeItem(t));break}}if(!a&&(X.isEdgePoint(r.endContainer,r.endOffset)||i===h&&h.childNodes[r.startOffset])){const t=i===h&&h.childNodes[r.startOffset]||i;if(t&&X.isNonEditable(t.nextSibling)){e.preventDefault(),e.stopPropagation(),X.removeItem(t.nextSibling);break}if(this.component.is(t)){e.preventDefault(),e.stopPropagation(),X.removeItem(t);break}}if(!a&&this.format.isEdgeLine(r.endContainer,r.endOffset,"end")&&this.format.isLine(h.nextElementSibling)&&(this._formatAttrsTemp=h.attributes),h=this.format.getLine(r.startContainer,null),c=this.format.getBlock(h,null),X.isListCell(h)&&X.isList(c)&&(i===h||3===i.nodeType&&(!i.nextSibling||X.isList(i.nextSibling))&&(this.format.getLine(r.startContainer,null)!==this.format.getLine(r.endContainer,null)?c.contains(r.endContainer):r.endOffset===i.textContent.length&&r.collapsed))){r.startContainer!==r.endContainer&&this.html.remove();let t=X.getArrayItem(h.children,X.isList,!1);if(t=t||h.nextElementSibling||c.parentNode.nextElementSibling,t&&(X.isList(t)||X.getArrayItem(t.children,X.isList,!1))){let i,s;if(e.preventDefault(),X.isList(t)){const e=t.firstElementChild;for(s=e.childNodes,i=s[0];s[0];)h.insertBefore(s[0],t);X.removeItem(e)}else{for(i=t.firstChild,s=t.childNodes;s[0];)h.appendChild(s[0]);X.removeItem(t)}this.selection.setRange(i,0,i,0),this.history.push(!0)}break}break;case 9:{if(this.options.get("tabDisable"))break;if(e.preventDefault(),o||l||X.isWysiwygFrame(i))break;const t=!r.collapsed||X.isEdgePoint(r.startContainer,r.startOffset),s=this.format.getLines(null);i=this.selection.getNode();const a=[],h=[],c=X.isListCell(s[0]),d=X.isListCell(s[s.length-1]);let u={sc:r.startContainer,so:r.startOffset,ec:r.endContainer,eo:r.endOffset};for(let t,e=0,i=s.length;e<i;e++)if(t=s[e],X.isListCell(t)){if(!t.previousElementSibling&&!n)continue;a.push(t)}else h.push(t);if(a.length>0&&t&&(u=this.format._applyNestedList(a,n)),h.length>0)if(n){const t=h.length-1;for(let e,i=0;i<=t;i++){e=h[i].childNodes;for(let t,i=0,s=e.length;i<s&&(t=e[i],t);i++)if(!X.isZeroWith(t)){/^\s{1,4}$/.test(t.textContent)?X.removeItem(t):/^\s{1,4}/.test(t.textContent)&&(t.textContent=t.textContent.replace(/^\s{1,4}/,""));break}}const e=X.getEdgeChild(h[0],"text",!1),i=X.getEdgeChild(h[t],"text",!0);!c&&e&&(u.sc=e,u.so=0),!d&&i&&(u.ec=i,u.eo=i.textContent.length)}else{const t=X.createTextNode(new Array(this.status.tabSize+1).join(" "));if(1===h.length){const e=this.html.insertNode(t,null,!1);if(!e)return!1;c||(u.sc=t,u.so=e.endOffset),d||(u.ec=t,u.eo=e.endOffset)}else{const e=h.length-1;for(let i,s=0;s<=e;s++)i=h[s].firstChild,i&&(X.isBreak(i)?h[s].insertBefore(t.cloneNode(!1),i):i.textContent=t.textContent+i.textContent);const i=X.getEdgeChild(h[0],"text",!1),s=X.getEdgeChild(h[e],"text",!0);!c&&i&&(u.sc=i,u.so=0),!d&&s&&(u.ec=s,u.eo=s.textContent.length)}}this.selection.setRange(u.sc,u.so,u.ec,u.eo),this.history.push(!1);break}case 13:{this.component.deselect();const s=this.format.getBrLine(i,null);if("byte-html"===this.editor.frameOptions.get("charCounter_type")){let t="";if(t=!n&&s||n?"<br>":"<"+h.nodeName+"><br></"+h.nodeName+">",!this.char.check(t))return e.preventDefault(),!1}if(!n){const n=this.format.isEdgeLine(r.endContainer,r.endOffset,"end"),o=this.format.isEdgeLine(r.startContainer,r.startOffset,"start");if(n&&(/^H[1-6]$/i.test(h.nodeName)||/^HR$/i.test(h.nodeName))){this.__enterPrevent(e);let t=null;const i=this.format.addLine(h,this.options.get("defaultLine"));if(n&&n.length>0){t=n.pop();const e=t;for(;n.length>0;)t=t.appendChild(n.pop());i.appendChild(e)}if(t=t?t.appendChild(i.firstChild):i.firstChild,X.isBreak(t)){const e=X.createTextNode(G.zeroWidthSpace);t.parentNode.insertBefore(e,t),this.selection.setRange(e,1,e,1)}else this.selection.setRange(t,0,t,0);this.selection.scrollTo(r);break}if(c&&h&&!X.isTableCell(c)&&!/^FIGCAPTION$/i.test(c.nodeName)){const t=this.selection.getRange();if(X.isEdgePoint(t.endContainer,t.endOffset)&&X.isList(i.nextSibling)){this.__enterPrevent(e);const t=X.createElement("BR"),s=X.createElement("LI",null,t);h.parentNode.insertBefore(s,h.nextElementSibling),s.appendChild(i.nextSibling),this.selection.setRange(t,1,t,1),this.selection.scrollTo(r);break}if((3!==t.commonAncestorContainer.nodeType||!t.commonAncestorContainer.nextElementSibling)&&X.isZeroWith(h.innerText.trim())&&!X.isListCell(h.nextElementSibling)){this.__enterPrevent(e);let t=null;if(X.isListCell(c.parentNode)){const e=h.parentNode.parentNode;c=e.parentNode;const i=X.createElement("LI");i.innerHTML="<br>",X.copyTagAttributes(i,h,this.options.get("lineAttrReset")),t=i,c.insertBefore(t,e.nextElementSibling)}else{let e;e=X.isTableCell(c.parentNode)?"DIV":X.isList(c.parentNode)?"LI":this.format.isLine(c.nextElementSibling)&&!this.format.isBlock(c.nextElementSibling)?c.nextElementSibling.nodeName:this.format.isLine(c.previousElementSibling)&&!this.format.isBlock(c.previousElementSibling)?c.previousElementSibling.nodeName:this.options.get("defaultLine"),t=X.createElement(e);const i=this.format.removeBlock(c,[h],null,!0,!0);i.cc.insertBefore(t,i.ec)}t.innerHTML="<br>",this.nodeTransform.removeAllParents(h,null,null),this.selection.setRange(t,1,t,1);break}}if(s){this.__enterPrevent(e);const t=i===s,n=this.selection.get(),o=i.childNodes,l=n.focusOffset,a=i.previousElementSibling,h=i.nextSibling;if(!this.format.isClosureBrLine(s)&&o&&(t&&r.collapsed&&o.length-1<=l+1&&X.isBreak(o[l])&&(!o[l+1]||(!o[l+2]||X.isZeroWith(o[l+2].textContent))&&3===o[l+1].nodeType&&X.isZeroWith(o[l+1].textContent))&&l>0&&X.isBreak(o[l-1])||!t&&X.isZeroWith(i.textContent)&&X.isBreak(a)&&(X.isBreak(a.previousSibling)||!X.isZeroWith(a.previousSibling.textContent))&&(!h||!X.isBreak(h)&&X.isZeroWith(h.textContent)))){t?X.removeItem(o[l-1]):X.removeItem(i);const e=this.format.addLine(s,this.format.isLine(s.nextElementSibling)&&!this.format.isBlock(s.nextElementSibling)?s.nextElementSibling:null);X.copyFormatAttributes(e,s),this.selection.setRange(e,1,e,1),this.selection.scrollTo(r);break}if(t){this.html.insert(r.collapsed&&X.isBreak(r.startContainer.childNodes[r.startOffset-1])?"<br>":"<br><br>",!1,!0,!0);let t=n.focusNode;const e=n.focusOffset;s===t&&(t=t.childNodes[e-l>1?e-1:e]),this.selection.setRange(t,1,t,1)}else{const t=n.focusNode.nextSibling,e=X.createElement("BR");this.html.insertNode(e,null,!0);const i=e.previousSibling,s=e.nextSibling;X.isBreak(t)||X.isBreak(i)||s&&!X.isZeroWith(s)?this.selection.setRange(s,0,s,0):(e.parentNode.insertBefore(e.cloneNode(!1),e),this.selection.setRange(e,1,e,1))}this._onShortcutKey=!0,this.selection.scrollTo(r);break}if(r.collapsed&&(o||n)){this.__enterPrevent(e);const t=X.createElement("BR"),s=X.createElement(h.nodeName,null,t);X.copyTagAttributes(s,h,this.options.get("lineAttrReset"));let l=t;do{if(!X.isBreak(i)&&1===i.nodeType){const t=i.cloneNode(!1);t.appendChild(l),l=t}i=i.parentNode}while(h!==i&&h.contains(i));if(s.appendChild(l),h.parentNode.insertBefore(s,o&&!n?h:h.nextElementSibling),n)this.selection.setRange(t,1,t,1);else{const t=h.firstChild||h;this.selection.setRange(t,0,t,0)}this.selection.scrollTo(r);break}if(h){let i;e.stopPropagation();let s=0;if(r.collapsed)i=X.isZeroWith(h)?this.format.addLine(h,h.cloneNode(!1)):this.nodeTransform.split(r.endContainer,r.endOffset,X.getNodeDepth(h));else{const l=this.format.getLine(r.startContainer,null)!==this.format.getLine(r.endContainer,null),a=h.cloneNode(!1);a.innerHTML="<br>";const c=this.html.remove();if(i=this.format.getLine(c.container,null),!i){X.isWysiwygFrame(c.container)&&(this.__enterPrevent(e),t.get("wysiwyg").appendChild(a),i=a,X.copyTagAttributes(i,h,this.options.get("lineAttrReset")),this.selection.setRange(i,s,i,s)),this.selection.scrollTo(r);break}const d=this.format.getBlock(c.container);if(i=i.contains(d)?X.getEdgeChild(d,this.format.getLine.bind(this.format)):i,l){if(n&&!o)i.parentNode.insertBefore(a,c.prevContainer&&c.container!==c.prevContainer?i:i.nextElementSibling),i=a,s=0;else if(s=c.offset,o){const t=i.parentNode.insertBefore(a,i);n&&(i=t,s=0)}}else n&&o?(i.parentNode.insertBefore(a,c.prevContainer&&c.container===c.prevContainer?i.nextElementSibling:i),i=a,s=0):i=this.nodeTransform.split(c.container,c.offset,X.getNodeDepth(h))}this.__enterPrevent(e),X.copyTagAttributes(i,h,this.options.get("lineAttrReset")),this.selection.setRange(i,s,i,s),this.selection.scrollTo(r);break}}if(a){this.selection.scrollTo(r);break}c&&X.getParentElement(c,"FIGCAPTION")&&X.getParentElement(c,X.isList)&&(this.__enterPrevent(e),h=this.format.addLine(h,null),this.selection.setRange(h,0,h,0),this.selection.scrollTo(r));break}}if(n&&(Ft?l:o)&&32===s){e.preventDefault(),e.stopPropagation();const t=this.html.insertNode(X.createTextNode(" "),null,!0);if(t&&t.container)return void this.selection.setRange(t.container,t.endOffset,t.container,t.endOffset)}if(!o&&!l&&!a&&!qt.test(s)&&X.isBreak(r.commonAncestorContainer)){const t=X.createTextNode(G.zeroWidthSpace);this.html.insertNode(t,null,!0),this.selection.setRange(t,1,t,1)}if(!Ut.test(s))return;let d=null;switch(s){case 38:this.component.is(h.previousElementSibling)&&(d=this.component.get(h.previousElementSibling));break;case 37:if(X.isEdgePoint(i,r.startOffset,"front")){const t=i.previousElementSibling;t&&this.component.is(t)?d=this.component.get(t):this.component.is(h.previousElementSibling)&&(d=this.component.get(h.previousElementSibling))}break;case 40:this.component.is(h.nextElementSibling)&&(d=this.component.get(h.nextElementSibling));break;case 39:if(X.isEdgePoint(i,r.endOffset,"end")){const t=i.nextElementSibling;t&&this.component.is(t)?d=this.component.get(t):this.component.is(h.nextElementSibling)&&(d=this.component.get(h.nextElementSibling))}}d&&!d.options?.isInputComponent&&(e.preventDefault(),!1===this.component.select(d.target,d.pluginName,!1)&&this.editor.blur())}function Jt(t,e){if(this._onShortcutKey||this.menu.currentDropdownName)return;const i=e.keyCode,s=e.ctrlKey||e.metaKey||91===i||92===i||224===i,n=e.altKey;if(t.get("isReadOnly"))return;const o=this.selection.getRange();let l=this.selection.getNode();if((this.editor.isBalloon||this.editor.isSubBalloon)&&((this.editor.isBalloonAlways||this.editor.isSubBalloonAlways)&&27!==i||!o.collapsed)){if(!this.editor.isBalloonAlways&&!this.editor.isSubBalloonAlways)return void(this.editor.isSubBalloon?this.subToolbar._showBalloon():this.toolbar._showBalloon());27!==i&&this._showToolbarBalloonDelay()}if(8===i&&X.isWysiwygFrame(l)&&""===l.textContent&&0===l.children.length){e.preventDefault(),e.stopPropagation(),l.innerHTML="";const t=X.createElement(this.format.isLine(this.status.currentNodes[0])&&!X.isListCell(this.status.currentNodes[0])?this.status.currentNodes[0]:this.options.get("defaultLine"),null,"<br>");return l.appendChild(t),this.selection.setRange(t,0,t,0),this.applyTagEffect(),void this.history.push(!1)}const r=this.format.getLine(l,null),a=this.format.getBlock(l,null),h=this._formatAttrsTemp;if(r&&h){for(let t=0,e=h.length;t<e;t++)13===i&&/^id$/i.test(h[t].name)?r.removeAttribute("id"):r.setAttribute(h[t].name,h[t].value);this._formatAttrsTemp=null}if(r||!o.collapsed||this.component.is(l)||X.isList(l)||null===this._setDefaultLine(this.format.isBlock(a)?"DIV":this.options.get("defaultLine"))||(l=this.selection.getNode()),!s&&!n&&!qt.test(i)&&3===l.nodeType&&G.zeroWidthRegExp.test(l.textContent)&&!(void 0!==e.isComposing?e.isComposing:this.isComposing)){let t=o.startOffset,e=o.endOffset;const i=(l.textContent.substring(0,e).match(Yt)||"").length;t=o.startOffset-i,e=o.endOffset-i,l.textContent=l.textContent.replace(G.zeroWidthRegExp,""),this.selection.setRange(l,t<0?0:t,l,e<0?0:e)}if(Zt.test(i)&&X.isZeroWith(r?.textContent)&&!r.previousElementSibling){const t=this.options.get("retainStyleMode");"none"!==t&&Xt?.length>0?"repeat"===t?this.__retainTimer?(this.__retainTimer=Dt.clearTimeout(this.__retainTimer),this._clearRetainStyleNodes(r)):(this.__retainTimer=Dt.setTimeout((()=>{this.__retainTimer=null}),0),this._retainStyleNodes(r,Xt)):(this.__retainTimer=null,this._retainStyleNodes(r,Xt)):this._clearRetainStyleNodes(r)}this.char.test("",!1),!1!==this.triggerEvent("onKeyUp",{frameContext:t,event:e})&&!1!==this._callPluginEvent("onKeyUp",{frameContext:t,event:e,range:o,line:r})&&(s||n||Gt.test(i)||this.history.push(!0))}function Qt(t,e){const i=e.clipboardData;return!i||this._dataTransferAction("paste",e,i,t)}function te(t,e){const i=e.clipboardData;if(!1===this.triggerEvent("onCopy",{frameContext:t,event:e,clipboardData:i}))return e.preventDefault(),e.stopPropagation(),!1}function ee(t,e){const i=e.clipboardData;if(!1===this.triggerEvent("onCut",{frameContext:t,event:e,clipboardData:i}))return e.preventDefault(),e.stopPropagation(),!1;this._w.setTimeout((()=>{this.history.push(!1)}),0)}function ie(t,e,i,s,n){n.preventDefault();const{sc:o,so:l,ec:r,eo:a}=this.selection.getEventLocationRange(n),h=t.get("_wd").createRange();h.setStart(o,l),h.setEnd(r,a);const c={y:0,x:0};if(i){const t=this.offset.getGlobal(i),e=s?this.context.get("toolbar.main").offsetHeight:0;c.y=t.top+e-this._w.scrollY,c.x=t.left-this._w.scrollX}const d=h.getBoundingClientRect();d.height>0?(e.style.left=`${d.right+this._w.scrollX+c.x}px`,e.style.top=d.top+this._w.scrollY+c.y-5+"px",e.style.height=`${d.height+10}px`,e.style.display="block"):e.style.display="none"}function se(t){t.style.display="none"}function ne(t,e,i){try{if(t.get("isReadOnly"))return i.preventDefault(),i.stopPropagation(),!1;const e=i.dataTransfer;if(!e)return!0;const{sc:s,so:n,ec:o,eo:l}=this.selection.getEventLocationRange(i);if(X.getParentElement(s,".se-disable-pointer"))return void i.preventDefault();if(Lt.get("__dragContainer")){if(i.preventDefault(),Lt.get("__dragContainer").contains(i.target))return void this.component.deselect();const t=Lt.get("__dragContainer");return this.component.deselect(),this.selection.setRange(s,n,o,l),void this.html.insertNode(t,null,!0)}return this.html.remove(),this.selection.setRange(s,n,o,l),this._dataTransferAction("drop",i,e,t)}finally{e.style.display="none"}}const{_w:oe,ON_OVER_COMPONENT:le,isMobile:re}=q,ae=function(t){Ht.call(this,t),this._events=[],this._onButtonsCheck=new RegExp(`^(${Object.keys(t.options.get("_defaultStyleTagMap")).join("|")})$`,"i"),this._onShortcutKey=!1,this.isComposing=!1,this._balloonDelay=null,this._wwFrameObserver=null,this._toolbarObserver=null,this._lineBreakDir=null,this._lineBreakComp=null,this._formatAttrsTemp=null,this._resizeClientY=0,this.__resize_editor=null,this.__close_move=null,this.__geckoActiveEvent=null,this.__scrollparents=[],this.__cacheStyleNodes=[],this.__selectionSyncEvent=null,this._inputFocus=!1,this.__inputPlugin=null,this.__inputBlurEvent=null,this.__inputKeyEvent=null,this._vitualKeyboardHeight=0,this.__focusTemp=this.carrierWrapper.querySelector(".__se__focus__temp__"),this.__retainTimer=null,this.__eventDoc=null};function he(t,e,i){this._moveContainer(e),this._scrollContainer(),this._callPluginEvent("onScroll",{frameContext:t,event:i}),this.triggerEvent("onScroll",{frameContext:t,event:i})}function ce(t,e){const i=t.get("key");this._inputFocus?this.editor.isInline&&this._w.setTimeout((()=>{this.toolbar._showInline()}),0):this.status.rootKey===i&&this.editor._antiBlur||(this.editor._offCurrentController(),this.status.hasFocus=!0,X.removeClass(this.editor.commandTargets.get("codeView"),"active"),X.setDisabled(this.editor._codeViewDisabledButtons,!1),this.editor.changeFrameContext(i),this.history.resetButtons(i,null),this._w.setTimeout((()=>{this.editor.isInline&&this.toolbar._showInline(),this.triggerEvent("onFocus",{frameContext:t,event:e}),this._callPluginEvent("onFocus",{frameContext:t,event:e})}),0))}function de(t,e){this._inputFocus||this.editor._antiBlur||t.get("isCodeView")||(this.status.hasFocus=!1,this.editor.effectNode=null,this.editor._offCurrentController(),(this.editor.isInline||this.editor.isBalloon)&&this._hideToolbar(),this.editor.isSubBalloon&&this._hideToolbar_sub(),this._setKeyEffect([]),this.status.currentNodes=[],this.status.currentNodesMap=[],this.editor.applyFrameRoots((t=>{t.get("navigation")&&(t.get("navigation").textContent="")})),this.history.check(t.get("key"),this.status._range),this.triggerEvent("onBlur",{frameContext:t,event:e}),this._callPluginEvent("onBlur",{frameContext:t,event:e}))}function ue(t){t.stopPropagation(),this._resizeClientY=t.clientY,this.editor.enableBackWrapper("ns-resize"),this.__resize_editor=this.addGlobalEvent("mousemove",pe.bind(this)),this.__close_move=this.addGlobalEvent("mouseup",ge.bind(this))}function pe(t){const e=this.editor.frameContext,i=e.get("wrapper").offsetHeight+(t.clientY-this._resizeClientY),s=i<e.get("_minHeight")?e.get("_minHeight"):i;e.get("wysiwygFrame").style.height=e.get("code").style.height=s+"px",this._resizeClientY=t.clientY,q.isResizeObserverSupported||this.editor.__callResizeFunction(s,null)}function ge(){this.editor.disableBackWrapper(),this.__resize_editor&&(this.__resize_editor=this.removeGlobalEvent(this.__resize_editor)),this.__close_move&&(this.__close_move=this.removeGlobalEvent(this.__close_move))}function me(t,e){e.preventDefault();const i=this._lineBreakComp;if(!i)return;t=t||this._lineBreakDir;const s=X.isListCell(i.parentNode),n=X.createElement(s?"BR":X.isTableCell(i.parentNode)?"DIV":this.options.get("defaultLine"));if(s||(n.innerHTML="<br>"),"byte-html"===this.editor.frameOptions.get("charCounter_type")&&!this.char.check(n.outerHTML))return;i.parentNode.insertBefore(n,"t"===t?i:i.nextSibling),this.component.deselect();const o=s?n:n.firstChild;this.selection.setRange(o,1,o,1),this.history.push(!1)}function fe(){re?this._scrollContainer():this.editor._offCurrentController(),this.editor.isBalloon?this.toolbar.hide():this.editor.isSubBalloon&&this.subToolbar.hide(),this._resetFrameStatus()}function _e(){this.options.get("toolbar_sticky")>-1&&(this._vitualKeyboardHeight&&this.toolbar._sticky?this.toolbar._visible(!1):this.toolbar._resetSticky()),this.editor.isBalloon&&"block"===this.context.get("toolbar.main").style.display?this.toolbar._setBalloonOffset("top"===this.toolbar._balloonOffset.position):this.editor.isSubBalloon&&"block"===this.context.get("toolbar.sub.main").style.display&&this.subToolbar._setBalloonOffset("top"===this.subToolbar._balloonOffset.position),this._scrollContainer()}function be(){this._vitualKeyboardHeight=oe.innerHeight-oe.visualViewport.height}function ve(){this.options.get("toolbar_sticky")>-1&&(this._vitualKeyboardHeight&&this.toolbar._sticky?this.toolbar._visible(!1):this.toolbar._resetSticky())}function ye(){this.toolbar._visible(!0),this._vitualKeyboardHeight&&this.options.get("toolbar_sticky")>-1&&this.toolbar._resetSticky()}function we(t){let e=t.getSelection().anchorNode;this.editor.applyFrameRoots((t=>{e&&t.get("wysiwyg").contains(e)&&(e=null,this.selection._init(),this.applyTagEffect())}))}function Ce(){this._scrollContainer()}function xe(t){this.editor.changeFrameContext(t.get("key")),X.addClass(this.editor.commandTargets.get("codeView"),"active"),X.setDisabled(this.editor._codeViewDisabledButtons,!0)}ae.prototype={addEvent(t,e,i,s){if(!t)return!1;if((!j.is(t.length)||t.nodeName||!Array.isArray(t)&&t.length<1)&&(t=[t]),0===t.length)return!1;const n=t.length;for(let o=0;o<n;o++)t[o].addEventListener(e,i,s),this._events.push({target:t[o],type:e,handler:i,useCapture:s});return{target:n>1?t:t[0],type:e,listener:i,handler:i,useCapture:s}},removeEvent(t){if(!t)return;let e=t.target;const i=t.type,s=t.listener,n=t.useCapture;if(!e)return!1;if((!j.is(e.length)||e.nodeName||!Array.isArray(e)&&e.length<1)&&(e=[e]),0===e.length)return!1;for(let t=0,o=e.length;t<o;t++)e[t].removeEventListener(i,s,n);return null},addGlobalEvent(t,e,i){return this.editor.frameOptions.get("iframe")&&this.editor.frameContext.get("_ww").addEventListener(t,e,i),this._w.addEventListener(t,e,i),{type:t,listener:e,useCapture:i}},removeGlobalEvent(t,e,i){t&&("object"==typeof t&&(e=t.listener,i=t.useCapture,t=t.type),this.editor.frameOptions.get("iframe")&&this.editor.frameContext.get("_ww").removeEventListener(t,e,i),this._w.removeEventListener(t,e,i))},applyTagEffect(t){if((t=t||this.selection.getNode())===this.editor.effectNode)return;this.editor.effectNode=t;const e=this.options.get("_rtl")?"marginRight":"marginLeft",i=this.plugins,s=this.editor.commandTargets,n=this._onButtonsCheck,o=this.options.get("_styleCommandMap"),l=[],r=[],a=this.options.get("_textStyleTags"),h=[],c=this.editor.activeCommands,d=c.length;let u="";for(;t.firstChild;)t=t.firstChild;if(this.component.is(t)&&!this.component.__selectionSelected){const e=this.component.get(t);return void this.component.select(e.target,e.pluginName,!1)}const p=this.editor.frameContext,g=!p.get("isReadOnly");for(let p=t;!X.isWysiwygFrame(p)&&p;p=p.parentNode)if(1===p.nodeType&&!X.isBreak(p)){if(this._isNonFocusNode(p))return void this.editor.blur();if(u=p.nodeName.toLowerCase(),r.push(u),a.includes(u)&&!this.format.isLine(u)&&h.push(p),g)for(let t,e=0;e<d;e++)t=c[e],!l.includes(t)&&s.get(t)&&s.get(t).filter((e=>i[t]?.active(p,e))).length>0&&l.push(t);if(this.format.isLine(p)){if(!l.includes("outdent")&&s.has("outdent")&&(X.isListCell(p)||p.style[e]&&j.get(p.style[e],0)>0)&&s.get("outdent").filter((function(t){return!X.isImportantDisabled(t)&&(t.removeAttribute("disabled"),!0)})).length>0&&l.push("outdent"),!l.includes("indent")&&s.has("indent")){const t=X.isListCell(p)&&!p.previousElementSibling;s.get("indent").filter((function(e){return!X.isImportantDisabled(e)&&(t?e.setAttribute("disabled",!0):e.removeAttribute("disabled"),!0)})).length>0&&l.push("indent")}}else n.test(u)&&(u=o[u]||u,l.push(u),X.addClass(s.get(u),"active"))}return this._setKeyEffect(l),this.__cacheStyleNodes=h.reverse(),this.status.currentNodes=r.reverse(),this.status.currentNodesMap=l,this.editor.frameOptions.get("statusbar_showPathLabel")&&p.get("navigation")&&(p.get("navigation").textContent=this.options.get("_rtl")?this.status.currentNodes.reverse().join(" < "):this.status.currentNodes.join(" > ")),t},_injectActiveEvent(t){X.addClass(t,"__se__active"),this.__geckoActiveEvent=this.addGlobalEvent("mouseup",(()=>{X.removeClass(t,"__se__active"),this.__geckoActiveEvent=this.removeGlobalEvent(this.__geckoActiveEvent)}))},_setKeyEffect(t){const e=this.editor.activeCommands,i=this.editor.commandTargets,s=this.plugins;for(let n,o,l,r=0,a=e.length;r<a;r++)if(n=e[r],!t.includes(n)&&(o=i.get(n))){l=s[n];for(let t,e=0,i=o.length;e<i;e++)t=o[e],t&&0!==t.length&&(l?l.active(null,t):/^outdent$/i.test(n)?X.isImportantDisabled(t)||t.setAttribute("disabled",!0):/^indent$/i.test(n)?X.isImportantDisabled(t)||t.removeAttribute("disabled"):X.removeClass(t,"active"))}},_showToolbarBalloonDelay(){this._balloonDelay&&oe.clearTimeout(this._balloonDelay),this._balloonDelay=oe.setTimeout((()=>{oe.clearTimeout(this._balloonDelay),this._balloonDelay=null,this.editor.isSubBalloon?this.subToolbar._showBalloon():this.toolbar._showBalloon()}),250)},_toggleToolbarBalloon(){this.selection._init();const t=this.selection.getRange(),e=this.options.has("_subMode");this.menu._bindControllersOff||!(e?this.editor.isSubBalloonAlways:this.editor.isBalloonAlways)&&t.collapsed?e?this._hideToolbar_sub():this._hideToolbar():e?this.subToolbar._showBalloon(t):this.toolbar._showBalloon(t)},_hideToolbar(){this.editor._notHideToolbar||this.editor.frameContext.get("isFullScreen")||this.toolbar.hide()},_hideToolbar_sub(){this.subToolbar&&!this.editor._notHideToolbar&&this.subToolbar.hide()},_isNonFocusNode:t=>1===t.nodeType&&"true"===t.getAttribute("data-se-non-focus"),_isUneditableNode(t,e){const i=e?t.startContainer:t.endContainer,s=e?t.startOffset:t.endOffset,n=e?"previousSibling":"nextSibling";let o;return 1===i.nodeType?(o=this._isUneditableNode_getSibling(i.childNodes[s],n,i),o&&1===o.nodeType&&"false"===o.getAttribute("contenteditable")?o:null):(o=this._isUneditableNode_getSibling(i,n,i),X.isEdgePoint(i,s,e?"front":"end")&&o&&1===o.nodeType&&"false"===o.getAttribute("contenteditable")?o:null)},_isUneditableNode_getSibling(t,e,i){if(!t)return null;let s=t[e];if(!s){if(s=this.format.getLine(i),s=s?s[e]:null,!s||this.component.is(s))return null;s="previousSibling"===e?s.firstChild:s.lastChild}return s},_hardDelete(){const t=this.selection.getRange(),e=t.startContainer,i=t.endContainer,s=this.format.getBlock(e),n=this.format.getBlock(i),o=X.isTableCell(s),l=X.isTableCell(n),r=t.commonAncestorContainer;if((o&&!s.previousElementSibling&&!s.parentElement.previousElementSibling||l&&!n.nextElementSibling&&!n.parentElement.nextElementSibling)&&s!==n)if(o){if(l)return X.removeItem(X.getParentElement(s,(t=>r===t.parentNode))),this.editor._nativeFocus(),!0;X.removeItem(X.getParentElement(s,(t=>r===t.parentNode)))}else X.removeItem(X.getParentElement(n,(t=>r===t.parentNode)));const a=1===e.nodeType?X.getParentElement(e,".se-component"):null,h=1===i.nodeType?X.getParentElement(i,".se-component"):null;return a&&X.removeItem(a),h&&X.removeItem(h),!1},_setDefaultLine(t){if(this.editor._fileManager.pluginRegExp.test(this.editor.currentControllerName))return;const e=this.selection.getRange(),i=e.commonAncestorContainer,s=e.startContainer,n=this.format.getBlock(i,null);let o,l,r;if(n)return r=X.createElement(t||this.options.get("defaultLine")),r.innerHTML=n.innerHTML,0===r.childNodes.length&&(r.innerHTML=G.zeroWidthSpace),n.innerHTML=r.outerHTML,r=n.firstChild,o=X.getEdgeChildNodes(r,null).sc,o||(o=X.createTextNode(G.zeroWidthSpace),r.insertBefore(o,r.firstChild)),l=o.textContent.length,void this.selection.setRange(o,l,o,l);const a=X.getParentElement(i,this.component.is.bind(this.component));if(a&&3===i.nodeType){const t=i.nextElementSibling?a:a.nextElementSibling,e=X.createElement(this.options.get("defaultLine"),null,i);return a.parentElement.insertBefore(e,t),void this.editor.focusEdge(e)}if(1===i.nodeType&&"true"===i.getAttribute("data-se-embed")){let t=i.nextElementSibling;return this.format.isLine(t)||(t=this.format.addLine(i,this.options.get("defaultLine"))),void this.selection.setRange(t.firstChild,0,t.firstChild,0)}if(!this.format.isBlock(s)&&!X.isWysiwygFrame(s)||!this.component.is(s.children[e.startOffset])&&!this.component.is(s.children[e.startOffset-1])){if(X.getParentElement(i,X.isExcludeFormat))return null;if(this.format.isBlock(i)&&i.childNodes.length<=1){let t=null;return 1===i.childNodes.length&&X.isBreak(i.firstChild)?t=i.firstChild:(t=X.createTextNode(G.zeroWidthSpace),i.appendChild(t)),void this.selection.setRange(t,1,t,1)}try{if(3===i.nodeType&&(r=X.createElement(t||this.options.get("defaultLine")),i.parentNode.insertBefore(r,i),r.appendChild(i)),X.isBreak(r.nextSibling)&&X.removeItem(r.nextSibling),X.isBreak(r.previousSibling)&&X.removeItem(r.previousSibling),X.isBreak(o)){const t=X.createTextNode(G.zeroWidthSpace);o.parentNode.insertBefore(t,o),o=t}}catch(e){this.editor.execCommand("formatBlock",!1,t||this.options.get("defaultLine")),this.selection.removeRange(),this.selection._init()}if(r&&(X.isBreak(r.nextSibling)&&X.removeItem(r.nextSibling),X.isBreak(r.previousSibling)&&X.removeItem(r.previousSibling),X.isBreak(o))){const t=X.createTextNode(G.zeroWidthSpace);o.parentNode.insertBefore(t,o),o=t}this.editor.effectNode=null,this.editor._nativeFocus()}},_dataTransferAction(t,e,i,s){const n=i.getData("text/plain"),o=i.getData("text/html");try{return this._setClipboardData(t,e,n,o,i,s),e.preventDefault(),e.stopPropagation(),!1}catch(t){console.warn("[SUNEDITOR.paste.error]",t)}},async _setClipboardData(t,e,i,s,n,o){const l=/class=["']*Mso(Normal|List)/i.test(s)||/content=["']*Word.Document/i.test(s)||/content=["']*OneNote.File/i.test(s)||/content=["']*Excel.Sheet/i.test(s);s?(s=s.replace(/^<html>\r?\n?<body>\r?\n?\x3C!--StartFragment-->|\x3C!--EndFragment-->\r?\n?<\/body>\r?\n?<\/html>$/g,""),l&&(s=s.replace(/\n/g," "),i=i.replace(/\n/g," ")),s=this.html.clean(s,!1,null,null)):s=Y.htmlToEntity(i).replace(/\n/g,"<br>");const r=this.char.test("byte-html"===this.editor.frameOptions.get("charCounter_type")?s:i,!1);if("paste"===t){const t=await this.triggerEvent("onPaste",{frameContext:o,event:e,cleanData:s,maxCharCount:r});if(!1===t)return!1;if("string"==typeof t){if(!t)return!1;s=t}}if("drop"===t){const t=await this.triggerEvent("onDrop",{frameContext:o,event:e,cleanData:s,maxCharCount:r});if(!1===t)return!1;if("string"==typeof t){if(!t)return!1;s=t}}const a=n.files;if(a.length>0&&!l){for(let t=0,i=a.length;t<i;t++)this._callPluginEvent("onPastAndDrop",{frameContext:o,event:e,file:a[t]});return!1}return!!r&&(s?(this.html.insert(s,!1,!0,!0),!1):void 0)},_addCommonEvents(){const t=Bt.bind(this),e=Vt.bind(this);this.addEvent(this.context.get("menuTray"),"mousedown",t,!1),this.addEvent(this.context.get("menuTray"),"click",At.bind(this),!0),this.addEvent(this.context.get("toolbar.main"),"mousedown",t,!1),this.addEvent(this.context.get("toolbar.main"),"click",e,!1),this.options.has("_subMode")&&(this.addEvent(this.context.get("toolbar.sub.main"),"mousedown",t,!1),this.addEvent(this.context.get("toolbar.sub.main"),"click",e,!1)),this.toolbar._setResponsive(),q.isResizeObserverSupported&&(this._toolbarObserver=new ResizeObserver((()=>{oe.setTimeout((()=>{this.toolbar.resetResponsiveToolbar()}),0)})),this._wwFrameObserver=new ResizeObserver((t=>{oe.setTimeout((()=>{t.forEach((t=>{this.editor.__callResizeFunction(this.editor.frameRoots.get(t.target.getAttribute("data-root-key")),-1,t)}))}),0)}))),this.addEvent(oe,"resize",fe.bind(this),!1),this.addEvent(oe,"scroll",_e.bind(this),!1),q.isMobile&&(this.addEvent(oe.visualViewport,"resize",be.bind(this),!1),this.addEvent(oe.visualViewport,"scroll",ve.bind(this),!1),this.addEvent(oe.visualViewport,"scroll",Y.debounce(ye.bind(this),200),!1))},_addFrameEvents(t){const e=t.get("options").get("iframe"),i=e?t.get("_ww"):t.get("wysiwyg");t.set("eventWysiwyg",i);const s=t.get("code"),n=this.editor.carrierWrapper.querySelector(".se-drag-cursor"),o=$t.bind(this,t);this.addEvent(i,"mousemove",o,!1),this.addEvent(i,"mouseleave",Pt.bind(this,t),!1),this.addEvent(i,"mousedown",Rt.bind(this,t),!1),this.addEvent(i,"mouseup",zt.bind(this,t),!1),this.addEvent(i,"click",Ot.bind(this,t),!1),this.addEvent(i,"input",jt.bind(this,t),!1),this.addEvent(i,"keydown",Kt.bind(this,t),!1),this.addEvent(i,"keyup",Jt.bind(this,t),!1),this.addEvent(i,"paste",Qt.bind(this,t),!1),this.addEvent(i,"copy",te.bind(this,t),!1),this.addEvent(i,"cut",ee.bind(this,t),!1),this.addEvent(i,"dragover",ie.bind(this,t,n,e?this.editor.frameContext.get("topArea"):null,!this.options.get("toolbar_container")&&!this.editor.isBalloon&&!this.editor.isInline),!1),this.addEvent(i,"dragend",se.bind(this,n),!1),this.addEvent(i,"drop",ne.bind(this,t,n),!1),this.addEvent(i,"scroll",he.bind(this,t,i),{passive:!0,useCapture:!1}),this.addEvent(i,"focus",ce.bind(this,t),!1),this.addEvent(i,"blur",de.bind(this,t),!1),this.addEvent(s,"mousedown",xe.bind(this,t),!1);const l=this.editor.frameContext.get("wrapper").querySelector(".se-drag-handle");if(this.addEvent(l,"wheel",(t=>{t.preventDefault(),this.component.deselect()}),!1),this.addEvent([t.get("lineBreaker_t"),t.get("lineBreaker_b")],"mousedown",(t=>{t.preventDefault()}),!1),this.addEvent(t.get("lineBreaker_t"),"mousedown",me.bind(this,"t"),!1),this.addEvent(t.get("lineBreaker_b"),"mousedown",me.bind(this,"b"),!1),re&&this.addEvent(i,"touchstart",o,{passive:!0,useCapture:!1}),!this.options.get("hasCodeMirror")){const e=t.get("codeNumbers"),i=this.viewer._codeViewAutoHeight.bind(this.viewer,t.get("code"),e,"auto"===this.editor.frameOptions.get("height"));this.addEvent(s,"keydown",i,!1),this.addEvent(s,"keyup",i,!1),this.addEvent(s,"paste",i,!1),e&&this.addEvent(s,"scroll",this.viewer._scrollLineNumbers.bind(s,e),!1)}t.has("statusbar")&&this.__addStatusbarEvent(t,t.get("options"));const r=Ce.bind(this);let a=t.get("originElement");for(;a=X.getScrollParent(a.parentElement);)this.__scrollparents.push(a),this.addEvent(a,"scroll",r,!1);this.addEvent(this.__focusTemp,"focus",(t=>t.preventDefault()),!1),this.__eventDoc!==t.get("_wd")&&(this.__eventDoc=t.get("_wd"),this.addEvent(this.__eventDoc,"selectionchange",we.bind(this,this.__eventDoc),!1))},__addStatusbarEvent(t,e){/\d+/.test(e.get("height"))&&e.get("statusbar_resizeEnable")?e.set("__statusbarEvent",this.addEvent(t.get("statusbar"),"mousedown",ue.bind(this),!1)):X.addClass(t.get("statusbar"),"se-resizing-none")},_removeAllEvents(){for(let t,e=0,i=this._events.length;e<i;e++)t=this._events[e],t.target.removeEventListener(t.type,t.handler,t.useCapture);this._events=[],this._wwFrameObserver&&(this._wwFrameObserver.disconnect(),this._wwFrameObserver=null),this._toolbarObserver&&(this._toolbarObserver.disconnect(),this._toolbarObserver=null)},_moveContainer(t){const e=t.scrollY||t.scrollTop||0,i=t.scrollX||t.scrollLeft||0;if(this.editor.isBalloon?(this.context.get("toolbar.main").style.top=this.toolbar._balloonOffset.top-e+"px",this.context.get("toolbar.main").style.left=this.toolbar._balloonOffset.left-i+"px"):this.editor.isSubBalloon&&(this.context.get("toolbar.sub.main").style.top=this.subToolbar._balloonOffset.top-e+"px",this.context.get("toolbar.sub.main").style.left=this.subToolbar._balloonOffset.left-i+"px"),this.editor._controllerTargetContext!==this.editor.frameContext.get("topArea")&&this.editor._offCurrentController(),this.editor._lineBreaker_t){const t=this.editor._lineBreaker_t.style;if("none"!==t.display){const s=(this.editor._lineBreaker_t.getAttribute("data-offset")||",").split(",");t.top=j.get(t.top,0)-(e-j.get(s[0],0))+"px",t.left=j.get(t.left,0)-(i-j.get(s[1],0))+"px",this.editor._lineBreaker_t.setAttribute("data-offset",e+","+i)}}if(this.editor._lineBreaker_b){const t=this.editor._lineBreaker_b.style;if("none"!==t.display){const s=(this.editor._lineBreaker_b.getAttribute("data-offset")||",").split(",");t.top=j.get(t.top,0)-(e-j.get(s[0],0))+"px",t[s[1]]=j.get(t[s[1]],0)-(i-j.get(s[2],0))+"px",this.editor._lineBreaker_b.setAttribute("data-offset",e+","+s[1]+","+i)}}const s=this.editor.opendControllers;for(let t=0;t<s.length;t++)s[t].notInCarrier&&(s[t].form.style.top=s[t].inst.__offset.top-e+"px",s[t].form.style.left=s[t].inst.__offset.left-i+"px")},_scrollContainer(){const t=this.editor.opendControllers;t.length&&this.__rePositionController(t)},__rePositionController(t){Lt.get("__dragMove")&&Lt.get("__dragMove")();for(let e=0;e<t.length;e++)t[e].notInCarrier||t[e].inst?.show()},_resetFrameStatus(){q.isResizeObserverSupported||(this.toolbar.resetResponsiveToolbar(),this.options.get("_subMode")&&this.subToolbar.resetResponsiveToolbar());const t=this.context.get("toolbar.main"),e="none"===t.style.display||this.editor.isInline&&!this.toolbar._inlineToolbarAttr.isShow;if(0===t.offsetWidth&&!e)return;const i=this.editor.frameContext,s=i.get("fileBrowser");s&&"block"===s.area.style.display&&(s.body.style.maxHeight=X.getClientSize().h-s.header.offsetHeight-50+"px"),this.menu.currentDropdownActiveButton&&this.menu.currentDropdown&&this.menu._setMenuPosition(this.menu.currentDropdownActiveButton,this.menu.currentDropdown),this.viewer._resetFullScreenHeight()||(i.get("isCodeView")&&this.editor.isInline?this.toolbar._showInline():(this.editor._iframeAutoHeight(i),this.toolbar._sticky&&(this.context.get("toolbar.main").style.width=i.get("topArea").offsetWidth-2+"px",this.toolbar._resetSticky())))},_setSelectionSync(){this.removeGlobalEvent(this.__selectionSyncEvent),this.__selectionSyncEvent=this.addGlobalEvent("mouseup",(()=>{this.selection._init(),this.removeGlobalEvent(this.__selectionSyncEvent)}))},_retainStyleNodes(t,e){const i=e[0].cloneNode(!1);let s=i;for(let t,i=1,n=e.length;i<n;i++)t=e[i].cloneNode(!1),s.appendChild(t),s=t;const n=X.createTextNode(G.zeroWidthSpace);t.innerHTML=s.innerHTML="",s.appendChild(n),t.appendChild(i),this.selection.setRange(n,1,n,1)},_clearRetainStyleNodes(t){t.innerHTML="<br>",this.selection.setRange(t,0,t,0)},_callPluginEvent(t,e){const i=this.editor._onPluginEvents.get(t);for(let t=0;t<i.length;t++)if(!1===i[t](e))return!1},_overComponentSelect(t){const e=X.getParentElement(t,X.isFigure);let i=this.component.get(t);i||e?(i||(i=this.component.get(e)),i&&!X.hasClass(i.container,"se-component-selected")&&(this.editor._offCurrentController(),Lt.set("__overInfo",le),this.component.select(i.target,i.pluginName,!1))):null===Lt.get("__overInfo")||X.hasClass(t,"se-drag-handle")||(this.component.deselect(),Lt.set("__overInfo",null))},__removeInput(){this._inputFocus=this.editor._antiBlur=!1,this.__inputBlurEvent=this.removeEvent(this.__inputBlurEvent),this.__inputKeyEvent=this.removeEvent(this.__inputKeyEvent),this.__inputPlugin=null},__enterPrevent(t){t.preventDefault(),re&&this.__focusTemp.focus()},constructor:ae};const Se=ae,Ee=function(t){this.char=t.char,this.component=t.component,this.format=t.format,this.html=t.html,this.menu=t.menu,this.nodeTransform=t.nodeTransform,this.notice=t.notice,this.offset=t.offset,this.selection=t.selection,this.shortcuts=t.shortcuts,this.toolbar=t.toolbar,this.viewer=t.viewer,t.subToolbar&&(this.subToolbar=t.subToolbar)},Te=function(t){Ht.call(this,t)};function ke(e){e&&!I(e,"se-blink")&&(R(e,"se-blink"),t.setTimeout((()=>{z(e,"se-blink")}),600))}Te.prototype={check(t){const e=this.editor.frameOptions.get("charCounter_max");if(e){const i=this.getLength("string"==typeof t?t:"byte-html"===this.editor.frameOptions.get("charCounter_type")&&1===t.nodeType?t.outerHTML:t.textContent);if(i>0&&i+this.getLength()>e)return ke(this.editor.frameContext.get("charWrapper")),!1}return!0},getLength(t){return"string"!=typeof t&&(t="byte-html"===this.editor.frameOptions.get("charCounter_type")?this.editor.frameContext.get("wysiwyg").innerHTML:this.editor.frameContext.get("wysiwyg").textContent),/byte/.test(this.editor.frameOptions.get("charCounter_type"))?this.getByteLength(t):t.length},getByteLength(t){if(!t||!t.toString)return 0;let e,i;return t=t.toString(),a?(i=decodeURIComponent(encodeURIComponent(t)).length,e=0,null!==encodeURIComponent(t).match(/(%0A|%0D)/gi)&&(e=encodeURIComponent(t).match(/(%0A|%0D)/gi).length),i+e):(i=new TextEncoder("utf-8").encode(t).length,e=0,null!==encodeURIComponent(t).match(/(%0A|%0D)/gi)&&(e=encodeURIComponent(t).match(/(%0A|%0D)/gi).length),i+e)},display(){this.editor.frameContext.has("charCounter")&&t.setTimeout((()=>{this.editor.frameContext.get("charCounter").textContent=this.getLength()}),0)},test(t,e){let i=0;t&&(i=this.getLength(t)),this.display();const s=this.editor.frameOptions.get("charCounter_max");if(s>0){let t=!1;const n=this.getLength();if(n>s){if(t=!0,i>0&&e){this.selection._init();const t=this.selection.getRange(),e=t.endOffset-1,i=this.selection.getNode().textContent,s=t.endOffset-1;this.selection.getNode().textContent=i.slice(0,s<0?0:s)+i.slice(t.endOffset,i.length),this.selection.setRange(t.endContainer,e,t.endContainer,e)}}else n+i>s&&(t=!0);if(t&&(ke(this.editor.frameContext.get("charWrapper")),i>0))return!1}return!0},constructor:Te};const Ne=Te,He=function(t){Ht.call(this,t),Ee.call(this,t)},{ON_OVER_COMPONENT:Le}=q,Me=/^(1[7-9]|20|27|45|11[2-9]|12[0-3]|144|145)$/,Be=2147483645,Ae=function(t,e,i,s){He.call(this,t.editor),this.kind=s||t.constructor.key||t.constructor.name,this.inst=t,this.form=e,this.isOpen=!1,this.currentTarget=null,this.currentPositionTarget=null,this.isWWTarget=i.isWWTarget??!0,this.position=i.position,this.disabled=!!i.disabled,this.parents=i.parents||[],this.parentsHide=!!i.parentsHide,this.isInsideForm=!!i.isInsideForm,this.isOutsideForm=!!i.isOutsideForm,this._initMethod="function"==typeof i.initMethod?i.initMethod:null,this.__globalEventHandlers={keydown:ze.bind(this),mousedown:Oe.bind(this)},this._bindClose_key=null,this._bindClose_mouse=null,this.__offset={},this.__addOffset={left:0,top:0},this.carrierWrapper.appendChild(e),this.eventManager.addEvent(e,"click",Ve.bind(this)),this.eventManager.addEvent(e,"mouseenter",Ie.bind(this)),this.eventManager.addEvent(e,"mouseleave",Re.bind(this))};function Ve(t){const e=X.getCommandTarget(t.target);e&&(t.stopPropagation(),t.preventDefault(),this.inst.controllerAction(e))}function Ie(t){this.editor.currentControllerName=this.kind,this.parents.length>0&&this.isInsideForm||(t.target.style.zIndex=2147483647)}function Re(t){this.parents.length>0&&this.isInsideForm||(t.target.style.zIndex=Be)}function ze(t){if(this._checkFixed())return;const e=t.keyCode;!t.ctrlKey&&!t.metaKey&&91!==e&&92!==e&&224!==e&&Me.test(e)&&(this.form.contains(t.target)||this._checkForm(t.target)||this.editor._fileManager.pluginRegExp.test(this.kind)&&27!==e||this.close())}function Oe({target:t}){this.inst?._element?.contains(t)?this.isOpen=!1:(this.isOpen=!0,t===this.inst._element||t===this.currentTarget||this._checkFixed()||this.form.contains(t)||this._checkForm(t)||this.close(!0))}Ae.prototype={open(t,e,{isWWTarget:i,initMethod:s,disabled:n,addOffset:o}){if(Lt.get("__overInfo")===Le)return;if(!t)return void console.warn("[SUNEDITOR.Controller.open.fail] The target element is required.");this.editor.isBalloon?this.toolbar.hide():this.editor.isSubBalloon&&this.subToolbar.hide(),(n??this.disabled)&&X.setDisabled(this.editor._controllerOnDisabledButtons,!0),this.currentTarget=t,this.currentPositionTarget=e||t,this.isWWTarget=i??this.isWWTarget,"function"==typeof s&&(this._initMethod=s),this.editor.currentControllerName=this.kind,o&&(this.__addOffset={...this.__addOffset,...o});const l=this.isOutsideForm?this.parents:[];this.editor.opendControllers?.forEach((t=>{l.includes(t.form)||(t.form.style.zIndex=Be)})),this.parentsHide&&this.parents.forEach((t=>{t.style.display="none"})),this.__addGlobalEvent(),this._setControllerPosition(this.form,this.currentPositionTarget),this._controllerOn(this.form,t),this._w.setTimeout((()=>Lt.set("__overInfo",!1)),0)},close(t){this.isOpen&&(this.isOpen=!1,this.editor._antiBlur=!1,this.__offset={},this.__addOffset={left:0,top:0},this.__removeGlobalEvent(),"function"==typeof this._initMethod&&this._initMethod(),this._controllerOff(),this.parentsHide&&!t&&this.parents.forEach((t=>{t.style.display="block"})),this.parents.length>0||("function"==typeof this.inst.close&&this.inst.close(),this.component.deselect()))},hide(){this.form.style.display="none"},show(){this._setControllerPosition(this.form,this.currentPositionTarget)},resetPosition(t){this._setControllerPosition(this.form,t||this.currentPositionTarget)},_controllerOn(t,e){const i={position:this.position,form:t,target:e,inst:this};!1!==this.triggerEvent("onBeforeShowController",{caller:this.kind,frameContext:this.editor.frameContext,params:i})&&(t.style.display="block",this._shadowRoot&&t.addEventListener("mousedown",(t=>t.stopPropagation())),this.editor._controllerTargetContext=this.editor.frameContext.get("topArea"),this.isOpen||this.editor.opendControllers.push({position:this.position,form:t,target:e,inst:this}),this.isOpen=!0,this.editor._antiBlur=!0,this.triggerEvent("onShowController",{caller:this.kind,frameContext:this.editor.frameContext,params:i}))},_controllerOff(){this.form.style.display="none",this.editor.opendControllers=this.editor.opendControllers.filter((t=>t.form!==this.form)),this.editor.currentControllerName!==this.kind&&this.editor.opendControllers.length>0||(this.disabled&&X.setDisabled(this.editor._controllerOnDisabledButtons,!1),this.editor.frameContext.get("lineBreaker_t").style.display=this.editor.frameContext.get("lineBreaker_b").style.display="none",this.editor.effectNode=null,this.editor.currentControllerName="",this.editor._antiBlur=!1,this.editor._controllerTargetContext=null,"function"==typeof this.inst.reset&&this.inst.reset())},_setControllerPosition(t,e){t.style.zIndex=2147483646,t.style.visibility="hidden",t.style.display="block",this.offset.setAbsPosition(t,e,{addOffset:this.__addOffset,position:this.position,isWWTarget:this.isWWTarget,inst:this})?t.style.visibility="":this.hide()},__addGlobalEvent(){this.__removeGlobalEvent(),this._bindClose_key=this.eventManager.addGlobalEvent("keydown",this.__globalEventHandlers.keydown,!0),this._bindClose_mouse=this.eventManager.addGlobalEvent("mousedown",this.__globalEventHandlers.mousedown,!0)},__removeGlobalEvent(){this.component.__removeGlobalEvent(),this._bindClose_key&&(this._bindClose_key=this.eventManager.removeGlobalEvent(this._bindClose_key)),this._bindClose_mouse&&(this._bindClose_mouse=this.eventManager.removeGlobalEvent(this._bindClose_mouse))},_checkFixed(){if(this.editor.selectMenuOn)return!0;const t=this.editor.opendControllers;for(let e=0;e<t.length;e++)if(t[e].inst===this&&t[e].fixed)return!0;return!1},_checkForm(t){if(X.isWysiwygFrame(t))return!1;if(X.hasClass(t,"se-drag-handle"))return!0;let e=!1;return this.isInsideForm&&this.parents?.length>0&&this.parents.some((i=>{if(i.contains(t))return e=!0,!0})),!e&&(X.getParentElement(t,".se-controller")||t?.contains(this.inst._element))},constructor:Ae},Ae.CreateHTML=function(){return X.createElement("DIV",{class:""},"")};const $e=Ae,Pe=function(t,e){Ht.call(this,t.editor),this.kink=t.constructor.key||t.constructor.name,this.inst=t;const i=e.position.split("-");this.form=null,this.items=[],this.menus=[],this.menuLen=0,this.index=-1,this.item=null,this.isOpen=!1,this.checkList=!!e.checkList,this.position=i[0],this.subPosition=i[1],this._dirPosition=/^(left|right)$/.test(this.position)?"left"===this.position?"right":"left":this.position,this._dirSubPosition=/^(left|right)$/.test(this.subPosition)?"left"===this.subPosition?"right":"left":this.subPosition,this._textDirDiff="ltr"!==e.dir&&("rtl"===e.dir||null),this.splitNum=e.splitNum||0,this.horizontal=!!this.splitNum,this.openMethod=e.openMethod,this.closeMethod=e.closeMethod,this._refer=null,this._keydownTarget=null,this._selectMethod=null,this._bindClose_key=null,this._bindClose_mousedown=null,this._bindClose_click=null,this._closeSignal=!1,this.__events=[],this.__eventHandlers={mousedown:Fe.bind(this.eventManager),mousemove:We.bind(this),click:Ue.bind(this),keydown:De.bind(this)},this.__globalEventHandlers={keydown:Ze.bind(this),mousedown:qe.bind(this),click:Ge.bind(this)}};function De(t){let e;switch(t.keyCode){case 38:if(t.preventDefault(),t.stopPropagation(),this.horizontal&&this.index>-1){const t=this.splitNum;e=this.index-t<0?t:-t}else e=-1;break;case 40:if(t.preventDefault(),t.stopPropagation(),this.horizontal&&this.index>-1){const t=this.splitNum;e=this.index+t>this.menuLen?-t:t}else e=1;break;case 37:t.preventDefault(),t.stopPropagation(),e=-1;break;case 39:t.preventDefault(),t.stopPropagation(),e=1;break;case 13:case 32:this.index>-1?(t.preventDefault(),t.stopPropagation(),this._select(this.index)):this.close()}e&&this._moveItem(e)}function Fe(t){if(q.isGecko){const e=X.getParentElement(t.target,".se-select-item");e&&this._injectActiveEvent(e)}}function We(t){X.addClass(this.form,"se-select-menu-mouse-move");const e=t.target.getAttribute("data-index");e&&(this.index=1*e)}function Ue(t){let e=t.target,i=null;for(;!i&&!/UL/i.test(e.tagName)&&!X.hasClass(e,"se-select-menu");)i=e.getAttribute("data-index"),e=e.parentNode;i&&this._select(1*i)}function Ze(t){/27/.test(t.keyCode)&&this.close()}function qe(t){this.form.contains(t.target)||(t.target!==this._refer?this.close():X.isInputElement(t.target)||(this._bindClose_click=this.eventManager.addGlobalEvent("click",this.__globalEventHandlers.click,!0)))}function Ge(t){this._bindClose_click=this.eventManager.removeGlobalEvent(this._bindClose_click),t.target===this._refer&&(t.stopPropagation(),this.close())}Pe.prototype={create(t,e){this.form.firstElementChild.innerHTML="";let i="";for(let s=0,n=(e=e||t).length;s<n;s++)s>0&&s%this.splitNum==0&&(this._createFormat(i),i=""),i+=`<li class="se-select-item" data-index="${s}">${"string"==typeof e[s]?e[s]:e[s].outerHTML}</li>`;this._createFormat(i),this.items=t,this.menus=this.form.querySelectorAll("li"),this.menuLen=this.menus.length},on(t,e,i){i||(i={}),this._refer=t,this._keydownTarget=X.isInputElement(t)?t:this._w,this._selectMethod=e,this.form=X.createElement("DIV",{class:"se-select-menu"+(i.class?" "+i.class:""),style:i.style||""},'<div class="se-list-inner"></div>'),t.parentNode.insertBefore(this.form,t)},open(t,e){this.editor.selectMenuOn=!0,"function"==typeof this.openMethod&&this.openMethod(),this.__addEvents(),this.__addGlobalEvent();const i=t?t.split("-"):[],s=i[0]||(null!==this._textDirDiff&&this._textDirDiff!==this.options.get("_rtl")?this._dirPosition:this.position),n=i[1]||(null!==this._textDirDiff&&this._textDirDiff!==this.options.get("_rtl")?this._dirSubPosition:this.subPosition);this._setPosition(s,n,e),this.isOpen=!0},close(){this.editor.selectMenuOn=!1,X.removeClass(this._refer,"on"),this._init(),this.form&&(this.form.style.cssText=""),this.isOpen=!1,"function"==typeof this.closeMethod&&this.closeMethod()},getItem(t){return this.items[t]},setItem(t){this._selectItem(t)},_createFormat(t){this.form.firstElementChild.innerHTML+=`<ul class="se-list-basic se-list-checked${this.horizontal?" se-list-horizontal":""}">${t}</ul>`},_init(){this.__removeEvents(),this.__removeGlobalEvent(),this.index=-1,this.item=null,this._onItem&&(X.removeClass(this._onItem,"se-select-on"),this._onItem=null)},_moveItem(t){t=this.index+t;const e=this.menuLen,i=this.index=t>=e?0:t<0?e-1:t;this._selectItem(i)},_selectItem(t){X.removeClass(this.form,"se-select-menu-mouse-move");const e=this.menuLen;for(let i=0;i<e;i++)i===t?X.addClass(this.menus[i],"active"):X.removeClass(this.menus[i],"active");this.index=t,this.item=this.items[t]},_setPosition(t,e,i,s){const n=t,o=this.form,l=this._refer;o.style.visibility="hidden",o.style.display="block",X.removeClass(o,"se-select-menu-scroll"),X.addClass(l,"on");const r=o.offsetWidth,a=l.offsetWidth,h=l.offsetLeft;let c=!1,d=0,u=0;"left"===t?(d=h-r-1,t=e,c=!0):"right"===t&&(d=h+a+1,t=e,c=!0);const p=this.editor.offset.get(l),g=l.offsetTop,m=p.top,f=l.offsetHeight,_=X.getClientSize().h-(m-this._w.scrollY+f),b=c?f:0;let v=1e4;switch(t){case"middle":{let t=o.offsetHeight;const e=f/2;u=g-t/2+e,m<t/2&&(u+=t/2-m-e+4,o.style.top=u+"px");let i=this.editor.offset.getGlobal(o).top;const s=t-(m-i)-_-f;s>0&&(u-=s+4,o.style.top=u+"px"),i=this.editor.offset.getGlobal(o).top,i<0&&(t+=i-4,u-=i-4),o.style.height=t+"px";break}case"top":if(m<o.offsetHeight-b){if(!s){v=0;break}v=m-4+b,v>=38&&(o.style.height=v+"px")}u=g-o.offsetHeight+b;break;case"bottom":if(_<o.offsetHeight+b){if(!s){v=0;break}v=_-4+b,v>=38&&(o.style.height=v+"px")}u=g+(c?0:f)}if(v<38&&!s&&"middle"!==t)return void this._setPosition("top"===t?"bottpm":"top",e,i,!0);if(!c)switch(e){case"center":d=h+a/2-r/2;break;case"left":d=h;break;case"right":d=h-(r-a)}o.style.left=d+"px";const y=this.editor.offset.getGlobal(o).left;let w=0;switch(c+"-"+(c?n:e)){case"true-left":w=p.left-this._w.scrollX+y,w<0&&(d=d=h+a+1);break;case"true-right":w=this._w.innerWidth-(y+r),w<0&&(d=h-r-1);break;case"false-center":{w=this._w.innerWidth-(y+r),w<0&&(d+=w-4),o.style.left=d+"px";const t=this.editor.offset.getGlobal(o).left;t<0&&(d-=t-4);break}case"false-left":w=this._w.innerWidth-(p.left-this._w.scrollX+r),w<0&&(d+=w-4);break;case"false-right":y<0&&(d-=y-4)}if(i){const t=o.firstElementChild.querySelector(i);t&&(this._onItem=t,X.addClass(t,"se-select-on"))}o.style.left=d+"px",o.style.top=u+"px",o.style.visibility=""},_select(t){this.checkList&&X.toggleClass(this.menus[t],"se-checked"),this._selectMethod(this.getItem(t))},__addEvents(){this.__removeEvents(),this.__events=this.__eventHandlers,this.form.addEventListener("mousedown",this.__events.mousedown),this.form.addEventListener("mousemove",this.__events.mousemove),this.form.addEventListener("click",this.__events.click),this._keydownTarget.addEventListener("keydown",this.__events.keydown)},__removeEvents(){0!==this.__events.length&&(this.form.removeEventListener("mousedown",this.__events.mousedown),this.form.removeEventListener("mousemove",this.__events.mousemove),this.form.removeEventListener("click",this.__events.click),this._keydownTarget.removeEventListener("keydown",this.__events.keydown),this.__events=[])},__addGlobalEvent(){this.__removeGlobalEvent(),this._bindClose_key=this.eventManager.addGlobalEvent("keydown",this.__globalEventHandlers.keydown,!0),this._bindClose_mousedown=this.eventManager.addGlobalEvent("mousedown",this.__globalEventHandlers.mousedown,!0)},__removeGlobalEvent(){this._bindClose_key&&(this._bindClose_key=this.eventManager.removeGlobalEvent(this._bindClose_key)),this._bindClose_mousedown&&(this._bindClose_mousedown=this.eventManager.removeGlobalEvent(this._bindClose_mousedown)),this._bindClose_click&&(this._bindClose_click=this.eventManager.removeGlobalEvent(this._bindClose_click))},constructor:Pe};const Ye=Pe,{ON_OVER_COMPONENT:Xe}=q,je={tl:"nw-resize",tr:"ne-resize",bl:"sw-resize",br:"se-resize",lw:"w-resize",th:"n-resize",rw:"e-resize",bh:"s-resize"};let Ke=!1,Je=!1,Qe=0,ti=0;const ei=function(t,e,i){He.call(this,t.editor),this.kind=t.constructor.key||t.constructor.name,this._alignIcons={none:this.icons.format_float_none,left:this.icons.format_float_left,right:this.icons.format_float_right,center:this.icons.format_float_center},this._action={};const s=function(t,e){let i=null;if(e?.length>0){const{lang:s,icons:n}=t;i='<div class="se-arrow se-arrow-up"></div>';for(let o,l=0;l<e.length;l++){o=e[l],i+='<div class="se-btn-group">';for(let e,l=0,r=o.length;l<r;l++){if(e=o[l],"function"==typeof e?.action){const i=e;e={c:`__c__${i.command}`,v:i.value||"",l:i.title,i:i.icon},t._action[e.c]=i.action}else if(e=pi(e),!e)continue;i+=`\n\t\t\t\t\t<button type="button" data-command="${e.c}" data-value="${e.v}" class="${e.t?"se-btn-w-auto ":""}se-btn se-tooltip">\n\t\t\t\t\t\t${n[e.i]||e.t||e.i}\n\t\t\t\t\t\t<span class="se-tooltip-inner"><span class="se-tooltip-text">${s[e.l]||e.l}</span></span>\n\t\t\t\t\t</button>`}i+="</div>"}}return X.createElement("DIV",{class:"se-controller se-controller-resizing"+(i?"":" se-empty-controller")},i)}(this,e||[]);this.controller=new $e(this,s,{position:"bottom",disabled:!0},this.kind),this.alignButton=s.querySelector('[data-command="onalign"]');const n=function(t,e){if(!e)return null;const i=[t._alignIcons.none,t._alignIcons.left,t._alignIcons.center,t._alignIcons.right],s=[t.lang.basic,t.lang.left,t.lang.center,t.lang.right],n=["none","left","center","right"],o=[],l=[];for(let t=0;t<n.length;t++)o.push(`\n\t\t<button type="button" class="se-btn-list se-tooltip" data-command="${n[t]}">\n\t\t\t${i[t]}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${s[t]}</span>\n\t\t\t</span>\n\t\t</button>`),l.push(n[t]);return{html:o,items:l}}(this,this.alignButton);n&&(this.selectMenu_align=new Ye(this,{checkList:!1,position:"bottom-center"}),this.selectMenu_align.on(this.alignButton,ai.bind(this),{class:"se-resizing-align-list"}),this.selectMenu_align.create(n.items,n.html)),this.resizeButton=s.querySelector('[data-command="onresize"]');const o=function(t,e){if(!e)return null;const i=e.getAttribute("data-value").split(","),s=[];for(let e,n,o,l,r=0;r<i.length;r++)o=i[r],e=j.is(o),n=e?"resize_percent"+o:"auto",l=e?o+"%":t.lang.autoSize,s.push('<button type="button" class="se-btn-list" data-command="'+n+'" data-value="'+o+'"><span>'+l+"</span></button>");return{html:s,items:i}}(this,this.resizeButton);o&&(this.selectMenu_resize=new Ye(this,{checkList:!1,position:"bottom-left",dir:"ltr"}),this.selectMenu_resize.on(this.resizeButton,hi.bind(this)),this.selectMenu_resize.create(o.items,o.html)),this.inst=t,this.sizeUnit=i.sizeUnit||"px",this.autoRatio=i.autoRatio,this.isVertical=!1,this.percentageButtons=s.querySelectorAll('[data-command="resize_percent"]'),this.captionButton=s.querySelector('[data-command="caption"]'),this.align="none",this._element=null,this._cover=null,this._container=null,this._caption=null,this._width=0,this._height=0,this._element_w=0,this._element_h=0,this._element_l=0,this._element_t=0,this._resize_w=0,this._resize_h=0,this._resizeClientX=0,this._resizeClientY=0,this._resize_direction="",this._floatClassStr="__se__float-none|__se__float-left|__se__float-center|__se__float-right",this.__preventSizechange=!1,this.__revertSize={w:"",h:""},this.__offset={},this.__offContainer=ci.bind(this),this.__containerResizing=oi.bind(this),this.__containerResizingOff=li.bind(this),this.__containerResizingESC=ri.bind(this),this.__onContainerEvent=null,this.__offContainerEvent=null,this.__onResizeESCEvent=null,this.__fileManagerInfo=!1,this.eventManager.addEvent(this.alignButton,"click",di.bind(this)),this.eventManager.addEvent(this.resizeButton,"click",ui.bind(this)),this.editor.applyFrameRoots((t=>{if(!t.get("wrapper").querySelector(".se-controller.se-resizing-container")){const e=X.createElement("DIV",{class:"se-controller se-resizing-container",style:"display: none;"},'\n\t\t<div class="se-resize-dot">\n\t\t\t<span class="tl"></span>\n\t\t\t<span class="tr"></span>\n\t\t\t<span class="bl"></span>\n\t\t\t<span class="br"></span>\n\t\t\t<span class="lw"></span>\n\t\t\t<span class="th"></span>\n\t\t\t<span class="rw"></span>\n\t\t\t<span class="bh"></span>\n\t\t\t<div class="se-resize-display"></div>\n\t\t</div>'),i=e.querySelectorAll(".se-resize-dot > span");t.set("_figure",{main:e,border:e.querySelector(".se-resize-dot"),display:e.querySelector(".se-resize-display"),handles:i}),t.get("wrapper").appendChild(e),this.eventManager.addEvent(i,"mousedown",ni.bind(this))}}))};function ii(t,e){t.style.display="block",t.style.left=e.offsetLeft+(this.options.get("_rtl")?t.offsetWidth:e.offsetWidth-1.5*t.offsetWidth)+"px",t.style.top=e.offsetTop-t.offsetHeight+"px"}function si(t){const e=t.style.transform;return e?{r:1*((e.match(/rotate\(([-0-9]+)deg\)/)||[])[1]||0),x:(e.match(/rotateX\(([-0-9]+)deg\)/)||[])[1]||"",y:(e.match(/rotateY\(([-0-9]+)deg\)/)||[])[1]||""}:{r:0,x:"",y:""}}function ni(t){t.stopPropagation(),t.preventDefault();const e=Lt.get("__figureInst"),i=e._resize_direction=t.target.classList[0];e._resizeClientX=t.clientX,e._resizeClientY=t.clientY,e.editor.frameContext.get("_figure").main.style.float=/l/.test(i)?"right":/r/.test(i)?"left":"none",this.editor.enableBackWrapper(je[i]);const{w:s,h:n}=this.getSize(e._element);if(Ke=Je=!1,Qe=ti=0,!this.isVertical){const t=!s||/auto|%$/.test(s),o=!n||/auto|%$/.test(n);if("tl|bl|tr|br".includes(i)&&t&&o?Ke=!0:"lw|rw".includes(i)&&t&&(Je=!0),Ke||Je){const t=e._cover||e._element;ti=t.offsetWidth,Qe=Y.getWidthInPercentage(t,this.editor.frameContext.get("wysiwygFrame"))/100}}e.__onContainerEvent=e.eventManager.addGlobalEvent("mousemove",e.__containerResizing),e.__offContainerEvent=e.eventManager.addGlobalEvent("mouseup",e.__containerResizingOff),e._displayResizeHandles(!1)}function oi(t){const e=this._resize_direction,i=t.clientX,s=t.clientY;let n=this._element_w,o=this._element_h;const l=n+(/r/.test(e)?i-this._resizeClientX:this._resizeClientX-i),r=o+(/b/.test(e)?s-this._resizeClientY:this._resizeClientY-s),a=o/n*l,h=this.editor.frameContext.get("_figure").border;/t/.test(e)&&(h.style.top=o-(/h/.test(e)?r:a)+"px"),/l/.test(e)&&(h.style.left=n-l+"px"),/r|l/.test(e)&&(h.style.width=l+"px",n=l),/^(t|b)[^h]$/.test(e)?(h.style.height=a+"px",o=a):/^(t|b)h$/.test(e)&&(h.style.height=r+"px",o=r),this._resize_w=/h$/.test(e)?this._width:Math.round(n),this._resize_h=/w$/.test(e)?this._height:Math.round(o);const c=Qe?this._resize_w/ti*Qe*100:this._resize_w;X.changeTxt(this.editor.frameContext.get("_figure").display,Qe?j.get(c>100?100:c,2).toFixed(2)+"%":c+" x "+this._resize_h)}function li(){this._offResizeEvent();let t=this.isVertical?this._resize_h:this._resize_w,e=this.isVertical?this._resize_w:this._resize_h;if(t=Math.round(t)||t,e=Math.round(e)||e,!this.isVertical&&!/%$/.test(t)){const i=this.editor.frameContext.get("wysiwygFrame").clientWidth-j.get(this.editor.frameContext.get("wwComputedStyle").getPropertyValue("padding-left"))+j.get(this.editor.frameContext.get("wwComputedStyle").getPropertyValue("padding-right"))-2;j.get(t,0)>i&&(e=Math.round(e/t*i),t=i)}Ke||Je?(t=t/(this._cover||this._element).offsetWidth*Qe*100,t=j.get(t>100?100:t,2)+"%",this._setPercentSize(t,Je?this.getSize(this._element).h:"")):(this._applySize(t,e,this._resize_direction),this.isVertical&&this.setTransform(this._element,t,e,0)),this.history.push(!1),this.component.select(this._element,this.kind,!1)}function ri(t){/^27$/.test(t.keyCode)&&(this._offResizeEvent(),this.component.select(this._element,this.kind,!1))}function ai(t){this.setAlign(this._element,t),this.selectMenu_align.close(),this.component.select(this._element,this.kind,!1)}function hi(t){if("auto"===t)this.deleteTransform(),this._setAutoSize();else{let e=this.getSize(this._element).h;if(this.isVertical){const t=(this._element.getAttribute("data-se-size")||",").split(",");t[1]&&(e=t[1])}this.deleteTransform(),this._setPercentSize(1*t,null!==j.get(e,0)&&/%$/.test(e)?e:"")}this.selectMenu_resize.close(),this.component.select(this._element,this.kind,!1)}function ci(){this.editor.frameContext.get("_figure").main.style.display="none",this.editor._figureContainer=null}function di(){this.selectMenu_align.open("",'[data-command="'+this.align+'"]')}function ui(){const t=this.getSize(this._element),e=t.w,i=t.h;let s="";if(this.autoRatio){if(i===this.autoRatio.default&&/%$/.test(e)){const t=j.get(e);s=100===t?"auto":"resize_percent"+t}}else"auto"===i&&("auto"===e?s="auto":/%$/.test(e)&&(s="resize_percent"+j.get(e)));this.selectMenu_resize.open("",'[data-command="'+s+'"]')}function pi(t){const e=t.split("_"),i=e[0],s=e[1];let n,o,l,r;switch(i){case"resize":n="onresize",o=s,l="resize",r="resize";break;case"auto":n="auto",l="autoSize",r="auto_size";break;case"rotate":n="rotate",o="l"===s?-90:"r"===s?90:j.get(s),l=o<0?"rotateLeft":"rotateRight",r=o<0?"rotate_left":"rotate_right";break;case"mirror":n="mirror",o=s,l="h"===s?"mirrorHorizontal":"mirrorVertical",r="h"===s?"mirror_horizontal":"mirror_vertical";break;case"align":n="onalign",l="align",r="align_justify";break;case"caption":n="caption",l="caption",r="caption";break;case"revert":n="revert",l="revert",r="revert";break;case"edit":n="edit",l="edit",r="edit";break;case"remove":n="remove",l="remove",r="delete"}return n?{c:n,v:o,l,t:void 0,i:r}:null}ei.CreateContainer=function(t,e){return X.createElement("DIV",{class:"se-component"+(e?" "+e:"")},X.createElement("FIGURE",null,t)),ei.GetContainer(t)},ei.CreateCaption=function(t,e){const i=X.createElement("FIGCAPTION",null,"<div>"+e+"</div>");return t.appendChild(i),i},ei.GetContainer=function(t){const e=X.getParentElement(t,"FIGURE");return{target:t,container:X.getParentElement(t,ei.__is)||e,cover:e,caption:X.getEdgeChild(t.parentElement,"FIGCAPTION")}},ei.GetRatio=function(t,e,i){let s=1,n=1;if(/\d+/.test(t)&&/\d+/.test(e)&&(!j.is(t)&&t.replace(/\d+|\./g,"")||i||"px")===(!j.is(e)&&e.replace(/\d+|\./g,"")||i||"px")){const i=j.get(t,4),o=j.get(e,4);s=i/o,n=o/i}return{w:j.get(s,4),h:j.get(n,4)}},ei.CalcRatio=function(t,e,i,s){if(/\d+/.test(t)&&/\d+/.test(e)){const n=!j.is(t)&&t.replace(/\d+|\./g,"")||i||"px",o=!j.is(e)&&e.replace(/\d+|\./g,"")||i||"px";if(n===o){const i="%"===n?2:0,l=t,r=e;e=j.get(s.h*j.get(l,i),i)+o,t=j.get(s.w*j.get(r,i),i)+n}}return{w:t,h:e}},ei.__is=function(t){return X.hasClass(t,"se-component")||/^(HR)$/.test(t?.nodeName)},ei.prototype={close(){this.editor._antiBlur=!1,X.removeClass(this._cover,"se-figure-selected"),this.controller.close(),X.hasClass(this._w.event?.target,"se-drag-handle|sun-editor-editable")||this.component._removeDragEvent()},open(t,{nonResizing:e,nonSizeInfo:i,nonBorder:s,figureTarget:n,__fileManagerInfo:o}){if(!t)return void console.warn("[SUNEDITOR.modules.Figure.open] The target element is null.");Lt.get("__overInfo")!==Xe?this.editor._offCurrentController():s=!0;const l=ei.GetContainer(t);if(!l.container)return{container:null,cover:null};Lt.set("__figureInst",this),this._cover=l.cover,this._container=l.container,this._caption=l.caption,this._element=t,this.align=(this._container.className.match(/(?:^|\s)__se__float-(none|left|center|right)(?:$|\s)/)||[])[1]||t.style.float||"none",this.isVertical=/^(90|270)$/.test(Math.abs(si(t).r).toString());const r=n&&(this._cover||this._container)||t,{w:a,h,t:c,l:d,scrollX:u,scrollY:p}=this.offset.getSize(r),g=(t.getAttribute("data-se-size")||"").split(","),m=ei.GetRatio(g[0]||j.get(t.style.width,2)||a,g[1]||j.get(t.style.height,2)||h,this.sizeUnit),f={container:l.container,cover:l.cover,caption:l.caption,align:this.align,ratio:m,w:a,h,t:c,l:d,width:g[0]||"auto",height:g[1]||"auto",originWidth:t.naturalWidth||t.offsetWidth,originHeight:t.naturalHeight||t.offsetHeight};if(this._width=f.width,this._height=f.height,o||this.__fileManagerInfo)return f;const _=this.editor.frameContext.get("_figure");this.editor._figureContainer=_.main,_.main.style.top=c+"px",_.main.style.left=d+"px",_.main.style.width=(this.isVertical?h:a)+"px",_.main.style.height=(this.isVertical?a:h)+"px",_.border.style.top="0px",_.border.style.left="0px",_.border.style.width=(this.isVertical?h:a)+"px",_.border.style.height=(this.isVertical?a:h)+"px",this.__offset={left:d+u,top:c+p},this.editor.opendControllers.push({position:"none",form:_.main,target:r,inst:this,notInCarrier:!0});const b=/%$/.test(t.style.width)&&/%$/.test(l.container.style.width)?j.get(l.container.style.width,0)/100+"":"";for(let t=0,e=this.percentageButtons.length;t<e;t++)this.percentageButtons[t].getAttribute("data-value")===b?X.addClass(this.percentageButtons[t],"active"):X.removeClass(this.percentageButtons[t],"active");if(this.captionButton&&(l.caption?X.addClass(this.captionButton,"active"):X.removeClass(this.captionButton,"active")),_.display.style.display=i?"none":"",_.border.style.display=s?"none":"",_.main.style.display="block",Lt.get("__overInfo")!==Xe){this._setAlignIcon(),this.editor._visibleControllers(!0,!0);const i=this.getSize(t);X.changeTxt(_.display,this.lang["none"===this.align?"basic":this.align]+" ("+i.w+", "+i.h+")"),this._displayResizeHandles(!e),X.removeClass(this._cover,"se-figure-over-selected"),this.controller.open(_.main,null,{initMethod:this.__offContainer,isWWTarget:!1,addOffset:null}),this._w.setTimeout((()=>Lt.set("__overInfo",!1)),0)}else X.addClass(this._cover,"se-figure-over-selected");return X.addClass(this._cover,"se-figure-selected"),this._element_w=this._resize_w=a,this._element_h=this._resize_h=h,this._element_l=d,this._element_t=c,(Lt.get("__overInfo")!==Xe||X.hasClass(l.container,"se-input-component"))&&this._setDragEvent(_.main),f},controllerHide(){this.controller.hide()},controllerShow(){this.controller.show()},controllerOpen(t,e){this._element=t,this.controller.open(t,null,e)},setSize(t,e){/%$/.test(t)?this._setPercentSize(t,e):t&&"auto"!==t||e&&"auto"!==e?this._applySize(t,e,""):this.autoRatio?this._setPercentSize(100,this.autoRatio.default||this.autoRatio.current):this._setAutoSize()},getSize(t){if(t||(t=this._element),!t)return{w:"",h:""};const e=ei.GetContainer(t);return e.container?{w:(/%$/.test(t.style.width)?(e.container&&j.get(e.container.style.width,2)||100)+"%":t.style.width)||"auto",h:(j.get(e.cover.style.paddingBottom,0)>0&&!this.isVertical?e.cover.style.height:/%$/.test(t.style.height)&&/%$/.test(t.style.width)?(e.container&&j.get(e.container.style.height,2)||100)+"%":t.style.height)||"auto"}:{w:"",h:t.style.height}},setAlign(t,e){t||(t=this._element),this.align=e=e||"none";const i=ei.GetContainer(t),s=i.container,n=i.cover;if(/%$/.test(t.style.width)&&"center"===e&&!this.component.isInline(s)?(s.style.minWidth="100%",n.style.width=s.style.width):(s.style.minWidth="",n.style.width=this.isVertical?t.style.height||t.offsetHeight:t.style.width&&"auto"!==t.style.width?t.style.width||"100%":""),X.hasClass(s,"__se__float-"+e)||(X.removeClass(s,this._floatClassStr),X.addClass(s,"__se__float-"+e)),this.autoRatio){const{w:t,h:e}=this.getSize(this._element);this.__setCoverPaddingBottom(t,e)}this._setAlignIcon()},controllerAction(t){const e=t.getAttribute("data-command"),i=t.getAttribute("data-value"),s=this._element;if(!/^(onalign|onresize)$/.test(e)){switch(e){case"mirror":{const t=si(s);let e=t.x,n=t.y;"h"===i&&!this.isVertical||"v"===i&&this.isVertical?n=n?"":"180":e=e?"":"180",this._setRotate(s,t.r,e,n);break}case"rotate":this.setTransform(s,null,null,i);break;case"caption":if(this._caption)X.removeItem(this._caption),this._w.setTimeout(this.component.select.bind(this.component,s,this.kind),0);else{const t=ei.CreateCaption(this._cover,this.lang.caption),e=X.getEdgeChild(t,(t=>3===t.nodeType));e?this.selection.setRange(e,0,e,e.textContent.length):t.focus(),this.controller.close()}this._caption=!this._caption,(/\d+/.test(s.style.height)||this.isVertical&&this._caption)&&(/%$/.test(s.style.width)||/auto/.test(s.style.height)?this.deleteTransform():this.setTransform(s,s.style.width,s.style.height,0));break;case"revert":this._setRevert();break;case"edit":this.inst.edit(s);break;case"remove":this.inst.destroy(s),this.controller.close()}/^__c__/.test(e)?this._action[e](s,i,t):/^edit$/.test(e)||(this.history.push(!1),/^remove|caption$/.test(e)||this.component.select(s,this.kind,!1))}},deleteTransform(t){t||(t=this._element);const e=(t.getAttribute("data-se-size")||"").split(",");this.isVertical=!1,t.style.maxWidth="",t.style.transform="",t.style.transformOrigin="",this._deleteCaptionPosition(t),this._applySize(e[0]||"auto",e[1]||"","")},setTransform(t,e,i,s){try{this.__preventSizechange=!0;const n=si(t),o=n.r+1*(s||0);s=Math.abs(o)>=360?0:o;const l=this.isVertical=/^(90|270)$/.test(Math.abs(s).toString());e=j.get(e,0),i=j.get(i,0);const r=(t.getAttribute("data-se-size")||"auto,auto").split(",");let a="";if(/auto|%$/.test(r[0])&&!l)"auto"===r[0]&&"auto"===r[1]?this._setAutoSize():this._setPercentSize(r[0],r[1]);else{const n=ei.GetContainer(t),o=e||t.offsetWidth,r=i||t.offsetHeight,h=(l?r:o)+"px",c=(l?o:r)+"px";this._deletePercentSize(),this._applySize(o+"px",r+"px",""),n.cover.style.width=h,n.cover.style.height=n.caption?"":c,l&&(a=90===s||-270===s?r/2+"px "+r/2+"px 0":o/2+"px "+o/2+"px 0")}t.style.transformOrigin=a,this._setRotate(t,s,n.x,n.y),t.style.maxWidth=l?"none":"",this._setCaptionPosition(t)}finally{this.__preventSizechange=!1}},_setRotate(t,e,i,s){let n=(t.offsetWidth-t.offsetHeight)*(/^-/.test(e)?1:-1),o="";if(/[1-9]/.test(e)&&(i||s))switch(o=i?"Y":"X",e+""){case"90":o=i&&s?"X":s?o:"";break;case"270":n*=-1,o=i&&s?"Y":i?o:"";break;case"-90":o=i&&s?"Y":i?o:"";break;case"-270":n*=-1,o=i&&s?"X":s?o:"";break;default:o=""}e%180==0&&(t.style.maxWidth=""),t.style.transform="rotate("+e+"deg)"+(i?" rotateX("+i+"deg)":"")+(s?" rotateY("+s+"deg)":"")+(o?" translate"+o+"("+n+"px)":"")},_applySize(t,e,i){const s=/^(rw|lw)$/.test(i)&&/\d+/.test(this._element.style.height),n=/^(th|bh)$/.test(i)&&/\d+/.test(this._element.style.width);e=e||(this.autoRatio?this.autoRatio.current||this.autoRatio.default:e),t=j.is(t)?t+this.sizeUnit:t,/%$/.test(t)||/%$/.test(e)||s||n||this._deletePercentSize();const o=this._cover||this._element;this.autoRatio&&(this._cover.style.width=t),n||(o.style.width=this._element.style.width=t),s||(e=j.is(e)?e+this.sizeUnit:e,o.style.height=this._element.style.height=this.autoRatio&&!this.isVertical?"100%":e,this.autoRatio&&(this._cover.style.height=e,this.__setCoverPaddingBottom(t,e))),"center"===this.align&&this.setAlign(this._element,this.align),this._saveCurrentSize()},__setCoverPaddingBottom(t,e){this._cover.style.height=e,/%$/.test(t)&&"center"===this.align?this._cover.style.paddingBottom=/%$/.test(e)?j.get(j.get(e,2)/100*j.get(t,2),2)+"%":e:this._cover.style.paddingBottom=e},_setAutoSize(){this._caption&&(this._caption.style.marginTop=""),this.deleteTransform(),this._deletePercentSize(),this.autoRatio?this._setPercentSize("100%",this.autoRatio.current||this.autoRatio.default):(this._element.style.maxWidth="",this._element.style.width="",this._element.style.height="",this._cover.style.width="",this._cover.style.height=""),this.setAlign(this._element,this.align),this._saveCurrentSize()},_setPercentSize(t,e){e||(e=this.autoRatio?/%$/.test(this.autoRatio.current)?this.autoRatio.current:this.autoRatio.default:e),e=!e||/%$/.test(e)||j.get(e,0)?j.is(e)?e+this.sizeUnit:e||(this.autoRatio?this.autoRatio.default:""):j.is(e)?e+"%":e;const i=/%$/.test(e);this._container.style.width=j.is(t)?t+"%":t,this._container.style.height="",this._cover.style.width="100%",this._cover.style.height=e,this._element.style.width="100%",this._element.style.maxWidth="",this._element.style.height=this.autoRatio?"100%":i?"":e,"center"===this.align&&this.setAlign(this._element,this.align),this.autoRatio&&this.__setCoverPaddingBottom(t,e),this._setCaptionPosition(this._element),this._saveCurrentSize()},_deletePercentSize(){this._cover.style.width="",this._cover.style.height="",this._container.style.width="",this._container.style.height="",X.removeClass(this._container,this._floatClassStr),X.addClass(this._container,"__se__float-"+this.align),"center"===this.align&&this.setAlign(this._element,this.align)},_setRevert(){this.setSize(this.__revertSize.w,this.__revertSize.h)},_setAlignIcon(){this.alignButton&&X.changeElement(this.alignButton.firstElementChild,this._alignIcons[this.align])},_saveCurrentSize(){if(this.__preventSizechange)return;const t=(this._element.getAttribute("data-se-size")||",").split(",");this.__revertSize.w=t[0],this.__revertSize.h=t[1];const e=this.getSize(this._element);this._element.setAttribute("width",e.w.replace("px","")),this._element.setAttribute("height",e.h.replace("px","")),this._element.setAttribute("data-se-size",e.w+","+e.h),this.autoRatio&&(this.autoRatio.current=/%$/.test(e.h)?e.h:"")},_setCaptionPosition(t){const e=X.getEdgeChild(X.getParentElement(t,"FIGURE"),"FIGCAPTION");e&&(e.style.marginTop=(this.isVertical?t.offsetWidth-t.offsetHeight:0)+"px")},_deleteCaptionPosition(t){const e=X.getEdgeChild(X.getParentElement(t,"FIGURE"),"FIGCAPTION");e&&(e.style.marginTop="")},_displayResizeHandles(t){t=t?"flex":"none",this.controller.form.style.display=t;const e=this.editor.frameContext.get("_figure"),i=e.handles;for(let e=0,s=i.length;e<s;e++)i[e].style.display=t;"none"===t?(X.addClass(e.main,"se-resize-ing"),this.__onResizeESCEvent=this.eventManager.addGlobalEvent("keydown",this.__containerResizingESC)):X.removeClass(e.main,"se-resize-ing")},_offResizeEvent(){this.component._removeDragEvent(),this.eventManager.removeGlobalEvent(this.__onContainerEvent),this.eventManager.removeGlobalEvent(this.__offContainerEvent),this.eventManager.removeGlobalEvent(this.__onResizeESCEvent),this._displayResizeHandles(!0),this.editor._offCurrentController(),this.editor.disableBackWrapper()},_setDragEvent(t){const e=this.editor.frameContext.get("wrapper").querySelector(".se-drag-handle");X.removeClass(e,"se-drag-handle-full"),e.style.opacity="",e.style.width="",e.style.height="",Lt.set("__dragHandler",e),Lt.set("__dragContainer",this._container),Lt.set("__dragCover",this._cover),Lt.set("__dragMove",ii.bind(this,e,t)),Lt.get("__dragMove")(),e.style.display="block"},_retainFigureFormat(t,e,i){let s=this.format.isBlock(e.parentNode)||X.isWysiwygFrame(e.parentNode)?e:X.isAnchor(e.parentNode)?e.parentNode:this.format.getLine(e)||e;if(X.getParentElement(e,X.isExcludeFormat))s=i&&i!==e?i:e,s.parentNode.replaceChild(t,s);else if(X.isListCell(s)){const i=X.getParentElement(e,(t=>t.parentNode===s));s.insertBefore(t,i),X.removeItem(e),this.nodeTransform.removeEmptyNode(i,null,!0)}else if(this.format.isLine(s)){const i=X.getParentElement(e,(t=>t.parentNode===s));s=this.nodeTransform.split(s,i),s.parentNode.insertBefore(t,s),X.removeItem(e),this.nodeTransform.removeEmptyNode(s,null,!0)}else if(this.format.isLineOnly(s.parentNode)){const e=s.parentNode;e.parentNode.insertBefore(t,s.previousSibling?e.nextElementSibling:e),0===this.fileManager.__updateTags.map((t=>s.contains(t))).length&&X.removeItem(s)}else s=X.isFigure(s.parentNode)?X.getParentElement(s.parentNode,ei.__is):s,s.parentNode.replaceChild(t,s)},constructor:ei};const gi=ei,{_w:mi,ON_OVER_COMPONENT:fi}=q,_i=/^(3[7-9]|40)$/,bi=/^3[7-8]$/,vi=function(t){Ht.call(this,t),this.info=null,this.isSelected=!1,this.currentTarget=null,this.currentPlugin=null,this.currentPluginName="",this.currentInfo=null,this.__globalEvents={copy:Ti.bind(this),cut:ki.bind(this),keydown:Ni.bind(this),mousedown:Ei.bind(this)},this._bindClose_copy=null,this._bindClose_cut=null,this._bindClose_keydown=null,this._bindClose_mousedown=null,this._bindClose_touchstart=null,this.__selectionSelected=!1,this.editor.applyFrameRoots((t=>{const e=X.createElement("DIV",{class:"se-drag-handle",draggable:"true"},this.icons.selection);t.get("wrapper").appendChild(e),this.eventManager.addEvent(e,"mouseenter",yi.bind(this)),this.eventManager.addEvent(e,"mouseleave",wi.bind(this)),this.eventManager.addEvent(e,"dragstart",Ci.bind(this)),this.eventManager.addEvent(e,"dragend",xi.bind(this)),this.eventManager.addEvent(e,"click",Si.bind(this))}))};function yi(){this.editor._antiBlur=!0,this.editor._visibleControllers(!1,X.hasClass(Lt.get("__dragHandler"),"se-drag-handle-full")),X.addClass(Lt.get("__dragCover")||Lt.get("__dragContainer"),"se-drag-over")}function wi(){this.editor._antiBlur=!1,X.hasClass(Lt.get("__dragHandler"),"se-drag-handle-full")||this.editor._visibleControllers(!0,!0),X.removeClass([Lt.get("__dragCover"),Lt.get("__dragContainer")],"se-drag-over")}function Ci(t){const e=Lt.get("__dragCover")||Lt.get("__dragContainer");e?(this.editor._antiBlur=!1,X.addClass(Lt.get("__dragHandler"),"se-dragging"),X.addClass(Lt.get("__dragContainer"),"se-dragging"),t.dataTransfer.setDragImage(e,this.options.get("_rtl")?e.offsetWidth:-5,-5)):t.preventDefault()}function xi(){this.editor._antiBlur=!1,X.removeClass([Lt.get("__dragHandler"),Lt.get("__dragContainer")],"se-dragging"),this._removeDragEvent()}function Si({target:t}){if(!X.hasClass(t,"se-drag-handle-full"))return;const e=Lt.get("__dragInst");this.select(e.currentTarget,e.currentPluginName,!1)}function Ei({target:t}){this.currentTarget?.contains(t)||X.getParentElement(t,".se-controller")||X.hasClass(t,"se-drag-handle")||this.currentPluginName===this.editor.currentControllerName&&this.editor.opendControllers.some((({form:e})=>e.contains(t)))||this.deselect()}function Ti(t){if(X.isInputElement(t.target)&&X.getParentElement(t.target,".se-modal"))return;const e=this.info;e&&(Hi(t,e.container,t.clipboardData),X.addClass(e.container,"se-copy"),mi.setTimeout((()=>{X.removeClass(e.container,"se-copy")}),120))}function ki(t){const e=this.info;e&&(Hi(t,e.container,t.clipboardData),this.deselect(),X.removeItem(e.container))}function Ni(t){if(this.editor.selectMenuOn)return;const e=t.keyCode;if(t.ctrlKey||t.metaKey||91===e||92===e||224===e){if(17!==e){const i=this.editor.shortcutsKeyMap.get(e+(t.shiftKey?1e3:0));/^(redo|undo)$/.test(i?.c)&&(t.preventDefault(),t.stopPropagation(),this.editor.run(i.c,i.t,i.e))}}else{if((8===e||46===e)&&(t.preventDefault(),t.stopPropagation(),"function"==typeof this.currentPlugin?.destroy))return this.currentPlugin.destroy(this.currentTarget),this.deselect(),void this.editor.focus();if(13===e){t.preventDefault();const e=this.currentInfo||this.get(this.currentTarget),i=e.container||e.target,s=i.previousElementSibling||i.nextElementSibling;let n=null;n=X.isListCell(i.parentNode)?X.createElement("BR"):X.createElement(this.format.isLine(s)&&!this.format.isBlock(s)?s.nodeName:this.options.get("defaultLine"),null,"<br>");const o=this.currentPluginName;return this.deselect(),i.parentNode.insertBefore(n,i),!1===this.select(e.target,o)&&this.editor.blur(),void this.history.push(!1)}if(_i.test(e)){const{container:i}=this.get(this.currentTarget);let s=null,n=1;if(this.isInline(i||this.currentTarget))switch(e){case 37:s=i.previousSibling,n=3===s?.nodeType?s.textContent.length:1;break;case 39:s=i.nextSibling;break;case 38:{const t=this.format.getLine(i,null);s=t?.previousElementSibling,n=0;break}case 40:{const t=this.format.getLine(i,null);s=t?.nextElementSibling;break}}else bi.test(e)?s=i.previousElementSibling:(s=i.nextElementSibling,n=0);if(!s)return;this.deselect();const o=this.get(s);o?.container?(t.stopPropagation(),t.preventDefault(),this.select(o.target,o.pluginName)):(t.stopPropagation(),t.preventDefault(),this.selection.setRange(s,n,s,n))}else 27!==e||this.deselect()}}function Hi(t,e,i){t.preventDefault(),t.stopPropagation();const s=e.cloneNode(!0);X.removeClass(s,"se-component-selected"),s.querySelectorAll(".se-figure-selected").forEach((t=>X.removeClass(t,"se-figure-selected"))),i.setData("text/html",s.outerHTML)}vi.prototype={insert(t,e,i){if(this.editor.frameContext.get("isReadOnly")||!e&&!this.char.check(t))return null;const s=this.html.remove(),n=this.isInline(t);this.selection.getRangeAndAddLine(this.selection.getRange(),s.container);const o=this.selection.getNode();let l=null,r=this.format.getLine(o,null);if(X.isListCell(r))this.html.insertNode(t,n||o===r?null:s.container.nextSibling,!0),n||t.nextSibling||t.parentNode.appendChild(X.createElement("BR"));else{if(this.selection.getRange().collapsed&&(3===s.container.nodeType||X.isBreak(s.container))){const t=X.getParentElement(s.container,this.format.isBlock.bind(this.format));l=this.nodeTransform.split(s.container,s.offset,t?X.getNodeDepth(t)+1:0),l&&(r=l.previousSibling)}this.html.insertNode(t,n||this.format.isBlock(r)?null:r,!0),!n&&r&&X.isZeroWith(r)&&X.removeItem(r)}if(n){const e=X.createTextNode(G.zeroWidthSpace);t.parentNode.insertBefore(e,t.nextSibling)}if(this.history.push(!1),!i){this.selection.setRange(t,0,t,0);const e=this.get(t);e?this.select(e.target,e.pluginName):l&&(l=X.getEdgeChildNodes(l,null).sc||l,this.selection.setRange(l,0,l,0))}return l||t},get(t){if(!t)return null;let e,i="",s={},n=!1;if(this.is(t)){if(X.hasClass(t,"se-component")&&!X.hasClass(t,"se-inline-component")&&(t=t.firstElementChild||t),/^FIGURE$/i.test(t.nodeName)&&(t=t.firstElementChild),!t)return null;const n=this.editor._componentManager.map((e=>e(t))).find((t=>t));if(!n)return null;e=n.target,i=n.pluginName,s=n.options}if(!e&&t.nodeName){this.__isFiles(t)&&(n=!0);const o=this.editor._componentManager.map((e=>e(t))).find((t=>t));if(!o)return null;e=o.target,i=o.pluginName,s=o.options}if(!e)return null;const o=gi.GetContainer(e);return this.info={target:e,pluginName:i,options:s,container:o.container||o.cover||e,cover:o.cover,caption:o.caption,isFile:n}},select(t,e,i){const s=this.get(t);if(!s||X.isUneditable(X.getParentElement(t,this.is.bind(this)))||X.isUneditable(t))return!1;const n=this.plugins[e];if(!n)return;let o;i||Lt.get("__overInfo")===fi||(this.editor._antiBlur=!0,this.__selectionSelected=!0,this.isInline(s.container)&&this.selection.setRange(s.container,0,s.container,0),this.editor.blur(),mi.setTimeout((()=>{this.__selectionSelected=!1}))),this.isSelected=!0,"function"==typeof n.select&&(o=n.select(t)),o||X.hasClass(s.container,"se-inline-component")||this._setComponentLineBreaker(s.container||s.cover||t),this.currentTarget=t,this.currentPlugin=n,this.currentPluginName=e,this.currentInfo=s,Lt.set("__dragInst",this);const l=Lt.get("__overInfo");if(mi.setTimeout((()=>{Lt.set("__overInfo",l===fi&&void 0),l!==fi&&this.__addGlobalEvent(),s.isFile||this.__addNotFileGlobalEvent()}),0),X.addClass(s.container,"se-component-selected"),l!==fi){if(X.setDisabled(this.editor._controllerOnDisabledButtons,!0),!this.isInline(s.container))return;const t=s.container;let e=null;t.previousSibling&&!X.isBreak(t.previousSibling)||(e=X.createTextNode(G.zeroWidthSpace),t.parentNode.insertBefore(e,t)),t.nextSibling&&!X.isBreak(t.nextSibling)||(e=X.createTextNode(G.zeroWidthSpace),t.parentNode.insertBefore(e,t.nextSibling))}else if(!X.hasClass(s.container,"se-input-component")){const t=this.editor.frameContext.get("wrapper").querySelector(".se-drag-handle");X.addClass(t,"se-drag-handle-full"),this.editor._visibleControllers(!1,!1);const e=s.caption?s.target:s.cover||s.container||s.target,{w:i,h:n,t:o,l}=this.offset.getSize(e);t.style.opacity=0,t.style.width=i+"px",t.style.height=n+"px",t.style.top=o+"px",t.style.left=l+"px",Lt.set("__dragHandler",t),Lt.set("__dragContainer",s.container),Lt.set("__dragCover",s.cover),t.style.display="block"}},deselect(){this.editor._antiBlur=!1,Lt.set("__overInfo",null),this._removeDragEvent(this),X.removeClass(this.currentInfo?.container,"se-component-selected|"),X.removeClass(this.currentInfo?.cover,"se-figure-over-selected");const{frameContext:t}=this.editor;t.get("lineBreaker_t").style.display=t.get("lineBreaker_b").style.display="none",this.currentPlugin&&"function"==typeof this.currentPlugin.deselect&&this.currentPlugin.deselect(this.currentTarget),this.isSelected=!1,this.currentPlugin=null,this.currentTarget=null,this.currentPluginName="",this.currentInfo=null,this.__removeGlobalEvent(),this.editor.__offControllers(),X.setDisabled(this.editor._controllerOnDisabledButtons,!1)},is(t){return!(!t||!/^FIGURE$/i.test(t.nodeName)&&!X.hasClass(t,"se-component")&&!this.editor._componentManager.find((e=>e(t))))},isInline(t){return!!t&&(/^FIGURE$/i.test(t.nodeName)&&(t=t.parentElement),!!X.hasClass(t,"se-inline-component")||!(!this.editor._componentManager.find((e=>e(t)))||!X.hasClass(t,"se-inline-component")))},isBasic(t){return this.is(t)&&!this.isInline(t)},__isFiles(t){const e=t.nodeName.toLowerCase();return this.editor._fileManager.regExp.test(e)&&(!this.editor._fileManager.tagAttrs[e]||this.editor._fileManager.tagAttrs[e]?.every((e=>t.hasAttribute(e))))},_setComponentLineBreaker(t){this.eventManager._lineBreakComp=null;const e=this.get(t);if(!e)return;const i=this.editor.frameContext,s=e.container,n=X.hasClass(s,"se-flex-component"),o=i.get("lineBreaker_t"),l=i.get("lineBreaker_b"),r=o.style,a=l.style,h=s.offsetWidth<t.offsetWidth?s:t,c="block"===this.editor._figureContainer?.style.display?this.editor._figureContainer:h,d=X.isListCell(s.parentNode);let u,p;const g=this.options.get("_rtl"),m=g?["right","left"]:["left","right"],{t:f,scrollX:_,scrollY:b}=this.offset.getSize(h);if(d?s.previousSibling:this.format.isLine(s.previousElementSibling))r.display="none";else{const t=j.get(mi.getComputedStyle(o).height,1);this.eventManager._lineBreakComp=s,u=f+b,p=c.offsetWidth/2/2,r.top=u-b-t/2+"px",r[m[0]]=(n?4:this.offset.get(c).left+p)+"px",r[m[1]]="",o.setAttribute("data-offset",b+","+_),r.display="block"}if(d?s.nextSibling:this.format.isLine(s.nextElementSibling))a.display="none";else{const t=mi.getComputedStyle(l),e=j.get(t.height,1),i=j.get(t.width,1);u||(this.eventManager._lineBreakComp=s,u=f+b,p=c.offsetWidth/2/2),a.top=u+c.offsetHeight-b-e/2+"px",a.right="",a.left=this.offset.get(c).left+(g?0:c.offsetWidth)-(n?0:p)-(n?i/2:i)+"px";const o="left";l.setAttribute("data-offset",b+","+o+","+_),a.display="block"}},__addGlobalEvent(){this.__removeGlobalEvent(),this._bindClose_copy=this.eventManager.addGlobalEvent("copy",this.__globalEvents.copy),this._bindClose_cut=this.eventManager.addGlobalEvent("cut",this.__globalEvents.cut),this._bindClose_keydown=this.eventManager.addGlobalEvent("keydown",this.__globalEvents.keydown)},__removeGlobalEvent(){this.__removeNotFileGlobalEvent(),this._bindClose_copy&&(this._bindClose_copy=this.eventManager.removeGlobalEvent(this._bindClose_copy)),this._bindClose_cut&&(this._bindClose_cut=this.eventManager.removeGlobalEvent(this._bindClose_cut)),this._bindClose_keydown&&(this._bindClose_keydown=this.eventManager.removeGlobalEvent(this._bindClose_keydown))},__addNotFileGlobalEvent(){this.__removeNotFileGlobalEvent(),this._bindClose_mousedown=this.eventManager.addGlobalEvent("mousedown",this.__globalEvents.mousedown,!0),this._bindClose_touchstart=this.eventManager.addGlobalEvent("touchstart",this.__globalEvents.mousedown,!0)},__removeNotFileGlobalEvent(){this._bindClose_mousedown&&(this._bindClose_mousedown=this.eventManager.removeGlobalEvent(this._bindClose_mousedown)),this._bindClose_touchstart&&(this._bindClose_touchstart=this.eventManager.removeGlobalEvent(this._bindClose_touchstart))},_removeDragEvent(){this.carrierWrapper.querySelector(".se-drag-cursor").style.left="-10000px",Lt.get("__dragHandler")&&(Lt.get("__dragHandler").style.display="none"),X.removeClass([Lt.get("__dragHandler"),Lt.get("__dragContainer")],"se-dragging"),X.removeClass([Lt.get("__dragCover"),Lt.get("__dragContainer")],"se-drag-over"),Lt.set("__figureInst",null),Lt.set("__dragInst",null),Lt.set("__dragHandler",null),Lt.set("__dragContainer",null),Lt.set("__dragCover",null),Lt.set("__dragMove",null),Lt.set("__overInfo",null)},constructor:vi};const Li=vi,Mi=function(t){Ht.call(this,t),this._listCamel=this.options.get("__listCommonStyle"),this._listKebab=q.camelToKebabCase(this.options.get("__listCommonStyle")),this._formatLineCheck=this.options.get("formatLine").reg,this._formatBrLineCheck=this.options.get("formatBrLine").reg,this._formatBlockCheck=this.options.get("formatBlock").reg,this._formatClosureBlockCheck=this.options.get("formatClosureBlock").reg,this._formatClosureBrLineCheck=this.options.get("formatClosureBrLine").reg,this._textStyleTagsCheck=new RegExp("^("+this.options.get("textStyleTags")+")$","i")};function Bi(t){const e=t.parentNode;let i,s,n,o,l,r=e,a=r.parentNode;for(;X.isListCell(a);){for(o=X.getPositionIndex(t),i=a.nextElementSibling,s=a.parentNode,n=r;n;){if(r=r.nextSibling,X.isList(n)){for(l=n.childNodes;l[o];)s.insertBefore(l[o],i);0===l.length&&X.removeItem(n)}else s.appendChild(n);n=r}r=s,a=s.parentNode}return 0===e.children.length&&X.removeItem(e),s}function Ai(t,e,i){const s=[];for(let n,o,l=0,r=t.length;l<r;l++)n=t[l],X.isListCell(n)?(e<0||n.previousElementSibling)&&s.push(n):(o=/\d+/.test(n.style[i])?j.get(n.style[i],0):0,o+=e,X.setStyle(n,i,o<=0?"":o+"px"));return s}function Vi(t){const e=t.parentNode;if(!t||3===t.nodeType||!e)return;const i=t.childNodes;for(;i[0];)e.insertBefore(i[0],t);e.removeChild(t)}Mi.prototype={setLine(t){if(!this.isLine(t))throw new Error('[SUNEDITOR.format.setLine.fail] The "element" must satisfy "format.isLine()".');const e=this._lineWork(),i=e.lines,s=t.className,n=t.nodeName;let o=e.firstNode,l=e.lastNode;for(let e,r,a=0,h=i.length;a<h;a++)e=i[a],e.nodeName===n&&(e.className.match(/(\s|^)__se__format__[^\s]+/)||[""])[0].trim()===s||this.component.is(e)||(r=t.cloneNode(!1),X.copyFormatAttributes(r,e),r.innerHTML=e.innerHTML,e.parentNode.replaceChild(r,e)),0===a&&(o=r||e),a===h-1&&(l=r||e),r=null;this.selection.setRange(X.getNodeFromPath(e.firstPath,o),e.startOffset,X.getNodeFromPath(e.lastPath,l),e.endOffset),this.history.push(!1)},getLine(t,e){if(!t)return null;for(e||(e=function(){return!0});t;){if(X.isWysiwygFrame(t))return null;if(this.isBlock(t))return t.firstElementChild;if(this.isLine(t)&&e(t))return t;t=t.parentNode}return null},setBrLine(t){if(!this.isBrLine(t))throw new Error('[SUNEDITOR.format.setBrLine.fail] The "element" must satisfy "format.isBrLine()".');const e=this._lineWork().lines,i=e.length-1;let s=e[i].parentNode,n=t.cloneNode(!1);const o=n;for(let o,l,r,a,h,c,d=i,u=!0;d>=0;d--)if(o=e[d],o!==(e[d+1]?e[d+1].parentNode:null)){if(c=this.component.is(o),l=c?"":o.innerHTML.replace(/(?!>)\s+(?=<)|\n/g," "),r=X.getParentElement(o,(t=>t.parentNode===s)),(s!==o.parentNode||c)&&(this.isLine(s)?(s.parentNode.insertBefore(n,s.nextSibling),s=s.parentNode):(s.insertBefore(n,r?r.nextSibling:null),s=o.parentNode),a=n.nextSibling,a&&n.nodeName===a.nodeName&&X.isSameAttributes(n,a)&&(n.innerHTML+="<BR>"+a.innerHTML,X.removeItem(a)),n=t.cloneNode(!1),u=!0),h=n.innerHTML,n.innerHTML=(u||!l||!h||/<br>$/i.test(l)?l:l+"<BR>")+h,0===d){s.insertBefore(n,o),a=o.nextSibling,a&&n.nodeName===a.nodeName&&X.isSameAttributes(n,a)&&(n.innerHTML+="<BR>"+a.innerHTML,X.removeItem(a));const t=n.previousSibling;t&&n.nodeName===t.nodeName&&X.isSameAttributes(n,t)&&(t.innerHTML+="<BR>"+n.innerHTML,X.removeItem(n))}c||X.removeItem(o),l&&(u=!1)}this.selection.setRange(o,0,o,0),this.history.push(!1)},getBrLine(t,e){if(!t)return null;for(e||(e=function(){return!0});t;){if(X.isWysiwygFrame(t))return null;if(this.isBrLine(t)&&e(t))return t;t=t.parentNode}return null},addLine(t,e){if(!t||!t.parentNode)return null;const i=this.getLine(this.selection.getNode(),null);let s=null;if(!this.isBrLine(t)&&this.isBrLine(i||t.parentNode))s=X.createElement("BR");else{const t=e?"string"==typeof e?e:e.nodeName:!this.isLine(i)||this.isBlock(i)||this.isBrLine(i)?this.options.get("defaultLine"):i.nodeName;s=X.createElement(t,null,"<br>"),(e&&"string"!=typeof e||!e&&this.isLine(i))&&X.copyTagAttributes(s,e||i,["id"])}return X.isTableCell(t)?t.insertBefore(s,t.nextElementSibling):t.parentNode.insertBefore(s,t.nextElementSibling),s},getBlock(t,e){if(!t)return null;for(e||(e=function(){return!0});t;){if(X.isWysiwygFrame(t))return null;if(this.isBlock(t)&&!/^(THEAD|TBODY|TR)$/i.test(t.nodeName)&&e(t))return t;t=t.parentNode}return null},applyBlock(t){this.selection.getRangeAndAddLine(this.selection.getRange(),null);const e=this.getLinesAndComponents(!1);if(!e||0===e.length)return;t:for(let t,i,s,n,o,l,r=0,a=e.length;r<a;r++)if(t=e[r],X.isListCell(t)&&(i=t.lastElementChild,i&&X.isListCell(t.nextElementSibling)&&e.includes(t.nextElementSibling)&&(n=i.lastElementChild,e.includes(n)))){let t=null;for(;t=n.lastElementChild;)if(X.isList(t)){if(!e.includes(t.lastElementChild))continue t;n=t.lastElementChild}s=i.firstElementChild,o=e.indexOf(s),l=e.indexOf(n),e.splice(o,l-o+1),a=e.length}const i=e[e.length-1];let s,n,o;s=this.isBlock(i)||this.isLine(i)?i:this.getBlock(i,null)||this.getLine(i,null),X.isTableCell(s)?(n=null,o=s):(n=s.nextSibling,o=s.parentNode),t=t.cloneNode(!1);let l=X.getNodeDepth(s),r=null;const a=[],h=(t,e,i)=>{let s=null;if(t!==e&&!X.isTableElements(e)){if(e&&X.getNodeDepth(t)===X.getNodeDepth(e))return i;s=this.nodeTransform.removeAllParents(e,null,t)}return s?s.ec:i};for(let i,s,c,d,u,p,g,m=0,f=e.length;m<f;m++)if(i=e[m],s=i.parentNode,s&&!t.contains(s))if(c=X.getNodeDepth(i),X.isList(s)){if(null===r&&(p?(r=p,g=!0,p=null):r=s.cloneNode(!1)),a.push(i),u=e[m+1],m===f-1||u?.parentNode!==s){i.contains(u?.parentNode)&&(p=u.parentNode.cloneNode(!1));let e,m=s.parentNode;for(;X.isList(m);)e=X.createElement(m.nodeName),e.appendChild(r),r=e,m=m.parentNode;const f=this.removeBlock(s,a,null,!0,!0);l>=c?(l=c,o=f.cc,n=h(o,s,f.ec),n&&(o=n.parentNode)):o===f.cc&&(n=f.ec),o!==f.cc&&(d=h(o,f.cc,d),n=void 0!==d?d:f.cc);for(let t=0,e=f.removeArray.length;t<e;t++)r.appendChild(f.removeArray[t]);g||t.appendChild(r),p&&f.removeArray[f.removeArray.length-1].appendChild(p),r=null,g=!1}}else l>=c&&(l=c,o=s,n=i.nextSibling),t.appendChild(i),o!==s&&(d=h(o,s),void 0!==d&&(n=d));if(this.editor.effectNode=null,this.nodeTransform.mergeSameTags(t,null,!1),this.nodeTransform.mergeNestedTags(t,(t=>X.isList(t))),n&&X.getNodeDepth(n)>0&&(X.isList(n.parentNode)||X.isList(n.parentNode.parentNode))){const e=X.getParentElement(n,(t=>this.isBlock(t)&&!X.isList(t))),i=this.nodeTransform.split(n,null,e?X.getNodeDepth(e)+1:0);i.parentNode.insertBefore(t,i)}else o.insertBefore(t,n),h(t,n);const c=X.getEdgeChildNodes(t.firstElementChild,t.lastElementChild);e.length>1?this.selection.setRange(c.sc,0,c.ec,c.ec.textContent.length):this.selection.setRange(c.ec,c.ec.textContent.length,c.ec,c.ec.textContent.length),this.history.push(!1)},removeBlock(t,e,i,s,n){const o=this.selection.getRange();let l=o.startOffset,r=o.endOffset,a=X.getListChildNodes(t,(e=>e.parentNode===t)),h=t.parentNode,c=null,d=null,u=t.cloneNode(!1);const p=[],g=X.isList(i);let m=!1,f=!1,_=!1;const b=(e,i,s,n)=>{if(X.isZeroWith(i)&&(i.innerHTML=G.zeroWidthSpace,l=r=1),3===i.nodeType)return e.insertBefore(i,s),i;const o=(_?i:n).childNodes;let a=i.cloneNode(!1),h=null,c=null;for(;o[0];)c=o[0],!this._notTextNode(c)||X.isBreak(c)||X.isListCell(a)?a.appendChild(c):(a.childNodes.length>0&&(h||(h=a),e.insertBefore(a,s),a=i.cloneNode(!1)),e.insertBefore(c,s),h||(h=c));if(a.childNodes.length>0){if(X.isListCell(e)&&X.isListCell(a)&&X.isList(s))if(g){for(h=s;s;)a.appendChild(s),s=s.nextSibling;e.parentNode.insertBefore(a,e.nextElementSibling)}else{const e=n.nextElementSibling,i=this._removeNestedList(n,!1);if(t!==i||e!==n.nextElementSibling){const e=a.childNodes;for(;e[0];)n.appendChild(e[0]);t=i,f=!0}}else e.insertBefore(a,s);h||(h=a)}return h};for(let n,o,l,r=0,v=a.length;r<v;r++)if(n=a[r],3!==n.nodeType||!X.isList(u))if(_=!1,s&&0===r&&(c=e&&e.length!==v&&e[0]!==n?u:t.previousSibling),e&&(o=e.indexOf(n)),e&&-1===o)u||(u=t.cloneNode(!1)),u.appendChild(n);else{if(e&&(l=e[o+1]),u&&u.children.length>0&&(h.insertBefore(u,t),u=null),!g&&X.isListCell(n))if(l&&X.getNodeDepth(n)!==X.getNodeDepth(l)&&(X.isListCell(h)||X.getArrayItem(n.children,X.isList,!1))){const e=n.nextElementSibling,i=this._removeNestedList(n,!1);t===i&&e===n.nextElementSibling||(t=i,f=!0)}else{const e=n;n=X.createElement(s?e.nodeName:X.isList(t.parentNode)||X.isListCell(t.parentNode)?"LI":X.isTableCell(t.parentNode)?"DIV":this.options.get("defaultLine"));const i=X.isListCell(n),o=e.childNodes;for(;o[0]&&(!X.isList(o[0])||i);)n.appendChild(o[0]);X.copyFormatAttributes(n,e),_=!0}else n=n.cloneNode(!1);if(!f&&(s?(p.push(n),X.removeItem(a[r])):(i?(m||(h.insertBefore(i,t),m=!0),n=b(i,n,null,a[r])):n=b(h,n,t,a[r]),f||(e?(d=n,c||(c=n)):c||(c=d=n))),f)){f=_=!1,a=X.getListChildNodes(t,(e=>e.parentNode===t)),u=t.cloneNode(!1),h=t.parentNode,r=-1,v=a.length;continue}}const v=t.parentNode;let y=t.nextSibling;u?.children.length>0&&v.insertBefore(u,y),i?c=i.previousSibling:c||(c=t.previousSibling),y=t.nextSibling!==u?t.nextSibling:u?u.nextSibling:null,0===t.children.length||0===t.textContent.length?X.removeItem(t):this.nodeTransform.removeEmptyNode(t,null,!1);let w=null;if(s)w={cc:v,sc:c,so:l,ec:y,eo:r,removeArray:p};else{c||(c=d),d||(d=c);const t=X.getEdgeChildNodes(c,d.parentNode?c:d);w={cc:(t.sc||t.ec).parentNode,sc:t.sc,so:l,ec:t.ec,eo:r,removeArray:null}}if(this.editor.effectNode=null,n)return w;!s&&w&&(e?this.selection.setRange(w.sc,l,w.ec,r):this.selection.setRange(w.sc,0,w.sc,0)),this.history.push(!1)},applyList(t,e,i){const s=(t.split(":")[0]||"ol").toUpperCase(),n=t.split(":")[1]||"";let o=this.selection.getRange(),l=e||this.getLinesAndComponents(!1);if(0===l.length){if(e)return;if(o=this.selection.getRangeAndAddLine(o,null),l=this.getLinesAndComponents(!1),0===l.length)return}X.sortNodeByDepth(l,!0);const r=l[0],a=l[l.length-1];let h=!X.isListCell(r)&&!this.component.is(r)||r.previousElementSibling?r.previousElementSibling:r.parentNode.previousElementSibling,c=!X.isListCell(a)&&!this.component.is(a)||a.nextElementSibling?a.nextElementSibling:a.parentNode.nextElementSibling;const d=o.collapsed,u={sc:o.startContainer,so:o.startContainer===o.endContainer&&X.isZeroWith(o.startContainer)&&0===o.startOffset&&1===o.endOffset?o.endOffset:o.startOffset,ec:o.endContainer,eo:o.endOffset};let p=null,g=!0;for(let t=0,e=l.length;t<e;t++)if(!X.isList(this.getBlock(l[t],(e=>this.getBlock(e)&&e!==l[t])))){g=!1;break}if(!g||h&&r.tagName===h.tagName&&s===h.tagName.toUpperCase()||c&&a.tagName===c.tagName&&s===c.tagName.toUpperCase()){const t=h?h.parentNode:h,e=c?c.parentNode:c;h=t&&!X.isWysiwygFrame(t)&&t.nodeName===s?t:h,c=e&&!X.isWysiwygFrame(e)&&e.nodeName===s?e:c;const i=h?.tagName===s,o=c?.tagName===s;let r=i?h:X.createElement(s,{style:"list-style-type: "+n}),a=null,d=null;const u=t=>!this.component.is(t)&&!X.isList(t);for(let t,e,o,h,c,p,g,m,f,_=0,b=l.length;_<b;_++)if(e=l[_],0!==e.childNodes.length||this._isIgnoreNodeChange(e)){if(h=l[_+1],c=e.parentNode,p=h?h.parentNode:null,o=X.isListCell(e),f=this.isBlock(c)?c:null,g=o&&!X.isWysiwygFrame(c)?c.parentNode:c,m=o&&!X.isWysiwygFrame(c)?!h||X.isListCell(g)?c:c.nextSibling:e.nextSibling,t=X.createElement("LI"),X.copyFormatAttributes(t,e),this.component.is(e)){const i=/^HR$/i.test(e.nodeName);i||(t.innerHTML="<br>"),t.innerHTML+=e.outerHTML,i&&(t.innerHTML+="<br>")}else{const i=e.childNodes;for(;i[0];)t.appendChild(i[0])}r.appendChild(t),h&&g===p&&!this.isBlock(m)||(a||(a=r),i&&h&&g===p||h&&X.isList(p)&&p===c||r.parentNode!==g&&g.insertBefore(r,m)),X.removeItem(e),i&&null===d&&(d=r.children.length-1),h&&(this.getBlock(p,u)!==this.getBlock(c,u)||X.isList(p)&&X.isList(c)&&X.getNodeDepth(p)!==X.getNodeDepth(c))&&(r=X.createElement(s,{style:"list-style-type: "+n})),0===f?.children.length&&X.removeItem(f)}else X.removeItem(e);d&&(a=a.children[d]),o&&(r.innerHTML+=c.innerHTML,X.removeItem(c))}else{if(i)for(let t=0,e=l.length;t<e;t++)for(let i=t-1;i>=0;i--)if(l[i].contains(l[t])){l.splice(t,1),t--,e--;break}const t=this.getBlock(r),e=t?.tagName===s;let o,a;const h=t=>!this.component.is(t);e||(a=X.createElement(s,{style:"list-style-type: "+n}));for(let t,r,c=0,d=l.length;c<d;c++)r=this.getBlock(l[c],h),r&&X.isList(r)&&(t?t!==r?(i&&X.isListCell(r.parentNode)?this._detachNested(o.f):p=this.removeBlock(o.f[0].parentNode,o.f,a,!1,!0),r=l[c].parentNode,e||(a=X.createElement(s,{style:"list-style-type: "+n})),t=r,o={r:t,f:[X.getParentElement(l[c],"LI")]}):o.f.push(X.getParentElement(l[c],"LI")):(t=r,o={r:t,f:[X.getParentElement(l[c],"LI")]}),c===d-1&&(i&&X.isListCell(r.parentNode)?this._detachNested(o.f):p=this.removeBlock(o.f[0].parentNode,o.f,a,!1,!0)))}return this.editor.effectNode=null,g&&d?p:u},removeList(t,e){let i={},s=!1,n=!1,o=null,l=null;const r=t=>!this.component.is(t);for(let a,h,c,d,u=0,p=t.length;u<p;u++){if(c=u===p-1,h=this.getBlock(t[u],r),d=X.isList(h),!a&&d)a=h,i={r:a,f:[X.getParentElement(t[u],"LI")]},0===u&&(s=!0);else if(a&&d)if(a!==h){const r=this.detachRangeFormatElement(i.f[0].parentNode,i.f,null,e,!0);h=t[u].parentNode,s&&(o=r.sc,s=!1),c&&(l=r.ec),d?(a=h,i={r:a,f:[X.getParentElement(t[u],"LI")]},c&&(n=!0)):a=null}else i.f.push(X.getParentElement(t[u],"LI")),c&&(n=!0);if(c&&X.isList(a)){const t=this.detachRangeFormatElement(i.f[0].parentNode,i.f,null,e,!0);(n||1===p)&&(l=t.ec),s&&(o=t.sc||l)}}return{sc:o,ec:l}},indent(){const t=this.selection.getRange(),e=t.startContainer,i=t.endContainer,s=t.startOffset,n=t.endOffset,o=Ai(this.getLines(null),this.status.indentSize,this.options.get("_rtl")?"marginRight":"marginLeft");o.length>0&&this._applyNestedList(o,!0),this.editor.effectNode=null,this.selection.setRange(e,s,i,n),this.history.push(!1)},outdent(){const t=this.selection.getRange(),e=t.startContainer,i=t.endContainer,s=t.startOffset,n=t.endOffset,o=Ai(this.getLines(null),-1*this.status.indentSize,this.options.get("_rtl")?"marginRight":"marginLeft");o.length>0&&this._applyNestedList(o,!1),this.editor.effectNode=null,this.selection.setRange(e,s,i,n),this.history.push(!1)},applyTextStyle(t,e,i,s){if(X.getParentElement(this.selection.getNode(),X.isNonEditable))return;this.selection._resetRangeToTextNode();let n=this.selection.getRangeAndAddLine(this.selection.getRange(),null);e=e?.length>0&&e,i=i?.length>0&&i;const o=!t,l=o&&!i&&!e;let r=n.startContainer,a=n.startOffset,h=n.endContainer,c=n.endOffset;if(l&&n.collapsed&&this.isLine(r.parentNode)&&this.isLine(h.parentNode)||r===h&&1===r.nodeType&&X.isNonEditable(r)){const t=r.parentNode;return void(!X.isListCell(t)||q.getValues(t.style).some((t=>this._listKebab.includes(t))))}if(n.collapsed&&!l&&1===r.nodeType&&!X.isBreak(r)&&!this.component.is(r)){let t=null;const e=r.childNodes[a];e&&(t=e.nextSibling?X.isBreak(e)?e:e.nextSibling:null);const i=X.createTextNode(G.zeroWidthSpace);r.insertBefore(i,t),this.selection.setRange(i,1,i,1),n=this.selection.getRange(),r=n.startContainer,a=n.startOffset,h=n.endContainer,c=n.endOffset}this.isLine(r)&&(r=r.childNodes[a]||r.firstChild,a=0),this.isLine(h)&&(h=h.childNodes[c]||h.lastChild,c=h.textContent.length),o&&(t=X.createElement("DIV"));const d=RegExp,u=t.nodeName;if(!l&&r===h&&!i&&t){let e=r,i=0;const s=[],n=t.style;for(let t=0,e=n.length;t<e;t++)s.push(n[t]);const l=t.classList;for(let t=0,e=l.length;t<e;t++)s.push("."+l[t]);if(s.length>0){for(;!this.isLine(e)&&!X.isWysiwygFrame(e);){for(let n=0;n<s.length;n++)if(1===e.nodeType){const l=s[n],r=!!/^\./.test(l)&&new d("\\s*"+l.replace(/^\./,"")+"(\\s+|$)","ig"),a=o?!!e.style[l]:!!e.style[l]&&!!t.style[l]&&e.style[l]===t.style[l],h=!1!==r&&(o?!!e.className.match(r):!!e.className.match(r)&&!!t.className.match(r));(a||h)&&i++}e=e.parentNode}if(i>=s.length)return}}let p,g={},m={},f="",_="",b=null;if(e){for(let t,i=0,s=e.length;i<s;i++)t=e[i],/^\./.test(t)?_+=(_?"|":"\\s*(?:")+t.replace(/^\./,""):f+=(f?"|":"(?:;|^|\\s)(?:")+t;f&&(f+=")\\s*:[^;]*\\s*(?:;|$)",f=new d(f,"ig")),_&&(_+=")(?=\\s+|$)",_=new d(_,"ig"))}if(i){b="^(?:"+i[0];for(let t=1;t<i.length;t++)b+="|"+i[t];b+=")$",b=new d(b,"i")}const v=Boolean,y={v:!1},w=function(t){const e=t.cloneNode(!1);if(3===e.nodeType||X.isBreak(e))return e;if(l)return null;const i=!b&&o||b?.test(e.nodeName);if(i&&!s)return y.v=!0,null;const n=e.style.cssText;let r="";f&&n.length>0&&(r=n.replace(f,"").trim(),r!==n&&(y.v=!0));const a=e.className;let h="";return _&&a.length>0&&(h=a.replace(_,"").trim(),h!==a&&(y.v=!0)),(!o||!_&&a||!f&&n||r||h||!i)&&(r||h||e.nodeName!==u||v(f)!==v(n)||v(_)!==v(a))?(f&&n.length>0&&(e.style.cssText=r),e.style.cssText||e.removeAttribute("style"),_&&a.length>0&&(e.className=h.trim()),e.className.trim()||e.removeAttribute("class"),e.style.cssText||e.className||e.nodeName!==u&&!i?e:(y.v=!0,null)):(y.v=!0,null)},C=this.getLines(null);n=this.selection.getRange(),r=n.startContainer,a=n.startOffset,h=n.endContainer,c=n.endOffset,this.getLine(r,null)||(r=X.getEdgeChild(C[0],(function(t){return 3===t.nodeType}),!1),a=0),this.getLine(h,null)||(h=X.getEdgeChild(C[C.length-1],(function(t){return 3===t.nodeType}),!1),c=h.textContent.length);const x=this.getLine(r,null)===this.getLine(h,null),S=C.length-(x?0:1);p=t.cloneNode(!1);const E=l||o&&function(t,e){for(let i=0,s=e.length;i<s;i++)if(t._isNonSplitNode(e[i])||t._sn_isSizeNode(e[i]))return!0;return!1}(this,i),T=o||this._sn_isSizeNode(p),k=this._sn_getMaintainedNode.bind(this,E,T),N=this._sn_isMaintainedNode.bind(this,E,T);if(x){this._sn_resetCommonListCell(C[0],e)&&(n=this.selection.setRange(r,a,h,c));const t=this._setNode_oneLine(C[0],p,w,r,a,h,c,l,o,n.collapsed,y,k,N);g.container=t.startContainer,g.offset=t.startOffset,m.container=t.endContainer,m.offset=t.endOffset,g.container===m.container&&X.isZeroWith(g.container)&&(g.offset=m.offset=1),this._sn_setCommonListStyle(t.ancestor,null)}else{let i=!1;S>0&&this._sn_resetCommonListCell(C[S],e)&&(i=!0),this._sn_resetCommonListCell(C[0],e)&&(i=!0),i&&this.selection.setRange(r,a,h,c),S>0&&(p=t.cloneNode(!1),m=this._setNode_endLine(C[S],p,w,h,c,l,o,y,k,N));for(let i,s=S-1;s>0;s--)this._sn_resetCommonListCell(C[s],e),p=t.cloneNode(!1),i=this._setNode_middleLine(C[s],p,w,l,o,y,m.container),i.endContainer&&i.ancestor.contains(i.endContainer)&&(m.ancestor=null,m.container=i.endContainer),this._sn_setCommonListStyle(i.ancestor,null);p=t.cloneNode(!1),g=this._setNode_startLine(C[0],p,w,r,a,l,o,y,k,N,m.container),g.endContainer&&(m.ancestor=null,m.container=g.endContainer),S<=0?m=g:m.container||(m.ancestor=null,m.container=g.container,m.offset=g.container.textContent.length),this._sn_setCommonListStyle(g.ancestor,null),this._sn_setCommonListStyle(m.ancestor||this.getLine(m.container),null)}this.editor._offCurrentController(),this.selection.setRange(g.container,g.offset,m.container,m.offset),this.history.push(!1)},removeTextStyle(){this.applyTextStyle(null,null,null,null)},isEdgeLine(t,e,i){if(!X.isEdgePoint(t,e,i))return!1;const s=[];for(i="front"===i?"previousSibling":"nextSibling";t&&!this.isLine(t)&&!X.isWysiwygFrame(t);){if(t[i]&&(!X.isBreak(t[i])||t[i][i]))return null;1===t.nodeType&&s.push(t.cloneNode(!1)),t=t.parentNode}return s},isTextStyleNode(t){return"string"==typeof t?this._textStyleTagsCheck.test(t):t&&1===t.nodeType&&this._textStyleTagsCheck.test(t.nodeName)},isLine(t){return"string"==typeof t?this._formatLineCheck.test(t):t&&1===t.nodeType&&(this._formatLineCheck.test(t.nodeName)||X.hasClass(t,"__se__format__line_.+|__se__format__br_line_.+"))&&!this._nonFormat(t)},isLineOnly(t){return this._formatLineCheck.test(t)&&!this._formatBlockCheck.test(t)},isBrLine(t){return"string"==typeof t?this._formatBrLineCheck.test(t):t&&1===t.nodeType&&(this._formatBrLineCheck.test(t.nodeName)||X.hasClass(t,"__se__format__br_line_.+"))&&!this._nonFormat(t)},isBlock(t){return"string"==typeof t?this._formatBlockCheck.test(t):t&&1===t.nodeType&&(this._formatBlockCheck.test(t.nodeName)||X.hasClass(t,"__se__format__block_.+"))&&!this._nonFormat(t)},isClosureBlock(t){return"string"==typeof t?this._formatClosureBlockCheck.test(t):t&&1===t.nodeType&&(this._formatClosureBlockCheck.test(t.nodeName)||X.hasClass(t,"__se__format__block_closure_.+"))&&!this._nonFormat(t)},isClosureBrLine(t){return"string"==typeof t?this._formatClosureBrLineCheck.test(t):t&&1===t.nodeType&&(this._formatClosureBrLineCheck.test(t.nodeName)||X.hasClass(t,"__se__format__br_line__closure_.+"))&&!this._nonFormat(t)},getLines(t){if(!this.selection._resetRangeToTextNode())return[];let e=this.selection.getRange();if(X.isWysiwygFrame(e.startContainer)){const t=this.editor.frameContext.get("wysiwyg").children;if(0===t.length)return[];this.selection.setRange(t[0],0,t[t.length-1],t[t.length-1].textContent.trim().length),e=this.selection.getRange()}const i=e.startContainer,s=e.endContainer,n=e.commonAncestorContainer,o=X.getListChildren(n,(e=>t?t(e):this.isLine(e)));if(X.isWysiwygFrame(n)||this.isBlock(n)||o.unshift(this.getLine(n,null)),i===s||1===o.length)return o;const l=this.getLine(i,null),r=this.getLine(s,null);let a=null,h=null;const c=function(t){return!X.isTableElements(t)||/^TABLE$/i.test(t.nodeName)};let d=this.getBlock(l,c),u=this.getBlock(r,c);X.isTableElements(d)&&X.isListCell(d.parentNode)&&(d=d.parentNode),X.isTableElements(u)&&X.isListCell(u.parentNode)&&(u=u.parentNode);const p=d===u;for(let t,e=0,i=o.length;e<i;e++)if(t=o[e],l===t||!p&&t===d)a=e;else if(r===t||!p&&t===u){h=e;break}return null===a&&(a=0),null===h&&(h=o.length-1),o.slice(a,h+1)},getLinesAndComponents(t){const e=this.selection.getRange().commonAncestorContainer,i=X.getParentElement(e,this.component.is.bind(this.component)),s=X.isTableElements(e)?this.getLines(null):this.getLines((t=>{const e=X.getParentElement(t,this.component.is.bind(this.component));return this.isLine(t)&&(!e||e===i)||this.component.is(t)&&!this.getLine(t)}));if(t)for(let t=0,e=s.length;t<e;t++)for(let i=t-1;i>=0;i--)if(s[i].contains(s[t])){s.splice(t,1),t--,e--;break}return s},_isExcludeSelectionElement(t){return!/FIGCAPTION/i.test(t.nodeName)&&(this.component.is(t)||/FIGURE/i.test(t.nodeName))},_nonFormat(t){return X.isExcludeFormat(t)||this.component.is(t)||X.isWysiwygFrame(t)},_isNonSplitNode:t=>t&&3!==t.nodeType&&/^(a|label|code|summary)$/i.test("string"==typeof t?t:t.nodeName),_notTextNode(t){return t&&3!==t.nodeType&&(this.component.is(t)||/^(br|input|select|canvas|img|iframe|audio|video)$/i.test("string"==typeof t?t:t.nodeName))},_isIgnoreNodeChange(t){return t&&3!==t.nodeType&&(X.isNonEditable(t)||!this.isTextStyleNode(t))},_lineWork(){let t=this.selection.getRange(),e=this.getLinesAndComponents(!1);if(0===e.length&&(t=this.selection.getRangeAndAddLine(t,null),e=this.getLinesAndComponents(!1),0===e.length))return;const i=t.startOffset,s=t.endOffset;let n=e[0],o=e[e.length-1];const l=X.getNodePath(t.startContainer,n,null,null),r=X.getNodePath(t.endContainer,o,null,null),a=this.removeList(e,!1);return a.sc&&(n=a.sc),a.ec&&(o=a.ec),this.selection.setRange(X.getNodeFromPath(l,n),i,X.getNodeFromPath(r,o),s),{lines:this.getLinesAndComponents(!1),firstNode:n,lastNode:o,firstPath:l,lastPath:r,startOffset:i,endOffset:s}},_attachNested(t,e,i,s,n){let o=!1;if(e.tagName===i?.tagName){const t=e.children;for(;t[0];)i.appendChild(t[0]);e=i,o=!0}if(e.tagName===s?.tagName){const t=s.children;for(;t[0];)e.appendChild(t[0]);const i=s.nextElementSibling;s.parentNode.removeChild(s),s=i}if(!o){X.isListCell(i)&&(t=i,s=null),t.insertBefore(e,s),n.s||(n.s=X.getNodePath(e.firstElementChild.firstChild,t,null),n.sl=t);const o=t.contains(n.sl)?X.getNodePath(n.sl,t):null;n.e=X.getNodePath(e.lastElementChild.firstChild,t,null),n.el=t,this.nodeTransform.mergeSameTags(t,[n.s,n.e,o],!1),this.nodeTransform.mergeNestedTags(t),o&&(n.sl=X.getNodeFromPath(o,t))}return e},_detachNested(t){const e=t[0],i=t[t.length-1],s=i.nextElementSibling,n=e.parentNode,o=n.parentNode.nextElementSibling,l=n.parentNode.parentNode;for(let e=0,i=t.length;e<i;e++)l.insertBefore(t[e],o);if(s&&n.children.length>0){const t=n.cloneNode(!1),e=n.childNodes,o=X.getPositionIndex(s);for(;e[o];)t.appendChild(e[o]);i.appendChild(t)}0===n.children.length&&X.removeItem(n),this.nodeTransform.mergeSameTags(l);const r=X.getEdgeChildNodes(e,i);return{cc:e.parentNode,sc:r.sc,ec:r.ec}},_applyNestedList(t,e){const i=(t=t||this.getLines().filter((function(t){return X.isListCell(t)}))).length;if(0===i||!e&&!X.isListCell(t[0].previousElementSibling)&&!X.isListCell(t[i-1].nextElementSibling))return{sc:t[0],so:0,ec:t[i-1],eo:1};let s=t[0].parentNode,n=t[i-1],o=null;if(e){if(s!==n.parentNode&&X.isList(n.parentNode.parentNode)&&n.nextElementSibling)for(n=n.nextElementSibling;n;)t.push(n),n=n.nextElementSibling;o=this.applyList(s.nodeName+":"+s.style.listStyleType,t,!0)}else{let e=X.createElement(s.nodeName),l=t[0].previousElementSibling,r=n.nextElementSibling;const a={s:null,e:null,sl:s,el:s};for(let n,o=0,h=i;o<h;o++)n=t[o],n.parentNode!==s&&(this._attachNested(s,e,l,r,a),s=n.parentNode,e=X.createElement(s.nodeName)),l=n.previousElementSibling,r=n.nextElementSibling,e.appendChild(n);this._attachNested(s,e,l,r,a);const h=X.getNodeFromPath(a.s,a.sl),c=X.getNodeFromPath(a.e,a.el);o={sc:h,so:0,ec:c,eo:c.textContent.length}}return o},_removeNestedList(t,e){const i=Bi(t);let s,n,o;if(i){s=i.cloneNode(!1),n=i.childNodes;const e=X.getPositionIndex(t);for(;n[e];)s.appendChild(n[e])}else s=t;if(e)o=X.getListChildren(s,(t=>X.isListCell(t)&&!t.previousElementSibling));else{const e=X.getNodeDepth(t)+2;o=X.getListChildren(t,(t=>X.isListCell(t)&&!t.previousElementSibling&&X.getNodeDepth(t)===e))}for(let t=0,e=o.length;t<e;t++)Bi(o[t]);return i&&(i.parentNode.insertBefore(s,i.nextSibling),0===n?.length&&X.removeItem(i)),s===t?s.parentNode:s},_setNode_oneLine(t,e,i,s,n,o,l,r,a,h,c,d,u){let p=s.parentNode;for(;!(p.nextSibling||p.previousSibling||this.isLine(p.parentNode)||X.isWysiwygFrame(p.parentNode))&&p.nodeName!==e.nodeName;)p=p.parentNode;if(!a&&p===o.parentNode&&p.nodeName===e.nodeName&&X.isZeroWith(s.textContent.slice(0,n))&&X.isZeroWith(o.textContent.slice(l))){const i=p.childNodes;let r=!1;for(let t,e,n,l,a=0,h=i.length;a<h;a++)if(t=i[a],l=!X.isZeroWith(t),t!==s)if(t!==o){if(!e&&l||e&&n&&l){r=!1;break}}else n=!0;else e=!0;if(r)return X.copyTagAttributes(p,e),{ancestor:t,startContainer:s,startOffset:n,endContainer:o,endOffset:l}}c.v=!1;const g=this,m=t,f=[e],_=t.cloneNode(!1),b=s===o;let v,y,w,C,x,S=s,E=n,T=o,k=l,N=!1,H=!1;const L=RegExp;function M(t){const e=new L("(?:;|^|\\s)(?:"+C+"null)\\s*:[^;]*\\s*(?:;|$)","ig");let i="";return e&&t.style.cssText.length>0&&(i=e.test(t.style.cssText)),!i}if(function t(s,n){const o=s.childNodes;for(let s,l=0,a=o.length;l<a;l++){const a=o[l];if(!a)continue;let c,p=n;if(!N&&a===S){let t=_;x=d(a);const o=X.createTextNode(1===S.nodeType?"":S.substringData(0,E)),l=X.createTextNode(1===S.nodeType?"":S.substringData(E,b&&k>=E?k-E:S.data.length-E));if(x){const e=d(n);if(e.parentNode!==t){let i=e,s=null;for(;i.parentNode!==t;){for(n=s=i.parentNode.cloneNode(!1);i.childNodes[0];)s.appendChild(i.childNodes[0]);i.appendChild(s),i=i.parentNode}i.parentNode.appendChild(e)}x=x.cloneNode(!1)}X.isZeroWith(o)||n.appendChild(o);const r=d(n);for(r&&(x=r),x&&(t=x),y=a,v=[],C="";y!==t&&y!==m&&null!==y;)s=u(y)?null:i(y),s&&1===y.nodeType&&M(y)&&(v.push(s),C+=y.style.cssText.substr(0,y.style.cssText.indexOf(":"))+"|"),y=y.parentNode;const h=v.pop()||l;for(w=y=h;v.length>0;)y=v.pop(),w.appendChild(y),w=y;if(e.appendChild(h),t.appendChild(e),x&&!d(T)&&(e=e.cloneNode(!1),_.appendChild(e),f.push(e)),S=l,E=0,N=!0,y!==l&&y.appendChild(S),!b)continue}if(H||a!==T){if(N){if(1===a.nodeType&&!X.isBreak(a)){g._isIgnoreNodeChange(a)?(_.appendChild(a.cloneNode(!0)),h||(e=e.cloneNode(!1),_.appendChild(e),f.push(e))):t(a,a);continue}y=a,v=[],C="";const o=[];for(;null!==y.parentNode&&y!==m&&y!==e;)s=H?y.cloneNode(!1):i(y),1===y.nodeType&&!X.isBreak(a)&&s&&M(y)&&(u(y)?x||o.push(s):v.push(s),C+=y.style.cssText.substr(0,y.style.cssText.indexOf(":"))+"|"),y=y.parentNode;v=v.concat(o);const l=v.pop()||a;for(w=y=l;v.length>0;)y=v.pop(),w.appendChild(y),w=y;if(!u(e.parentNode)||u(l)||X.isZeroWith(e)||(e=e.cloneNode(!1),_.appendChild(e),f.push(e)),H||x||!u(l))l===a?n=H?_:e:H?(_.appendChild(l),n=y):(e.appendChild(l),n=y);else{e=e.cloneNode(!1);const t=l.childNodes;for(let i=0,s=t.length;i<s;i++)e.appendChild(t[i]);l.appendChild(e),_.appendChild(l),f.push(e),n=e.children.length>0?y:e}if(x&&3===a.nodeType)if(d(a)){const t=X.getParentElement(n,(t=>g._isNonSplitNode(t.parentNode)||t.parentNode===_));x.appendChild(t),e=t.cloneNode(!1),f.push(e),_.appendChild(e)}else x=null}c=a.cloneNode(!1),n.appendChild(c),1!==a.nodeType||X.isBreak(a)||(p=c),t(a,p)}else{x=d(a);const t=X.createTextNode(1===T.nodeType?"":T.substringData(k,T.length-k)),n=X.createTextNode(b||1===T.nodeType?"":T.substringData(0,k));if(x?x=x.cloneNode(!1):u(e.parentNode)&&!x&&(e=e.cloneNode(!1),_.appendChild(e),f.push(e)),!X.isZeroWith(t)){y=a,C="",v=[];const e=[];for(;y!==_&&y!==m&&null!==y;)1===y.nodeType&&M(y)&&(u(y)?e.push(y.cloneNode(!1)):v.push(y.cloneNode(!1)),C+=y.style.cssText.substr(0,y.style.cssText.indexOf(":"))+"|"),y=y.parentNode;for(v=v.concat(e),c=w=y=v.pop()||t;v.length>0;)y=v.pop(),w.appendChild(y),w=y;_.appendChild(c),y.textContent=t.data}if(x&&c){const t=d(c);t&&(x=t)}for(y=a,v=[],C="";y!==_&&y!==m&&null!==y;)s=u(y)?null:i(y),s&&1===y.nodeType&&M(y)&&(v.push(s),C+=y.style.cssText.substr(0,y.style.cssText.indexOf(":"))+"|"),y=y.parentNode;const o=v.pop()||n;for(w=y=o;v.length>0;)y=v.pop(),w.appendChild(y),w=y;x?((e=e.cloneNode(!1)).appendChild(o),x.insertBefore(e,x.firstChild),_.appendChild(x),f.push(e),x=null):e.appendChild(o),T=n,k=n.data.length,H=!0,!r&&h&&(e=n,n.textContent=G.zeroWidthSpace),y!==n&&y.appendChild(T)}}}(t,_),a&&!r&&!c.v)return{ancestor:t,startContainer:s,startOffset:n,endContainer:o,endOffset:l};if(r=r&&a)for(let t=0;t<f.length;t++){const e=f[t];let i,s,n;if(h)i=X.createTextNode(G.zeroWidthSpace),_.replaceChild(i,e);else{const t=e.childNodes;for(s=t[0];t[0];)n=t[0],_.insertBefore(n,e);X.removeItem(e)}0===t&&(h?S=T=i:(S=s,T=n))}else{if(a)for(let t=0;t<f.length;t++)Vi(f[t]);h&&(S=T=e)}this.nodeTransform.removeEmptyNode(_,e,!1),h&&(E=S.textContent.length,k=T.textContent.length);const B=r||0===T.textContent.length;X.isBreak(T)||0!==T.textContent.length||(X.removeItem(T),T=S),k=B?T.textContent.length:k;const A={s:0,e:0},V=X.getNodePath(S,_,A),I=!T.parentNode;I&&(T=S);const R={s:0,e:0},z=X.getNodePath(T,_,I||B?null:R);E+=A.s,k=h?E:I?S.textContent.length:B?k+A.s:k+R.s;const O=this.nodeTransform.mergeSameTags(_,[V,z],!0);return t.parentNode.replaceChild(_,t),S=X.getNodeFromPath(V,_),T=X.getNodeFromPath(z,_),{ancestor:_,startContainer:S,startOffset:E+O[0],endContainer:T,endOffset:k+O[1]}},_setNode_startLine(t,e,i,s,n,o,l,r,a,h,c){let d=s.parentNode;for(;!(d.nextSibling||d.previousSibling||this.isLine(d.parentNode)||X.isWysiwygFrame(d.parentNode))&&d.nodeName!==e.nodeName;)d=d.parentNode;if(!l&&d.nodeName===e.nodeName&&!this.isLine(d)&&!d.nextSibling&&X.isZeroWith(s.textContent.slice(0,n))){let i=!1,o=s.previousSibling;for(;o;){if(!X.isZeroWith(o)){i=!1;break}o=o.previousSibling}if(i)return X.copyTagAttributes(d,e),{ancestor:t,container:s,offset:n}}r.v=!1;const u=this,p=t,g=[e],m=t.cloneNode(!1);let f,_,b,v,y=s,w=n,C=!1;if(function t(s,n){const o=s.childNodes;for(let s,l,r=0,d=o.length;r<d;r++){const d=o[r];if(!d)continue;let x=n;if(C&&!X.isBreak(d)){if(1===d.nodeType){if(u._isIgnoreNodeChange(d)){if(e=e.cloneNode(!1),l=d.cloneNode(!0),m.appendChild(l),m.appendChild(e),g.push(e),c&&d.contains(c)){const t=X.getNodePath(c,d);c=X.getNodeFromPath(t,l)}}else t(d,d);continue}_=d,f=[];const o=[];for(;null!==_.parentNode&&_!==p&&_!==e;)s=i(_),1===_.nodeType&&s&&(h(_)?v||o.push(s):f.push(s)),_=_.parentNode;f=f.concat(o);const r=f.length>0,y=f.pop()||d;for(b=_=y;f.length>0;)_=f.pop(),b.appendChild(_),b=_;if(h(e.parentNode)&&!h(y)&&(e=e.cloneNode(!1),m.appendChild(e),g.push(e)),!v&&h(y)){e=e.cloneNode(!1);const t=y.childNodes;for(let i=0,s=t.length;i<s;i++)e.appendChild(t[i]);y.appendChild(e),m.appendChild(y),n=h(_)?e:_,g.push(e)}else r?(e.appendChild(y),n=_):n=e;if(v&&3===d.nodeType)if(a(d)){const t=X.getParentElement(n,(t=>u._isNonSplitNode(t.parentNode)||t.parentNode===m));v.appendChild(t),e=t.cloneNode(!1),g.push(e),m.appendChild(e)}else v=null}if(C||d!==y)s=C?i(d):d.cloneNode(!1),s&&(n.appendChild(s),1!==d.nodeType||X.isBreak(d)||(x=s)),t(d,x);else{let t=m;v=a(d);const o=X.createTextNode(1===y.nodeType?"":y.substringData(0,w)),l=X.createTextNode(1===y.nodeType?"":y.substringData(w,y.length-w));if(v){const e=a(n);if(e&&e.parentNode!==t){let i=e,s=null;for(;i.parentNode!==t;){for(n=s=i.parentNode.cloneNode(!1);i.childNodes[0];)s.appendChild(i.childNodes[0]);i.appendChild(s),i=i.parentNode}i.parentNode.appendChild(e)}v=v.cloneNode(!1)}X.isZeroWith(o)||n.appendChild(o);const r=a(n);for(r&&(v=r),v&&(t=v),_=n,f=[];_!==t&&null!==_;)s=i(_),1===_.nodeType&&s&&f.push(s),_=_.parentNode;const h=f.pop()||n;for(b=_=h;f.length>0;)_=f.pop(),b.appendChild(_),b=_;h!==n?(e.appendChild(h),n=_):n=e,X.isBreak(d)&&e.appendChild(d.cloneNode(!1)),t.appendChild(e),y=l,w=0,C=!0,n.appendChild(y)}}}(t,m),l&&!o&&!r.v)return{ancestor:t,container:s,offset:n,endContainer:c};if(o=o&&l)for(let t=0;t<g.length;t++){const e=g[t],i=e.childNodes,s=i[0];for(;i[0];)m.insertBefore(i[0],e);X.removeItem(e),0===t&&(y=s)}else if(l){e=e.firstChild;for(let t=0;t<g.length;t++)Vi(g[t])}if(o||0!==m.childNodes.length){this.nodeTransform.removeEmptyNode(m,e,!1),X.isZeroWith(m.textContent)&&(y=m.firstChild,w=0);const i={s:0,e:0},s=X.getNodePath(y,m,i);w+=i.s;const n=this.nodeTransform.mergeSameTags(m,[s],!0);t.parentNode.replaceChild(m,t),y=X.getNodeFromPath(s,m),w+=n[0]}else t.childNodes?y=t.childNodes[0]:(y=X.createTextNode(G.zeroWidthSpace),t.appendChild(y));return{ancestor:m,container:y,offset:w,endContainer:c}},_setNode_middleLine(t,e,i,s,n,o,l){if(!n){let i=null;l&&t.contains(l)&&(i=X.getNodePath(l,t));const s=t.cloneNode(!0),n=e.nodeName,o=e.style.cssText,r=e.className;let a=s.childNodes,h=0,c=a.length;for(let t;h<c&&(t=a[h],3!==t.nodeType);h++){if(t.nodeName!==n){if(!X.isBreak(t)&&this._isIgnoreNodeChange(t))continue;if(1===c){a=t.childNodes,c=a.length,h=-1;continue}break}t.style.cssText+=o,X.addClass(t,r)}if(c>0&&h===c)return t.innerHTML=s.innerHTML,{ancestor:t,endContainer:i?X.getNodeFromPath(i,t):null}}o.v=!1;const r=this,a=t.cloneNode(!1),h=[e];let c=!0;if(function t(s,n){const o=s.childNodes;for(let s,d,u=0,p=o.length;u<p;u++){const p=o[u];if(!p)continue;let g=n;if(X.isBreak(p)||!r._isIgnoreNodeChange(p))s=i(p),s&&(c=!1,n.appendChild(s),1===p.nodeType&&(g=s)),X.isBreak(p)||t(p,g);else if(e.childNodes.length>0&&(a.appendChild(e),e=e.cloneNode(!1)),d=p.cloneNode(!0),a.appendChild(d),a.appendChild(e),h.push(e),n=e,l&&p.contains(l)){const t=X.getNodePath(l,p);l=X.getNodeFromPath(t,d)}}}(t,e),c||n&&!s&&!o.v)return{ancestor:t,endContainer:l};if(a.appendChild(e),s&&n)for(let t=0;t<h.length;t++){const e=h[t],i=e.childNodes;for(;i[0];)a.insertBefore(i[0],e);X.removeItem(e)}else if(n){e=e.firstChild;for(let t=0;t<h.length;t++)Vi(h[t])}return this.nodeTransform.removeEmptyNode(a,e,!1),this.nodeTransform.mergeSameTags(a,null,!0),t.parentNode.replaceChild(a,t),{ancestor:a,endContainer:l}},_setNode_endLine(t,e,i,s,n,o,l,r,a,h){let c=s.parentNode;for(;!(c.nextSibling||c.previousSibling||this.isLine(c.parentNode)||X.isWysiwygFrame(c.parentNode))&&c.nodeName!==e.nodeName;)c=c.parentNode;if(!l&&c.nodeName===e.nodeName&&!this.isLine(c)&&!c.previousSibling&&X.isZeroWith(s.textContent.slice(n))){let i=!1,o=s.nextSibling;for(;o;){if(!X.isZeroWith(o)){i=!1;break}o=o.nextSibling}if(i)return X.copyTagAttributes(c,e),{ancestor:t,container:s,offset:n}}r.v=!1;const d=this,u=t,p=[e],g=t.cloneNode(!1);let m,f,_,b,v=s,y=n,w=!1;if(function t(s,n){const o=s.childNodes;for(let s,l=o.length-1;0<=l;l--){const r=o[l];if(!r)continue;let c=n;if(w&&!X.isBreak(r)){if(1===r.nodeType){if(d._isIgnoreNodeChange(r)){e=e.cloneNode(!1);const t=r.cloneNode(!0);g.insertBefore(t,n),g.insertBefore(e,t),p.push(e)}else t(r,r);continue}f=r,m=[];const o=[];for(;null!==f.parentNode&&f!==u&&f!==e;)s=i(f),s&&1===f.nodeType&&(h(f)?b||o.push(s):m.push(s)),f=f.parentNode;m=m.concat(o);const l=m.length>0,c=m.pop()||r;for(_=f=c;m.length>0;)f=m.pop(),_.appendChild(f),_=f;if(h(e.parentNode)&&!h(c)&&(e=e.cloneNode(!1),g.insertBefore(e,g.firstChild),p.push(e)),!b&&h(c)){e=e.cloneNode(!1);const t=c.childNodes;for(let i=0,s=t.length;i<s;i++)e.appendChild(t[i]);c.appendChild(e),g.insertBefore(c,g.firstChild),p.push(e),n=e.children.length>0?f:e}else l?(e.insertBefore(c,e.firstChild),n=f):n=e;if(b&&3===r.nodeType)if(a(r)){const t=X.getParentElement(n,(t=>d._isNonSplitNode(t.parentNode)||t.parentNode===g));b.appendChild(t),e=t.cloneNode(!1),p.push(e),g.insertBefore(e,g.firstChild)}else b=null}if(w||r!==v)s=w?i(r):r.cloneNode(!1),s&&(n.insertBefore(s,n.firstChild),1!==r.nodeType||X.isBreak(r)||(c=s)),t(r,c);else{b=a(r);const t=X.createTextNode(1===v.nodeType?"":v.substringData(y,v.length-y)),o=X.createTextNode(1===v.nodeType?"":v.substringData(0,y));if(b){b=b.cloneNode(!1);const t=a(n);if(t.parentNode!==g){let e=t,i=null;for(;e.parentNode!==g;){for(n=i=e.parentNode.cloneNode(!1);e.childNodes[0];)i.appendChild(e.childNodes[0]);e.appendChild(i),e=e.parentNode}e.parentNode.insertBefore(t,e.parentNode.firstChild)}b=b.cloneNode(!1)}else h(e.parentNode)&&!b&&(e=e.cloneNode(!1),g.appendChild(e),p.push(e));for(X.isZeroWith(t)||n.insertBefore(t,n.firstChild),f=n,m=[];f!==g&&null!==f;)s=h(f)?null:i(f),s&&1===f.nodeType&&m.push(s),f=f.parentNode;const l=m.pop()||n;for(_=f=l;m.length>0;)f=m.pop(),_.appendChild(f),_=f;l!==n?(e.insertBefore(l,e.firstChild),n=f):n=e,X.isBreak(r)&&e.appendChild(r.cloneNode(!1)),b?(b.insertBefore(e,b.firstChild),g.insertBefore(b,g.firstChild),b=null):g.insertBefore(e,g.firstChild),v=o,y=o.data.length,w=!0,n.insertBefore(v,n.firstChild)}}}(t,g),l&&!o&&!r.v)return{ancestor:t,container:s,offset:n};if(o=o&&l)for(let t=0;t<p.length;t++){const e=p[t],i=e.childNodes;let s=null;for(;i[0];)s=i[0],g.insertBefore(s,e);X.removeItem(e),t===p.length-1&&(v=s,y=s.textContent.length)}else if(l){e=e.firstChild;for(let t=0;t<p.length;t++)Vi(p[t])}if(o||0!==g.childNodes.length){if(!l&&0===e.textContent.length)return this.nodeTransform.removeEmptyNode(g,null,!1),{ancestor:null,container:null,offset:0};this.nodeTransform.removeEmptyNode(g,e,!1),X.isZeroWith(g.textContent)?(v=g.firstChild,y=v.textContent.length):X.isZeroWith(v)&&(v=e,y=1);const i={s:0,e:0},s=X.getNodePath(v,g,i);y+=i.s;const n=this.nodeTransform.mergeSameTags(g,[s],!0);t.parentNode.replaceChild(g,t),v=X.getNodeFromPath(s,g),y+=n[0]}else t.childNodes?v=t.childNodes[0]:(v=X.createTextNode(G.zeroWidthSpace),t.appendChild(v));return{ancestor:g,container:v,offset:1===v.nodeType&&1===y?v.childNodes.length:y}},_sn_isSizeNode(t){return t&&"string"!=typeof t&&3!==t.nodeType&&this.isTextStyleNode(t)&&t.style.fontSize},_sn_getMaintainedNode(t,e,i){return!i||t?null:X.getParentElement(i,this._isNonSplitNode)||(e?null:X.getParentElement(i,this._sn_isSizeNode.bind(this)))},_sn_isMaintainedNode(t,e,i){if(!i||t||1!==i.nodeType)return!1;const s=this._isNonSplitNode(i);return X.getParentElement(i,this._isNonSplitNode)?s:s||!e&&this._sn_isSizeNode(i)},_sn_setCommonListStyle(t,e){if(!X.isListCell(t))return;const i=X.getArrayItem((e||t).childNodes,(function(t){return!X.isBreak(t)}),!0);if(!(e=i[0])||i.length>1||1!==e.nodeType)return;const s=e.style,n=t.style,o=e.nodeName.toLowerCase();let l=!1;this.options.get("_defaultStyleTagMap")[o]===this.options.get("_defaultTagCommand").bold.toLowerCase()&&(n.fontWeight="bold"),this.options.get("_defaultStyleTagMap")[o]===this.options.get("_defaultTagCommand").italic.toLowerCase()&&(n.fontStyle="italic");const r=q.getValues(s);if(r.length>0)for(let t=0,e=this._listCamel.length;t<e;t++)r.includes(this._listKebab[t])&&(n[this._listCamel[t]]=s[this._listCamel[t]],s.removeProperty(this._listKebab[t]),l=!0);if(this._sn_setCommonListStyle(t,e),l&&!s.length){const t=e.childNodes,i=e.parentNode,s=e.nextSibling;for(;t.length>0;)i.insertBefore(t[0],s);X.removeItem(e)}},_sn_resetCommonListCell(t,e){if(!X.isListCell(t))return;e||(e=this._listKebab);const i=X.getArrayItem(t.childNodes,(function(t){return!X.isBreak(t)}),!0),s=t.style,n=[],o=[],l=q.getValues(s);for(let t=0,i=this._listKebab.length;t<i;t++)l.includes(this._listKebab[t])&&e.includes(this._listKebab[t])&&(n.push(this._listCamel[t]),o.push(this._listKebab[t]));if(!n.length)return;const r=X.createElement("SPAN");for(let t=0,e=n.length;t<e;t++)r.style[n[t]]=s[o[t]],s.removeProperty(o[t]);let a=r.cloneNode(!1),h=null,c=!1;for(let e,s,o=0,l=i.length;o<l;o++)e=i[o],this.options.get("_defaultStyleTagMap")[e.nodeName.toLowerCase()]||(s=q.getValues(e.style),0===s.length||n.some((function(t){return!s.includes(t)}))&&s.some((function(t){n.includes(t)}))?(h=e.nextSibling,a.appendChild(e)):a.childNodes.length>0&&(t.insertBefore(a,h),a=r.cloneNode(!1),h=null,c=!0));return a.childNodes.length>0&&(t.insertBefore(a,h),c=!0),s.length||t.removeAttribute("style"),c},constructor:Mi};const Ii=Mi,Ri=function(t){Ht.call(this,t);const e=this.options;this._isAllowedClassName=function(t){return this.test(t)?t:""}.bind(this.options.get("allowedClassName")),this._allowHTMLComment=null,this._disallowedStyleNodesRegExp=null,this._htmlCheckWhitelistRegExp=null,this._htmlCheckBlacklistRegExp=null,this._elementWhitelistRegExp=null,this._elementBlacklistRegExp=null,this._attributeWhitelist=null,this._attributeWhitelistRegExp=null,this._attributeBlacklist=null,this._attributeBlacklistRegExp=null,this._textStyleTags=e.get("_textStyleTags");const i=e.get("tagStyles"),s={};for(const t in i){const e=t.split("|");for(let n,o=0,l=e.length;o<l;o++)n=e[o],s[n]?s[n]+="|":s[n]="",s[n]+=i[t]}for(const t in s)s[t]=new RegExp(`\\s*[^-a-zA-Z](${s[t]})\\s*:[^;]+(?!;)*`,"gi");const n=new Map,o={...s,line:e.get("_lineStylesRegExp")};this._textStyleTags.forEach((t=>{o[t]=e.get("_textStylesRegExp")}));for(const t in o)n.set(new RegExp(`^(${t})$`),o[t]);this._cleanStyleTagKeyRegExp=new RegExp(`^(${Object.keys(o).join("|")})$`,"i"),this._cleanStyleRegExpMap=n,this.fontSizeUnitRegExp=new RegExp("\\d+("+this.options.get("fontSizeUnits").join("|")+")$","i");const l=e.get("_allowedExtraTag"),r=e.get("_disallowedExtraTag");this.__disallowedTagsRegExp=new RegExp(`<(${r})[^>]*>([\\s\\S]*?)<\\/\\1>|<(${r})[^>]*\\/?>`,"gi"),this.__disallowedTagNameRegExp=new RegExp(`^(${r})$`,"i"),this.__allowedTagNameRegExp=new RegExp(`^(${l})$`,"i");const a=Object.keys(e.get("_defaultStyleTagMap")),h=e.get("elementWhitelist")?e.get("elementWhitelist").split("|").filter((t=>/b|i|ins|s|strike/i.test(t))):[];for(let t=0;t<h.length;t++)a.splice(a.indexOf(h[t].toLowerCase()),1);this._disallowedStyleNodesRegExp=0===a.length?null:new RegExp("(<\\/?)("+a.join("|")+")\\b\\s*([^>^<]+)?\\s*(?=>)","gi");const c=e.get("__defaultAttributeWhitelist");this._allowHTMLComment=e.get("_editorElementWhitelist").includes("//")||"*"===e.get("_editorElementWhitelist"),this._htmlCheckWhitelistRegExp=new RegExp("^("+Oi(e.get("_editorElementWhitelist").replace("|//",""),"")+")$","i"),this._htmlCheckBlacklistRegExp=new RegExp("^("+(e.get("elementBlacklist")||"^")+")$","i"),this._elementWhitelistRegExp=Y.createElementWhitelist(Oi(e.get("_editorElementWhitelist").replace("|//","|\x3c!--|--\x3e"),"")),this._elementBlacklistRegExp=Y.createElementBlacklist(e.get("elementBlacklist").replace("|//","|\x3c!--|--\x3e"));const d='\\s*=\\s*(")[^"]*\\1',u=e.get("attributeWhitelist");let p={},g="";if(u)for(const t in u)/^on[a-z]+$/i.test(u[t])||("*"===t?g=Oi(u[t],c):p[t]=new RegExp("\\s(?:"+Oi(u[t],"")+")"+d,"ig"));this._attributeWhitelistRegExp=new RegExp("\\s(?:"+(g||c)+"|data-se-[^\\s]+)"+d,"ig"),this._attributeWhitelist=p;const m=e.get("attributeBlacklist");if(p={},g="",m)for(const t in m)"*"===t?g=Oi(m[t],""):p[t]=new RegExp("\\s(?:"+Oi(m[t],"")+")"+d,"ig");this._attributeBlacklistRegExp=new RegExp("\\s(?:"+(g||"^")+")"+d,"ig"),this._attributeBlacklist=p};function zi(t,e,i,s){if(/^<[a-z0-9]+:[a-z0-9]+/i.test(i))return i;let n=null;const o=s.match(/(?!<)[a-zA-Z0-9-]+/)[0].toLowerCase();if(t){const t=this._attributeBlacklist[o];i=i.replace(/\s(?:on[a-z]+)\s*=\s*(")[^"]*\1/gi,""),i=t?i.replace(t,""):i.replace(this._attributeBlacklistRegExp,"");const e=this._attributeWhitelist[o];n=e?i.match(e):i.match(this._attributeWhitelistRegExp)}if(!e)return i;if("a"===o){const t=i.match(/(?:(?:id|name)\s*=\s*(?:"|')[^"']*(?:"|'))/g);t&&(n||(n=[]),n.push(t[0]))}else n&&/style=/i.test(n.toString())||(this._textStyleTags.includes(o)?n=this._cleanStyle(i,n,o):this.format.isLine(o)?n=this._cleanStyle(i,n,"line"):this._cleanStyleTagKeyRegExp.test(o)&&(n=this._cleanStyle(i,n,o)));if(X.isMedia(o)||X.isFigure(o)){const t=i.match(/style\s*=\s*(?:"|')[^"']*(?:"|')/);n||(n=[]),t&&n.push(t[0])}if(n)for(let t,e=0,i=n.length;e<i;e++)t=/^(?:href|src)\s*=\s*('|"|\s)*javascript\s*:/i.test(n[e].trim())?"":n[e],s+=(/^\s/.test(t)?"":" ")+t;return s}function Oi(t,e){return t?"*"===t?"[a-z-]+":e?t+"|"+e:t:"^"}Ri.prototype={clean(t,e,i,s){const{tagFilter:n,formatFilter:o,classFilter:l,styleNodeFilter:r,attrFilter:a,styleFilter:h}=this.options.get("strictMode");let c="";t=this.compress(t),n&&(t=this._deleteDisallowedTags(t,this._elementWhitelistRegExp,this._elementBlacklistRegExp).replace(/<br\/?>$/i,"")),(a||h)&&(t=t.replace(/(<[a-zA-Z0-9-]+)[^>]*(?=>)/g,zi.bind(this,a,h)));const d=this._d.createRange().createContextualFragment(t,!0);if(n)try{this._consistencyCheckOfHTML(d,this._htmlCheckWhitelistRegExp,this._htmlCheckBlacklistRegExp,n,o,l)}catch(t){console.warn("[SUNEDITOR.html.clean.fail]",t.message)}if(this.editor._MELInfo.forEach(((t,e)=>{const i=d.querySelectorAll(e);for(let e=0,s=i.length;e<s;e++)t(i[e])})),o){let t=d.childNodes;e||(e=this._isFormatData(t)),e&&(t=this._editFormat(d).childNodes);for(let i,s=0,n=t.length;s<n;s++)i=t[s],this.__allowedTagNameRegExp.test(i.nodeName)?c+=i.outerHTML:c+=this._makeLine(i,e)}return c||(c=t),n&&(i&&(c=c.replace("string"==typeof i?Y.createElementWhitelist(i):i,"")),s&&(c=c.replace("string"==typeof s?Y.createElementBlacklist(s):s,""))),r&&(c=this._styleNodeConvertor(c)),c},insert(t,e,i,s){if(this.editor.frameContext.get("wysiwygFrame").contains(this.selection.get().focusNode)||this.editor.focus(),"string"==typeof t){s||(t=this.clean(t,!1,null,null));try{if(X.isListCell(this.format.getLine(this.selection.getNode(),null))){const e=this._d.createRange().createContextualFragment(t).childNodes;this._isFormatData(e)&&(t=this._convertListCell(e))}const s=this._d.createRange().createContextualFragment(t).childNodes;if(!i){const t="byte-html"===this.editor.frameOptions.get("charCounter_type")?"outerHTML":"textContent";let e="";for(let i=0,n=s.length;i<n;i++)e+=s[i][t];if(!this.char.check(e))return}let n,o,l,r,a;for(;n=s[0];)3===r?.nodeType&&1===o?.nodeType&&X.isBreak(n)?(r=n,X.removeItem(n)):(l=this.insertNode(n,o,!0),o=l.container||l,a||(a=l),r=n);3===r?.nodeType&&1===o?.nodeType&&(o=r);const h=3===o.nodeType?l.endOffset||o.textContent.length:o.childNodes.length;e?this.selection.setRange(a.container||a,a.startOffset||0,o,h):this.component.is(o)||this.selection.setRange(o,h,o,h)}catch(t){if(this.editor.frameContext.get("isReadOnly")||this.editor.frameContext.get("isDisabled"))return;throw Error("[SUNEDITOR.html.insert.error]",t.message)}}else if(this.component.is(t))this.component.insert(t,i,!1);else{let e=null;(this.format.isLine(t)||X.isMedia(t))&&(e=this.format.getLine(this.selection.getNode(),null)),this.insertNode(t,e,i)}this.editor.effectNode=null,this.editor.focus(),this.history.push(!1)},insertNode(t,e,i){let s=null;if(this.editor.frameContext.get("isReadOnly")||!i&&!this.char.check(t,null))return s;let n,o,l,r=this.selection.getRange(),a=X.isListCell(r.commonAncestorContainer)?r.commonAncestorContainer:this.format.getLine(this.selection.getNode(),null),h=X.isListCell(a)&&(X.isListCell(t)||X.isList(t)),c=null;const d=this.format.isBrLine(a),u=!d&&(this.format.isLine(t)||this.format.isBlock(t))||this.component.isBasic(t);if(h&&(l=e||X.isList(t)?a.lastChild:a.nextElementSibling,c=X.isList(t)?a:(l||a).parentNode),!e&&(u||this.component.isBasic(t)||X.isMedia(t))){const t=X.isEdgePoint(r.endContainer,r.endOffset,"end"),i=this.remove(),s=i.container,n=s===i.prevContainer&&r.collapsed?null:i.prevContainer;if(h&&n)if(c=3===n.nodeType?n.parentNode:n,c.contains(s)){let t=!0;for(l=s;l.parentNode&&l.parentNode!==c;)l=l.parentNode,t=!1;t&&s===n&&(l=l.nextSibling)}else l=null;else if(h&&X.isListCell(s)&&!a.parentElement)a=X.createElement("LI"),c.appendChild(a),s.appendChild(c),l=null;else if(3===s.nodeType||X.isBreak(s)||h){const n=X.getParentElement(s,(t=>this.format.isBlock(t)||X.isListCell(t)));if(e=this.nodeTransform.split(s,i.offset,n?X.getNodeDepth(n)+1:0))if(h){if(a.contains(s)){const i=X.isList(a.lastElementChild);let s=null;t||(s=a.cloneNode(!1),s.appendChild(e.textContent.trim()?e:X.createTextNode(G.zeroWidthSpace))),i&&(s||(s=a.cloneNode(!1),s.appendChild(X.createTextNode(G.zeroWidthSpace))),s.appendChild(a.lastElementChild)),s&&(a.parentNode.insertBefore(s,a.nextElementSibling),l=e=s)}}else e=e.previousSibling;else l=e=a}}r=e||u?this.selection.getRange():this.selection.getRangeAndAddLine(this.selection.getRange(),null);const p=r.commonAncestorContainer,g=r.startOffset,m=r.endOffset,f=r.startContainer===p&&this.format.isLine(p),_=f&&(p.childNodes[g]||p.childNodes[0])||r.startContainer,b=f&&(p.childNodes[m]||p.childNodes[p.childNodes.length-1])||r.endContainer;if(!h)if(e)n=e.parentNode,e=e.nextSibling,o=!0;else if(n=_,3===_.nodeType&&(n=_.parentNode),r.collapsed)if(3===p.nodeType)e=p.textContent.length>m?p.splitText(m):p.nextSibling;else if(X.isBreak(n))e=n,n=n.parentNode;else{const i=n.childNodes[g],s=3===i?.nodeType&&X.isZeroWith(i)&&X.isBreak(i.nextSibling)?i.nextSibling:i;s?!s.nextSibling&&X.isBreak(s)?(n.removeChild(s),e=null):e=X.isBreak(s)&&!X.isBreak(t)?s:s.nextSibling:e=null}else if(_===b){e=X.isEdgePoint(b,m)?b.nextSibling:b.splitText(m);let t=_;X.isEdgePoint(_,g)||(t=_.splitText(g)),n.removeChild(t),0===n.childNodes.length&&u&&(n.innerHTML="<br>")}else{const i=this.remove(),s=i.container,o=i.prevContainer;if(0===s?.childNodes.length&&u&&(this.format.isLine(s)?s.innerHTML="<br>":this.format.isBlock(s)&&(s.innerHTML="<"+this.options.get("defaultLine")+"><br></"+this.options.get("defaultLine")+">")),X.isListCell(s)&&3===t.nodeType)n=s,e=null;else if(!u&&o)if(n=3===o.nodeType?o.parentNode:o,n.contains(s)){let t=!0;for(e=s;e.parentNode&&e.parentNode!==n;)e=e.parentNode,t=!1;t&&s===o&&(e=e.nextSibling)}else e=null;else X.isWysiwygFrame(s)&&!this.format.isLine(t)?(n=s.appendChild(X.createElement(this.options.get("defaultLine"))),e=null):n=(e=u?b:s===o?s.nextSibling:s)&&e.parentNode?e.parentNode:p;for(;e&&!this.format.isLine(e)&&e.parentNode!==p;)e=e.parentNode}try{const i=this.editor.frameContext.get("wysiwyg");if(!h){if((X.isWysiwygFrame(e)||n===i.parentNode)&&(n=i,e=null),this.format.isLine(t)||this.format.isBlock(t)||!X.isListCell(n)&&this.component.isBasic(t)){const t=n;if(X.isList(e))n=e,e=null;else if(X.isListCell(e))n=e.previousElementSibling||e;else if(!o&&!e){const t=this.remove(),i=3===t.container.nodeType?X.isListCell(this.format.getLine(t.container,null))?t.container:this.format.getLine(t.container,null)||t.container.parentNode:t.container,s=X.isWysiwygFrame(i)||this.format.isBlock(i);n=s?i:i.parentNode,e=s?null:i.nextSibling}0===t.childNodes.length&&n!==t&&X.removeItem(t)}!u||d||this.format.isBlock(n)||X.isListCell(n)||X.isWysiwygFrame(n)||(e=n.nextElementSibling,n=n.parentNode),X.isWysiwygFrame(n)&&(3===t.nodeType||X.isBreak(t))&&(t=X.createElement(this.options.get("defaultLine"),null,t))}if(h?c.parentNode?(n=c,e=l):(n=i,e=null):e=n===e?n.lastChild:e,X.isListCell(t)&&!X.isList(n)){if(X.isListCell(n))e=n.nextElementSibling,n=n.parentNode;else{const t=X.createElement("ol");n.insertBefore(t,e),n=t,e=null}h=!0}if(this._checkDuplicateNode(t,n),n.insertBefore(t,e),h)if(X.isZeroWith(a.textContent.trim()))X.removeItem(a),t=t.lastChild;else{const e=X.getArrayItem(a.children,X.isList);e&&(t!==e?(t.appendChild(e),t=e.previousSibling):(n.appendChild(t),t=n),X.isZeroWith(a.textContent.trim())&&X.removeItem(a))}}catch(e){n.appendChild(t),console.warn("[SUNEDITOR.html.insertNode.warn]",e)}finally{const e=n.querySelectorAll("[data-duple]");if(e.length>0)for(let i,s,n,o,l=0,r=e.length;l<r;l++){for(i=e[l],n=i.childNodes,o=i.parentNode;n[0];)s=n[0],o.insertBefore(s,i);i===t&&(t=s),X.removeItem(i)}if((this.format.isLine(t)||this.component.isBasic(t))&&_===b){const t=this.format.getLine(p,null);1===t?.nodeType&&X.isEmptyLine(t)&&X.removeItem(t)}if(d&&(this.format.isLine(t)||this.format.isBlock(t))&&(t=this._setIntoFreeFormat(t)),!this.component.isBasic(t)){let e=1;if(3===t.nodeType){const e=t.previousSibling,i=t.nextSibling,n=!e||1===e.nodeType||X.isZeroWith(e)?"":e.textContent,o=!i||1===i.nodeType||X.isZeroWith(i)?"":i.textContent;e&&n.length>0&&(t.textContent=n+t.textContent,X.removeItem(e)),i&&o.length>0&&(t.textContent+=o,X.removeItem(i));const l={container:t,startOffset:n.length,endOffset:t.textContent.length-o.length};this.selection.setRange(t,l.startOffset,t,l.endOffset),s=l}else if(!X.isBreak(t)&&!X.isListCell(t)&&this.format.isLine(n)){let i=null;t.previousSibling&&!X.isBreak(t.previousSibling)||(i=X.createTextNode(G.zeroWidthSpace),t.parentNode.insertBefore(i,t)),t.nextSibling&&!X.isBreak(t.nextSibling)||(i=X.createTextNode(G.zeroWidthSpace),t.parentNode.insertBefore(i,t.nextSibling)),this.format._isIgnoreNodeChange(t)&&(t=t.nextSibling,e=0),this.selection.setRange(t,e,t,e)}}s||(this.history.push(!0),s=t)}return s},remove(){this.selection._resetRangeToTextNode();const t=this.selection.getRange(),e=0===t.startOffset,i=X.isEdgePoint(t.endContainer,t.endOffset,"end");let s=null,n=null,o=null;e&&(n=this.format.getLine(t.startContainer),s=n?n.previousElementSibling:null,n=n?s:n),i&&(o=this.format.getLine(t.endContainer),o=o?o.nextElementSibling:o);let l,r=0,a=t.startContainer,h=t.endContainer,c=t.startOffset,d=t.endOffset;const u=3===t.commonAncestorContainer.nodeType&&t.commonAncestorContainer.parentNode===a.parentNode?a.parentNode:t.commonAncestorContainer;if(u===a&&u===h){if(this.component.isBasic(u)){const t=this.component.get(u).container,e=t.parentNode,i=t.nextSibling||t.previousSibling,s=i===t.previousSibling?i?.textContent?.length||1:0,n=e.nextElementSibling||e.previousElementSibling,o=n===e.previousElementSibling?n?.textContent?.length||1:0;return X.removeItem(t),this.format.isLine(e)?0===e.childNodes.length?(X.removeItem(e),{container:n,offset:o}):{container:i,offset:s}:{container:n,offset:o}}if(1===u.nodeType&&0===c&&1===d||3===u.nodeType&&0===c&&d===u.textContent.length){const t=X.getNextDeepestNode(u,this.editor.frameContext.get("wysiwygFrame")),e=X.getPreviousDeepestNode(u,this.editor.frameContext.get("wysiwygFrame")),i=this.format.getLine(u);X.removeItem(u);let s=t||e,n=t?0:3===s?.nodeType?s.textContent.length:1;const o=this.format.getLine(s)||this.component.get(s);return i!==o&&(s=o,n=0===n?0:1),X.isZeroWith(i)&&X.removeItem(i),{container:s,offset:n}}a=u.children[c],h=u.children[d],c=d=0}if(!a||!h)return{container:u,offset:0};if(a===h&&t.collapsed&&X.isZeroWith(a.textContent?.substr(c)))return{container:a,offset:c,prevContainer:a&&a.parentNode?a:null};let p=null,g=null;const m=X.getListChildNodes(u,null);let f=X.getArrayIndex(m,a),_=X.getArrayIndex(m,h);if(m.length>0&&f>-1&&_>-1){for(let t=f+1,e=a;t>=0;t--)m[t]===e.parentNode&&m[t].firstChild===e&&0===c&&(f=t,e=e.parentNode);for(let t=_-1,e=h;t>f;t--)m[t]===e.parentNode&&1===m[t].nodeType&&(m.splice(t,1),e=e.parentNode,--_)}else{if(0===m.length){if(this.format.isLine(u)||this.format.isBlock(u)||X.isWysiwygFrame(u)||X.isBreak(u)||X.isMedia(u))return{container:u,offset:0};if(3===u.nodeType)return{container:u,offset:d};m.push(u),a=h=u}else if(a=h=m[0],X.isBreak(a)||X.isZeroWith(a))return{container:X.isMedia(u)?u:a,offset:0};f=_=0}for(let t=f;t<=_;t++){const e=m[t];if(0===e.length||3===e.nodeType&&void 0===e.data)this._nodeRemoveListItem(e);else if(e!==a)if(e!==h)this._nodeRemoveListItem(e);else{if(1===h.nodeType){if(this.component.is(h))continue;g=X.createTextNode(h.textContent)}else g=X.createTextNode(h.substringData(d,h.length-d));g.length>0?h.data=g.data:this._nodeRemoveListItem(h)}else{if(1===a.nodeType){if(this.component.is(a))continue;p=X.createTextNode(a.textContent)}else e===h?(p=X.createTextNode(a.substringData(0,c)+h.substringData(d,h.length-d)),r=c):p=X.createTextNode(a.substringData(0,c));if(p.length>0?a.data=p.data:this._nodeRemoveListItem(a),e===h)break}}const b=X.getParentElement(h,"ul"),v=X.getParentElement(a,"li");if(b&&v&&v.contains(b)?(l=b.previousSibling,r=l.textContent.length):(l=h&&h.parentNode?h:a&&a.parentNode?a:t.endContainer||t.startContainer,r=e||i?i?l.textContent.length:0:r),this.format.getLine(l)||a&&a.parentNode||(o?(l=o,r=0):n&&(l=n,r=1)),!X.isWysiwygFrame(l)&&0===l.childNodes.length){const t=this.nodeTransform.removeAllParents(l,null,null);t&&(l=t.sc||t.ec||this.editor.frameContext.get("wysiwyg"))}return this.selection.setRange(l,r,l,r),{container:l,offset:r,prevContainer:s}},get(t,e,i){i?Array.isArray(i)||(i=[i]):i=[this.status.rootKey];const s=this.status.rootKey,n={};for(let s,o=0,l=i.length;o<l;o++){this.editor.changeFrameContext(i[o]);const l=this.editor.frameContext,r=X.createElement("DIV",null,this._convertToCode(l.get("wysiwyg"),!0)),a=X.getListChildren(r,(t=>t.hasAttribute("contenteditable")));for(let t=0,e=a.length;t<e;t++)a[t].removeAttribute("contenteditable");const h=this.clean(r.innerHTML,!1,null,null);if(this.editor.frameOptions.get("iframe_fullPage"))if(e){const t=X.getAttributesToString(l.get("_wd").body,["contenteditable"]);s="<!DOCTYPE html><html>"+l.get("_wd").head.outerHTML+"<body "+t+">"+h+"</body></html>"}else s=h;else s=t?'<div class="sun-editor-editable'+(this.options.get("_rtl")?" se-rtl":"")+'">'+h+"</div>":r.innerHTML;n[i[o]]=s}return this.editor.changeFrameContext(s),i.length>1?n:n[i[0]]},set(t,e){this.selection.removeRange();const i=null==t?"":this.clean(t,!0,null,null);e?Array.isArray(e)||(e=[e]):e=[this.status.rootKey];for(let t=0;t<e.length;t++)if(this.editor.changeFrameContext(e[t]),this.editor.frameContext.get("isCodeView")){const t=this._convertToCode(i,!1);this.viewer._setCodeView(t)}else this.editor.frameContext.get("wysiwyg").innerHTML=i,this.editor._resetComponents(),this.history.push(!1,e[t])},add(t,e){e?Array.isArray(e)||(e=[e]):e=[this.status.rootKey];for(let i=0;i<e.length;i++){this.editor.changeFrameContext(e[i]);const s=this.clean(t,!0,null,null);if(this.editor.frameContext.get("isCodeView"))this.viewer._setCodeView(this.viewer._getCodeView()+"\n"+this._convertToCode(s,!1));else{const t=X.createElement("DIV",null,s).children,n=t.length;for(let e=0;e<n;e++)t[e]&&this.editor.frameContext.get("wysiwyg").appendChild(t[e]);this.history.push(!1,e[i]),this.selection.scrollTo(t[n-1])}}},setFullPage(t,e){if(!this.editor.frameOptions.get("iframe"))return!1;e?Array.isArray(e)||(e=[e]):e=[this.status.rootKey];for(let i=0;i<e.length;i++)this.editor.changeFrameContext(e[i]),t.head&&(this.editor.frameContext.get("_wd").head.innerHTML=t.head.replace(this.__disallowedTagsRegExp,"")),t.body&&(this.editor.frameContext.get("_wd").body.innerHTML=this.clean(t.body,!0,null,null)),this.editor._resetComponents()},compress:t=>t.replace(/\n/g,"").replace(/(>)(?:\s+)(<)/g,"$1$2"),_convertToCode(t,e){let i="";const s=RegExp,n=new s("^(BLOCKQUOTE|PRE|TABLE|THEAD|TBODY|TR|TH|TD|OL|UL|IMG|IFRAME|VIDEO|AUDIO|FIGURE|FIGCAPTION|HR|BR|CANVAS|SELECT)$","i"),o="string"==typeof t?this._d.createRange().createContextualFragment(t):t,l=t=>this.format.isLine(t)||this.component.is(t),r=e?"":"\n";let a=e?0:1*this.status.codeIndentSize;return a=a>0?new Array(a+1).join(" "):"",function t(e,o){const h=e.childNodes,c=n.test(e.nodeName),d=c?o:"";for(let u,p,g,m,f,_,b=0,v=h.length;b<v;b++)u=h[b],m=n.test(u.nodeName),p=m?r:"",g=!l(u)||c||/^(TH|TD)$/i.test(e.nodeName)?"":r,8!==u.nodeType?3!==u.nodeType?0!==u.childNodes.length?u.outerHTML?(f=u.nodeName.toLowerCase(),_=d||m?o:"",i+=(g||(c?"":p))+_+u.outerHTML.match(s("<"+f+"[^>]*>","i"))[0]+p,t(u,o+a),i+=(/\n$/.test(i)?_:"")+"</"+f+">"+(g||p||c||/^(TH|TD)$/i.test(u.nodeName)?r:"")):i+=(new XMLSerializer).serializeToString(u):i+=(/^HR$/i.test(u.nodeName)?r:"")+(/^PRE$/i.test(u.parentElement.nodeName)&&/^BR$/i.test(u.nodeName)?"":d)+u.outerHTML+p:X.isList(u.parentElement)||(i+=Y.htmlToEntity(/^\n+$/.test(u.data)?"":u.data)):i+="\n\x3c!-- "+u.textContent.trim()+" --\x3e"+p}(o,""),i.trim()+r},_nodeRemoveListItem(t){const e=this.format.getLine(t,null);X.removeItem(t),X.isListCell(e)&&(this.nodeTransform.removeAllParents(e,null,null),X.isList(e?.firstChild)&&e.insertBefore(X.createTextNode(G.zeroWidthSpace),e.firstChild))},_setIntoFreeFormat(t){const e=t.parentNode;let i,s;for(;this.format.isLine(t)||this.format.isBlock(t);){for(i=t.childNodes,s=null;i[0];)if(s=i[0],this.format.isLine(s)||this.format.isBlock(s)){if(this._setIntoFreeFormat(s),!t.parentNode)break;i=t.childNodes}else e.insertBefore(s,t);0===t.childNodes.length&&X.removeItem(t),t=X.createElement("BR"),e.insertBefore(t,s.nextSibling)}return t},_makeLine(t,e){const i=this.options.get("defaultLine");if(1===t.nodeType){if(this.__disallowedTagNameRegExp.test(t.nodeName))return"";if(X.isExcludeFormat(t))return t.outerHTML;const s=X.getListChildNodes(t,(t=>X.isSpanWithoutAttr(t)&&!X.getParentElement(t,X.isExcludeFormat)))||[];for(let t=s.length-1;t>=0;t--)s[t].outerHTML=s[t].innerHTML;return!e||this.format.isLine(t)||this.format.isBlock(t)||this.component.is(t)||X.isMedia(t)||X.isFigure(t)||X.isAnchor(t)&&X.isMedia(t.firstElementChild)?X.isSpanWithoutAttr(t)?t.innerHTML:t.outerHTML:"<"+i+">"+(X.isSpanWithoutAttr(t)?t.innerHTML:t.outerHTML)+"</"+i+">"}if(3===t.nodeType){if(!e)return Y.htmlToEntity(t.textContent);const s=t.textContent.split(/\n/g);let n="";for(let t,e=0,o=s.length;e<o;e++)t=s[e].trim(),t.length>0&&(n+="<"+i+">"+Y.htmlToEntity(t)+"</"+i+">");return n}return 8===t.nodeType&&this._allowHTMLComment?"\x3c!--"+t.textContent.trim()+"--\x3e":""},_consistencyCheckOfHTML(t,e,i,s,n,o){const l=[],r=[],a=[],h=[],c=X.getListChildNodes(t,(c=>{if(n&&1!==c.nodeType)return X.isList(c.parentElement)&&l.push(c),!1;if(s&&(i.test(c.nodeName)||!e.test(c.nodeName)&&0===c.childNodes.length&&X.isExcludeFormat(c)))return l.push(c),!1;const d=!X.getParentElement(c,X.isExcludeFormat);if(n){if(!X.isTableElements(c)&&!X.isListCell(c)&&!X.isAnchor(c)&&(this.format.isLine(c)||this.format.isBlock(c)||this.format.isTextStyleNode(c))&&0===c.childNodes.length&&d)return r.push(c),!1;if(X.isList(c.parentNode)&&!X.isList(c)&&!X.isListCell(c))return a.push(c),!1;if(X.isTableCell(c)){const t=c.firstElementChild;if(!this.format.isLine(t)&&!this.format.isBlock(t)&&!this.component.is(t))return h.push(c),!1}}if(o&&d&&c.className){const t=new Array(c.classList).map(this._isAllowedClassName).join(" ").trim();t?c.className=t:c.removeAttribute("class")}return!!n&&(c.parentNode!==t&&d&&(X.isListCell(c)&&!X.isList(c.parentNode)||(this.format.isLine(c)||this.component.is(c))&&!this.format.isBlock(c.parentNode)&&!X.getParentElement(c,this.component.is.bind(this.component))))}));for(let t=0,e=l.length;t<e;t++)X.removeItem(l[t]);const d=[];for(let t,e,i=0,s=c.length;i<s;i++)if(t=c[i],e=t.parentNode,e&&e.parentNode)if(X.getParentElement(t,X.isListCell)){const i=t.childNodes;for(let n=i.length-1;s>=0;n--)e.insertBefore(t,i[n]);d.push(t)}else e.parentNode.insertBefore(t,e),d.push(e);for(let t,e=0,i=d.length;e<i;e++)t=d[e],X.isZeroWith(t.textContent.trim())&&X.removeItem(t);for(let t=0,e=r.length;t<e;t++)X.removeItem(r[t]);for(let t,e,i,s,n=0,o=a.length;n<o;n++)if(t=a[n],s=t.parentNode,s)if(e=X.createElement("LI"),this.format.isLine(t)){for(i=t.childNodes;i[0];)e.appendChild(i[0]);s.insertBefore(e,t),X.removeItem(t)}else t=t.nextSibling,e.appendChild(a[n]),s.insertBefore(e,t);for(let t,e,i=0,s=h.length;i<s;i++)t=h[i],e=X.createElement("DIV"),e.innerHTML=0===t.textContent.trim().length&&0===t.children.length?"<br>":t.innerHTML,t.innerHTML=e.outerHTML},_styleNodeConvertor(t){if(!this._disallowedStyleNodesRegExp)return t;const e=this.options.get("_defaultStyleTagMap");return t.replace(this._disallowedStyleNodesRegExp,((t,i,s,n)=>i+("string"==typeof e[s]?e[s]:s)+(n?" "+n:"")))},_editFormat(t){let e,i="";const s=t.childNodes;for(let t,n=0,o=s.length;n<o;n++)t=s[n],this.__allowedTagNameRegExp.test(t.nodeName)?i+=t.outerHTML:8===t.nodeType?i+="\x3c!-- "+t.textContent+" --\x3e":this.format.isLine(t)||this.format.isBlock(t)||this.component.is(t)||/meta/i.test(t.nodeName)||X.isExcludeFormat(t)?(e&&(i+=e.outerHTML,e=null),i+=t.outerHTML):(e||(e=X.createElement(this.options.get("defaultLine"))),e.appendChild(t),n--,o--);return e&&(i+=e.outerHTML),this._d.createRange().createContextualFragment(i)},_convertListCell(t){let e="";for(let i,s=0,n=t.length;s<n;s++)i=t[s],1===i.nodeType?X.isList(i)?e+=i.innerHTML:X.isListCell(i)?e+=i.outerHTML:this.format.isLine(i)?e+="<li>"+(i.innerHTML.trim()||"<br>")+"</li>":this.format.isBlock(i)&&!X.isTableElements(i)?e+=this._convertListCell(i):e+="<li>"+i.outerHTML+"</li>":e+="<li>"+(i.textContent||"<br>")+"</li>";return e},_isFormatData(t){let e=!1;for(let i,s=0,n=t.length;s<n;s++)if(i=t[s],1===i.nodeType&&!this.format.isTextStyleNode(i)&&!X.isBreak(i)&&!this.__disallowedTagNameRegExp.test(i.nodeName)){e=!0;break}return e},_cleanStyle(t,e,i){let s=(t.match(/style\s*=\s*(?:"|')[^"']*(?:"|')/)||[])[0];if(this._textStyleTags.includes(i)&&!s&&(t.match(/<[^\s]+\s(.+)/)||[])[1]){const e=(t.match(/\ssize="([^"]+)"/i)||[])[1],i=(t.match(/\sface="([^"]+)"/i)||[])[1],n=(t.match(/\scolor="([^"]+)"/i)||[])[1];(e||i||n)&&(s='style="'+(e?"font-size:"+j.get(e/3.333,1)+"rem;":"")+(i?"font-family:"+i+";":"")+(n?"color:"+n+";":"")+'"')}if(s){let t;e||(e=[]);for(const[e,s]of this._cleanStyleRegExpMap)if(e.test(i)){t=s;break}if(!t)return e;const n=s.replace(/&quot;/g,"").match(t);if(!n)return e;const o=[];for(let t,e=0,i=n.length;e<i;e++)if(t=n[e].match(/([a-zA-Z0-9-]+)(:)([^"']+)/),t&&!/inherit|initial|revert|unset/i.test(t[3])){const e=q.kebabToCamelCase(t[1].trim()),i=this.editor.frameContext.get("wwComputedStyle")[e].replace(/"/g,""),s=t[3].trim();switch(e){case"fontFamily":if(!this.plugins.font||!this.plugins.font.fontArray.includes(s))continue;break;case"fontSize":if(!this.plugins.fontSize)continue;this.fontSizeUnitRegExp.test(t[0])||(t[0]=t[0].replace((t[0].match(/:\s*([^;]+)/)||[])[1],Y.fontSize.bind(null,this.options.get("fontSizeUnits")[0])));break;case"color":if(!this.plugins.fontColor||/rgba\(([0-9]+\s*,\s*){3}0\)|windowtext/i.test(s))continue;break;case"backgroundColor":if(!this.plugins.backgroundColor||/rgba\(([0-9]+\s*,\s*){3}0\)|windowtext/i.test(s))continue}i!==s&&o.push(t[0])}o.length>0&&e.push('style="'+o.join(";")+'"')}return e},_deleteDisallowedTags(t,e,i){return t=t.replace(this.__disallowedTagsRegExp,""),e.test("<font>")&&(t=t.replace(/(<\/?)font(\s?)/gi,"$1span$2")),t.replace(e,"").replace(i,"")},_checkDuplicateNode(t,e){const i=this;!function t(s){i._dupleCheck(s,e);const n=s.childNodes;for(let e=0,i=n.length;e<i;e++)t(n[e])}(t)},_dupleCheck(t,e){if(!this.format.isTextStyleNode(t))return;const i=(t.style.cssText.match(/[^;]+;/g)||[]).map((function(t){return t.trim()})),s=t.nodeName;if(/^span$/i.test(s)&&0===i.length)return t;const n=this.format;let o=!1;return function e(l){if(!X.isWysiwygFrame(l)&&n.isTextStyleNode(l)){if(l.nodeName===s){o=!0;const e=l.style.cssText.match(/[^;]+;/g)||[];for(let t,s=0,n=e.length;s<n;s++)(t=i.indexOf(e[s].trim()))>-1&&i.splice(t,1);for(let e=0,i=l.classList.length;e<i;e++)t.classList.remove(l.classList[e])}e(l.parentElement)}}(e),o&&((t.style.cssText=i.join(" "))||(t.setAttribute("style",""),t.removeAttribute("style")),t.attributes.length||t.setAttribute("data-duple","true")),t},constructor:Ri};const $i=Ri,Pi=function(t){Ht.call(this,t),this.targetMap={},this.index=-1,this.menus=[],this.currentDropdown=null,this.currentDropdownActiveButton=null,this.currentDropdownName="",this.currentDropdownType="",this.currentContainer=null,this.currentContainerActiveButton=null,this._dropdownCommands=[],this.__globalEventHandler={mousedown:Di.bind(this),containerDown:this.containerOff.bind(this),keydown:Wi.bind(this),mousemove:Ui.bind(this),mouseout:Fi.bind(this)},this._bindClose_dropdown_mouse=null,this._bindClose_dropdown_key=null,this._bindClose_cons_mouse=null,this.currentDropdownPlugin=null};function Di(t){X.getParentElement(t.target,".se-dropdown")||this.dropdownOff()}function Fi(){this.index=-1}function Wi(t){switch(t.keyCode){case 38:t.preventDefault(),t.stopPropagation(),this._moveItem(-1);break;case 40:t.preventDefault(),t.stopPropagation(),this._moveItem(1);break;case 13:case 32:{if(this.index<0)break;const e=this.menus[this.index];if(!e||"function"!=typeof this.plugins[this.currentDropdownName].action)return;t.preventDefault(),t.stopPropagation(),this.plugins[this.currentDropdownName].action(e),this.dropdownOff();break}}}function Ui(t){X.addClass(this.currentDropdown,"se-select-menu-mouse-move"),X.removeClass(this.currentDropdown,"se-select-menu-key-action");const e=this.menus.indexOf(t.target);-1!==e&&(this.index=1*e)}Pi.prototype={initDropdownTarget({key:t,type:e},i){if(!t)throw Error("[SUNEDITOR.init.fail] The plugin's key is not added.");/free$/.test(e)||(i.setAttribute("data-key",t),this._dropdownCommands.push(t)),this.context.get("menuTray").appendChild(i),this.targetMap[t]=i},dropdownOn(t){this.__removeGlobalEvent();const e=this._checkMoreLayer(t);if(e){const i=X.getParentElement(e,".se-btn-tray").querySelector('[data-command="'+e.getAttribute("data-ref")+'"]');if(i)return this.editor.runFromTarget(i),void this.dropdownOn(t)}const i=this.currentDropdownName=t.getAttribute("data-command");this.currentDropdownType=t.getAttribute("data-type");const s=this.currentDropdown=this.targetMap[i];this.currentDropdownActiveButton=t,this._setMenuPosition(t,s),this._bindClose_dropdown_mouse=this.eventManager.addGlobalEvent("mousedown",this.__globalEventHandler.mousedown,!1),this._dropdownCommands.includes(i)&&(this.menus=Y.nodeListToArray(s.querySelectorAll(".se-toolbar-btn[data-command]")),this.menus.length>0&&(this._bindClose_dropdown_key=this.eventManager.addGlobalEvent("keydown",this.__globalEventHandler.keydown,!1),s.addEventListener("mousemove",this.__globalEventHandler.mousemove,!1),s.addEventListener("mouseout",this.__globalEventHandler.mouseout,!1))),this.currentDropdownPlugin=this.plugins[i],"function"==typeof this.currentDropdownPlugin?.on&&this.currentDropdownPlugin.on(t),this.editor._antiBlur=!0},dropdownOff(){this.__removeGlobalEvent(),this.index=-1,this.menus=[],this.currentDropdown&&(this.currentDropdownName="",this.currentDropdownType="",this.currentDropdown.style.display="none",this.currentDropdown=null,this.currentDropdownActiveButton&&X.removeClass(this.currentDropdownActiveButton.parentElement.children,"on"),this.currentDropdownActiveButton=null,this.editor._notHideToolbar=!1),this.editor._antiBlur=!1,"function"==typeof this.currentDropdownPlugin?.off&&this.currentDropdownPlugin.off(),this.currentDropdownPlugin=null},containerOn(t){this.__removeGlobalEvent();const e=this._containerName=t.getAttribute("data-command");this.currentContainerActiveButton=t,this._setMenuPosition(t,this.currentContainer=this.targetMap[e]),this._bindClose_cons_mouse=this.eventManager.addGlobalEvent("mousedown",this.__globalEventHandler.containerDown,!1),this.plugins[e].on&&this.plugins[e].on(t),this.editor._antiBlur=!0},containerOff(){this.__removeGlobalEvent(),this.currentContainer&&(this._containerName="",this.currentContainer.style.display="none",this.currentContainer=null,X.removeClass(this.currentContainerActiveButton,"on"),this.currentContainerActiveButton=null,this.editor._notHideToolbar=!1),this.editor._antiBlur=!1},_setMenuPosition(t,e){e.style.visibility="hidden",e.style.display="block",e.style.height="",X.addClass(t.parentElement.children,"on"),this.offset.setRelPosition(e,this.carrierWrapper,t.parentElement,X.getParentElement(t,".se-toolbar"),!1),e.style.visibility=""},_checkMoreLayer(t){const e=X.getParentElement(t,".se-more-layer");return e&&"block"!==e.style.display&&e.getAttribute("data-ref")?e:null},_moveItem(t){X.removeClass(this.currentDropdown,"se-select-menu-mouse-move"),X.addClass(this.currentDropdown,"se-select-menu-key-action"),t=this.index+t;const e=this.menus.length,i=this.index=t>=e?0:t<0?e-1:t;for(let t=0;t<e;t++)t===i?X.addClass(this.menus[t],"on"):X.removeClass(this.menus[t],"on")},__removeGlobalEvent(){this._bindClose_dropdown_mouse&&(this._bindClose_dropdown_mouse=this.eventManager.removeGlobalEvent(this._bindClose_dropdown_mouse)),this._bindClose_cons_mouse&&(this._bindClose_cons_mouse=this.eventManager.removeGlobalEvent(this._bindClose_cons_mouse)),this._bindClose_dropdown_key&&(this._bindClose_dropdown_key=this.eventManager.removeGlobalEvent(this._bindClose_dropdown_key),X.removeClass(this.menus,"on"),X.removeClass(this.currentDropdown,"se-select-menu-key-action|se-select-menu-mouse-move"),this.currentDropdown.removeEventListener("mousemove",this.__globalEventHandler.mousemove,!1),this.currentDropdown.removeEventListener("mouseout",this.__globalEventHandler.mouseout,!1))},constructor:Pi};const Zi=Pi,qi=function(t){Ht.call(this,t)};qi.prototype={split(t,e,i){if(X.isWysiwygFrame(t)||this.component.is(t)||!t)return t;if(e&&!j.is(e)){const i=t.childNodes;let s=X.getPositionIndex(e);const n=t.cloneNode(!1),o=t.cloneNode(!1);for(let t=0,e=i.length;t<e;t++){if(t<s)n.appendChild(i[t]);else{if(!(t>s))continue;o.appendChild(i[t])}t--,e--,s--}return n.childNodes.length>0&&t.parentNode.insertBefore(n,t),o.childNodes.length>0&&t.parentNode.insertBefore(o,t.nextElementSibling),t}const s=t.parentNode;let n,o,l,r=0,a=1,h=!0;if((!i||i<0)&&(i=0),3===t.nodeType){if(r=X.getPositionIndex(t),e>=0&&t.length!==e){t.splitText(e);const i=X.getNodeFromPath([r+1],s);X.isZeroWith(i)&&(i.data=G.zeroWidthSpace)}}else if(1===t.nodeType){if(0===e){for(;t.firstChild;)t=t.firstChild;if(3===t.nodeType){const e=X.createTextNode(G.zeroWidthSpace);t.parentNode.insertBefore(e,t),t=e}}t.previousSibling?t=t.previousSibling:X.getNodeDepth(t)===i&&(h=!1)}1===t.nodeType&&(a=0);let c=t;for(;X.getNodeDepth(c)>i;)for(r=X.getPositionIndex(c)+a,c=c.parentNode,l=n,n=c.cloneNode(!1),o=c.childNodes,l&&(X.isListCell(n)&&X.isList(l)&&l.firstElementChild?(n.innerHTML=l.firstElementChild.innerHTML,X.removeItem(l.firstElementChild),l.children.length>0&&n.appendChild(l)):n.appendChild(l));o[r];)n.appendChild(o[r]);c.childNodes.length<=1&&(!c.firstChild||0===c.firstChild.textContent.length)&&(c.innerHTML="<br>");const d=c.parentNode;return h&&(c=c.nextSibling),n?(this.mergeSameTags(n,null,!1),this.mergeNestedTags(n,X.isList),n.childNodes.length>0?d.insertBefore(n,c):n=c,X.isListCell(n)&&n.children&&X.isList(n.children[0])&&n.insertBefore(X.createElement("BR"),n.children[0]),0===s.childNodes.length&&X.removeItem(s),n):c},mergeSameTags(t,e,i){const s=this,n=e?e.length:0;let o=null;return n&&(o=Array.apply(null,new Array(n)).map(Number.prototype.valueOf,0)),function t(l,r,a){const h=l.childNodes;for(let c,d,u=0,p=h.length;u<p&&(c=h[u],d=h[u+1],c);u++)if(i&&s.format._isIgnoreNodeChange(c)||!i&&(X.isTableElements(c)||X.isListCell(c)||s.format.isLine(c)&&!s.format.isBrLine(c)))(X.isTableElements(c)||X.isListCell(c))&&t(c,r+1,u);else{if(1===p&&l.nodeName===c.nodeName&&l.parentNode){if(n){let t,i,s,o,a;for(let h=0;h<n;h++)if(t=e[h],t&&t[r]===u){for(i=c,s=l,o=r,a=!0;o>=0;){if(X.getArrayIndex(s.childNodes,i)!==t[o]){a=!1;break}i=c.parentNode,s=i.parentNode,o--}a&&(t.splice(r,1),t[r]=u)}}X.copyTagAttributes(c,l),l.parentNode.insertBefore(c,l),X.removeItem(l)}if(!d){1===c.nodeType&&t(c,r+1,u);break}if(c.nodeName===d.nodeName&&X.isSameAttributes(c,d)&&c.href===d.href){const t=c.childNodes;let i=0;for(let e=0,s=t.length;e<s;e++)t[e].textContent.length>0&&i++;const s=c.lastChild,l=d.firstChild;let h=0;if(s&&l){const t=3===s.nodeType&&3===l.nodeType;h=s.textContent.length;let c=s.previousSibling;for(;c&&3===c.nodeType;)h+=c.textContent.length,c=c.previousSibling;if(i>0&&3===s.nodeType&&3===l.nodeType&&(s.textContent.length>0||l.textContent.length>0)&&i--,n){let c=null;for(let d=0;d<n;d++)if(c=e[d],c&&c[r]>u){if(r>0&&c[r-1]!==a)continue;c[r]-=1,c[r+1]>=0&&c[r]===u&&(c[r+1]+=i,t&&s&&3===s.nodeType&&l&&3===l.nodeType&&(o[d]+=h))}}}if(3===c.nodeType){if(h=c.textContent.length,c.textContent+=d.textContent,n){let t=null;for(let s=0;s<n;s++)if(t=e[s],t&&t[r]>u){if(r>0&&t[r-1]!==a)continue;t[r]-=1,t[r+1]>=0&&t[r]===u&&(t[r+1]+=i,o[s]+=h)}}}else c.innerHTML+=d.innerHTML;X.removeItem(d),u--}else 1===c.nodeType&&t(c,r+1,u)}}(t,0,0),o},mergeNestedTags(t,e){"string"==typeof e?e=function(t){return this.test(t.tagName)}.bind(new RegExp(`^(${e||".+"})$`,"i")):"function"!=typeof e&&(e=()=>!0),function t(i){let s=i.children;if(1===s.length&&s[0].nodeName===i.nodeName&&e(i)){const t=s[0];for(s=t.children;s[0];)i.appendChild(s[0]);i.removeChild(t)}for(let e=0,s=i.children.length;e<s;e++)t(i.children[e])}(t)},removeAllParents(t,e,i){if(!t)return null;let s=null;return e||(e=t=>{if(t===i||this.component.is(t))return!1;const e=t.textContent.trim();return 0===e.length||/^(\n|\u200B)+$/.test(e)}),function t(i){if(!X.isWysiwygFrame(i)){const n=i.parentNode;n&&e(i)&&(s={sc:i.previousElementSibling,ec:i.nextElementSibling},X.removeItem(i),t(n))}}(t),s},removeEmptyNode(t,e,i){const s=this;e&&(e=X.getParentElement(e,(e=>t===e.parentElement))),function i(n){if(s.format._notTextNode(n)||n===e||X.isNonEditable(n))return 0;if(n===t||!X.isZeroWith(n.textContent)||n.firstChild&&X.isBreak(n.firstChild)||n.querySelector(q._allowedEmptyNodeList)){const t=n.children;for(let e=0,n=t.length,o=0;e<n;e++)t[e+o]&&!s.component.is(t[e+o])&&(o+=i(t[e+o]))}else if(n.parentNode)return n.parentNode.removeChild(n),-1;return 0}(t),0===t.childNodes.length&&(i?X.removeItem(t):t.innerHTML="<br>")},constructor:qi};const Gi=qi,Yi=function(t,e){Ht.call(this,t.editor),this.inst=t,this.kind=t.constructor.key||t.constructor.name,this.form=e,this.focusElement=e.querySelector("[data-focus]"),this.isUpdate=!1,this._modalArea=this.carrierWrapper.querySelector(".se-modal"),this._modalBack=this.carrierWrapper.querySelector(".se-modal-back"),this._modalInner=this.carrierWrapper.querySelector(".se-modal-inner"),this._closeListener=[Ki.bind(this),ji.bind(this)],this._bindClose=null,this._onClickEvent=null,this._closeSignal=!1,this._modalInner.appendChild(e),this.eventManager.addEvent(e.querySelector("form"),"submit",Xi.bind(this)),this._closeSignal=!this.eventManager.addEvent(e.querySelector('[data-command="close"]'),"click",this.close.bind(this))};async function Xi(t){t.preventDefault(),t.stopPropagation(),this.editor.showLoading();try{const t=await this.inst.modalAction();!1===t?this.editor.hideLoading():void 0===t?this.close():(this.close(),this.editor.hideLoading())}catch(t){throw this.close(),this.editor.hideLoading(),Error(`[SUNEDITOR.Modal[${this.kind}].warn] ${t.message}`)}}function ji(t){(/close/.test(t.target.getAttribute("data-command"))||t.target===this._modalInner)&&this.close()}function Ki(t){/27/.test(t.keyCode)&&this.close()}Yi.prototype={open(){this.editor._offCurrentModal(),this._fixCurrentController(!0),this._closeSignal&&this._modalInner.addEventListener("click",this._closeListener[1]),this._bindClose&&(this._bindClose=this.eventManager.removeGlobalEvent(this._bindClose)),this._bindClose=this.eventManager.addGlobalEvent("keydown",this._closeListener[0]),this.isUpdate=this.kind===this.editor.currentControllerName,this.editor.opendModal=this,this.isUpdate||"function"!=typeof this.inst.init||this.inst.init(),"function"==typeof this.inst.on&&this.inst.on(this.isUpdate),this._modalArea.style.display="block",this._modalBack.style.display="block",this._modalInner.style.display="block",this.form.style.display="block",this.focusElement&&this.focusElement.focus()},close(){this._fixCurrentController(!1),this.editor.opendModal=null,this._closeSignal&&this._modalInner.removeEventListener("click",this._closeListener[1]),this._bindClose&&(this._bindClose=this.eventManager.removeGlobalEvent(this._bindClose)),this.form.style.display="none",this._modalBack.style.display="none",this._modalArea.style.display="none","function"==typeof this.inst.init&&this.inst.init(),this.editor.focus()},_fixCurrentController(t){const e=this.editor.opendControllers;for(let i=0;i<e.length;i++)e[i].fixed=t,e[i].form.style.display=t?"none":"block"},constructor:Yi},Yi.CreateFileInput=function({icons:t,lang:e},{acceptedFormats:i,allowMultiple:s}){return`\n\t<div class="se-modal-form-files">\n\t\t<div class="se-flex-input-wrapper">\n\t\t\t<div class="se-input-form-abs">\n\t\t\t\t<div>\n\t\t\t\t\t<div class="se-input-file-w">\n\t\t\t\t\t\t<div class="se-input-file-icon-up">${t.upload_tray}</div>\n\t\t\t\t\t\t<div class="se-input-file-icon-files">${t.file_plus}</div>\n\t\t\t\t\t\t<span class="se-input-file-cnt"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<input class="se-input-form __se__file_input" data-focus type="file" accept="${i}"${s?' multiple="multiple"':""}/>\n\t\t</div>\n\t\t<button type="button" class="se-btn se-modal-files-edge-button se-file-remove se-tooltip" aria-label="${e.remove}">\n\t\t\t${t.selection_remove}\n\t\t\t${Ct(e.remove)}\n\t\t</button>\n\t</div>`},Yi.OnChangeFile=function(t,e){if(!t||!e)return;const i=t.querySelector(".se-input-file-cnt"),s=t.querySelector(".se-input-file-icon-up"),n=t.querySelector(".se-input-file-icon-files");e.length>1?(s.style.display="none",n.style.display="inline-block",i.style.display="",i.textContent=` ..${e.length}`):e.length>0?(s.style.display="none",n.style.display="none",i.style.display="block",i.textContent=e[0].name):(s.style.display="inline-block",n.style.display="none",i.style.display="",i.textContent="")};const Ji=Yi,Qi=function(t){const e=function({lang:t,icons:e}){const i='<div><button class="close" data-command="close" title="'+t.close+'">'+e.cancel+"</button></div><div><span></span></div>";return X.createElement("DIV",{class:"se-notice"},i)}(t);this.editor=t,this.modal=new Ji(this,e),this.message=e.querySelector("span")};Qi.prototype={open(t){this.message.textContent=t,this.modal.open()},close(){this.modal.close()},constructor:Qi};const ts=Qi,es=function(t){this.editor=t,this.options=t.options,this.context=t.context,this._scrollEvent=null,this._elTop=0,this._scrollY=0,this._isFixed=!1};function is(e,i,s,n){const o=/^fixed$/i.test(t.getComputedStyle(n).position);this._isFixed?o?e.style.top=this._elTop-(this._scrollY-t.scrollY-n.offsetTop)+"px":this.setRelPosition(e,i,s,n,!0):o&&this.setRelPosition(e,i,s,n,!0)}es.prototype={getSize(t){const e=this.editor.frameContext.get("eventWysiwyg"),i=this.editor.frameContext.get("wysiwygFrame"),s=this.get(t),n=this.get(i);return{w:t.offsetWidth-1,h:t.offsetHeight-1,t:s.top-(this.editor.frameOptions.get("iframe")?n.top:0),l:s.left-(this.editor.frameOptions.get("iframe")?n.left+(e.scrollX||e.scrollLeft||0):0)-i.scrollLeft,scrollX:e.scrollX||e.scrollLeft||0,scrollY:e.scrollY||e.scrollTop||0}},get(t){const e=this.editor.frameContext.get("wysiwygFrame"),i=/iframe/i.test(e?.nodeName),s=this.getLocal(t);return{left:s.left+(i?e.parentElement.offsetLeft:0),top:s.top+(i?e.parentElement.offsetTop:0)}},getLocal(t){let e=0,i=0,s=3===t.nodeType?t.parentElement:t;const n=M(t,O.bind(this)),o=s;for(;s&&!I(s,"se-wrapper")&&s!==n;)e+=s.offsetLeft-(o!==s?s.scrollLeft:0),i+=s.offsetTop+(o!==s?s.scrollTop:0),s=s.offsetParent;return{left:e,top:i-(n?n.scrollTop:0)}},getGlobal(e){const i=this.editor.frameContext.get("topArea"),s=this.editor.frameContext.get("wysiwygFrame");let n=!1,o=!1;e||(e=i),e===i&&(n=!0),n||1!==e.nodeType||(o="absolute"===t.getComputedStyle(e).position);const l=e.offsetWidth,r=e.offsetHeight;let a=0,h=0,c=0,d=0;for(;e;)a+=e.offsetTop,h+=e.offsetLeft,c+=e.scrollTop,d+=e.scrollLeft,e=e.offsetParent;if(!o&&!n&&/^iframe$/i.test(s.nodeName)&&s.contains(e))for(e=this.editor.frameContext.get("wrapper");e;)a+=e.offsetTop,h+=e.offsetLeft,e=e.offsetParent;return{top:a+c,left:h+d,width:l,height:r,scrollTop:c,scrollLeft:d}},getGlobalScroll(e){const i=this.editor.frameContext.get("topArea");let s=!1,n=!1;e||(e=i),e===i&&(s=!0),s||1!==e.nodeType||(n="absolute"===t.getComputedStyle(e).position);let o=0,l=0,r=0,a=0,h=0,c=0,d=0,u=0,p=null,g=null,m=null,f=null,_=e;for(;_;)o+=_.scrollTop,l+=_.scrollLeft,r+=_.scrollHeight,a+=_.scrollWidth,_.scrollTop>0&&(c+=_.offsetTop),_.scrollHeight>_.clientHeight&&(d=/^html$/i.test(_.nodeName)?d||_.clientHeight:_.clientHeight+(m?-m.clientTop:0),p=m||p||_,m=_),_.scrollLeft>0&&(h+=_.offsetLeft),_.scrollWidth>_.clientWidth&&(u=/^html$/i.test(_.nodeName)?u||_.clientWidth:_.clientWidth+(f?-f.clientLeft:0),g=f||g||_,f=_),_=_.parentElement;if(!n&&!s&&/^iframe$/i.test(this.editor.frameContext.get("wysiwygFrame").nodeName))for(_=this.editor.frameContext.get("wrapper"),p=g=i;_;)o+=_.scrollTop,l+=_.scrollLeft,r+=_.scrollHeight,a+=_.scrollWidth,_.scrollTop>0&&(c+=_.offsetTop),_.scrollHeight>_.clientHeight&&(d=/^html$/i.test(_.nodeName)?d||_.clientHeight:_.clientHeight+(m?-m.clientTop:0),m=_),_.scrollLeft>0&&(h+=_.offsetLeft),_.scrollWidth>_.clientWidth&&(u=/^html$/i.test(_.nodeName)?u||_.clientWidth:_.clientWidth+(f?-f.clientLeft:0),f=_),_=_.parentElement;for(_=this._shadowRoot?.host,_&&(p=g=i);_;)o+=_.scrollTop,l+=_.scrollLeft,r+=_.scrollHeight,a+=_.scrollWidth,_.scrollTop>0&&(c+=_.offsetTop),_.scrollHeight>_.clientHeight&&(d=/^html$/i.test(_.nodeName)?d||_.clientHeight:_.clientHeight+(m?-m.clientTop:0),m=_),_.scrollLeft>0&&(h+=_.offsetLeft),_.scrollWidth>_.clientWidth&&(u=/^html$/i.test(_.nodeName)?u||_.clientWidth:_.clientWidth+(f?-f.clientLeft:0),f=_),_=_.parentElement;const b=i.contains(p),v=i.contains(g);p=b?i:p,g=v?i:g;const y=p?p.getBoundingClientRect().top+(!p.parentElement||/^html$/i.test(p.parentElement.nodeName)?t.scrollY:0):0,w=g?g.getBoundingClientRect().left+(!g.parentElement||/^html$/i.test(g.parentElement.nodeName)?t.scrollX:0):0;d=b?i.clientHeight:d,u=v?i.clientWidth:u;const C=W(this.editor.frameContext.get("_wd"));return{top:o,ts:y,left:l,ls:w,width:a,height:r,x:h,y:c,ohOffsetEl:n?window:p,owOffsetEl:n?window:g,oh:n?C.h:d,ow:n?C.w:u,heightEditorRefer:b,widthEditorRefer:v}},getWWScroll(){const t=this.editor.frameContext.get("wysiwyg"),e=this.editor.selection.getRects(t,"start").rects,i=t.scrollY||t.scrollTop||0,s=t.scrollHeight||0;return{top:i,left:t.scrollX||t.scrollLeft||0,width:t.scrollWidth||0,height:s,bottom:i+s,rects:e}},setRelPosition(e,i,s,n,o){this._scrollY=t.scrollY;let l=0,r=n;do{if(this._isFixed=/^fixed$/i.test(t.getComputedStyle(r).position)){l+=this._scrollY;break}}while(!X.hasClass(r,"sun-editor")&&(r=r.parentElement));o||(this.__removeGlobalEvent(),this._scrollEvent=this.editor.eventManager.addGlobalEvent("scroll",is.bind(this,e,i,s,n),!1));const a=e.offsetWidth,h=s.offsetWidth,c=this.getGlobal(s).left,d=this.getGlobal(n).left;if(this.options.get("_rtl")){const t=a>h?a-h:0,i=t>0?0:h-a;e.style.left=`${c-t+i+d}px`,d>this.getGlobal(e).left&&(e.style.left=d+"px")}else{const t=n.offsetWidth,i=t<=a?0:t-(c+a);e.style.left=i<0?`${c+i+d}px`:`${c}px`}const u=n.contains(e)?this.getGlobal(i).top:0,p=e.offsetHeight,g=this.getGlobalScroll().top;let m=l,f=s;for(;f&&f!==i;)m+=f.offsetTop,f=f.offsetParent;const _=W(this.editor.frameContext.get("_wd")).h-(u-g+m+s.offsetHeight);if(_<p){let t=-1*(p-m+3);const i=u-g+t,n=p+(i<0?i:0);n>_?(e.style.height=`${n}px`,t=-1*(n-m+3)):(e.style.height=`${_}px`,t=m+s.offsetHeight),e.style.top=`${t}px`}else e.style.top=`${m+s.offsetHeight}px`;this._isFixed&&(this._elTop=e.offsetTop)},setAbsPosition(i,s,n){const o=n.addOffset||{left:0,top:0},l=n.position||"bottom",r=n.inst,a=!this.options.get("_rtl");a||(o.left*=-1);const h=this.editor.frameContext.get("wrapper").contains(s)||n.isWWTarget,c=X.getParentElement(s,".se-controller"),d=h&&!c,u=W(e),p=d?this.getWWScroll():this._getWindowScroll(),g=c?s.getBoundingClientRect():this.editor.selection.getRects(s,"start").rects,m=this.getGlobal(s),f=I(i.firstElementChild,"se-arrow")?i.firstElementChild:null,_=d&&this.editor.frameOptions.get("iframe"),b=f?f.offsetHeight:0,v=i.offsetHeight,y=s.offsetHeight,w=g.top,C=u.h-g.bottom;let x,S,E=this.editor.toolbar._sticky||!this.editor.isBalloon&&!this.editor.isInline?this.context.get("toolbar.main").offsetHeight:0,T=0;if(this.editor.frameContext.get("isFullScreen"))x=w-E,S=C;else{const e=g.top,i=u.h-g.bottom,s=this.getGlobal(),n=this.getGlobalScroll(),o=this.editor.frameContext.get("statusbar")?.offsetHeight||0;if(_){const t=s.top-n.top-n.ts,e=this.editor.frameContext.get("topArea").offsetHeight;x=g.top-t,S=i-(n.oh-(e+t)+o)}else{T=this.editor.toolbar._sticky||this.options.get("toolbar_container")?0:E;const e=!d&&/\d+/.test(this.editor.frameOptions.get("height"))?s.top-t.scrollY+T:0,i=!d&&/\d+/.test(this.editor.frameOptions.get("height"))?t.innerHeight-(s.top+s.height-t.scrollY):0;let n=e;E>e?this.editor.toolbar._sticky?(n=E,E=0):n=e+E:this.options.get("toolbar_container")?E=0:n=e+(this.editor.toolbar._sticky?E:0),x=g.top-n,S=p.rects.bottom-g.bottom-i-o}x=(x>0?e:x)-E,S=S>0?i:S}if(h&&(S+y<=0||x+T+y<=0))return;let k=o.top,N=0,H="";"bottom"===l?(H="up",k+=g.bottom+b+t.scrollY,N=S-(v+b),N<0&&(H="down",k-=y+v+2*b,N=E+x-(v+b),N<0&&(H="",k-=N))):(H="down",k+=g.top-v-b+t.scrollY,N=x-(v+b),N<0&&(H="up",k+=y+v+2*b,N=S-(v+b),N<0&&(H="",k+=N))),this._setArrow(f,H),i.style.top=`${k}px`;const L=(1===i.nodeType?j.get(t.getComputedStyle(i).borderRadius):0)||0,M=m.width,B=i.offsetWidth,A=f?f.offsetWidth:0,V=g.left,R=u.w-g.right;let z,O;if(this.editor.frameContext.get("isFullScreen")?(z=V,O=R):(z=g.left,O=u.w-g.right),h&&(z+M<=0||O+M<=0))return;f&&(f.style.left="",f.style.right="");let $=o.left,P=0,D=0,F=0;return a?($+=g.left+t.scrollX-(z<0?z:0),P=M+z,P<A&&(F=A/2-1+(L<=2?0:L-2),D=F),P=M+O-B,P<0&&($+=P,F=B-1-(A/2+(L<=2?0:L-2)),D=-(P-A/2),D=D>F?F:D),f&&D>0&&(f.style.left=D+"px")):($+=g.right-B+t.scrollX+(O<0?O:0),P=M+O,P<A&&(F=A/2-1+(L<=2?0:L-2),D=F),P=M+z-B,P<0&&($-=P,F=A/2-1+(L<=2?0:L-2),D=-(P-A/2),D=D<F?F:D>B-F?B-F:D),f&&D>0&&(f.style.right=D+"px")),i.style.left=`${$}px`,r.__offset={left:i.offsetLeft+p.left,top:i.offsetTop+p.top,addOffset:o},!0},_setArrow(t,e){"up"===e?(t&&(t.style.visibility=""),R(t,"se-arrow-up"),z(t,"se-arrow-down")):"down"===e?(t&&(t.style.visibility=""),R(t,"se-arrow-down"),z(t,"se-arrow-up")):t&&(t.style.visibility="hidden")},_getWindowScroll(){const e=X.getClientSize();return{top:t.scrollY,left:t.scrollX,width:e.w,height:e.h,rects:{left:0,top:0,right:t.innerWidth,bottom:t.innerHeight,noText:!0}}},__removeGlobalEvent(){this._scrollEvent&&(this._scrollEvent=this.editor.eventManager.removeGlobalEvent(this._scrollEvent),this._scrollY=0,this._elTop=null)},constructor:es};const ss=es,ns=function(t){Ht.call(this,t),this.range=null,this.selectionNode=null};ns.prototype={get(){const t=this._shadowRoot?.getSelection()||this.editor.frameContext.get("_ww").getSelection();return t?(this.status._range||this.editor.frameContext.get("wysiwyg").contains(t.focusNode)||(t.removeAllRanges(),t.addRange(this._createDefaultRange())),t):null},getRange(){const t=this.status._range||this._createDefaultRange(),e=this.get();if(t.collapsed===e.isCollapsed||!this.editor.frameContext.get("wysiwyg").contains(e.focusNode)){if(this.component.is(t.startContainer)){const e=this.component.get(t.startContainer),i=e?.container;return i?this.setRange(i,0,i,1):t}return t}if(e.rangeCount>0)return this.status._range=e.getRangeAt(0),this.status._range;{const t=e.anchorNode,i=e.focusNode,s=e.anchorOffset,n=e.focusOffset,o=X.compareElements(t,i),l=o.ancestor&&(0===o.result?s<=n:o.result>1);return this.setRange(l?t:i,l?s:n,l?i:t,l?n:s)}},setRange(t,e,i,s){if(!t||!i)return;e>t.textContent.length&&(e=t.textContent.length),s>i.textContent.length&&(s=i.textContent.length),this.format.isLine(t)&&(t=t.childNodes[e>0?t.childNodes.length-1:0]||t,e=e>0?1!==t.nodeType||X.isBreak(t)?t.textContent?t.textContent.length:0:1:0),this.format.isLine(i)&&(i=i.childNodes[s>0?i.childNodes.length-1:0]||i,s=s>0?1!==i.nodeType||X.isBreak(i)?i.textContent?i.textContent.length:0:1:0);const n=this.editor.frameContext.get("_wd").createRange();try{n.setStart(t,e),n.setEnd(i,s)}catch(t){return console.warn("[SUNEDITOR.selection.focus.warn]",t.message),void this.editor._nativeFocus()}const o=this.get();return o.removeAllRanges&&o.removeAllRanges(),o.addRange(n),this.status._range=n,this._rangeInfo(n,this.get()),this.editor.frameOptions.get("iframe")&&this.__focus(),n},removeRange(){this.status._range=null,this.selectionNode=null,this.status.hasFocus&&this.get().removeAllRanges(),this.eventManager._setKeyEffect([])},getRangeAndAddLine(t,e){if(this._isNone(t)){const i=e?.parentElement||this.editor.frameContext.get("wysiwyg"),s=X.createElement(this.options.get("defaultLine"),null,"<br>");i.insertBefore(s,e&&e!==i?e.previousElementSibling?e.nextElementSibling:e:i.firstElementChild),this.setRange(s.firstElementChild,0,s.firstElementChild,1),t=this.status._range}return t},getNode(){if(this.editor.frameContext.get("wysiwyg").contains(this.selectionNode)||this._init(),!this.selectionNode){const t=X.getEdgeChild(this.editor.frameContext.get("wysiwyg").firstChild,(function(t){return 0===t.childNodes.length||3===t.nodeType}),!1);if(t)return this.selectionNode=t,t;this._init()}return this.selectionNode},getRects(t,e){const i=1===t?.nodeType&&"absolute"===this._w.getComputedStyle(t).position;t=t&&3!==t.nodeType?t:this.getRange();const s=this.offset.getGlobalScroll();let n="start"===e,o=s.left,l=s.top,r=t.getClientRects();if(r=r[n?0:r.length-1],!r){const t=this.getNode();if(this.format.isLine(t)){const t=X.createTextNode(G.zeroWidthSpace);this.html.insertNode(t,null,!0),this.setRange(t,1,t,1),this._init(),r=this.getRange().getClientRects(),r=r[n?0:r.length-1]}if(!r){const e=this.offset.get(t);r={left:e.left,top:e.top,right:e.right,bottom:e.top+t.offsetHeight,noText:!0},o=0,l=0}n=!0}const a=/^iframe$/i.test(this.editor.frameContext.get("wysiwygFrame").nodeName)?this.editor.frameContext.get("wysiwygFrame").getClientRects()[0]:null;return!i&&a&&(r={left:r.left+a.left,top:r.top+a.top,right:r.right+a.right-a.width,bottom:r.bottom+a.bottom-a.height}),{rects:r,position:n?"start":"end",scrollLeft:o,scrollTop:l}},getEventLocationRange(t){let e,i,s,n;if(t.rangeParent)e=t.rangeParent,i=t.rangeOffset,s=t.rangeParent,n=t.rangeOffset;else if(this.editor.frameContext.get("_wd").caretRangeFromPoint){let o=this.editor.frameContext.get("_wd").caretRangeFromPoint(t.clientX,t.clientY);o||(o=this.getRange()),e=o.startContainer,i=o.startOffset,s=o.endContainer,n=o.endOffset}else{const t=this.getRange();e=t.startContainer,i=t.startOffset,s=t.endContainer,n=t.endOffset}return{sc:e,so:i,ec:s,eo:n}},scrollTo(t){t instanceof ns?t=t.getRangeAt(0):t instanceof Node?t=this.setRange(t,1,t,1):void 0===t?.startContainer&&console.warn('[SUNEDITOR.html.scrollTo.warn] "selectionRange" must be Selection or Range or Node object.',t);const e=t.getBoundingClientRect();e.top>=0&&e.bottom<=this.editor.frameContext.get("wysiwygFrame").innerHeight||t.startContainer?.scrollIntoView?.({behavior:"auto",block:"nearest"})},_isNone(t){const e=t.commonAncestorContainer;return X.isWysiwygFrame(t.startContainer)&&X.isWysiwygFrame(t.endContainer)||/FIGURE/i.test(e.nodeName)||this.editor._fileManager.regExp.test(e.nodeName)&&(!this.editor._fileManager.tagAttrs[e.nodeName]||this.editor._fileManager.tagAttrs[e.nodeName]?.every((t=>e.hasAttribute(t))))||this.component.is(e)},_createDefaultRange(){const t=this.editor.frameContext.get("wysiwyg"),e=this.editor.frameContext.get("_wd").createRange();let i=t.firstElementChild,s=null;return i?(s=i.firstChild,s||(s=X.createElement("BR"),i.appendChild(s))):(s=X.createElement("BR"),i=X.createElement(this.options.get("defaultLine"),null,s),t.appendChild(i)),e.setStart(s,0),e.setEnd(s,0),e},_rangeInfo(t,e){let i=null;this.status._range=t,i=t.collapsed?X.isWysiwygFrame(t.commonAncestorContainer)&&t.commonAncestorContainer.children[t.startOffset]||t.commonAncestorContainer:e.extentNode||e.anchorNode,this.selectionNode=i},_init(){const t=this.editor.frameContext.get("_wd").activeElement;if(X.isInputElement(t))return this.selectionNode=t,t;const e=this.get();if(!e)return null;let i=null;i=e.rangeCount>0?e.getRangeAt(0):this._createDefaultRange(),this._rangeInfo(i,e)},__focus(){const t=X.getParentElement(this.getNode(),"figcaption");t?t.focus():this.editor.frameContext.get("wysiwyg").focus()},_resetRangeToTextNode(){let t=this.getRange();if(this._isNone(t)){if(!X.isWysiwygFrame(t.startContainer)||!X.isWysiwygFrame(t.endContainer))return!1;const e=t.commonAncestorContainer,i=e.children[t.startOffset],s=e.children[t.endOffset];t=this.setRange(i,0,s,i===s?0:1)}const e=t;let i,s,n,o=e.startContainer,l=e.startOffset,r=e.endContainer,a=e.endOffset;if(this.format.isLine(o))for(o.childNodes[l]?(o=o.childNodes[l]||o,l=0):(o=o.lastChild||o,l=o.textContent.length);1===o?.nodeType&&o.firstChild;)o=o.firstChild||o,l=0;if(this.format.isLine(r)){for(r=r.childNodes[a]||r.lastChild||r;1===r?.nodeType&&r.lastChild;)r=r.lastChild;a=r.textContent.length}if(i=X.isWysiwygFrame(o)?this.editor.frameContext.get("wysiwyg").firstChild:o,s=l,X.isBreak(i)||1===i.nodeType&&i.childNodes.length>0){const t=X.isBreak(i);if(!t){const t=i;for(;i&&!X.isBreak(i)&&1===i.nodeType&&(n=i.childNodes,0!==n.length);)i=n[s>0?s-1:s]||!/FIGURE/i.test(n[0].nodeName)?n[0]:i.previousElementSibling||i.previousSibling||o,s=s>0?i.textContent.length:s;let e=this.format.getLine(i,null);e===this.format.getBlock(e,null)&&(i=i||t,e=X.createElement(X.getParentElement(i,X.isTableCell)?"DIV":this.options.get("defaultLine")),i.parentNode.insertBefore(e,i),i!==t&&e.appendChild(i))}if(X.isBreak(i)||this.component.is(i)){const e=X.createTextNode(G.zeroWidthSpace);i.parentNode.insertBefore(e,i),i=e,t&&o===r&&(r=i,a=1)}}if(o=i,l=s,i=X.isWysiwygFrame(r)?this.editor.frameContext.get("wysiwyg").lastChild:r,s=a,X.isBreak(i)||1===i.nodeType&&i.childNodes.length>0){const t=X.isBreak(i);if(!t){for(;i&&!X.isBreak(i)&&1===i.nodeType&&(n=i.childNodes,0!==n.length);)i=n[s>0?s-1:s]||!/FIGURE/i.test(n[0].nodeName)?n[0]:i.previousElementSibling||i.previousSibling||o,s=s>0?i.textContent.length:s;let t=this.format.getLine(i,null);t===this.format.getBlock(t,null)&&(t=X.createElement(X.isTableCell(t)?"DIV":this.options.get("defaultLine")),i.parentNode.insertBefore(t,i),t.appendChild(i))}if(X.isBreak(i)){const e=X.createTextNode(G.zeroWidthSpace);i.parentNode.insertBefore(e,i),i=e,s=1,t&&!i.previousSibling&&X.removeItem(r)}}return r=i,a=s,this.setRange(o,l,r,a),!0},constructor:ns};const os=ns,ls=function(t){this.editor=t,this.isDisabled=!1};ls.prototype={command(t,e){if(this.isDisabled)return!1;const i=this.editor.shortcutsKeyMap.get(t+(e?1e3:0));return!(!i||!e&&i.s||(this.editor.run(i.c,i.t,i.e),0))},disable(){this.isDisabled=!0},enable(){this.isDisabled=!1},constructor:ls};const rs=ls,{_w:as,_d:hs}=q,cs=function(t,{keyName:e,balloon:i,inline:s,balloonAlways:n,res:o}){Ht.call(this,t),this.keyName=e,this.isSub=/sub/.test(e),this.currentMoreLayerActiveButton=null,this._isBalloon=i,this._isInline=s,this._isBalloonAlways=n,this._responsiveCurrentSize="default",this._originRes=o,this._rButtonArray=o,this._rButtonsize=null,this._sticky=!1,this._isViewPortSize="visualViewport"in as,this._inlineToolbarAttr={top:"",width:"",isShow:!1},this._balloonOffset={top:0,left:0},this._setResponsive()};cs.prototype={disable(){this._moreLayerOff(),this.menu.dropdownOff(),this.menu.containerOff(),X.setDisabled(this.context.get(this.keyName+".buttonTray").querySelectorAll(".se-menu-list .se-toolbar-btn[data-type]"),!0)},enable(){X.setDisabled(this.context.get(this.keyName+".buttonTray").querySelectorAll(".se-menu-list .se-toolbar-btn[data-type]"),!1)},show(){this._isInline?this._showInline():this._isBalloon?this._showBalloon():(this.context.get(this.keyName+".main").style.display="",this.isSub||(this.editor.frameContext.get("_stickyDummy").style.display="")),this.isSub||this.resetResponsiveToolbar()},hide(){this._isInline?(this.context.get(this.keyName+".main").style.display="none",this.context.get(this.keyName+".main").style.top="0px",this._inlineToolbarAttr.isShow=!1):(this.context.get(this.keyName+".main").style.display="none",this.isSub||(this.editor.frameContext.get("_stickyDummy").style.display="none"),this.editorisBalloon&&(this._balloonOffset={top:0,left:0}))},_visible(t){const e=this.context.get(this.keyName+".main");t?X.removeClass(e,"se-toolbar-onscroll-hide"):X.addClass(e,"se-toolbar-onscroll-hide")},resetResponsiveToolbar(){this.menu.containerOff();const t=this._rButtonsize;if(t){let e=0;e=(this._isBalloon||this._isInline)&&"auto"===this.options.get("toolbar_width")||this._isSubBalloon&&"auto"===this.options.get("toolbar.sub_width")?this.editor.frameContext.get("topArea").offsetWidth:this.context.get(this.keyName+".main").offsetWidth;let i="default";for(let s=1,n=t.length;s<n;s++)if(e<t[s]){i=t[s]+"";break}this._responsiveCurrentSize!==i&&(this._responsiveCurrentSize=i,this.setButtons(this._rButtonArray[i]))}},setButtons(t){this._moreLayerOff(),this.menu.dropdownOff(),this.menu.containerOff();const{options:e,icons:i,lang:s,isSub:n}=this,o=St(t,this.plugins,e,i,s,!0),l=e.get("shortcuts");let r;o.updateButtons.forEach((t=>xt(t.button,t.plugin,this.icons,this.lang,l[t.key]))),r=n?this.editor.subAllCommandButtons=new Map:this.editor.allCommandButtons=new Map,this.editor.commandTargets=new Map,this.editor.__saveCommandButtons(r,o.buttonTray),this.context.get(this.keyName+".main").replaceChild(o.buttonTray,this.context.get(this.keyName+".buttonTray")),this.context.set(this.keyName+".buttonTray",o.buttonTray),this.editor.__setDisabledButtons(),this.history.resetButtons(this.editor.frameContext.get("key"),null),this._resetSticky(),this.editor.effectNode=null,this.viewer._setButtonsActive(),this.status.hasFocus&&this.eventManager.applyTagEffect(),this.editor.frameContext.get("isReadOnly")&&X.setDisabled(this.editor._controllerOnDisabledButtons,!0),this.triggerEvent("onSetToolbarButtons",{buttonTray:o.buttonTray,frameContext:this.editor.frameContext})},_resetSticky(){const t=this.context.get(this.keyName+".main");if(this.editor.frameContext.get("isFullScreen")||0===t.offsetWidth||this.options.get("toolbar_sticky")<0)return;const e=this._isViewPortSize?as.visualViewport.pageTop:as.scrollY,i=this.editor.frameContext.get("_minHeight"),s=this.editor.frameContext.get("wrapper").offsetHeight,n=this.offset.getGlobal(this.editor.frameContext.get("topArea")),o=e+this.options.get("toolbar_sticky"),l=(this._isBalloon||this._isInline?n.top:this.offset.getGlobal(this.options.get("toolbar_container")).top)-(this._isInline?t.offsetHeight:0),r=this.options.get("toolbar_container")?n.top-e+s-i-this.options.get("toolbar_sticky")-t.offsetHeight:s+l+this.options.get("toolbar_sticky")-o-i;o<l?this._offSticky():r<0?(this._sticky||this._onSticky(1),t.style.top=1+r+this.__getViewportTop()+"px"):this._onSticky(1)},_onSticky(t){const e=this.context.get(this.keyName+".main");if(!this._isInline){const t=this.options.get("toolbar_container")?this.context.get("_stickyDummy"):this.editor.frameContext.get("_stickyDummy");t.style.height=e.offsetHeight+"px",t.style.display="block"}const i=this.options.get("toolbar_sticky")+t+this.__getViewportTop();e.style.top=`${i}px`,e.style.width=this._isInline?this._inlineToolbarAttr.width:e.offsetWidth+"px",X.addClass(e,"se-toolbar-sticky"),this._sticky=!0},__getViewportTop(){return this._isViewPortSize?as.visualViewport.offsetTop:0},_offSticky(){(this.options.get("toolbar_container")?this.context.get("_stickyDummy"):this.editor.frameContext.get("_stickyDummy")).style.display="none";const t=this.context.get(this.keyName+".main");t.style.top=this._isInline?this._inlineToolbarAttr.top:"",t.style.width=this._isInline?this._inlineToolbarAttr.width:"",this.editor.frameContext.get("wrapper").style.marginTop="",X.removeClass(t,"se-toolbar-sticky"),this._sticky=!1},_setResponsive(){if(0===this._rButtonArray?.length)return void(this._rButtonArray=null);this._responsiveCurrentSize="default";const t=this._rButtonsize=[],e=this._originRes,i=this._rButtonArray={default:e[0]};for(let s,n,o=1,l=e.length;o<l;o++)n=e[o],s=1*n[0],t.push(s),i[s]=n[1];t.sort((function(t,e){return t-e})).unshift("default")},_showBalloon(t){if(!this._isBalloon||this.editor.opendControllers.length>0)return;this.isSub&&this.resetResponsiveToolbar();const e=t||this.selection.getRange(),i=this.context.get(this.keyName+".main"),s=this.selection.get();let n;if(this._isBalloonAlways&&e.collapsed)n=!0;else if(s.focusNode===s.anchorNode)n=s.focusOffset<s.anchorOffset;else{const t=X.getListChildNodes(e.commonAncestorContainer,null);n=X.getArrayIndex(t,s.focusNode)<X.getArrayIndex(t,s.anchorNode)}i.style.top="-10000px","block"!==i.style.display&&(i.style.visibility="hidden",i.style.display="block"),this._setBalloonOffset(n,e),this.triggerEvent("onShowToolbar",{toolbar:i,mode:"balloon",frameContext:this.editor.frameContext}),as.setTimeout((()=>{i.style.visibility=""}),0)},_setBalloonOffset(t,e){const i=this.editor.frameContext.get("isFullScreen");e=e||this.selection.getRange();const s=this.selection.getRects(e,t?"start":"end");t="start"===s.position;const n=this.context.get(this.keyName+".main"),o=this.editor.frameContext.get("topArea"),l=s.rects,r=i?0:s.scrollLeft,a=i?0:s.scrollTop,h=o.offsetWidth,c=this.offset.getGlobal(o),d=c.top,u=c.left,p=n.offsetWidth,g=n.offsetHeight;if(this._setBalloonPosition(t,l,n,u,h,r,a,d),this.isSub&&this.offset.getGlobal(n).top-c.top<0&&(t=!t,this._setBalloonPosition(t,l,n,u,h,r,a,d)),p===n.offsetWidth&&g===n.offsetHeight||this._setBalloonPosition(t,l,n,u,h,r,a,d),this.options.get("toolbar_container")){const t=o.parentElement;let e=this.options.get("toolbar_container"),i=e.offsetLeft,s=e.offsetTop;for(;!e.parentElement.contains(t)||!/^(BODY|HTML)$/i.test(e.parentElement.nodeName);)e=e.offsetParent,i+=e.offsetLeft,s+=e.offsetTop;n.style.left=n.offsetLeft-i+o.offsetLeft+"px",n.style.top=n.offsetTop-s+o.offsetTop+"px"}const m=this.offset.getWWScroll();this._balloonOffset={top:n.offsetTop+m.top,left:n.offsetLeft+m.left,position:t?"top":"bottom"}},_setBalloonPosition(t,e,i,s,n,o,l,r){const a=this.context.get(this.keyName+"._arrow"),h=Math.round(a.offsetWidth/2),c=i.offsetWidth,d=e.noText&&!t?0:i.offsetHeight,u=(t?e.left:e.right)-s-c/2+o,p=u+c-n;let g=(t?e.top-d-h:e.bottom+h)-(e.noText?0:r)+l;const m=u<0?1:p<0?u:u-p-1-1;let f=!1;const _=g+(t?this.offset.getGlobal(this.editor.frameContext.get("topArea")).top:i.offsetHeight-this.editor.frameContext.get("wysiwyg").offsetHeight);!t&&_>0&&this._getPageBottomSpace()<_?(t=!0,f=!0):t&&hs.documentElement.offsetTop>_&&(t=!1,f=!0),f&&(g=(t?e.top-d-h:e.bottom+h)-(e.noText?0:r)+l),i.style.left=Math.floor(m)+"px",i.style.top=Math.floor(g)+"px",t?(X.removeClass(a,"se-arrow-up"),X.addClass(a,"se-arrow-down")):(X.removeClass(a,"se-arrow-down"),X.addClass(a,"se-arrow-up"));const b=Math.floor(c/2+(u-m));a.style.left=(b+h>i.offsetWidth?i.offsetWidth-h:b<h?h:b)+"px"},_getPageBottomSpace(){const t=this.editor.frameContext.get("topArea");return hs.documentElement.scrollHeight-(this.offset.getGlobal(t).top+t.offsetHeight)},_showInline(){if(!this._isInline)return;const t=this.context.get(this.keyName+".main");t.style.visibility="hidden",this._offSticky(),t.style.display="block",t.style.top="0px",this._inlineToolbarAttr.width=t.style.width=this.options.get(this.keyName+"_width"),this._inlineToolbarAttr.top=t.style.top=this.offset.getGlobal(this.editor.frameContext.get("topArea")).top-this.offset.getGlobal(t).top-t.offsetHeight-1+"px",this._resetSticky(),this._inlineToolbarAttr.isShow=!0,this.triggerEvent("onShowToolbar",{toolbar:t,mode:"inline"}),t.style.visibility=""},_moreLayerOn(t,e){this._moreLayerOff(),this.currentMoreLayerActiveButton=t,e.style.display="block"},_moreLayerOff(){this.currentMoreLayerActiveButton&&(this.context.get(this.keyName+".main").querySelector("."+this.currentMoreLayerActiveButton.getAttribute("data-command")).style.display="none",X.removeClass(this.currentMoreLayerActiveButton,"on"),this.currentMoreLayerActiveButton=null)},constructor:cs};const ds=cs,us=function(t){Ht.call(this,t),this.bodyOverflow="",this.editorAreaOriginCssText="",this.wysiwygOriginCssText="",this.codeWrapperOriginCssText="",this.codeOriginCssText="",this.codeNumberOriginCssText="",this.toolbarOriginCssText="",this.arrowOriginCssText="",this.fullScreenInnerHeight=0,this.fullScreenSticky=!1,this.fullScreenBalloon=!1,this.fullScreenInline=!1,this.toolbarParent=null};function ps(t){let e=q._w.getComputedStyle(t).lineHeight;if(j.is(e))e=j.get(e);else{const i=q._w.getComputedStyle(t).fontSize;e=1.2*j.get(i)}return e}us.prototype={codeView(t){const e=this.editor.frameContext;if(void 0===t&&(t=!e.get("isCodeView")),t===e.get("isCodeView"))return;e.set("isCodeView",t),this.editor._offCurrentController(),this.editor._offCurrentModal();const i=e.get("codeWrapper"),s=e.get("code"),n=e.get("wysiwygFrame");t?(this._setEditorDataToCodeView(),i.style.setProperty("display","flex","important"),n.style.display="none",e.get("isFullScreen")?s.style.height="100%":"auto"!==this.editor.frameOptions.get("height")||this.options.get("hasCodeMirror")||(s.style.height=s.scrollHeight>0?s.scrollHeight+"px":"auto"),this.options.get("hasCodeMirror")&&this._codeMirrorEditor("refresh",null,null),e.get("isFullScreen")||(this.editor._notHideToolbar=!0,this.editor.isBalloon&&(this.context.get("toolbar._arrow").style.display="none",this.context.get("toolbar.main").style.left="",this.editor.isInline=this.toolbar._isInline=!0,this.editor.isBalloon=this.toolbar._isBalloon=!1,this.toolbar._showInline())),this.editor.isSubBalloon&&this.subToolbar.hide(),function(t){const e=t.get("codeNumbers");if(!e)return;const i=ps(e),s=t.get("code").scrollHeight/i;let n="";for(let t=1;t<=s;t++)n+=`${t}\n`;const{padding:o,margin:l}=q._w.getComputedStyle(t.get("code"));e.value=n,e.style.padding=o||"",e.style.margin=l||""}(e),this.status._range=null,s.focus(),X.addClass(this.editor.commandTargets.get("codeView"),"active")):(X.isNonEditable(n)||this._setCodeDataToEditor(),n.scrollTop=0,i.style.setProperty("display","none","important"),n.style.display="block","auto"!==this.editor.frameOptions.get("height")||this.options.get("hasCodeMirror")||(e.get("code").style.height="0px"),e.get("isFullScreen")||(this.editor._notHideToolbar=!1,/balloon/.test(this.options.get("mode"))&&(this.context.get("toolbar._arrow").style.display="",this.editor.isInline=this.toolbar._isInline=!1,this.editor.isBalloon=this.toolbar._isBalloon=!0,this.eventManager._hideToolbar())),this.editor._nativeFocus(),X.removeClass(this.editor.commandTargets.get("codeView"),"active"),X.isNonEditable(n)||(this.history.push(!1),this.history.resetButtons(e.get("key"),null))),this.editor._checkPlaceholder(),X.setDisabled(this.editor._codeViewDisabledButtons,t),this.triggerEvent("onToggleCodeView",{frameContext:e,is:e.get("isCodeView")})},fullScreen(t){const e=this.editor.frameContext;if(void 0===t&&(t=!e.get("isFullScreen")),t===e.get("isFullScreen"))return;e.set("isFullScreen",t);const i=e.get("topArea"),s=this.context.get("toolbar.main"),n=e.get("wrapper"),o=e.get("wysiwygFrame"),l=e.get("codeWrapper"),r=e.get("code"),a=e.get("codeNumbers"),h=this.editor.frameContext.get("isCodeView"),c=this.context.get("toolbar._arrow");this.editor._offCurrentController();const d="none"===s.style.display||this.editor.isInline&&!this.editor.toolbar._inlineToolbarAttr.isShow;if(t){this._originCssText=i.style.cssText,this.editorAreaOriginCssText=n.style.cssText,this.wysiwygOriginCssText=o.style.cssText,this.codeWrapperOriginCssText=l.style.cssText,this.codeOriginCssText=r.style.cssText,this.codeNumberOriginCssText=a?.style.cssText,this.toolbarOriginCssText=s.style.cssText,c&&(this.arrowOriginCssText=c.style.cssText),(this.editor.isBalloon||this.editor.isInline)&&(c&&(c.style.display="none"),this.fullScreenInline=this.editor.isInline,this.fullScreenBalloon=this.editor.isBalloon,this.editor.isInline=this.toolbar._isInline=!1,this.editor.isBalloon=this.toolbar._isBalloon=!1),this.options.get("toolbar_container")&&(this.toolbarParent=s.parentElement,e.get("container").insertBefore(s,n)),i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.maxWidth="100%",i.style.height="100%",i.style.zIndex="2147483646","none"!==e.get("_stickyDummy").style.display&&""!==e.get("_stickyDummy").style.display&&(this.fullScreenSticky=!0,e.get("_stickyDummy").style.display="none",X.removeClass(s,"se-toolbar-sticky")),this.bodyOverflow=this._d.body.style.overflow,this._d.body.style.overflow="hidden",n.style.cssText=s.style.cssText="",o.style.cssText=(o.style.cssText.match(/\s?display(\s+)?:(\s+)?[a-zA-Z]+;/)||[""])[0]+this.editor.frameOptions.get("_defaultStyles").editor+(h?"display: none;":""),l.style.cssText=(l.style.cssText.match(/\s?display(\s+)?:(\s+)?[a-zA-Z]+;/)||[""])[0]+`display: ${h?"flex":"none"} !important;`,l.style.overflow="auto",l.style.height="100%",r.style.height="",s.style.width=o.style.height="100%",s.style.position="relative",s.style.display="block",this.fullScreenInnerHeight=this._w.innerHeight-s.offsetHeight,n.style.height=this.fullScreenInnerHeight-(e.has("statusbar")?e.get("statusbar").offsetHeight:0)-this.options.get("fullScreenOffset")+"px",this.editor.frameOptions.get("iframe")&&"auto"===this.editor.frameOptions.get("height")&&(n.style.overflow="auto",this.editor._iframeAutoHeight(e)),e.get("topArea").style.marginTop=this.options.get("fullScreenOffset")+"px";const t=this.icons.reduction;this.editor.applyCommandTargets("fullScreen",(e=>{X.changeElement(e.firstElementChild,t),X.addClass(e,"active")}))}else{o.style.cssText=this.wysiwygOriginCssText.replace(/\s?display(\s+)?:(\s+)?[a-zA-Z]+;/,"")+(h?"display: none;":""),l.style.cssText=this.codeWrapperOriginCssText.replace(/\s?display(\s+)?:(\s+)?[a-zA-Z]+;/,"")+`display: ${h?"flex":"none"} !important;`,r.style.cssText=this.codeOriginCssText,a&&(a.style.cssText=this.codeNumberOriginCssText),s.style.cssText=this.toolbarOriginCssText,n.style.cssText=this.editorAreaOriginCssText,i.style.cssText=this._originCssText,c&&(c.style.cssText=this.arrowOriginCssText),this._d.body.style.overflow=this.bodyOverflow,"auto"!==this.editor.frameOptions.get("height")||this.options.get("hasCodeMirror")||this._codeViewAutoHeight(e),this.toolbarParent&&(this.toolbarParent.appendChild(s),this.toolbarParent=null),this.options.get("toolbar_sticky")>-1&&X.removeClass(s,"se-toolbar-sticky"),this.fullScreenSticky&&!this.options.get("toolbar_container")&&(this.fullScreenSticky=!1,e.get("_stickyDummy").style.display="block",X.addClass(s,"se-toolbar-sticky")),this.editor.isInline=this.toolbar._isInline=this.fullScreenInline,this.editor.isBalloon=this.toolbar._isBalloon=this.fullScreenBalloon,e.get("isCodeView")||(this.editor.isInline?this.editor.toolbar._showInline():this.editor.isBalloon&&this.editor.toolbar._showBalloon()),this.editor.toolbar._resetSticky(),e.get("topArea").style.marginTop="";const t=this.icons.expansion;this.editor.applyCommandTargets("fullScreen",(e=>{X.changeElement(e.firstElementChild,t),X.removeClass(e,"active")}))}d&&!e.get("isCodeView")&&this.editor.toolbar.hide(),this.triggerEvent("onToggleFullScreen",{frameContext:e,is:e.get("isFullScreen")})},showBlocks(t){const e=this.editor.frameContext;void 0===t&&(t=!e.get("isShowBlocks")),e.set("isShowBlocks",!!t),t?(X.addClass(e.get("wysiwyg"),"se-show-block"),X.addClass(this.editor.commandTargets.get("showBlocks"),"active")):(X.removeClass(e.get("wysiwyg"),"se-show-block"),X.removeClass(this.editor.commandTargets.get("showBlocks"),"active")),this.editor._resourcesStateChange(e)},_setButtonsActive(){const t=this.editor.frameContext;if(t.get("isCodeView")?X.addClass(this.editor.commandTargets.get("codeView"),"active"):X.removeClass(this.editor.commandTargets.get("codeView"),"active"),t.get("isFullScreen")){const t=this.icons.reduction;this.editor.applyCommandTargets("fullScreen",(e=>{X.changeElement(e.firstElementChild,t),X.addClass(e,"active")}))}else{const t=this.icons.expansion;this.editor.applyCommandTargets("fullScreen",(e=>{X.changeElement(e.firstElementChild,t),X.removeClass(e,"active")}))}t.get("isShowBlocks")?X.addClass(this.editor.commandTargets.get("showBlocks"),"active"):X.removeClass(this.editor.commandTargets.get("showBlocks"),"active")},print(){const t=X.createElement("IFRAME",{style:"display: none;"});this._d.body.appendChild(t);const e=this.options.get("printTemplate")?this.options.get("printTemplate").replace(/\{\{\s*contents\s*\}\}/i,this.html.get(!0)):this.html.get(!0),i=X.getIframeDocument(t),s=this.editor.frameContext.get("_wd");if(this.editor.frameOptions.get("iframe")){const t=this.options.get("printClass")?'class="'+this.options.get("printClass")+'"':this.editor.frameOptions.get("iframe_fullPage")?X.getAttributesToString(s.body,["contenteditable"]):'class="'+this.options.get("_editableClass")+'"';i.write("<!DOCTYPE html><html><head>"+s.head.innerHTML+"</head><body "+t+">"+e+"</body></html>")}else{const t=this._d.head.getElementsByTagName("link"),s=this._d.head.getElementsByTagName("style");let n="";for(let e=0,i=t.length;e<i;e++)n+=t[e].outerHTML;for(let t=0,e=s.length;t<e;t++)n+=s[t].outerHTML;i.write(`<!DOCTYPE html>\n\t\t\t\t<html>\n\t\t\t\t\t<head>\n\t\t\t\t\t\t${n}\n\t\t\t\t\t</head>\n\t\t\t\t\t<body class="${this.options.get("printClass")?this.options.get("printClass"):this.options.get("_editableClass")}">\n\t\t\t\t\t\t${e} \n\t\t\t\t\t</body>\n\t\t\t\t</html>`)}this.editor.showLoading(),this._w.setTimeout((()=>{try{if(t.focus(),q.isEdge||q.isChromium||this._d.documentMode||this._w.StyleMedia)try{t.contentWindow.document.execCommand("print",!1,null)}catch(e){console.warn("[SUNEDITOR.print.warn]",e),t.contentWindow.print()}else t.contentWindow.print()}catch(t){throw Error(`[SUNEDITOR.print.fail] error: ${t.message}`)}finally{this.editor.hideLoading(),X.removeItem(t)}}),1e3)},preview(){this.menu.dropdownOff(),this.menu.containerOff(),this.editor._offCurrentController(),this.editor._offCurrentModal();const t=this.options.get("previewTemplate")?this.options.get("previewTemplate").replace(/\{\{\s*contents\s*\}\}/i,this.html.get(!0)):this.html.get(!0),e=this._w.open("","_blank");e.mimeType="text/html";const i=this.editor.frameContext.get("_wd");if(this.editor.frameOptions.get("iframe")){const s=this.options.get("printClass")?'class="'+this.options.get("printClass")+'"':this.editor.frameOptions.get("iframe_fullPage")?X.getAttributesToString(i.body,["contenteditable"]):'class="'+this.options.get("_editableClass")+'"';e.document.write(`<!DOCTYPE html>\n\t\t\t\t<html>\n\t\t\t\t\t<head>\n\t\t\t\t\t\t${i.head.innerHTML}\n\t\t\t\t\t\t<style>\n\t\t\t\t\t\t\tbody {overflow:auto !important; margin: 10px auto !important; height:auto !important; outline:1px dashed #ccc;}\n\t\t\t\t\t\t</style>\n\t\t\t\t\t</head>\n\t\t\t\t\t<body ${s}>\n\t\t\t\t\t\t${t}\n\t\t\t\t\t</body>\n\t\t\t\t</html>`)}else{const i=this._d.head.getElementsByTagName("link"),s=this._d.head.getElementsByTagName("style");let n="";for(let t=0,e=i.length;t<e;t++)n+=i[t].outerHTML;for(let t=0,e=s.length;t<e;t++)n+=s[t].outerHTML;e.document.write(`<!DOCTYPE html>\n\t\t\t\t<html>\n\t\t\t\t\t<head>\n\t\t\t\t\t\t<meta charset="utf-8" />\n\t\t\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">\n\t\t\t\t\t\t<title>${this.lang.preview}</title>\n\t\t\t\t\t\t${n}\n\t\t\t\t\t</head>\n\t\t\t\t\t<body class="${this.options.get("printClass")?this.options.get("printClass"):this.options.get("_editableClass")}" style="margin:10px auto !important; height:auto !important; outline:1px dashed #ccc;">\n\t\t\t\t\t\t${t}\n\t\t\t\t\t</body>\n\t\t\t\t</html>`)}},_resetFullScreenHeight(){if(this.editor.frameContext.get("isFullScreen"))return this.fullScreenInnerHeight+=this._w.innerHeight-this.context.get("toolbar.main").offsetHeight-(this.editor.frameContext.has("statusbar")?this.editor.frameContext.get("statusbar").offsetHeight:0)-this.fullScreenInnerHeight,this.editor.frameContext.get("wrapper").style.height=this.fullScreenInnerHeight+"px",!0},_codeMirrorEditor(t,e,i){const s=i?this.frameRoots.get(i).get("options"):this.editor.frameOptions;switch(t){case"set":s.has("codeMirror5Editor")?s.get("codeMirror5Editor").getDoc().setValue(e):s.has("codeMirror6Editor")&&s.get("codeMirror6Editor").dispatch({changes:{from:0,to:s.get("codeMirror6Editor").state.doc.length,insert:e}});break;case"get":if(s.has("codeMirror5Editor"))return s.get("codeMirror5Editor").getDoc().getValue();if(s.has("codeMirror6Editor"))return s.get("codeMirror6Editor").state.doc.toString();break;case"readonly":s.has("codeMirror5Editor")?s.get("codeMirror5Editor").setOption("readOnly",e):s.has("codeMirror6Editor")&&(e?s.get("codeMirror6Editor").contentDOM.removeAttribute("contenteditable"):s.get("codeMirror6Editor").contentDOM.setAttribute("contenteditable",!0));break;case"refresh":s.has("codeMirror5Editor")&&s.get("codeMirror5Editor").refresh()}},_setCodeView(t){this.options.get("hasCodeMirror")?this._codeMirrorEditor("set",t,null):this.editor.frameContext.get("code").value=t},_getCodeView(){return this.options.get("hasCodeMirror")?this._codeMirrorEditor("get",null,null):this.editor.frameContext.get("code").value},_setCodeDataToEditor(){const t=this._getCodeView();if(this.editor.frameOptions.get("iframe_fullPage")){const e=this.editor.frameContext.get("_wd"),i=(new DOMParser).parseFromString(t,"text/html");if(!this.options.get("__allowedScriptTag")){const t=i.head.children;for(let e=0,s=t.length;e<s;e++)/^script$/i.test(t[e].tagName)&&(i.head.removeChild(t[e]),e--,s--)}let s=i.head.innerHTML;i.head.querySelector('link[rel="stylesheet"]')&&("auto"!==this.editor.frameOptions.get("height")||i.head.querySelector("style"))||(s+=Y._setIframeStyleLinks(this.editor.frameOptions.get("iframe_cssFileName"))+Y._setAutoHeightStyle(this.editor.frameOptions.get("height"))),e.head.innerHTML=s,e.body.innerHTML=this.html.clean(i.body.innerHTML,!0,null,null);const n=i.body.attributes;for(let t=0,i=n.length;t<i;t++)"contenteditable"!==n[t].name&&e.body.setAttribute(n[t].name,n[t].value);if(!X.hasClass(e.body,"sun-editor-editable")){const t=this.options.get("_editableClass").split(" ");for(let i=0;i<t.length;i++)X.addClass(e.body,this.options.get("_editableClass")[i])}}else this.editor.frameContext.get("wysiwyg").innerHTML=t.length>0?this.html.clean(t,!0,null,null):"<"+this.options.get("defaultLine")+"><br></"+this.options.get("defaultLine")+">"},_setEditorDataToCodeView(){const t=this.html._convertToCode(this.editor.frameContext.get("wysiwyg"),!1);let e="";if(this.editor.frameOptions.get("iframe_fullPage")){const i=X.getAttributesToString(this.editor.frameContext.get("_wd").body,null);e="<!DOCTYPE html>\n<html>\n"+this.editor.frameContext.get("_wd").head.outerHTML.replace(/>(?!\n)/g,">\n")+"<body "+i+">\n"+t+"</body>\n</html>"}else e=t;this._setCodeView(e)},_codeViewAutoHeight(t,e,i){i&&(t.style.height=t.scrollHeight+"px"),this._updateLineNumbers(e,t)},_updateLineNumbers(t,e){if(!t)return;const i=ps(t),s=Math.ceil(e.scrollHeight/i),n=(t.value.match(/\n/g)||[]).length;if(s>n){let e="";for(let t=n+1;t<=s;t++)e+=`${t}\n`;t.value+=e}},_scrollLineNumbers(t){t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft},constructor:us};const gs=us,ms=".se-menu-list .se-toolbar-btn[data-command]",fs=`${ms}:not([class~="se-code-view-enabled"]):not([data-type="MORE"])`,_s=`${ms}:not([class~="se-component-enabled"]):not([data-type="MORE"])`,bs=function(t,e){const i=t[0].target.ownerDocument||q._d,s=i.defaultView||q._w,n=function(t,e){"object"!=typeof e&&(e={});const i={};if(e.plugins){const t=e.excludedPlugins||[],s=e.plugins,n=(Array.isArray(s)?s:Object.keys(s)).filter((e=>!t.includes(e))).map((t=>s[t]));for(let t,e=0,s=n.length;e<s;e++)t=n[e].default||n[e],i[t.key]=t}const s=gt(e,t),n=s.o,o=s.i,l=s.l,r=X.createElement("DIV",{class:"se-loading-box sun-editor-common"},'<div class="se-loading-effect"></div>'),a=X.createElement("DIV",{class:"sun-editor sun-editor-carrier-wrapper sun-editor-common"+(n.get("_rtl")?" se-rtl":"")}),h=X.createElement("DIV",{class:"se-menu-tray"});a.appendChild(h);const c=X.createElement("INPUT",{class:"__se__focus__temp__",style:"position: absolute !important; top: -10000px !important; display: block !important; width: 0 !important; height: 0 !important; margin: 0 !important; padding: 0 !important;"});c.tabIndex=0,a.appendChild(c);const d=X.createElement("DIV",{class:"se-modal sun-editor-common"}),u=X.createElement("DIV",{class:"se-modal-back",style:"display: none;"}),p=X.createElement("DIV",{class:"se-modal-inner",style:"display: none;"});d.appendChild(u),d.appendChild(p),a.appendChild(d),a.appendChild(X.createElement("DIV",{class:"se-back-wrapper"})),a.appendChild(r.cloneNode(!0));const g=X.createElement("DIV",{class:"se-drag-cursor"});a.appendChild(g),nt.body.appendChild(a);let m=null,f=null;const _=St(s.buttons,i,n,o,l,!1),b=_.element;b.style.visibility="hidden",/inline/i.test(n.get("mode"))?(b.className+=" se-toolbar-inline",b.style.width=n.get("toolbar_width")):/balloon/i.test(n.get("mode"))&&(b.className+=" se-toolbar-balloon",b.style.width=n.get("toolbar_width"),b.appendChild(X.createElement("DIV",{class:"se-arrow"}))),s.subButtons&&(f=St(s.subButtons,i,n,o,l,!1),m=f.element,m.style.visibility="hidden",m.className+=" se-toolbar-balloon se-toolbar-sub",m.style.width=n.get("toolbar.sub_width"),m.appendChild(X.createElement("DIV",{class:"se-arrow"})));const v=t[0].key||null,y=[],w=new Map,C=s.statusbarContainer;let x=null;for(let e=0,i=t.length;e<i;e++){const i=t[e],s=i.options,a=X.createElement("DIV",{class:"sun-editor"+(s.get("_rtl")?" se-rtl":"")}),h=X.createElement("DIV",{class:"se-container"}),c=X.createElement("DIV",{class:"se-wrapper"});h.appendChild(X.createElement("DIV",{class:"se-toolbar-shadow"}));const d=_t(i.key,n,a,s),u=d.bottomBar.statusbar,p=d.wysiwygFrame,g=d.placeholder;let m=d.codeView;const f=X.createElement("DIV",{class:"se-line-breaker-component se-line-breaker-component-t",title:l.insertLine},o.line_break),_=X.createElement("DIV",{class:"se-line-breaker-component se-line-breaker-component-b",title:l.insertLine},o.line_break);c.appendChild(f),c.appendChild(_),g&&c.appendChild(g),h.appendChild(X.createElement("DIV",{class:"se-toolbar-sticky-dummy"})),h.appendChild(c),u&&(C?x||(C.appendChild(X.createElement("DIV",{class:"sun-editor"},u)),x=u):h.appendChild(u)),h.appendChild(r.cloneNode(!0));const b=i.key||null,v=X.createElement("DIV",{class:"se-code-wrapper"},m);v.style.setProperty("display","none","important"),c.appendChild(v);const S=bt(n,s,m);if(m===S){const t=X.createElement("TEXTAREA",{class:"se-code-view-line",readonly:"true"},null);v.insertBefore(t,m)}else m=S;a.appendChild(h),y.push(b),w.set(b,et(i,a,p,v,m,x||u,b))}const S=n.get("toolbar_container");if(S){const t=X.createElement("DIV",{class:"sun-editor"+(n.get("_rtl")?" se-rtl":"")}),e=X.createElement("DIV",{class:"se-container"});e.appendChild(b),m&&e.appendChild(m),t.appendChild(e),S.appendChild(t),S.appendChild(X.createElement("DIV",{class:"se-toolbar-sticky-dummy"}))}else{const t=w.get(v).get("container");t.insertBefore(b,t.firstElementChild),m&&t.insertBefore(m,t.firstElementChild)}return{context:st(b,S,h,m,C),carrierWrapper:a,options:n,plugins:i,icons:o,lang:l,value:s.v,rootId:v,rootKeys:y,frameRoots:w,pluginCallButtons:_.pluginCallButtons,responsiveButtons:_.responsiveButtons,pluginCallButtons_sub:f?f.pluginCallButtons:[],responsiveButtons_sub:f?f.responsiveButtons:[]}}(t,e);this.rootKeys=n.rootKeys,this.frameRoots=n.frameRoots,this.context=n.context,this.frameContext=new Map,this.frameOptions=new Map,this._lineBreaker_t=null,this._lineBreaker_b=null,this._d=i,this._w=s,this.carrierWrapper=n.carrierWrapper,this.options=n.options,this.plugins=n.plugins||{},this.events=null,this.triggerEvent=null,this.icons=n.icons,this.lang=n.lang,this.status={hasFocus:!1,tabSize:4,indentSize:25,codeIndentSize:2,currentNodes:[],currentNodesMap:[],rootKey:n.rootId,_range:null},this.isClassic=null,this.isInline=null,this.isBalloon=null,this.isBalloonAlways=null,this.isSubBalloon=null,this.isSubBalloonAlways=null,this.allCommandButtons=new Map,this.subAllCommandButtons=new Map,this.shortcutsKeyMap=new Map,this.reverseKeys=[],this.commandTargets=new Map,this.activeCommands=null,this.effectNode=null,this._shadowRoot=null,this._onPluginEvents=null,this.opendModal=null,this.opendControllers=[],this.currentControllerName="",this._controllerTargetContext=null,this.selectMenuOn=!1,this._backWrapper=n.carrierWrapper.querySelector(".se-back-wrapper"),this._controllerOnDisabledButtons=[],this._codeViewDisabledButtons=[],this._pluginCallButtons=n.pluginCallButtons,this._pluginCallButtons_sub=n.pluginCallButtons_sub,this._responsiveButtons=n.responsiveButtons,this._responsiveButtons_sub=n.responsiveButtons_sub,this._notHideToolbar=!1,this._antiBlur=!1,this._componentsInfoInit=!0,this._componentsInfoReset=!1,this._MELInfo=null,this._fileInfoPluginsCheck=null,this._fileInfoPluginsReset=null,this._fileManager={tags:null,regExp:null,pluginRegExp:null,pluginMap:null},this._componentManager=[],this._figureContainer=null,this._originOptions=e,this.__Create(e)};function vs(t){return/^statusbar/i.test(t)?"statusbar":t}function ys(t,e,i){for(let s,n=0,o=t.length;n<o;n++)s=t[n],(dt.includes(s)||e&&e[s])&&(console.warn(`[SUNEDITOR.warn.resetOptions] "[${i+s}]" options not available in resetOptions have no effect.`),t.splice(n--,1),o--)}bs.prototype={registerPlugin(t,e,i,s){let n=this.plugins[t];if(!n)throw Error(`[SUNEDITOR.registerPlugin.fail] The called plugin does not exist or is in an invalid format. (pluginName: "${t}")`);if("function"==typeof this.plugins[t]&&(n=this.plugins[t]=new this.plugins[t](this,i||{}),"function"==typeof n.init&&n.init()),e){for(let t=0,i=e.length;t<i;t++)xt(e[t],n,this.icons,this.lang);this.activeCommands.includes(t)||"function"!=typeof this.plugins[t].active||this.activeCommands.push(t)}},run(t,e,i){if(e){if(/more/i.test(e)){const e=X.getParentElement(i,".se-toolbar"),s=X.hasClass(e,"se-toolbar-sub")?this.subToolbar:this.toolbar;if(i!==s.currentMoreLayerActiveButton){const n=e.querySelector("."+t);n&&(s._moreLayerOn(i,n),s._showBalloon(),s._showInline()),X.addClass(i,"on")}else s.currentMoreLayerActiveButton&&(s._moreLayerOff(),s._showBalloon(),s._showInline());return void this.viewer._resetFullScreenHeight()}if(/container/.test(e)&&(null===this.menu.targetMap[t]||i!==this.menu.currentContainerActiveButton))return void this.menu.containerOn(i);if(this.frameContext.get("isReadOnly")&&X.arrayIncludes(this._controllerOnDisabledButtons,i))return;if(/dropdown/.test(e)&&(null===this.menu.targetMap[t]||i!==this.menu.currentDropdownActiveButton))return void this.menu.dropdownOn(i);if(/modal/.test(e))return void this.plugins[t].open(i);/command/.test(e)?this.plugins[t].action(i):/fileBrowser/.test(e)&&this.plugins[t].open(null)}else t&&this.commandHandler(t);/dropdown/.test(e)?this.menu.dropdownOff():/command/.test(e)||(this.menu.dropdownOff(),this.menu.containerOff())},async commandHandler(t){if(!this.frameContext.get("isReadOnly")||/copy|cut|selectAll|codeView|fullScreen|print|preview|showBlocks/.test(t))switch(t){case"copy":case"cut":this.execCommand(t);break;case"paste":break;case"selectAll":!function(t){t._offCurrentController(),t.menu.containerOff();const e=X.getParentElement(t.selection.getNode(),"FIGCAPTION")||t.frameContext.get("wysiwyg");let i=X.getEdgeChild(e.firstChild,(t=>0===t.childNodes.length||3===t.nodeType||X.isTable(t)),!1)||e.firstChild,s=X.getEdgeChild(e.lastChild,(t=>0===t.childNodes.length||3===t.nodeType||X.isTable(t)),!0)||e.lastChild;if(i&&s){if(X.isMedia(i)||X.isTableElements(i)){const e=t.component.get(i),s=X.createElement("BR"),n=X.createElement(t.options.get("defaultLine"),null,s);i=e?e.container||e.cover:i,i.parentNode.insertBefore(n,i),i=s}(X.isMedia(s)||X.isTableElements(s))&&(s=X.createElement("BR"),e.appendChild(X.createElement(t.options.get("defaultLine"),null,s))),t.toolbar._showBalloon(t.selection.setRange(i,0,s,s.textContent.length))}}(this);break;case"newDocument":this.html.set(`<${this.options.get("defaultLine")}><br></${this.options.get("defaultLine")}>`),this.focus(),this.history.push(!1);break;case"codeView":this.viewer.codeView(!this.frameContext.get("isCodeView"));break;case"fullScreen":this.viewer.fullScreen(!this.frameContext.get("isFullScreen"));break;case"indent":this.format.indent();break;case"outdent":this.format.outdent();break;case"undo":this.history.undo();break;case"redo":this.history.redo();break;case"removeFormat":this.format.removeTextStyle(),this.focus();break;case"print":this.viewer.print();break;case"preview":this.viewer.preview();break;case"showBlocks":this.viewer.showBlocks(!this.frameContext.get("isShowBlocks"));break;case"dir":this.setDir(this.options.get("_rtl")?"ltr":"rtl");break;case"dir_ltr":this.setDir("ltr");break;case"dir_rtl":this.setDir("rtl");break;case"save":await async function(t){const e=t.frameContext;if(!e.get("isChanged"))return;const i=t.html.get();if(await t.triggerEvent("onSave",{frameContext:e,data:i})===Et){const t=e.get("originElement");/^TEXTAREA$/i.test(t.nodeName)?t.value=i:t.innerHTML=i}e.set("isChanged",!1),e.set("savedIndex",t.history.getRootStack()[t.status.rootKey].index),t.applyCommandTargets("save",(t=>{t.setAttribute("disabled",!0)}))}(this);break;default:!function(t,e){e=t.options.get("_defaultTagCommand")[e.toLowerCase()]||e;let i=t.options.get("convertTextTags")[e]||e;const s=t.status.currentNodesMap,n=s.includes(t.options.get("_styleCommandMap")[i])?null:X.createElement(i);/^sub$/i.test(i)&&s.includes("superscript")?i="sup":/^sup$/i.test(i)&&s.includes("subscript")&&(i="sub"),t.format.applyTextStyle(n,Tt[e]||null,[i],!1),t.focus()}(this,t)}},runFromTarget(t){if(X.isInputElement(t)||!(t=X.getCommandTarget(t)))return;const e=t.getAttribute("data-command"),i=t.getAttribute("data-type");(e||i)&&(t.disabled||this.run(e,i,t))},applyCommandTargets(t,e){this.commandTargets.has(t)&&this.commandTargets.get(t).forEach(e)},applyFrameRoots(t){this.frameRoots.forEach(t)},isEmpty(t){const e=(t=t||this.frameContext).get("wysiwyg");return X.isZeroWith(e.textContent)&&!e.querySelector(q._allowedEmptyNodeList)&&(e.innerText.match(/\n/g)||"").length<=1},setDir(t){const e="rtl"===t;if(this.options.get("_rtl")!==e){try{this.options.set("_rtl",e),this._offCurrentController();const i=this.frameContext,s=this.plugins;for(const e in s)"function"==typeof s[e].setDir&&s[e].setDir(t);const n=this.context.get("toolbar._wrapper"),o=this.context.get("statusbar._wrapper");e?(this.applyFrameRoots((t=>{X.addClass([t.get("topArea"),t.get("wysiwyg")],"se-rtl")})),X.addClass([this.carrierWrapper,n,o],"se-rtl")):(this.applyFrameRoots((t=>{X.removeClass([t.get("topArea"),t.get("wysiwyg")],"se-rtl")})),X.removeClass([this.carrierWrapper,n,o],"se-rtl"));const l=X.getListChildren(i.wysiwyg,(t=>this.format.isLine(t)&&(t.style.marginRight||t.style.marginLeft||t.style.textAlign)));for(let t,e,i,s=0;t=l[s];s++)t=l[s],i=t.style.marginRight,e=t.style.marginLeft,(i||e)&&(t.style.marginRight=e,t.style.marginLeft=i),i=t.style.textAlign,"left"===i?t.style.textAlign="right":"right"===i&&(t.style.textAlign="left");!function(t,e){const i=t.icons,s=t.commandTargets,n=t.shortcutsKeyMap;t.reverseKeys.forEach((t=>{const e=n.get(t);if(!e)return;const i=e.c;e.c=e.r,e.r=i})),t.applyCommandTargets("dir",(s=>{X.changeTxt(s.querySelector(".se-tooltip-text"),t.lang[e?"dir_ltr":"dir_rtl"]),X.changeElement(s.firstElementChild,i[e?"dir_ltr":"dir_rtl"])})),e?(X.addClass(s.get("dir_rtl"),"active"),X.removeClass(s.get("dir_ltr"),"active")):(X.addClass(s.get("dir_ltr"),"active"),X.removeClass(s.get("dir_rtl"),"active"))}(this,e),this.isBalloon?this.toolbar._showBalloon():this.isSubBalloon&&this.subToolbar._showBalloon()}catch(t){this.options.set("_rtl",!e),console.warn(`[SUNEDITOR.setDir.fail] ${t.toString()}`)}this.effectNode=null,this.eventManager.applyTagEffect()}},resetOptions(t){const e=Object.keys;this.viewer.codeView(!1),this.viewer.showBlocks(!1);const i=e(t);if(ys(i,this.plugins,""),0===i.length)return;const s={},n=this.rootKeys,o=this.frameRoots,l=[],r={};this._originOptions=[t,this._originOptions].reduce((function(t,i){for(const a in i)if(n.includes(a)&&i[a]){const t=i[a],n=e(t);if(ys(n,null,a+"."),0===n.length)continue;s[a]=new Map;const h=o.get(a).get("options").get("_origin");for(const e in t){const i=t[e];n.includes(e)&&h[e]!==i&&(s[a].set(vs(e),!0),h[e]=i)}l.push(r[a]={options:h})}else t[a]=i[a];return t}),{});const a=this.options,h=gt(this._originOptions,l).o;for(let t,e=0;t=i[e];e++)if(r[t]){const e=s[t],i=o.get(t),n=i.get("options"),l=r[t].options;if(e.has("statusbar"))if(X.removeItem(i.get("statusbar")),l.get("statusbar")){const t=mt(l,null).statusbar;i.get("container").appendChild(t),it(t,i),this.eventManager.__addStatusbarEvent(i,l)}else this.eventManager.removeEvent(n.get("__statusbarEvent")),l.set("__statusbarEvent",null),it(null,i);if(e.has("iframe_attributes")){const t=i.get("wysiwygFrame"),e=n.get("iframe_attributes"),s=l.get("iframe_attributes");for(const i in e)t.removeAttribute(i,e[i]);for(const e in s)t.setAttribute(e,s[e])}if(e.has("iframe_cssFileName")){const t=i.get("_wd").head,e=t.getElementsByTagName("link");for(;e[0];)t.removeChild(e[0]);const s=(new DOMParser).parseFromString(Y._setIframeStyleLinks(l.get("iframe_cssFileName")),"text/html").head.children,n=t.querySelector("style");for(;s[0];)t.insertBefore(s[0],n)}i.set("options",l),this.setEditorStyle(l.get("_defaultStyles"),i);const a=i.get("wysiwyg"),h=n.get("editableFrameAttributes"),c=l.get("editableFrameAttributes");for(const t in h)a.removeAttribute(t,h[t]);for(const t in c)a.setAttribute(t,c[t])}else a.set(t,h.get(t)),"historyStackDelayTime"!==t?"textDirection"!==t||this.setDir(a.get("_rtl")?"ltr":"rtl"):this.history.resetDelayTime(a.get("historyStackDelayTime"));const c=this.context.get("toolbar.main");/inline|balloon/i.test(a.get("mode"))&&i.includes("toolbar_width")&&(c.style.width=a.get("toolbar_width")),a.get("toolbar_hide")&&(c.style.display="none"),a.get("shortcutsHint")?X.removeClass(c,"se-shortcut-hide"):X.addClass(c,"se-shortcut-hide"),this.effectNode=null,this._setFrameInfo(this.frameRoots.get(this.status.rootKey))},changeFrameContext(t){t!==this.status.rootKey&&(this.status.rootKey=t,this._setFrameInfo(this.frameRoots.get(t)),this.toolbar._resetSticky())},execCommand(t,e,i){this.frameContext.get("_wd").execCommand(t,e,"formatBlock"===t?"<"+i+">":i),this.history.push(!0)},focus(t){if(t&&this.changeFrameContext(t),"none"!==this.frameContext.get("wysiwygFrame").style.display){if(this._antiBlur=!1,this.frameOptions.get("iframe")||!this.frameContext.get("wysiwyg").contains(this.selection.getNode()))this._nativeFocus();else try{const t=this.selection.getRange();if(t.startContainer===t.endContainer&&X.isWysiwygFrame(t.startContainer)){const e=t.commonAncestorContainer.children[t.startOffset];if(!this.format.isLine(e)&&!this.component.is(e)){const t=X.createElement("BR"),i=X.createElement(this.options.get("defaultLine"),null,t);return this.frameContext.get("wysiwyg").insertBefore(i,e),void this.selection.setRange(t,0,t,0)}}this.selection.setRange(t.startContainer,t.startOffset,t.endContainer,t.endOffset)}catch(t){console.warn("[SUNEDITOR.focus.warn] ",t),this._nativeFocus()}this.isBalloon&&this.eventManager._toggleToolbarBalloon()}},focusEdge(t){this._antiBlur=!1,t||(t=this.frameContext.get("wysiwyg").lastElementChild);const e=this.component.get(t);e?this.component.select(e.target,e.pluginName,!1):t?(3!==t.nodeType&&(t=X.getEdgeChild(t,(function(t){return 0===t.childNodes.length||3===t.nodeType}),!0)),t?this.selection.setRange(t,t.textContent.length,t,t.textContent.length):this._nativeFocus()):this.focus()},blur(){this.frameOptions.get("iframe")?this.frameContext.get("wysiwygFrame").blur():this.frameContext.get("wysiwyg").blur()},setEditorStyle(t,e){const i=(e=e||this.frameContext).get("options"),s=Y._setDefaultOptionStyle(i,t);i.set("_defaultStyles",s),e.get("topArea").style.cssText=s.top;const n=e.get("code");n.style.cssText=i.get("_defaultStyles").frame,n.style.display="none",i.get("iframe")?(e.get("wysiwygFrame").style.cssText=s.frame,e.get("wysiwyg").style.cssText=s.editor):e.get("wysiwygFrame").style.cssText=s.frame+s.editor},readOnly(t,e){const i=e?this.frameRoots.get(e):this.frameContext;i.set("isReadOnly",!!t),X.setDisabled(this._controllerOnDisabledButtons,!!t),t?(this._offCurrentController(),this._offCurrentModal(),this.toolbar?.currentMoreLayerActiveButton?.disabled&&this.toolbar.moreLayerOff(),this.subToolbar?.currentMoreLayerActiveButton?.disabled&&this.subToolbar.moreLayerOff(),this.menu?.currentDropdownActiveButton?.disabled&&this.menu.dropdownOff(),this.menu?.currentContainerActiveButton?.disabled&&this.menu.containerOff(),this.modalForm&&this.plugins.modal.close.call(this),i.get("code").setAttribute("readOnly","true"),X.addClass(i.get("wysiwygFrame"),"se-read-only")):(i.get("code").removeAttribute("readOnly"),X.removeClass(i.get("wysiwygFrame"),"se-read-only")),this.options.get("hasCodeMirror")&&this.viewer._codeMirrorEditor("readonly",!!t,e)},disable(t){const e=t?this.frameRoots.get(t):this.frameContext;this.toolbar.disable(),this._offCurrentController(),this._offCurrentModal(),this.modalForm&&this.plugins.modal.close.call(this),e.get("wysiwyg").setAttribute("contenteditable",!1),e.set("isDisabled",!0),this.options.get("hasCodeMirror")?this.viewer._codeMirrorEditor("readonly",!0,t):e.get("code").setAttribute("disabled",!0)},enable(t){const e=t?this.frameRoots.get(t):this.frameContext;this.toolbar.enable(),e.get("wysiwyg").setAttribute("contenteditable",!0),e.set("isDisabled",!1),this.options.get("hasCodeMirror")?this.viewer._codeMirrorEditor("readonly",!1,t):e.get("code").removeAttribute("disabled")},show(t){const e=(t?this.frameRoots.get(t):this.frameContext).get("topArea").style;"none"===e.display&&(e.display="block")},hide(t){(t?this.frameRoots.get(t):this.frameContext).get("topArea").style.display="none"},showLoading(t){(t?this.frameRoots.get(t).get("container"):this.carrierWrapper).querySelector(".se-loading-box").style.display="block"},hideLoading(t){(t?this.frameRoots.get(t).get("container"):this.carrierWrapper).querySelector(".se-loading-box").style.display="none"},enableBackWrapper(t){this._backWrapper.style.cursor=t,this._backWrapper.style.display="block"},disableBackWrapper(){this._backWrapper.style.display="none",this._backWrapper.style.cursor="default"},destroy(){this.history.destroy(),this.eventManager._removeAllEvents(),this.options.get("codeMirror6Editor")&&this.options.get("codeMirror6Editor").destroy(),X.removeItem(this.carrierWrapper),X.removeItem(this.context.get("toolbar._wrapper")),X.removeItem(this.context.get("toolbar.sub._wrapper")),X.removeItem(this.context.get("statusbar._wrapper")),this.applyFrameRoots((t=>{X.removeItem(t.get("topArea")),t.get("options").clear(),t.clear()})),this.options.clear(),this.context.clear();let t=this.plugins;for(const e in t){const i=t[e];"function"==typeof i._destroy&&i._destroy();for(const t in i)delete i[t];delete t[e]}t=this.events;for(const e in t)delete t[e];t=["eventManager","char","component","format","html","menu","nodeTransform","notice","offset","selection","shortcuts","toolbar","viewer"];for(let e,i=0,s=t.length;i<s;i++){e=this[t[i]];for(const t in e)delete e[t]}if(t=this.subToolbar,t)for(const e in t)delete t[e];t=null;for(const t in this)delete this[t];return null},_setFrameInfo(t){this.frameContext=t,this.frameOptions=t.get("options"),t.set("_editorHeight",t.get("wysiwygFrame").offsetHeight),this._lineBreaker_t=t.get("lineBreaker_t"),this._lineBreaker_b=t.get("lineBreaker_b")},_visibleControllers(t,e){const i=t?"":"hidden",s=e??i?"":"hidden",n=this.opendControllers;for(let t,e=0;e<n.length;e++)t=n[e],t.form&&(t.form.style.visibility=i);this._lineBreaker_t.style.visibility=s,this._lineBreaker_b.style.visibility=s},_offCurrentController(){this.__offControllers(),this.component.deselect()},__offControllers(){const t=this.opendControllers,e=[];for(let i,s=0;s<t.length;s++)i=t[s],i.fixed?e.push(i):("function"==typeof i.inst.close&&i.inst.close(),i.form&&(i.form.style.display="none"));this.opendControllers=e,this.currentControllerName="",this._antiBlur=!1},_offCurrentModal(){this.opendModal&&this.opendModal.close()},_nativeFocus(){this.selection.__focus(),this.selection._init()},_checkComponents(t){for(let e=0,i=this._fileInfoPluginsCheck.length;e<i;e++)this._fileInfoPluginsCheck[e](t)},_resetComponents(){for(let t=0,e=this._fileInfoPluginsReset.length;t<e;t++)this._fileInfoPluginsReset[t]()},_initWysiwygArea(t,e){t.get("wysiwyg").innerHTML=this.html.clean("string"==typeof e?e:(/^TEXTAREA$/i.test(t.get("originElement").nodeName)?t.get("originElement").value:t.get("originElement").innerHTML)||"",!0,null,null)||"<"+this.options.get("defaultLine")+"><br></"+this.options.get("defaultLine")+">",t.has("charCounter")&&(t.get("charCounter").textContent=this.char.getLength())},_resourcesStateChange(t){this._iframeAutoHeight(t),this._checkPlaceholder(t)},_iframeAutoHeight(t){const e=t.get("_iframeAuto");e?this._w.setTimeout((()=>{const i=e.offsetHeight;t.get("wysiwygFrame").style.height=i+"px",q.isResizeObserverSupported||this.__callResizeFunction(t,i,null)}),0):q.isResizeObserverSupported||this.__callResizeFunction(t,t.get("wysiwygFrame").offsetHeight,null)},__callResizeFunction(t,e,i){e=-1===e?i?.borderBoxSize&&i.borderBoxSize[0]?i.borderBoxSize[0].blockSize:i.contentRect.height+j.get(t.get("wwComputedStyle").getPropertyValue("padding-left"))+j.get(t.get("wwComputedStyle").getPropertyValue("padding-right")):e,t.get("_editorHeight")!==e&&(this.triggerEvent("onResizeEditor",{height:e,prevHeight:t.get("_editorHeight"),frameContext:t,observerEntry:i}),t.set("_editorHeight",e))},_checkPlaceholder(t){const e=(t=t||this.frameContext).get("placeholder");if(e){if(t.get("isCodeView"))return void(e.style.display="none");this.isEmpty(t)?e.style.display="block":e.style.display="none"}},__editorInit(t){this.applyFrameRoots((t=>{this.__setEditorParams(t)})),this._setFrameInfo(this.frameRoots.get(this.status.rootKey)),this.__init(t);for(const t of this._onPluginEvents.values())t.sort(((t,e)=>t.index-e.index));this.applyFrameRoots((t=>{this.eventManager._addFrameEvents(t),this._initWysiwygArea(t,t.get("options").get("value"))})),this.eventManager.__eventDoc=null,this._componentsInfoInit=!1,this._componentsInfoReset=!1,this._checkComponents(!0),this._w.setTimeout((()=>{this.context.get("toolbar.main").style.visibility="",this.applyFrameRoots((t=>{"function"==typeof this._resourcesStateChange&&(this.eventManager._wwFrameObserver&&this.eventManager._wwFrameObserver.observe(t.get("wysiwygFrame")),this.eventManager._toolbarObserver&&this.eventManager._toolbarObserver.observe(t.get("_toolbarShadow")),this._resourcesStateChange(t))})),this.history.reset(),this.triggerEvent("onload",{})}),0)},__init(t){this._fileInfoPluginsCheck=[],this._fileInfoPluginsReset=[],this._MELInfo=new Map,this.activeCommands=kt,this._onPluginEvents=new Map([["onMouseMove",[]],["onMouseLeave",[]],["onMouseDown",[]],["onMouseUp",[]],["onScroll",[]],["onClick",[]],["onInput",[]],["onKeyDown",[]],["onKeyUp",[]],["onFocus",[]],["onBlur",[]],["onPastAndDrop",[]]]),this._fileManager.tags=[],this._fileManager.pluginMap={},this._fileManager.tagAttrs={};const e=this.plugins,i=Array.isArray,s=this.options.get("shortcuts"),n=[];let o;for(const l in e){if(this.registerPlugin(l,this._pluginCallButtons[l],t[l],s[l]),this.registerPlugin(l,this._pluginCallButtons_sub[l],t[l],s[l]),o=this.plugins[l],"object"==typeof o.__fileManagement){const t=o.__fileManagement;if(this._fileInfoPluginsCheck.push(t._checkInfo.bind(t)),this._fileInfoPluginsReset.push(t._resetInfo.bind(t)),i(t.tagNames)){const e=t.tagNames;this._fileManager.tags=this._fileManager.tags.concat(e),n.push(l);for(let i,s=0,n=e.length;s<n;s++)i=e[s].toLowerCase(),this._fileManager.pluginMap[i]=l,t.tagAttrs&&(this._fileManager.tagAttrs[i]=t.tagAttrs)}}"function"==typeof o.constructor.component&&this._componentManager.push(function(t,e){return(e=t.component?.call(this,e))?{target:e,pluginName:t.key,options:t.options}:null}.bind(o,o.constructor));const e=o.constructor.options||{};if(this._onPluginEvents.forEach(((t,i)=>{if("function"==typeof o[i]){const s=o[i].bind(o);s.index=e[`eventIndex_${i}`]||e.eventIndex||0,t.push(s)}})),o.retainFormat){const t=o.retainFormat();this._MELInfo.set(t.query,t.method)}}this._fileManager.regExp=new RegExp(`^(${this._fileManager.tags.join("|")||"\\^"})$`,"i"),this._fileManager.pluginRegExp=new RegExp(`^(${0===n.length?"\\^":n.join("|")})$`,"i"),delete this._pluginCallButtons,delete this._pluginCallButtons_sub,this.__cachingButtons()},__cachingButtons(){const t=this.context;this.__setDisabledButtons(),this.__saveCommandButtons(this.allCommandButtons,t.get("toolbar.buttonTray")),this.options.has("_subMode")&&this.__saveCommandButtons(this.subAllCommandButtons,t.get("toolbar.sub.buttonTray"))},__setDisabledButtons(){const t=this.context;this._codeViewDisabledButtons=Y.nodeListToArray(t.get("toolbar.buttonTray").querySelectorAll(fs)),this._controllerOnDisabledButtons=Y.nodeListToArray(t.get("toolbar.buttonTray").querySelectorAll(_s)),this.options.has("_subMode")&&(this._codeViewDisabledButtons=this._codeViewDisabledButtons.concat(Y.nodeListToArray(t.get("toolbar.sub.buttonTray").querySelectorAll(fs))),this._controllerOnDisabledButtons=this._controllerOnDisabledButtons.concat(Y.nodeListToArray(t.get("toolbar.sub.buttonTray").querySelectorAll(_s))))},__saveCommandButtons(t,e){const i=e.querySelectorAll(ms),s=this.options.get("shortcuts"),n=this.options.get("_reverseCommandArray"),o=this.shortcutsKeyMap,l=this.reverseKeys;for(let e,r,a=0,h=i.length;a<h;a++)e=i[a],r=e.getAttribute("data-command"),t.set(r,e),this.__setCommandTargets(r,e),ut(r,e,s[r],o,n,l)},__setCommandTargets(t,e){t&&e&&(Nt.includes(t)||this.plugins[t])&&(this.commandTargets.get(t)?this.commandTargets.get(t).includes(e)||this.commandTargets.get(t).push(e):this.commandTargets.set(t,[e]))},__setIframeDocument(t,e,i){t.setAttribute("scrolling","auto"),t.contentDocument.head.innerHTML='<meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">'+Y._setIframeStyleLinks(i.get("iframe_cssFileName"))+Y._setAutoHeightStyle(i.get("height")),t.contentDocument.body.className=e.get("_editableClass"),t.contentDocument.body.setAttribute("contenteditable",!0)},__setEditorParams(t){const e=t.get("options"),i=this._w;if(t.set("wwComputedStyle",i.getComputedStyle(t.get("wysiwyg"))),!e.get("iframe")&&"function"==typeof ShadowRoot){let e=t.get("wysiwygFrame");for(;e;){if(e.shadowRoot){this._shadowRoot=e.shadowRoot;break}if(e instanceof ShadowRoot){this._shadowRoot=e;break}e=e.parentNode}}const s=e.get("editableFrameAttributes");for(const e in s)t.get("wysiwyg").setAttribute(e,s[e]);e.get("iframe")?(t.set("_ww",t.get("wysiwygFrame").contentWindow),t.set("_wd",t.get("wysiwygFrame").contentDocument),t.set("wysiwyg",t.get("_wd").body),e.get("_defaultStyles").editor&&(t.get("wysiwyg").style.cssText=e.get("_defaultStyles").editor),"auto"===e.get("height")&&t.set("_iframeAuto",t.get("_wd").body)):(t.set("_ww",i),t.set("_wd",this._d))},__registerClass(){this.events={onload:null,onScroll:null,onMouseDown:null,onClick:null,onInput:null,onMouseLeave:null,onKeyDown:null,onKeyUp:null,onCopy:null,onCut:null,onFocus:null,onBlur:null,onChange:null,onShowToolbar:null,onShowController:null,onBeforeShowController:null,onToggleCodeView:null,onToggleFullScreen:null,onResizeEditor:null,onSetToolbarButtons:null,onSave:null,onDrop:null,onPaste:null,imageUploadHandler:null,onImageUploadBefore:null,onImageDeleteBefore:null,onImageLoad:null,onImageAction:null,onImageUploadError:null,videoUploadHandler:null,onVideoUploadBefore:null,onVideoUploadError:null,onVideoLoad:null,onVideoAction:null,onVideoDeleteBefore:null,audioUploadHandler:null,onAudioUploadBefore:null,onAudioUploadError:null,onAudioAction:null,onAudioDeleteBefore:null,onAudioLoad:null,onFileAction:null,onFileDeleteBefore:null,onFileLoad:null,onFileUploadBefore:null,onFileUploadError:null,onExportPdfBefore:null,onFileManagerAction:null,...this.options.get("events")},this.triggerEvent=async(t,e)=>{const i=this.events[t];return"function"==typeof i?await i({editor:this,...e}):q.NO_EVENT},this.history=function(e){const i=e.frameRoots;let s,n,o,l,r=e.options.get("historyStackDelayTime"),a=null;function h(t,i){e.status.hasFocus&&e.eventManager.applyTagEffect(),e.history.resetButtons(t.get("key"),i),e.triggerEvent("onChange",{frameContext:t,data:t.get("wysiwyg").innerHTML}),"block"===e.context.get("toolbar.main").style.display?e.toolbar._showBalloon():e.isSubBalloon&&"block"===e.context.get("toolbar.sub.main").style.display&&e.subToolbar._showBalloon()}function c(t){const l=n[s],r=o[l];s+=t;const a=t<0&&l!==n[s]&&r.index>0?l:n[s],c=o[a];c.index+=t;const d=c.value[c.index];i.get(a).get("wysiwyg").innerHTML=d.content,l!==a&&t<0&&1===s?s=0:l!==a&&t>0&&1===c.index?s++:(t<0&&c.index<1||t>0&&c.index>c.value.length)&&(s+=t);let u=a,p=d;if(t<0&&s>0&&0===c.index){const e=n[s+t];if(e!==a){const t=o[e];u=e,p=t.value[t.index]}}e.changeFrameContext(u),e.selection.setRange(N(p.s.path,p.frame),p.s.offset,N(p.e.path,p.frame),p.e.offset),e.focus(),s<0?s=0:s>=n.length&&(s=n.length-1),e._offCurrentController(),e._checkComponents(),e.char.display(),e._resourcesStateChange(e.frameContext),h(e.frameContext,c.index)}function d(t,e,l,r){let a,h;e?(a={path:k(e.startContainer,null,null),offset:e.startOffset},h={path:k(e.endContainer,null,null),offset:e.endOffset}):(a={path:[0,0],offset:[0,0]},h={path:0,offset:0}),s+=r,n[s]=l;const c=o[l];c.index+=r,c.value[c.index]={content:t,s:a,e:h,frame:i.get(l).get("wysiwyg")}}function u(t){o[t]={value:[],index:-1},l[t]=i.get(t).get("wysiwyg").innerHTML}function p(t,r){e._checkComponents();const a=i.get(t),c=a.get("wysiwyg").innerHTML,p=o[t];!c||p.value[p.index]&&c===p.value[p.index].content||(n.length>s+1&&function(t){const i=[];for(let t=s+1,e=n.length;t<e;t++)i.includes(n[t])||i.push(n[t]);n=n.slice(0,s+1),t.value.splice(s+1),e.applyCommandTargets("redo",(t=>{t.setAttribute("disabled",!0)}));for(let t=0,e=i.length;t<e;t++)n.includes(i[t])||u(i[t])}(p),0===p.value.length&&function(t){s++,n[s]=t;const e=o[t];e.index=0,e.value[0]={content:l[t],s:{path:[0,0],offset:[0,0]},e:{path:0,offset:0},frame:i.get(t).get("wysiwyg")}}(t),d(c,r,t,1),1===s&&e.applyCommandTargets("undo",(t=>{t.removeAttribute("disabled")})),e.char.display(),h(a,p.index))}return{push(s,n){n=n||e.status.rootKey;const o=e.status._range;t.setTimeout(e._resourcesStateChange.bind(e,i.get(n)),0);const l="number"==typeof s?s>0?s:0:s?r:0;l&&!a||(t.clearTimeout(a),l)?a=t.setTimeout((()=>{t.clearTimeout(a),a=null,p(n,o)}),l):p(n,o)},check(e,i){a&&(t.clearTimeout(a),a=null,p(e,i))},undo(){s>0&&c(-1)},redo(){n.length-1>s&&c(1)},overwrite(t){d(i.get(t||e.status.rootKey).get("wysiwyg").innerHTML,null,e.status.rootKey,0)},reset(){e.applyCommandTargets("undo",(t=>{t.setAttribute("disabled",!0)})),e.applyCommandTargets("redo",(t=>{t.setAttribute("disabled",!0)})),e.applyCommandTargets("save",(t=>{t.setAttribute("disabled",!0)})),e.applyFrameRoots((t=>t.set("historyIndex",-1))),e.applyFrameRoots((t=>t.set("isChanged",!1))),s=-1,n=[],o={},l={};const t=e.rootKeys;for(let e=0,i=t.length;e<i;e++)u(t[e])},resetButtons(t,i){const l=!j.is(i),r=o[void 0===t?n[s]:t];i=l?r.index:i;const a=e.frameRoots.get(t),h=r.value.length-1;e.applyCommandTargets("undo",(t=>{i>0&&i<=h?t.removeAttribute("disabled"):t.setAttribute("disabled",!0)})),e.applyCommandTargets("redo",(t=>{i>-1&&i<h?t.removeAttribute("disabled"):t.setAttribute("disabled",!0)}));const c=a.get("savedIndex"),d=a.get("historyIndex"),u=c>-1?c!==i:l?r.length>0:i>0&&d!==i;a.set("historyIndex",i),a.set("isChanged",u),e.applyCommandTargets("save",(t=>{u?t.removeAttribute("disabled"):t.setAttribute("disabled",!0)})),e.triggerEvent("onResetButtons",{rootKey:t})},getRootStack:()=>o,resetDelayTime(t){r=t},destroy(){a&&t.clearTimeout(a),s=n=o=l=null}}}(this),this.eventManager=new Se(this),this.offset=new ss(this),this.shortcuts=new rs(this),this.notice=new ts(this),this.toolbar=new ds(this,{keyName:"toolbar",balloon:this.isBalloon,balloonAlways:this.isBalloonAlways,inline:this.isInline,res:this._responsiveButtons}),this.options.has("_subMode")&&(this.subToolbar=new ds(this,{keyName:"toolbar.sub",balloon:this.isSubBalloon,balloonAlways:this.isSubBalloonAlways,inline:!1,res:this._responsiveButtons_sub})),this.selection=new os(this),this.html=new $i(this),this.nodeTransform=new Gi(this),this.component=new Li(this),this.format=new Ii(this),this.menu=new Zi(this),this.char=new Ne(this),this.viewer=new gs(this),Ee.call(this.eventManager,this),Ee.call(this.char,this),Ee.call(this.component,this),Ee.call(this.format,this),Ee.call(this.html,this),Ee.call(this.menu,this),Ee.call(this.nodeTransform,this),Ee.call(this.selection,this),Ee.call(this.toolbar,this),Ee.call(this.viewer,this),this.options.has("_subMode")&&Ee.call(this.subToolbar,this),delete this.char.char,delete this.component.component,delete this.format.format,delete this.html.html,delete this.menu.menu,delete this.nodeTransform.nodeTransform,delete this.selection.selection,delete this.toolbar.toolbar,delete this.viewer.viewer,this.subToolbar&&delete this.subToolbar.subToolbar,this._responsiveButtons=this._responsiveButtons_res=null},async __Create(t){this.isInline=/inline/i.test(this.options.get("mode")),this.isBalloon=/balloon/i.test(this.options.get("mode")),this.isBalloonAlways=/balloon-always/i.test(this.options.get("mode")),this.isClassic=/classic/i.test(this.options.get("mode")),this.isSubBalloon=/balloon/i.test(this.options.get("_subMode")),this.isSubBalloonAlways=/balloon-always/i.test(this.options.get("_subMode")),this.__registerClass(),this.eventManager._addCommonEvents();const e=[];this.applyFrameRoots((t=>{const i=t.get("originElement"),s=t.get("topArea");if(i.style.display="none",s.style.display="block",i.parentNode.insertBefore(s,i.nextElementSibling),t.get("options").get("iframe")){const i=new Promise((e=>{t.get("wysiwygFrame").addEventListener("load",(({target:i})=>{this.__setIframeDocument(i,this.options,t.get("options")),e()}))}));e.push(i)}})),this.applyFrameRoots((t=>{t.get("wrapper").appendChild(t.get("wysiwygFrame"))})),e.length>0&&await Promise.all(e),this.__editorInit(t)},Constructor:bs};const ws=bs,Cs=function(t){He.call(this,t),this.title=this.lang.tag_blockquote,this.icon="blockquote",this.quoteTag=X.createElement("BLOCKQUOTE")};Cs.key="blockquote",Cs.type="command",Cs.className="",Cs.prototype={active:(t,e)=>/blockquote/i.test(t?.nodeName)?(X.addClass(e,"active"),!0):(X.removeClass(e,"active"),!1),action(){const t=X.getParentElement(this.selection.getNode(),"blockquote");t?this.format.removeBlock(t,null,null,!1,!1):this.format.applyBlock(this.quoteTag.cloneNode(!1))},constructor:Cs};const xs=Cs,Ss=function(t,e){this.editor=t.editor,this.kind=t.constructor.key||t.constructor.name,this._xhr=q.getXMLHttpRequest(),this.method=e?.method,this.url=e?.url,this.headers=e?.headers,this.data=e?.data,this.callBack=e?.callBack,this.errorCallBack=e?.errorCallBack,this.responseType=e?.responseType};async function Es(t,e,i){if(4===t.readyState)if(200===t.status)try{await e(t)}catch(t){throw Error(`[SUNEDITOR.ApiManager[${this.kind}].upload.callBack.fail] ${t.message}`)}finally{this.editor.hideLoading()}else{console.error(`[SUNEDITOR.ApiManager[${this.kind}].upload.serverException]`,t);try{const e=t.responseText?JSON.parse(t.responseText):t;let s="";"function"==typeof i&&(s=await i(e,t));const n=`[SUNEDITOR.ApiManager[${this.kind}].upload.serverException] status: ${t.status}, response: ${s||e.errorMessage||t.responseText}`;this.editor.notice.open(n)}catch(t){throw Error(`[SUNEDITOR.ApiManager[${this.kind}].upload.errorCallBack.fail] ${t.message}`)}finally{this.editor.hideLoading()}}}Ss.prototype={call({method:t,url:e,headers:i,data:s,callBack:n,errorCallBack:o,responseType:l}){this.cancel(),t=t||this.method,e=this._normalizeUrl(e||this.url),i=i||this.headers,s=s||this.data,n=n||this.callBack,o=o||this.errorCallBack,l=l||this.responseType;const r=this._xhr;if(l&&(r.responseType=l),r.onreadystatechange=Es.bind(this,r,n,o),r.open(t,e,!0),null!==i&&"object"==typeof i&&Object.keys(i).length>0)for(const t in i)r.setRequestHeader(t,i[t]);r.send(s)},asyncCall({method:t,url:e,headers:i,data:s,responseType:n}){this.cancel(),t=t||this.method,e=this._normalizeUrl(e||this.url),i=i||this.headers,s=s||this.data,n=n||this.responseType;const o=this._xhr;return n&&(o.responseType=n),new Promise(((n,l)=>{if(o.open(t,e,!0),null!==i&&"object"==typeof i&&Object.keys(i).length>0)for(const t in i)o.setRequestHeader(t,i[t]);o.onload=()=>{if(200===o.status)try{n(o)}finally{this.editor.hideLoading()}else try{const t=o.responseText?JSON.parse(o.responseText):o;l(t,o)}finally{this.editor.hideLoading()}},o.onerror=()=>{l(new Error("Network error"))},o.send(s)}))},cancel(){this._xhr&&this._xhr.abort()},_normalizeUrl:t=>t.replace(/([^:])\/+/g,"$1/").replace(/\/(\?|#|$)/,"$1"),constructor:Ss};const Ts=Ss,{_d:ks}=q,Ns=function(t,e){He.call(this,t),this.title=this.lang.exportPdf,this.icon="pdf",this.apiUrl=e.apiUrl,this.fileName=e.fileName||"suneditor-pdf",this.jsPDFOptions=e.jsPDFOptions||{},this.html2canvasOptions=e.html2canvasOptions||{},this.apiUrl||this.options.get("externalLibs").html2canvas||this.options.get("externalLibs").jsPDF?this.apiUrl&&(this.apiManager=new Ts(this,{method:"POST",url:this.apiUrl,headers:{"Content-Type":"application/json"},responseType:"blob"})):console.warn('[SUNEDITOR.plugins.exportPdf.error] Requires "apiUrl" or externalLibs.html2canvas and externalLibs.jsPDF options.')};Ns.key="exportPdf",Ns.type="command",Ns.className="se-component-enabled",Ns.prototype={async action(){this.editor.showLoading();let t=null;try{const e=this.editor.frameContext.get("topArea"),i=X.createElement("div",{class:this.editor.frameContext.get("wysiwygFrame").className},this.html.get());if(t=X.createElement("div",{style:`position: absolute; left: -10000px; width: ${e.clientWidth}px; height: auto;`},i),this.apiUrl){const e=X.applyInlineStylesAll(i,!0,this.options.get("allUsedStyles"));t.innerHTML=e.outerHTML}if(ks.body.appendChild(t),!1===await this.triggerEvent("onExportPdfBefore",{editableDiv:i}))return;if(this.apiUrl)return void await this._createByServer(t);const s=async()=>{const e=t.querySelectorAll("img, audio, video"),i=Array.from(e).map((t=>{switch(t.tagName.toLowerCase()){case"img":return new Promise((e=>{t.complete&&0!==t.naturalHeight?e():(t.onload=e,t.onerror=()=>e())}));case"audio":case"video":return new Promise((e=>{t.readyState>=4?e():(t.onloadeddata=e,t.onerror=()=>e())}));default:return Promise.resolve()}}));await Promise.all(i),await this._createByHtml2canvas(t)};new MutationObserver(s).observe(t,{childList:!0,subtree:!0,attributes:!0}),await s()}catch(t){console.error(`[SUNEDITOR.plugins.exportPdf.error] ${t.message}`)}finally{this.editor.hideLoading()}},async _createByHtml2canvas(t){const e=await this.options.get("externalLibs").html2canvas(t,{useCORS:!0,logging:!0,...this.html2canvasOptions}),i=e.toDataURL("image/png"),s=new(this.options.get("externalLibs").jsPDF)({orientation:"portrait",unit:"px",format:[e.width,e.height],...this.jsPDFOptions});s.addImage(i,"PNG",0,0,e.width,e.height),s.save(`${this.fileName}.pdf`)},async _createByServer(t){const e={fileName:this.fileName,htmlContent:t.innerHTML},i=await this.apiManager.asyncCall({data:JSON.stringify(e)});if(200!==i.status){const t=i.responseText?JSON.parse(i.responseText):i;throw Error(`[SUNEDITOR.plugins.exportPdf.error] ${t.errorMessage}`)}const s=new Blob([i.response],{type:"application/pdf"}),n=i.getResponseHeader("Content-Disposition"),o=URL.createObjectURL(s),l=(n.match(/filename="([^"]+)/)||[])[1]||this.fileName+".pdf",r=X.createElement("A",{href:o,download:l,style:"display: none;"},null);try{ks.body.appendChild(r),r.click()}finally{setTimeout((()=>{X.removeItem(r),URL.revokeObjectURL(o)}),100)}},constructor:Ns};const Hs=Ns,Ls=function(t,e){Ht.call(this,t.editor),t.__fileManagement=this,this.kind=t.constructor.key||t.constructor.name,this.inst=t,this.component=t.editor.component,this.query=e.query,this.loadHandler=e.loadHandler,this.eventHandler=e.eventHandler,this.infoList=[],this.infoIndex=0,this.uploadFileLength=0,this.__updateTags=[],this.apiManager=new Ts(this,null)};Ls.prototype={upload(t,e,i,s,n){this.editor.showLoading();let o=null;if(i.length){o=new FormData;for(let t=0,e=i.length;t<e;t++)o.append("file-"+t,i[t]);this.uploadFileLength=i.length}else o=i.formData,this.uploadFileLength=i.size;this.apiManager.call({method:"POST",url:t,headers:e,data:o,callBack:s,errorCallBack:n})},async asyncUpload(t,e,i){this.editor.showLoading();let s=null;if(i.length){s=new FormData;for(let t=0,e=i.length;t<e;t++)s.append("file-"+t,i[t]);this.uploadFileLength=i.length}else s=i.formData,this.uploadFileLength=i.size;return await this.apiManager.asyncCall({method:"POST",url:t,headers:e,data:s})},setFileData(t,{name:e,size:i}){t&&(t.setAttribute("data-se-file-name",e),t.setAttribute("data-se-file-size",i))},_setInfo(t,e){let i=t.getAttribute("data-se-index"),s=null,n="";if(e||(e={name:t.getAttribute("data-se-file-name")||("string"==typeof t.src?t.src.split("/").pop():""),size:t.getAttribute("data-se-file-size")||0}),!i||this._componentsInfoInit)n="create",i=this.infoIndex++,t.setAttribute("data-se-index",i),t.setAttribute("data-se-file-name",e.name),t.setAttribute("data-se-file-size",e.size),s={src:t.src,index:1*i,name:e.name,size:e.size},this.infoList.push(s);else{n="update",i*=1;for(let t=0,e=this.infoList.length;t<e;t++)if(i===this.infoList[t].index){s=this.infoList[t];break}s||(i=this.infoIndex++,s={index:i},this.infoList.push(s)),s.src=t.src,s.name=t.getAttribute("data-se-file-name"),s.size=1*t.getAttribute("data-se-file-size")}s.element=t,s.delete=function(t){"function"==typeof this.inst.destroy&&this.inst.destroy.call(this.inst,t),this._deleteInfo(1*t.getAttribute("data-se-index"))}.bind(this,t),s.select=function(t){t.scrollIntoView(!0),"function"==typeof this.inst.select&&this._w.setTimeout(this.inst.select.bind(this.inst,t),0)}.bind(this,t);const o={editor:this.editor,element:t,index:i,state:n,info:s,remainingFilesCount:--this.uploadFileLength<0?0:this.uploadFileLength};"function"==typeof this.eventHandler&&this.eventHandler(o),this.triggerEvent("onFileManagerAction",{...o,pluginName:this.kind})},getSize(){let t=0;for(let e=0,i=this.infoList.length;e<i;e++)t+=1*this.infoList[e].size;return t},_checkInfo(t){const e=[].slice.call(this.editor.frameContext.get("wysiwyg").querySelectorAll(this.query)),i=this.infoList;if(e.length===i.length){if(this._componentsInfoReset){for(let t=0,i=e.length;t<i;t++)this._setInfo(e[t],null);return}{let t=!1;for(let s,n=0,o=i.length;n<o;n++)if(s=i[n],0===e.filter((function(t){return s.src===t.src&&s.index.toString()===t.getAttribute("data-se-index")})).length){t=!0;break}if(!t)return}}const s=[],n=[];for(let t=0,e=i.length;t<e;t++)n[t]=i[t].index;for(this.__updateTags=e;e.length>0;){const t=e.shift();t.getAttribute("data-se-index")&&n.includes(1*t.getAttribute("data-se-index"))?s.push(1*t.getAttribute("data-se-index")):(s.push(this.infoIndex),t.removeAttribute("data-se-index"),this._setInfo(t,null))}if(t&&"function"==typeof this.loadHandler)this.loadHandler(i);else for(let t,e=0;e<i.length;e++){if(t=i[e].index,s.includes(t))continue;i.splice(e,1);const n={editor:this.editor,element:null,index:t,state:"delete",info:null,remainingFilesCount:0};"function"==typeof this.eventHandler&&this.eventHandler(n),this.triggerEvent("onFileManagerAction",{...n,pluginName:this.kind}),e--}},_resetInfo(){const t="function"==typeof this.eventHandler,e={editor:this.editor,element:null,state:"delete",info:null,remainingFilesCount:0};for(let i=0,s=this.infoList.length;i<s;i++)t&&this.eventHandler({...e,index:this.infoList[i].index,pluginName:this.kind}),this.triggerEvent("onFileManagerAction",{...e,index:this.infoList[i].index,pluginName:this.kind});this.infoList=[],this.infoIndex=0},_deleteInfo(t){if(t>=0)for(let e=0,i=this.infoList.length;e<i;e++)if(t===this.infoList[e].index)return this.infoList.splice(e,1),void("function"==typeof this.eventHandler&&this.eventHandler({editor:this.editor,element:null,index:t,state:"delete",info:null,remainingFilesCount:0}))},constructor:Ls};const Ms=Ls,{NO_EVENT:Bs}=q,As=function(t,e){He.call(this,t),this.title=this.lang.fileUpload,this.icon="file_upload",e.uploadUrl||console.warn('[SUNEDITOR.fileUpload.warn] "fileUpload" plugin must be have "uploadUrl" option.'),this.uploadUrl=e.uploadUrl,this.uploadHeaders=e.uploadHeaders,this.uploadSizeLimit=/\d+/.test(e.uploadSizeLimit)?j.get(e.uploadSizeLimit,0):null,this.uploadSingleSizeLimit=/\d+/.test(e.uploadSingleSizeLimit)?j.get(e.uploadSingleSizeLimit,0):null,this.allowMultiple=!!e.allowMultiple,this.acceptedFormats="string"!=typeof e.acceptedFormats?"*":e.acceptedFormats.trim()||"*",this._acceptedCheck=this.acceptedFormats.split(", "),this.as=e.as||"box",this.input=X.createElement("input",{type:"file",accept:this.acceptedFormats}),this.allowMultiple&&this.input.setAttribute("multiple","multiple"),this._element=null;const i={"custom-download":{command:"download",title:this.lang.download,icon:"download",action:t=>{const e=t.getAttribute("href");e&&X.createElement("A",{href:e},null).click()}},"custom-as":{command:"as",value:"link",title:this.lang.asLink,icon:"reduction",action:(t,e)=>{this.convertFormat(t,e)}}};let s=e.controls||[["custom-as","edit","align","remove","custom-download"]];if(s=s.map((t=>t.map((t=>t.startsWith("custom-")?i[t]:t)))),this.figure=new gi(this,s,{}),this.fileManager=new Ms(this,{query:"a[download][data-se-file-download]",loadHandler:this.events.onFileLoad,eventHandler:this.events.onFileAction}),/\bedit\b/.test(JSON.stringify(s))){const t=function({lang:t,icons:e}){const i=`\n\t\t<div class="se-arrow se-arrow-up"></div>\n\t\t<form>\n\t\t\t<div class="se-btn-group se-form-group">\n\t\t\t\t<input type="text" />\n\t\t\t\t<button type="submit" data-command="edit" class="se-btn se-tooltip se-btn-success">\n\t\t\t\t\t${e.checked}\n\t\t\t\t\t<span class="se-tooltip-inner"><span class="se-tooltip-text">${t.save}</span></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" data-command="cancel" class="se-btn se-tooltip se-btn-danger">\n\t\t\t\t\t${e.cancel}\n\t\t\t\t\t<span class="se-tooltip-inner"><span class="se-tooltip-text">${t.cancel}</span></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t\t`;return X.createElement("DIV",{class:"se-controller se-controller-resizing"},i)}(this);this.controller=new $e(this,t,{position:"bottom",disabled:!0},As.key),this.editInput=t.querySelector("input")}this.eventManager.addEvent(this.input,"change",Vs.bind(this))};async function Vs(t){await this.submitFile(t.target.files)}As.key="fileUpload",As.type="command",As.className="",As.options={eventIndex:1e4},As.component=function(t){return X.isAnchor(t)&&t.hasAttribute("download")&&t.hasAttribute("data-se-file-download")?t:null},As.prototype={action(){this.input.click()},select(t){this._element=t;const e=this.figure.controller.form.querySelector('[data-command="__c__as"]');if(!X.isFigure(t.parentElement))return e.innerHTML=this.icons.expansion+Ct(this.lang.asBlock),e.setAttribute("data-value","box"),this.figure.controllerOpen(t,{isWWTarget:!0}),!0;e.innerHTML=this.icons.reduction+Ct(this.lang.asLink),e.setAttribute("data-value","link"),this.figure.open(t,{nonResizing:!0,nonSizeInfo:!0,nonBorder:!0,figureTarget:!0,__fileManagerInfo:!1})},onPastAndDrop({file:t}){const e=t.type;if(this._acceptedCheck.some((t=>!!t.startsWith("*")||!!t.startsWith(e)||void 0)))return this.submitFile([t]),this.editor.focus(),!1},edit(t){this.editInput.value=t.textContent,this.figure.controllerHide(),this.controller.open(t,null,{isWWTarget:!X.isFigure(t.parentElement),initMethod:null,addOffset:null}),this.editInput.focus()},controllerAction(t){const e=t.getAttribute("data-command");if(e){if("edit"===e){if(0===this.editInput.value.trim().length)return;this._element.textContent=this.editInput.value}this.controller.close(),this.component.select(this._element,As.key,!1)}},async submitFile(t){if(0===t.length)return;let e=0;const i=[],s=this.uploadSingleSizeLimit;for(let n,o,l=0,r=t.length;l<r;l++){if(n=t[l],o=n.size,s&&s>o){const t="[SUNEDITOR.fileUpload.fail] Size of uploadable single file: "+s/1e3+"KB",e=await this.triggerEvent("onFileUploadError",{error:t,limitSize:s,uploadSize:o,file:n});return this.notice.open(e===Bs?t:e||t),!1}i.push(n),e+=o}const n=this.uploadSizeLimit,o=this.fileManager.getSize();if(n>0&&e+o>n){const t="[SUNEDITOR.fileUpload.fail] Size of uploadable total files: "+n/1e3+"KB",i=await this.triggerEvent("onFileUploadError",{error:t,limitSize:n,currentSize:o,uploadSize:e});return this.notice.open(i===Bs?t:i||t),!1}const l={url:this.uploadUrl,uploadHeaders:this.uploadHeaders,files:i},r=async function(t,e){t=e||t;const i=await this.fileManager.asyncUpload(t.url,t.uploadHeaders,t.files);this._uploadCallBack(i)}.bind(this,l),a=await this.triggerEvent("onFileUploadBefore",{...l,handler:r});return void 0===a||!1!==a&&(null!==a&&"object"==typeof a&&r(a),void(!0!==a&&a!==Bs||r(null)))},async destroy(t){if(!t)return;const e=gi.GetContainer(t);if(t=X.getParentElement(t,".se-component")||t,!1===await this.triggerEvent("onFileDeleteBefore",{target:e.target,container:e,url:e.target.getAttribute("href")}))return;const i=this.component.isInline(t)?t.previousSibling||t.nextSibling:t.previousElementSibling||t.nextElementSibling;X.removeItem(t),this.editor._offCurrentController(),this.editor.focusEdge(i),this.history.push(!1)},convertFormat(t,e){if("link"===e){this.figure.close();const{container:e}=gi.GetContainer(t),i=e.nextElementSibling,s=e.parentElement;t.removeAttribute("data-se-non-focus"),t.setAttribute("contenteditable",!1),X.addClass(t,"se-component|se-inline-component");const n=X.createElement(this.options.get("defaultLine"),null,t);s.insertBefore(n,i),X.removeItem(e)}else{this.selection.setRange(t,0,t,1);const e=this.html.remove(),i=this.nodeTransform.split(e.container,e.offset,0);i?.previousElementSibling&&X.isZeroWith(i.previousElementSibling)&&X.removeItem(i.previousElementSibling),t.setAttribute("data-se-non-focus","true"),t.removeAttribute("contenteditable"),X.removeClass(t,"se-component|se-component-selected|se-inline-component");const s=gi.CreateContainer(t,"se-file-figure se-flex-component");(i||e.container).parentElement.insertBefore(s.container,i)}this.history.push(!1),this.component.select(t,As.key,!1)},_register(t){t.result.forEach(((t,e,i)=>{this._create(t.url,{name:t.name,size:t.size},e===i.length-1)}))},_create(t,e,i){const s=e.name||t,n=X.createElement("A",{href:t,title:s,download:s,"data-se-file-download":"",contenteditable:"false","data-se-non-focus":"true","data-se-non-link":"true"},s);if(this.fileManager.setFileData(n,e),"link"===this.as)return n.className="se-component se-inline-component",void this.component.insert(n,!1,!1);const o=gi.CreateContainer(n);if(X.addClass(o.container,"se-file-figure|se-flex-component"),this.component.insert(o.container,!1,!i||!this.options.get("mediaAutoSelect"))){if(i)if(this.options.get("mediaAutoSelect"))this.component.select(n,As.key,!1);else{const t=this.format.addLine(o.container,null);t&&this.selection.setRange(t,0,t,0)}}else this.editor.focus()},async _error(t){const e=await this.triggerEvent("onFileUploadError",{error:t});if(!1===e)return;const i=e===Bs?t.errorMessage:e||t.errorMessage;this.notice.open(i),console.error("[SUNEDITOR.plugin.fileUpload.error]",i)},_uploadCallBack(t){const e=JSON.parse(t.responseText);e.errorMessage?this._error(e):this._register(e)},constructor:As};const Is=As,Rs=function(t){He.call(this,t),this.title=this.lang.bulletedList,this.icon="list_bulleted",this.afterButton=X.createElement("button",{class:"se-btn se-tooltip se-sub-arrow-btn","data-command":Rs.key,"data-type":"dropdown"},`${this.icons.arrow_down}<span class="se-tooltip-inner"><span class="se-tooltip-text">${this.lang.bulletedList}</span></span>`);const e=function(){const t=`\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic se-list-horizontal se-list-carrier">\n\t\t\t${e=["disc","circle","square"],e.map((t=>`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list se-icon-flip-rtl" data-command="${t}" title="${t}" aria-label="${t}">\n\t\t\t\t\t<ul style="list-style-type: ${t};">\n\t\t\t\t\t\t<li></li><li></li><li></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</button>\n\t\t\t</li>\n\t\t`)).join("")}\n\t\t</ul>\n\t</div>`;var e;return X.createElement("DIV",{class:"se-dropdown se-list-layer"},t)}();this.listItems=e.querySelectorAll("li button ul"),this.menu.initDropdownTarget({key:Rs.key,type:"dropdown"},e)};Rs.key="list_bulleted",Rs.type="command",Rs.className="se-icon-flip-rtl",Rs.prototype={active:(t,e)=>X.isListCell(t)&&/^UL$/i.test(t.parentElement.nodeName)?(X.addClass(e,"active"),!0):(X.removeClass(e,"active"),!1),on(){const t=this.listItems,e=this.format.getBlock(this.selection.getNode()),i=e?.style?e.style.listStyleType||"disc":"";for(let e,s=0,n=t.length;s<n;s++)e=t[s],i===e.style.listStyleType?X.addClass(e.parentElement,"active"):X.removeClass(e.parentElement,"active")},action(t){const e=this.format.getBlock(this.selection.getNode()),i=t?.querySelector("ul")?.style.listStyleType||"";if(X.isList(e)&&i)e.style.listStyleType=i;else{const t=this.format.applyList(`ul:${i}`,null,!1);t&&this.selection.setRange(t.sc,t.so,t.ec,t.eo)}this.menu.dropdownOff(),this.editor.focus(),this.history.push(!1)},constructor:Rs};const zs=Rs,Os=function(t){He.call(this,t),this.title=this.lang.numberedList,this.icon="list_numbered",this.afterButton=X.createElement("button",{class:"se-btn se-tooltip se-sub-arrow-btn","data-command":Os.key,"data-type":"dropdown"},`${this.icons.arrow_down}<span class="se-tooltip-inner"><span class="se-tooltip-text">${this.lang.numberedList}</span></span>`);const e=function(){const t=`\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic se-list-horizontal se-list-carrier">\n\t\t\t${$s(["decimal","upper-roman","lower-roman"])}\n\t\t</ul>\n\t\t<ul class="se-list-basic se-list-horizontal se-list-carrier">\n\t\t${$s(["lower-latin","upper-latin","lower-greek"])}\n\t\t</ul>\n\t</div>`;return X.createElement("DIV",{class:"se-dropdown se-list-layer"},t)}();this.listItems=e.querySelectorAll("li button ol"),this.menu.initDropdownTarget({key:Os.key,type:"dropdown"},e)};function $s(t){return t.map((t=>`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list se-icon-flip-rtl" data-command="${t}" title="${t}" aria-label="${t}">\n\t\t\t\t\t<ol style="list-style-type: ${t};">\n\t\t\t\t\t\t<li></li><li></li><li></li>\n\t\t\t\t\t</ol>\n\t\t\t\t</button>\n\t\t\t</li>\n\t\t`)).join("")}Os.key="list_numbered",Os.type="command",Os.className="se-icon-flip-rtl",Os.prototype={active:(t,e)=>X.isListCell(t)&&/^OL$/i.test(t.parentElement.nodeName)?(X.addClass(e,"active"),!0):(X.removeClass(e,"active"),!1),on(){const t=this.listItems,e=this.format.getBlock(this.selection.getNode()),i=e?.style?e.style.listStyleType||"decimal":"";for(let e,s=0,n=t.length;s<n;s++)e=t[s],i===e.style.listStyleType?X.addClass(e.parentElement,"active"):X.removeClass(e.parentElement,"active")},action(t){const e=this.format.getBlock(this.selection.getNode()),i=t?.querySelector("ol")?.style.listStyleType||"";if(X.isList(e)&&i)e.style.listStyleType=i;else{const t=this.format.applyList(`ol:${i}`,null,!1);t&&this.selection.setRange(t.sc,t.so,t.ec,t.eo)}this.menu.dropdownOff(),this.editor.focus(),this.history.push(!1)},constructor:Os};const Ps=Os,{debounce:Ds}=Y,Fs=function(t,e){He.call(this,t),this.title=this.lang.mention,this.icon="mention",this.triggerText=e.triggerText||"@",this.limitSize=e.limitSize||5,this.searchStartLength=e.searchStartLength||0,this.delayTime="number"==typeof e.delayTime?e.delayTime:200,this.apiUrl=e.apiUrl?.replace(/\s/g,"").replace(/\{limitSize\}/i,this.limitSize)||"",this._delay=0,this._lastAtPos=0,this._anchorOffset=0,this._anchorNode=null,this.apiManager=new Ts(this,{headers:e.apiHeaders}),this.cachingData=e.useCachingData??1?new Map:null;const i=X.createElement("DIV",{class:"se-controller se-empty-controller"},"<div></div>");this.selectMenu=new Ye(this,{position:"right-bottom",dir:"ltr",closeMethod:()=>this.controller.close()}),this.controller=new $e(this,i,{position:"bottom",initMethod:()=>{this.apiManager.cancel(),this.selectMenu.close()}},null),this.selectMenu.on(i.firstElementChild,Ws.bind(this)),this.onInput=Ds(this.onInput.bind(this),this.delayTime)};function Ws(t){if(!t)return!1;let e=null;const{key:i,name:s,url:n}=t,o=this._anchorNode.parentNode;if(X.isAnchor(o))e=o,e.setAttribute("data-se-mention",i),e.setAttribute("href",n),e.setAttribute("title",s),e.textContent=this.triggerText+i;else if(this.selection.setRange(this._anchorNode,this._lastAtPos,this._anchorNode,this._anchorOffset),e=X.createElement("A",{"data-se-mention":i,href:n,title:s,target:"_blank"},this.triggerText+i),!this.html.insertNode(e,null,!1))return!1;this.selectMenu.close();const l=X.createTextNode(" ");e.parentNode.insertBefore(l,e.nextSibling),this.selection.setRange(l,1,l,1)}Fs.key="mention",Fs.type="field",Fs.className="",Fs.prototype={async onInput(){this.apiManager.cancel();const t=this.selection.get();if(!t.rangeCount)return void this.selectMenu.close();const e=t.anchorNode,i=t.anchorOffset,s=e.textContent.substring(0,i),n=s.lastIndexOf(this.triggerText);if(n>-1){const t=s.substring(n+1,i),o=s[n-1]?.trim();if(!/\s/.test(t)&&(!o||X.isZeroWith(o))){if(t.length<this.searchStartLength)return!0;const s=e.parentNode;if(X.isAnchor(s)&&!s.getAttribute("data-se-mention"))return!0;try{const s=await this._createMentionList(t,e);return this._lastAtPos=n,this._anchorNode=e,this._anchorOffset=i,!s}catch(t){console.warn("[SUNEDITOR.mention.api.file] ",t)}}}return this.selectMenu.close(),!0},async _createMentionList(t,e){let i=null;if(this.cachingData&&(i=this.cachingData.get(t)),!i){const e=await this.apiManager.asyncCall({method:"GET",url:this._createUrl(t)});i=JSON.parse(e.responseText)}if(!i?.length)return this.selectMenu.close(),!1;const s=[],n=[];for(let t,e=0,o=i.length;e<o;e++)t=i[e],s.push(t),n.push(`<div class="se-mention-item"><span>${t.key}</span><span>${t.name}</span></div>`);return 0===s.length?(this.selectMenu.close(),!1):(this.controller.open(e,null,{isWWTarget:!0,initMethod:null,addOffset:null}),this.selectMenu.create(s,n),this.selectMenu.open(),this.selectMenu.setItem(0),this.cachingData&&this.cachingData.set(t,s),!0)},_createUrl(t){return this.apiUrl.replace(/\{key\}/i,t)},constructor:Fs};const Us=Fs,Zs=function(t,e){He.call(this,t),this.title=this.lang.align,this.icon=this.options.get("_rtl")?"align_right":"align_left";const i=function({lang:t,icons:e,options:i},s){const n=Array.isArray(s)?s:i.get("_rtl")?["right","center","left","justify"]:["left","center","right","justify"];let o="";for(let i,s,l=0;l<n.length;l++)i=n[l],s=t["align"+i.charAt(0).toUpperCase()+i.slice(1)],o+=`\n\t\t<li>\n\t\t\t<button type="button" class="se-btn se-btn-list" data-command="${i}" title="${s}" aria-label="${s}">\n\t\t\t\t<span class="se-list-icon">${e["align_"+i]}</span>${s}\n\t\t\t</button>\n\t\t</li>`;return X.createElement("div",{class:"se-dropdown se-list-layer se-list-align"},`\n\t\t<div class="se-list-inner">\n\t\t\t<ul class="se-list-basic">${o}</ul>\n\t\t</div>`)}(t,e.items),s=this._itemMenu=i.querySelector("ul");this.defaultDir=t.options.get("_rtl")?"right":"left",this.alignIcons={justify:t.icons.align_justify,left:t.icons.align_left,right:t.icons.align_right,center:t.icons.align_center},this.alignList=s.querySelectorAll("li button"),this.menu.initDropdownTarget(Zs,i)};Zs.key="align",Zs.type="dropdown",Zs.className="",Zs.prototype={active(t,e){const i=e.firstElementChild;if(t){if(this.format.isLine(t)){const s=t.style.textAlign;if(s)return X.changeElement(i,this.alignIcons[s]||this.alignIcons[this.defaultDir]),e.setAttribute("data-focus",s),!0}}else X.changeElement(i,this.alignIcons[this.defaultDir]),e.removeAttribute("data-focus");return!1},on(t){const e=t.getAttribute("data-focus")||this.defaultDir;if(!e)return;const i=this.alignList;for(let t=0,s=i.length;t<s;t++)e===i[t].getAttribute("data-command")?X.addClass(i[t],"active"):X.removeClass(i[t],"active")},setDir(t){const e="rtl"===t?"right":"left";if(this.defaultDir===e)return;this.defaultDir=e;const i=this._itemMenu.querySelector('[data-command="left"]'),s=this._itemMenu.querySelector('[data-command="right"]');if(i&&s){const t=i.parentElement,e=s.parentElement;t.appendChild(s),e.appendChild(i)}},action(t){const e=t.getAttribute("data-command");if(!e)return;const i=this.defaultDir,s=this.format.getLines();for(let t=0,n=s.length;t<n;t++)X.setStyle(s[t],"textAlign",e===i?"":e);this.editor.effectNode=null,this.menu.dropdownOff(),this.editor.focus(),this.history.push(!1)},constructor:Zs};const qs=Zs,Gs=function(t,e){He.call(this,t),this.title=this.lang.font,this.inner='<span class="se-txt">'+this.lang.font+"</span>"+this.icons.arrow_down;const i=e.items||["Arial","Comic Sans MS","Courier New","Impact","Georgia","tahoma","Trebuchet MS","Verdana"],s=function({lang:t},e){let i=`\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic">\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list default_value" title="${t.default}" aria-label="${t.default}">(${t.default})</button>\n\t\t\t</li>`;for(let t,s,n=0,o=e.length;n<o;n++)t=e[n],s=t.split(",")[0],i+=`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list" data-command="${t}" data-txt="${s}" title="${s}" aria-label="${s}" style="font-family:${t};">${s}</button>\n\t\t\t</li>`;return i+="\n\t\t</ul>\n\t</div>",X.createElement("DIV",{class:"se-dropdown se-list-layer se-list-font-family"},i)}(t,i);this.currentFont="",this.fontList=s.querySelectorAll("ul li button"),this.fontArray=i,this.menu.initDropdownTarget(Gs,s)};Gs.key="font",Gs.type="dropdown",Gs.className="se-btn-select se-btn-tool-font",Gs.prototype={active(t,e){const i=e.querySelector(".se-txt"),s=e.parentNode.querySelector(".se-tooltip-text");if(t){if(t?.style.fontFamily.length>0){const e=t.style.fontFamily.replace(/["']/g,"");return X.changeTxt(i,e),X.changeTxt(s,this.lang.font+" ("+e+")"),!0}}else{const t=this.status.hasFocus?this.editor.frameContext.get("wwComputedStyle").fontFamily:this.lang.font;X.changeTxt(i,t),X.changeTxt(s,this.status.hasFocus?this.lang.font+(t?" ("+t+")":""):t)}return!1},on(t){const e=this.fontList,i=t.querySelector(".se-txt").textContent;if(i!==this.currentFont){for(let t=0,s=e.length;t<s;t++)i===(e[t].getAttribute("data-command")||"").replace(/'|"/g,"")?X.addClass(e[t],"active"):X.removeClass(e[t],"active");this.currentFont=i}},action(t){let e=t.getAttribute("data-command");if(e){/[\s\d\W]/.test(e)&&!/^['"].*['"]$/.test(e)&&(e=`"${e}"`);const t=X.createElement("SPAN",{style:"font-family: "+e+";"});this.format.applyTextStyle(t,["font-family"],null,null)}else this.format.applyTextStyle(null,["font-family"],["span"],!0);this.menu.dropdownOff()},constructor:Gs};const Ys=Gs,{isMobile:Xs}=q,js=240,Ks=js/2,Js=3,Qs=10,tn=14,en={hex:"#FFFFFF",r:255,g:255,b:255,h:0,s:1,l:1};let sn,nn=0,on=!1,ln=!1,rn=js/2,an=js/2,hn=en;const cn=function(t,e,i){if(e||(e={}),this.editor=t.editor,this.eventManager=t.eventManager,this.inst=t,this.form=e.form,this.ctx={wheelX:rn,wheelY:an,lightness:nn,wheelPointerX:"50%",wheelPointerY:"50%",gradientPointerX:"calc(100% - 14px)",color:en},this.isOpen=!1,this.controlle=null,this.__globalMouseDown=null,this.__globalMouseMove=null,this.__globalMouseUp=null,!e.isNewForm){const s=function({lang:t,icons:e},i){return X.createElement("DIV",{class:`se-controller ${i}`},`\n\t\t<div class="se-hue"></div>\n\t\t<div class="se-form-group se-form-w0 se-form-flex-btn">\n\t\t\t<button type="button" class="se-btn se-btn-success" title="${t.submitButton}" aria-label="${t.submitButton}">${e.checked}</button>\n\t\t\t<button type="button" class="se-btn se-btn-danger" title="${t.close}" aria-label="${t.close}">${e.cancel}</button>\n\t\t</div>\n\t`)}(t.editor,i);this.form=s.querySelector(".se-hue"),this.controller=new $e(this,s,{position:"top",isWWTarget:!1,...e.controllerOptions}),this.eventManager.addEvent(s.querySelector(".se-btn-success"),"click",(()=>{t.hueSliderAction(this.get()),this.close()})),this.eventManager.addEvent(s.querySelector(".se-btn-danger"),"click",(()=>{this.close()}))}};cn.prototype={get:()=>hn,open(t){this.attach(),this.controller.open(t,null,{isWWTarget:!1,initMethod:null,addOffset:null})},off(){this.ctx={gradientPointerX:bn.style.left,wheelPointerX:fn.style.left,wheelPointerY:fn.style.top,wheelX:rn,wheelY:an,lightness:nn,color:sn?.color||Mn(mn)},this.controller.close(),this.init()},close(){this.off(),this.inst.hueSliderCancelAction()},attach(t){this.init(),(t||this.form).appendChild(dn),sn=this.ctx,sn&&(rn=sn.wheelX,an=sn.wheelY,nn=sn.lightness,fn.style.left=sn.wheelPointerX,fn.style.top=sn.wheelPointerY,bn.style.left=sn.gradientPointerX,Ln(sn.color.hex),Bn(),kn(Nn()));const e={name:"mousedown",func:xn},i={name:"mousemove",func:Sn,option:!0},s={name:"mouseup",func:()=>{on=!1,ln=!1}};Xs&&(e.name="touchstart",i.name="touchmove",s.name="touchend",e.func=wn,i.func=Cn),this.__globalMouseDown=this.eventManager.addGlobalEvent(e.name,e.func,{passive:!1,useCapture:!0}),this.__globalMouseMove=this.eventManager.addGlobalEvent(i.name,i.func,!0),this.__globalMouseUp=this.eventManager.addGlobalEvent(s.name,s.func,!0),this.isOpen=!0},init(){this.isOpen=!1,on=!1,ln=!1,this.__globalMouseDown&&(this.__globalMouseDown=this.eventManager.removeGlobalEvent(this.__globalMouseDown)),this.__globalMouseMove&&(this.__globalMouseMove=this.eventManager.removeGlobalEvent(this.__globalMouseMove)),this.__globalMouseUp&&(this.__globalMouseUp=this.eventManager.removeGlobalEvent(this.__globalMouseUp))},constructor:cn};const{slider:dn,offscreenCanvas:un,offscreenCtx:pn,wheel:gn,wheelCtx:mn,wheelPointer:fn,gradientBar:_n,gradientPointer:bn,fanalColorHex:vn,fanalColorBackground:yn}=function(){const t=document.createElement("canvas");t.width=js,t.height=js;const e=`\n\t<div class="se-hue-slider-container" style="width: ${js}px; height: ${js}px;">\n      <canvas class="se-hue-wheel" width="${js}" height="${js}"></canvas>\n      <div class="se-hue-wheel-pointer"></div>\n    </div>\n    <div class="se-hue-gradient-container">\n      <canvas class="se-hue-gradient" width="${js}" height="28"></canvas>\n      <div class="se-hue-gradient-pointer"></div>\n    </div>\n    <div class="se-hue-final-hex" style="width:${js}px; height: 28px;">\n\t\t<div style="flex: 3; line-height: 1.5;">${en.hex}</div>\n\t\t<div style="flex: 1; height: 100%; border: 1px solid #fff; outline: 1px solid #000;"></div>\n\t</div>\n\t`,i=X.createElement("DIV",{class:"se-hue-slider"},e),s=i.querySelector(".se-hue-wheel"),n=i.querySelector(".se-hue-gradient"),o=i.querySelector(".se-hue-final-hex").children;return{slider:i,offscreenCanvas:t,offscreenCtx:t.getContext("2d"),wheel:s,wheelCtx:s.getContext("2d"),wheelPointer:i.querySelector(".se-hue-wheel-pointer"),gradientBar:n,gradientPointer:i.querySelector(".se-hue-gradient-pointer"),fanalColorHex:o[0],fanalColorBackground:o[1]}}();function wn(t){const{target:e,touches:i}=t,s=i[0].clientX,n=i[0].clientY;e===gn?(t.preventDefault(),ln=!1,on=!0,En(s,n)):e===_n&&(t.preventDefault(),ln=!0,on=!1,Tn(s))}function Cn(t){t.preventDefault();const{touches:e}=t,i=e[0].clientX,s=e[0].clientY;on?En(i,s):ln&&Tn(i)}function xn({target:t,clientX:e,clientY:i}){t===gn?(ln=!1,on=!0,En(e,i)):t===_n&&(ln=!0,on=!1,Tn(e))}function Sn({clientX:t,clientY:e}){on?En(t,e):ln&&Tn(t)}function En(t,e){const i=gn.getBoundingClientRect();t=t-i.left-Ks,e=e-i.top-Ks;const s=180*Math.atan2(e,t)/Math.PI,n=Math.min(Math.sqrt(t*t+e*e),Ks),o=Ks+n*Math.cos(s*Math.PI/180),l=Ks+n*Math.sin(s*Math.PI/180);fn.style.left=`${o}px`,fn.style.top=`${l}px`,function(t,e){rn=t,an=e,kn(Nn())}(o,l),Hn()}function Tn(t){const e=_n.getBoundingClientRect();let i=t-e.left;i=Math.max(tn,Math.min(i,e.width-tn)),bn.style.left=`${i}px`,function(t){const e=_n.getBoundingClientRect();let i=t-e.left;i<0&&(i=0),i>e.width&&(i=e.width);const s=tn;i>=_n.width-s?i=_n.width:i<=s&&(i=0);const n=1-i/e.width;nn=n,Bn()}(t),Hn()}function kn(t){const e=_n.getContext("2d"),i=e.createLinearGradient(0,0,_n.width,0);i.addColorStop(0,"black"),i.addColorStop(1,t.hex),e.fillStyle=i,e.fillRect(0,0,_n.width,_n.height)}function Nn(){return Mn(pn)}function Hn(){sn.color=hn=Mn(mn),Ln(hn.hex)}function Ln(t){yn.style.backgroundColor=vn.textContent=t}function Mn(t){const e=t.getImageData(rn,an,1,1).data;let[i,s,n]=function([t,e,i]){t/=255,e/=255,i/=255;const s=Math.max(t,e,i),n=Math.min(t,e,i);let o,l;const r=(s+n)/2;if(s===n)o=l=0;else{const a=s-n;switch(l=r>.5?a/(2-s-n):a/(s+n),s){case t:o=(e-i)/a+(e<i?6:0);break;case e:o=(i-t)/a+2;break;case i:o=(t-e)/a+4}o/=6}return[Vn(o),Vn(l),Vn(r)]}(e);const o=rn-Ks,l=an-Ks;Math.sqrt(o*o+l*l)<Js&&(n=1-nn),n>1&&(n=1),n<0&&(n=0);const{r,g:a,b:h}=function([t,e,i]){let s,n,o;if(0===e)s=n=o=i;else{const l=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},r=i<.5?i*(1+e):i+e-i*e,a=2*i-r;s=l(a,r,t+1/3),n=l(a,r,t),o=l(a,r,t-1/3)}return{r:Math.round(255*s),g:Math.round(255*n),b:Math.round(255*o)}}([i,s,n]),c=`#${function({r:t,g:e,b:i}){let s=Math.floor(t).toString(16);t<16&&(s=`0${s}`);let n=Math.floor(e).toString(16);e<16&&(n=`0${n}`);let o=Math.floor(i).toString(16);return i<16&&(o=`0${o}`),`${s}${n}${o}`.toUpperCase()}({r,g:a,b:h})}`;return{hex:c,r,g:a,b:h,h:i,s,l:Vn(n)}}function Bn(){mn.clearRect(0,0,js,js),mn.drawImage(un,0,0),mn.globalAlpha=nn,mn.fillStyle="black",mn.beginPath(),mn.arc(Ks,Ks,Ks,0,2*Math.PI),mn.fill(),mn.globalAlpha=1}function An(t){return t*Math.PI/180}function Vn(t){const e=Math.pow(10,Qs);return Math.round(t*e)/e}!function(t){if(!t)throw new Error("Context not found.");for(let e=0;e<=360;e+=.5)for(let i=0;i<=Ks;i+=1){t.beginPath();const s=50+(Ks-i)/Ks*50;t.fillStyle=`hsl(${e}, 100%, ${s}%)`;const n=Ks+Math.cos(An(e))*i,o=Ks-Math.sin(An(e))*i;t.arc(n,o,1.5,0,2*Math.PI),t.fill()}}(pn),Bn();const In=cn,Rn=["#ff0000","#ff5e00","#ffe400","#abf200","#00d8ff","#0055ff","#6600ff","#ff00dd","#000000","#ffd8d8","#fae0d4","#faf4c0","#e4f7ba","#d4f4fa","#d9e5ff","#e8d9ff","#ffd9fa","#f1f1f1","#ffa7a7","#ffc19e","#faed7d","#cef279","#b2ebf4","#b2ccff","#d1b2ff","#ffb2f5","#bdbdbd","#f15f5f","#f29661","#e5d85c","#bce55c","#5cd1e5","#6699ff","#a366ff","#f261df","#8c8c8c","#980000","#993800","#998a00","#6b9900","#008299","#003399","#3d0099","#990085","#353535","#670000","#662500","#665c00","#476600","#005766","#002266","#290066","#660058","#222222"],zn=function(t,e,i){const s=t.editor;Ht.call(this,s),this.kind=t.constructor.key||t.constructor.name,this.inst=t,this.target=function({lang:t,icons:e},{colorList:i,disableHEXInput:s,disableRemove:n,splitNum:o}){o=(i=i||Rn)===Rn?9:o;let l="";for(let t,e=0,s=i.length,n=[];e<s;e++)t=i[e],t&&(("string"==typeof t||t.value)&&(n.push(t),e<s-1)||(n.length>0&&(l+=`<div class="se-selector-color">${Wn(n,o)}</div>`,n=[]),"object"==typeof t&&(l+=`<div class="se-selector-color">${Wn(t,o)}</div>`)));return l+=`\n\t\t<form class="se-form-group se-form-w0">\n\t\t\t${s?"":`<button type="button" class="se-btn se-btn-info" title="${t.colorPicker}" aria-label="${t.colorPicker}">${e.color_palette}</button>`}\n\t\t\t<input type="text" class="se-color-input" ${s?"readonly":""} placeholder="${t.color}" />\n\t\t\t${s?"":`<button type="submit" class="se-btn se-btn-success" title="${t.submitButton}" aria-label="${t.submitButton}">${e.checked}</button>`}\n\t\t\t${n?"":`<button type="button" class="se-btn __se_remove" title="${t.remove}" aria-label="${t.remove}">${e.remove_color}</button>`}\n\t\t</form>`,X.createElement("DIV",{class:"se-list-inner"},l)}(s,i),this.targetButton=null,this.inputElement=this.target.querySelector(".se-color-input"),this.styleProperties=e,this.splitNum=i.splitNum||0,this.defaultColor=i.defaultColor,this.hueSliderOptions=i.hueSliderOptions,this.parentDisplay="",this.currentColor="",this.parentForm=null,this.colorList=this.target.querySelectorAll("li button")||[],this.hueSlider=null,i.disableHEXInput||(this.hueSlider=new In(this,i.hueSliderOptions,"se-dropdown"),this.parentFormDisplay=[],this.parentForm=i.hueSliderOptions?.controllerOptions?.parents?.length>0&&!i.hueSliderOptions?.controllerOptions?.isInsideForm?i.hueSliderOptions.controllerOptions.parents:null,this.eventManager.addEvent(this.target.querySelector(".se-btn-info"),"click",On.bind(this)),this.eventManager.addEvent(this.inputElement,"input",Fn.bind(this)),this.eventManager.addEvent(this.target.querySelector("form"),"submit",$n.bind(this))),i.disableRemove||this.eventManager.addEvent(this.target.querySelector(".__se_remove"),"click",Dn.bind(this)),this.eventManager.addEvent(this.target,"click",Pn.bind(this))};function On(){this.parentForm?.length>0&&this.parentForm.forEach((t=>{this.parentFormDisplay.push([t,t.style.display]),t.style.display="none"})),this.hueSlider.open(this.targetButton)}function $n(t){t.preventDefault(),"function"==typeof this.inst.colorPickerAction&&this.inst.colorPickerAction(this.currentColor)}function Pn(t){const e=t.target.getAttribute("data-value");e&&"function"==typeof this.inst.colorPickerAction&&this.inst.colorPickerAction(e)}function Dn(){"function"==typeof this.inst.colorPickerAction&&this.inst.colorPickerAction(null)}function Fn(t){this.setHexColor(t.target.value)}function Wn(t,e){const i=`<ul class="se-color-pallet${e?" se-list-horizontal":""}">`;let s=i;for(let n,o,l,r=0,a=t.length;r<a;r++)n=t[r],"string"==typeof n?(o=n,l=n):"object"==typeof n&&(o=n.value,l=n.name||o),r>0&&r%e==0&&(s+=`</ul>${i}`),s+=`<li><button type="button" data-value="${o}" title="${l}" aria-label="${l}" style="background-color:${o};"></button></li>`;return s+="</ul>",s}zn.prototype={hueSliderAction(t){this._setInputText(t.hex)},hueSliderCancelAction(){this.parentForm?.length>0&&this.parentFormDisplay.forEach((t=>t[0].style.display=t[1]))},hueSliderClose(){this.hueSlider.off()},init(t,e){this.targetButton=e;const i=this.editor.frameContext.get("wwComputedStyle")[this.styleProperties],s=this.defaultColor||Y.isHexColor(i)?i:Y.rgb2hex(i);let n=("string"==typeof t?t:this._getColorInNode(t))||s;n=Y.isHexColor(n)?n:Y.rgb2hex(n)||n||"";const o=this.colorList;for(let t=0,e=o.length;t<e;t++)n.toLowerCase()===o[t].getAttribute("data-value").toLowerCase()?X.addClass(o[t],"active"):X.removeClass(o[t],"active");this._setInputText(this._colorName2hex(n))},setHexColor(t){this.currentColor=t,this.inputElement.style.borderColor=t},_setInputText(t){t=/^#/.test(t)?t:"#"+t,this.inputElement.value=t,this.setHexColor.call(this,t)},_getColorInNode(t){let e="";const i=this.styleProperties;for(;t&&!X.isWysiwygFrame(t)&&0===e.length;)1===t.nodeType&&t.style[i]&&(e=t.style[i]),t=t.parentNode;return e},_colorName2hex(t){if(/^#/.test(t))return t;const e=X.createElement("div",{style:"display: none; color: "+t}),i=this._w.getComputedStyle(this._d.body.appendChild(e)).color.match(/\d+/g).map((function(t){return parseInt(t,10)}));return X.removeItem(e),i.length>=3&&"#"+((1<<24)+(i[0]<<16)+(i[1]<<8)+i[2]).toString(16).substr(1)},constructor:zn};const Un=zn,Zn=function(t,e){He.call(this,t),this.title=this.lang.fontColor,this.icon="font_color";const i=X.createElement("DIV",{class:"se-dropdown se-list-layer"},null);this.colorPicker=new Un(this,"color",{colorList:e.items,splitNum:e.splitNum,disableHEXInput:e.disableHEXInput,hueSliderOptions:{controllerOptions:{parents:[i],isOutsideForm:!0}}}),i.appendChild(this.colorPicker.target),this.menu.initDropdownTarget(Zn,i)};Zn.key="fontColor",Zn.type="dropdown-free",Zn.className="",Zn.prototype={on(t){this.colorPicker.init(this.selection.getNode(),t)},onDropdownClose(){this.colorPicker.hueSliderClose()},colorPickerAction(t){this.action(t)},action(t){if(t){const e=X.createElement("SPAN",{style:"color: "+t+";"});this.format.applyTextStyle(e,["color"],null,null)}else this.format.applyTextStyle(null,["color"],["span"],!0);this.menu.dropdownOff()},constructor:Zn};const qn=Zn,Gn=function(t,e){He.call(this,t),this.title=this.lang.backgroundColor,this.icon="background_color";const i=X.createElement("DIV",{class:"se-dropdown se-list-layer"},null);this.colorPicker=new Un(this,"backgroundColor",{colorList:e.items,splitNum:e.splitNum,disableHEXInput:e.disableHEXInput,hueSliderOptions:{controllerOptions:{parents:[i],isOutsideForm:!0}}}),i.appendChild(this.colorPicker.target),this.menu.initDropdownTarget(Gn,i)};Gn.key="backgroundColor",Gn.type="dropdown-free",Gn.className="",Gn.prototype={on(t){this.colorPicker.init(this.selection.getNode(),t)},off(){this.colorPicker.hueSliderClose()},colorPickerAction(t){this.action(t)},action(t){if(t){const e=X.createElement("SPAN",{style:"background-color: "+t+";"});this.format.applyTextStyle(e,["background-color"],null,null)}else this.format.applyTextStyle(null,["background-color"],["span"],!0);this.menu.dropdownOff()},constructor:Gn};const Yn=Gn,Xn=function(t,e){He.call(this,t),this.title=this.lang.horizontalLine,this.icon="horizontal_line";const i=function({lang:t},e){const i=e||[{name:t.hr_solid,class:"__se__solid"},{name:t.hr_dashed,class:"__se__dashed"},{name:t.hr_dotted,class:"__se__dotted"}];let s="";for(let t=0,e=i.length;t<e;t++)s+=`\n\t\t<li>\n\t\t\t<button type="button" class="se-btn se-btn-list" data-command="hr" title="${i[t].name}" aria-label="${i[t].name}">\n\t\t\t\t<hr${i[t].class?` class="${i[t].class}"`:""}${i[t].style?` style="${i[t].style}"`:""}/>\n\t\t\t</button>\n\t\t</li>`;return X.createElement("DIV",{class:"se-dropdown se-list-layer se-list-line"},`\n\t\t<div class="se-list-inner">\n\t\t\t<ul class="se-list-basic">${s}</ul>\n\t\t</div>`)}(t,e.items);this.list=i.querySelectorAll("button"),this.menu.initDropdownTarget(Xn,i)};Xn.key="hr",Xn.type="dropdown",Xn.className="",Xn.component=function(t){return/^hr$/i.test(t?.nodeName)?t:null},Xn.prototype={select(t){X.addClass(t,"on")},deselect(t){X.removeClass(t,"on")},destroy(t){if(!t)return;const e=t.previousElementSibling||t.nextElementSibling;X.removeItem(t),this.editor.focusEdge(e),this.history.push(!1)},action(t){const e=t.firstElementChild.cloneNode(!1);this.editor.focus(),this.component.insert(e,!1,!1),this.menu.dropdownOff();const i=this.format.addLine(e);this.selection.setRange(i,1,i,1)},constructor:Xn};const jn=Xn,Kn=function(t){He.call(this,t),this.title=this.lang.list,this.icon="list_numbered";const e=function({lang:t,icons:e}){const i=`\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic">\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list se-tooltip se-icon-flip-rtl" data-command="ol" title="${t.numberedList}" aria-label="${t.numberedList}">\n\t\t\t\t\t${e.list_numbered}\n\t\t\t\t</button>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list se-tooltip se-icon-flip-rtl" data-command="ul" title="${t.bulletedList}" aria-label="${t.bulletedList}">\n\t\t\t\t\t${e.list_bulleted}\n\t\t\t\t</button>\n\t\t\t</li>\n\t\t</ul>\n\t</div>`;return X.createElement("DIV",{class:"se-dropdown se-list-layer"},i)}(t);this.listItems=e.querySelectorAll("li button"),this.icons={bulleted:t.icons.list_bulleted,numbered:t.icons.list_numbered},this.menu.initDropdownTarget(Kn,e)};Kn.key="list",Kn.type="dropdown",Kn.className="se-icon-flip-rtl",Kn.prototype={active(t,e){const i=e.firstElementChild;if(X.isList(t)){const s=t.nodeName.toLowerCase();return e.setAttribute("data-focus",s),X.addClass(e,"active"),/^ul$/.test(s)?X.changeElement(i,this.icons.bulleted):X.changeElement(i,this.icons.numbered),!0}return e.removeAttribute("data-focus"),X.changeElement(i,this.icons.number),X.removeClass(e,"active"),!1},on(t){const e=t.getAttribute("data-focus")||"",i=this.listItems;for(let t=0,s=i.length;t<s;t++)e===i[t].getAttribute("data-command")?X.addClass(i[t],"active"):X.removeClass(i[t],"active")},action(t){const e=t.getAttribute("data-command"),i=t.getAttribute("data-value")||"",s=this.format.applyList(`${e}:${i}`,null,!1);s&&this.selection.setRange(s.sc,s.so,s.ec,s.eo),this.menu.dropdownOff(),this.history.push(!1)},constructor:Kn};const Jn=Kn,{_w:Qn,ON_OVER_COMPONENT:to}=q,eo=".se-table-resize-line",io=".se-table-resize-line-prev",so=".se-table-resize-row",no=".se-table-resize-row-prev",oo=["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],lo={all:"border_all",inside:"border_inside",horizon:"border_horizontal",vertical:"border_vertical",outside:"border_outside",left:"border_left",top:"border_top",right:"border_right",bottom:"border_bottom",none:"border_none"},ro=["all","inside","horizon","vertical"],ao="borderLeft",ho="borderTop",co="borderRight",uo="borderBottom",po=["#b0dbb0","#efef7e","#f2acac","#dcb0f6","#99bdff","#5dbd5d","#e7c301","#f64444","#e57ff4","#4387f1","#27836a","#f69915","#ba0808","#a90bed","#134299","#e4e4e4","#B3B3B3","#808080","#4D4D4D","#000000"],go=function(t,e){He.call(this,t),this.title=this.lang.table,this.icon="table",this.figureScrollList=["se-scroll-figure-xy","se-scroll-figure-x","se-scroll-figure-y"],this.figureScroll="string"==typeof e.scrollType?e.scrollType.toLowerCase():"x",this.captionPosition="bottom"!==e.captionPosition?"top":"bottom",this.cellControllerTop="table"==("cell"!==e.cellControllerPosition?"table":"cell");const i=X.createElement("DIV",{class:"se-dropdown se-selector-table"},'\n\t<div class="se-table-size">\n\t\t<div class="se-table-size-picker se-controller-table-picker"></div>\n\t\t<div class="se-table-size-highlighted"></div>\n\t\t<div class="se-table-size-unhighlighted"></div>\n\t</div>\n\t<div class="se-table-size-display">1 x 1</div>'),s=i.querySelector(".se-controller-table-picker"),n=function({lang:t,icons:e}){const i=`\n\t<div class="se-arrow se-arrow-down se-visible-hidden"></div>\n\t<div class="se-btn-group">\n\t\t<button type="button" data-command="openTableProperties" class="se-btn se-tooltip">\n\t\t\t${e.table_properties}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.tableProperties}</span>\n\t\t\t</span>\n\t\t</button>\n\t\t<button type="button" data-command="layout" class="se-btn se-tooltip _se_table_fixed_column">\n\t\t\t${e.fixed_column_width}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.fixedColumnWidth}</span>\n\t\t\t</span>\n\t\t</button>\n\t\t<button type="button" data-command="header" class="se-btn se-tooltip _se_table_header">\n\t\t\t${e.table_header}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.tableHeader}</span>\n\t\t\t</span>\n\t\t</button>\n\t\t<button type="button" data-command="caption" class="se-btn se-tooltip _se_table_caption">\n\t\t\t${e.caption}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.caption}</span>\n\t\t\t</span>\n\t\t</button>\n\t\t<button type="button" data-command="resize" class="se-btn se-tooltip _se_table_resize">\n\t\t\t${e.reduction}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.minSize}</span>\n\t\t\t</span>\n\t\t</button>\n\t\t<button type="button" data-command="remove" class="se-btn se-tooltip">\n\t\t\t${e.delete}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.remove}</span>\n\t\t\t</span>\n\t\t</button>\n\t</div>`;return X.createElement("DIV",{class:"se-controller se-controller-table"},i)}(t),o=function({lang:t,icons:e},i){const s=`\n\t<div class="se-arrow se-arrow-${i?"down se-visible-hidden":"up"}"></div>\n    <div class="se-btn-group">\n\t\t<button type="button" data-command="openCellProperties" class="se-btn se-tooltip">\n\t\t\t${e.cell_properties}\n\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t<span class="se-tooltip-text">${t.cellProperties}</span>\n\t\t\t</span>\n\t\t</button>\n        <button type="button" data-command="oncolumn" class="se-btn se-tooltip">\n            ${e.table_column}\n            <span class="se-tooltip-inner">\n                <span class="se-tooltip-text">${t.column}</span>\n            </span>\n        </button>\n        <button type="button" data-command="onrow" class="se-btn se-tooltip">\n            ${e.table_row}\n            <span class="se-tooltip-inner">\n                <span class="se-tooltip-text">${t.row}</span>\n            </span>\n        </button>\n        <button type="button" data-command="merge" class="se-btn se-tooltip" style="display: none;">\n            ${e.merge_cell}\n            <span class="se-tooltip-inner">\n                <span class="se-tooltip-text">${t.mergeCells}</span>\n            </span>\n        </button>\n        <button type="button" data-command="onsplit" class="se-btn se-tooltip">\n            ${e.split_cell}\n            <span class="se-tooltip-inner">\n                <span class="se-tooltip-text">${t.splitCells}</span>\n            </span>\n        </button>\n    </div>`;return X.createElement("DIV",{class:"se-controller se-controller-table-cell"},s)}(t,this.cellControllerTop),l=function({lang:t,icons:e,options:i}){const s=i.get("_rtl")?["right","center","left","justify"]:["left","center","right","justify"];let n="";for(let i,o,l=0;l<s.length;l++)i=s[l],o=t["align"+i.charAt(0).toUpperCase()+i.slice(1)],n+=`\n\t\t<li>\n\t\t\t<button type="button" class="se-btn se-btn-list se-tooltip" data-command="props_align" data-value="${i}" title="${o}" aria-label="${o}">\n\t\t\t\t${e["align_"+i]}\n\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t<span class="se-tooltip-text">${o}</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t</li>`;const o=["top","middle","bottom"];let l="";for(let i,s,n=0;n<o.length;n++)i=o[n],s=t["align"+i.charAt(0).toUpperCase()+i.slice(1)],l+=`\n\t\t<li>\n\t\t\t<button type="button" class="se-btn se-btn-list se-tooltip" data-command="props_align_vertical" data-value="${i}" title="${s}" aria-label="${s}">\n\t\t\t\t${e["align_"+i]}\n\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t<span class="se-tooltip-text">${s}</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t</li>`;const r=`\n\t\t<div class="se-controller-content">\n\t\t\t<div class="se-controller-header">\n\t\t\t\t<button type="button" data-command="close_props" class="se-btn se-close-btn close" title="${t.close}" aria-label="${t.close}">${e.cancel}</button>\n\t\t\t\t<span class="se-controller-title">${t.tableProperties}</span>\n\t\t\t</div>\n\t\t\t<div class="se-controller-body">\n\n\t\t\t\t<label>${t.border}</label>\n\t\t\t\t<div class="se-form-group se-form-w0">\n\t\t\t\t\t<button type="button" data-command="props_onborder_format" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e[lo.all]}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.border}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" data-command="props_onborder_style" class="se-btn se-btn-select se-tooltip se-border-style">\n\t\t\t\t\t\t<span class="se-txt"></span>\n\t\t\t\t\t\t${e.arrow_down}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.border}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<input type="text" class="se-color-input __se_border_color" placeholder="${t.color}" />\n\t\t\t\t\t<button type="button" data-command="props_onpalette" data-value="border" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.color_palette}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.colorPicker}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<input type="text" class="se-input-control __se__border_size" placeholder="${t.width}" />\n\t\t\t\t</div>\n\n\t\t\t\t<label>${t.color}</label>\n\t\t\t\t<div class="se-form-group se-form-w0">\n\t\t\t\t\t<button type="button" data-command="props_onpalette" data-value="font" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.font_color}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.fontColor}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<input type="text" class="se-color-input __se_font_color" placeholder="${t.fontColor}" />\n\t\t\t\t\t<button type="button" data-command="props_onpalette" data-value="back" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.background_color}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.backgroundColor}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<input type="text" class="se-color-input __se_back_color" placeholder="${t.backgroundColor}" />\n\t\t\t\t</div>\n\n\t\t\t\t<label>${t.font}</label>\n\t\t\t\t<div class="se-form-group se-form-w0">\n\t\t\t\t\t<button type="button" data-command="props_font_style" data-value="bold" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.bold}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.bold}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" data-command="props_font_style" data-value="underline" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.underline}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.underline}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" data-command="props_font_style" data-value="italic" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.italic}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.italic}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" data-command="props_font_style" data-value="strike" class="se-btn se-tooltip">\n\t\t\t\t\t\t${e.strike}\n\t\t\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t\t\t<span class="se-tooltip-text">${t.strike}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="se-table-props-align">\n\t\t\t\t\t<label>${t.align}</label>\n\t\t\t\t\t<div class="se-form-group se-form-w0 se-list-inner __se__a_h">\n\t\t\t\t\t\t<ul class="se-form-group se-form-w0">${n}</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="se-form-group se-form-w0 se-list-inner __se__a_v">\n\t\t\t\t\t\t<ul class="se-form-group se-form-w0">${l}</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="se-form-group se-form-w0 se-form-flex-btn">\n\t\t\t\t<button type="button" class="se-btn se-btn-success" data-command="props_submit" title="${t.submitButton}" aria-label="${t.submitButton}">${e.checked}</button>\n\t\t\t\t<button type="button" class="se-btn se-btn-danger" data-command="revert" title="${t.revert}" aria-label="${t.revert}">${e.revert}</button>\n\t\t\t</div>\n\t\t</div>`;return X.createElement("DIV",{class:"se-controller se-table-props"},r)}(t);t.applyFrameRoots((t=>{t.get("wrapper").appendChild(X.createElement("DIV",{class:eo.replace(/^\./,"")})),t.get("wrapper").appendChild(X.createElement("DIV",{class:io.replace(/^\./,"")})),t.get("wrapper").appendChild(X.createElement("DIV",{class:so.replace(/^\./,"")})),t.get("wrapper").appendChild(X.createElement("DIV",{class:no.replace(/^\./,"")}))})),this.controller_table=new $e(this,n,{position:"top"}),this.controller_cell=new $e(this,o,{position:this.cellControllerTop?"top":"bottom"});const r=[this.controller_table.form,this.controller_cell.form];this.controller_props=new $e(this,l,{position:"bottom",parents:r,isInsideForm:!0}),this.controller_props_title=l.querySelector(".se-controller-title");const a=X.createElement("DIV",{class:"se-controller se-list-layer"},null);this.colorPicker=new Un(this,"",{colorList:e.colorList||po,splitNum:5,disableRemove:!0,hueSliderOptions:{controllerOptions:{parents:[a],isOutsideForm:!0}}}),a.appendChild(this.colorPicker.target),this.controller_colorPicker=new $e(this,a,{position:"bottom",parents:[this.controller_props.form].concat(r),isInsideForm:!0,isWWTarget:!1,initMethod:()=>{this.colorPicker.hueSlider.close(),X.removeClass(this.controller_colorPicker.currentTarget,"on")}}),this.figure=new gi(this,null,{}),this.sliderType="";const h=(c=this.lang,{items:["vertical","horizontal"],menus:X.createElement("DIV",null,`\n\t\t<div title="${c.verticalSplit}" aria-label="${c.verticalSplit}">\n\t\t\t${c.verticalSplit}\n\t\t</div>\n\t\t<div title="${c.horizontalSplit}" aria-label="${c.horizontalSplit}">\n\t\t\t${c.horizontalSplit}\n\t\t</div>`).querySelectorAll("div")});var c;this.splitButton=o.querySelector('[data-command="onsplit"]'),this.selectMenu_split=new Ye(this,{checkList:!1,position:"bottom-center"}),this.selectMenu_split.on(this.splitButton,bo.bind(this)),this.selectMenu_split.create(h.items,h.menus);const d=function(t,e){return{items:["insert-left","insert-right","delete"],menus:X.createElement("DIV",null,`\n\t\t<div title="${t.insertColumnBefore}" aria-label="${t.insertColumnBefore}">\n\t\t\t<span class="se-list-icon">${e.insert_column_left}</span><span class="se-txt">${t.insertColumnBefore}</span>\n\t\t</div>\n\t\t<div title="${t.insertColumnAfter}" aria-label="${t.insertColumnAfter}">\n\t\t\t<span class="se-list-icon">${e.insert_column_right}</span><span class="se-txt">${t.insertColumnAfter}</span>\n\t\t</div>\n\t\t<div title="${t.deleteColumn}" aria-label="${t.deleteColumn}">\n\t\t\t<span class="se-list-icon">${e.delete_column}</span><span class="se-txt">${t.deleteColumn}</span>\n\t\t</div>`).querySelectorAll("div")}}(this.lang,this.icons),u=o.querySelector('[data-command="oncolumn"]');this.selectMenu_column=new Ye(this,{checkList:!1,position:"bottom-center"}),this.selectMenu_column.on(u,vo.bind(this)),this.selectMenu_column.create(d.items,d.menus);const p=function(t,e){return{items:["insert-above","insert-below","delete"],menus:X.createElement("DIV",null,`\n\t\t<div title="${t.insertRowAbove}" aria-label="${t.insertRowAbove}">\n\t\t\t<span class="se-list-icon">${e.insert_row_above}</span><span class="se-txt">${t.insertRowAbove}</span>\n\t\t</div>\n\t\t<div title="${t.insertRowBelow}" aria-label="${t.insertRowBelow}">\n\t\t\t<span class="se-list-icon">${e.insert_row_below}</span><span class="se-txt">${t.insertRowBelow}</span>\n\t\t</div>\n\t\t<div title="${t.deleteRow}" aria-label="${t.deleteRow}">\n\t\t\t<span class="se-list-icon">${e.delete_row}</span><span class="se-txt">${t.deleteRow}</span>\n\t\t</div>`).querySelectorAll("div")}}(this.lang,this.icons),g=o.querySelector('[data-command="onrow"]');this.selectMenu_row=new Ye(this,{checkList:!1,position:"bottom-center"}),this.selectMenu_row.on(g,yo.bind(this)),this.selectMenu_row.create(p.items,p.menus);const m=function(){let t="";for(let e,i=0,s=oo.length;i<s;i++)e=oo[i],t+=`\n\t\t<div title="${e}" aria-label="${e}" style="padding: 0 12px;">\n\t\t\t<span class="se-txt">${e}</span>\n\t\t</div>`;const e=X.createElement("DIV",null,t);return{items:oo,menus:e.querySelectorAll("div")}}(),f=l.querySelector('[data-command="props_onborder_style"]');this.selectMenu_props_border=new Ye(this,{checkList:!1,position:"bottom-center"}),this.selectMenu_props_border.on(f,No.bind(this)),this.selectMenu_props_border.create(m.items,m.menus);const _=Lo(this.lang,this.icons,[]),b=l.querySelector('[data-command="props_onborder_format"]');this.selectMenu_props_border_format=new Ye(this,{checkList:!1,position:"bottom-left",dir:"ltr",splitNum:5}),this.selectMenu_props_border_format.on(b,Ho.bind(this,"all")),this.selectMenu_props_border_format.create(_.items,_.menus);const v=Lo(this.lang,this.icons,ro);this.selectMenu_props_border_format_oneCell=new Ye(this,{checkList:!1,position:"bottom-left",dir:"ltr",splitNum:6}),this.selectMenu_props_border_format_oneCell.on(b,Ho.bind(this,"outside")),this.selectMenu_props_border_format_oneCell.create(v.items,v.menus),this.maxText=this.lang.maxSize,this.minText=this.lang.minSize,this.propTargets={cell_alignment:l.querySelector(".se-table-props-align > .__se__a_h"),cell_alignment_vertical:l.querySelector(".se-table-props-align > .__se__a_v"),border_format:b,border_style:l.querySelector('[data-command="props_onborder_style"] .se-txt'),border_color:l.querySelector(".__se_border_color"),border_width:l.querySelector(".__se__border_size"),back_color:l.querySelector(".__se_back_color"),font_color:l.querySelector(".__se_font_color"),palette_border_button:l.querySelector('[data-command="props_onpalette"][data-value="border"]'),font_bold:l.querySelector('[data-command="props_font_style"][data-value="bold"]'),font_underline:l.querySelector('[data-command="props_font_style"][data-value="underline"]'),font_italic:l.querySelector('[data-command="props_font_style"][data-value="italic"]'),font_strike:l.querySelector('[data-command="props_font_style"][data-value="strike"]')},this._propsCache=[],this._currentFontStyles=[],this._propsAlignCache="",this._propsVerticalAlignCache="",this._typeCache="",this.tableHighlight=i.querySelector(".se-table-size-highlighted"),this.tableUnHighlight=i.querySelector(".se-table-size-unhighlighted"),this.tableDisplay=i.querySelector(".se-table-size-display"),this.resizeButton=n.querySelector("._se_table_resize"),this.resizeText=n.querySelector("._se_table_resize > span > span"),this.columnFixedButton=n.querySelector("._se_table_fixed_column"),this.headerButton=n.querySelector("._se_table_header"),this.captionButton=n.querySelector("._se_table_caption"),this.mergeButton=o.querySelector('[data-command="merge"]'),this._resizing=!1,this._resizeLine=null,this._resizeLinePrev=null,this._figure=null,this._element=null,this._tdElement=null,this._trElement=null,this._trElements=null,this._tableXY=[],this._maxWidth=!0,this._fixedColumn=!1,this._physical_cellCnt=0,this._logical_cellCnt=0,this._rowCnt=0,this._rowIndex=0,this._physical_cellIndex=0,this._logical_cellIndex=0,this._current_colSpan=0,this._current_rowSpan=0,this._selectedCells=null,this._shift=!1,this._fixedCell=null,this._fixedCellName=null,this._selectedCell=null,this._selectedTable=null,this._ref=null,this._bindMultiOn=So.bind(this),this._bindMultiOff=Eo.bind(this),this._bindShiftOff=To.bind(this),this._bindTouchOff=ko.bind(this),this.__globalEvents={on:null,off:null,shiftOff:null,touchOff:null,resize:null,resizeStop:null,resizeKeyDown:null},this.menu.initDropdownTarget(go,i),this.eventManager.addEvent(s,"mousemove",wo.bind(this)),this.eventManager.addEvent(s,"click",Co.bind(this))};function mo(t){return/^(TD|TH|TR)$/i.test(t?.nodeName)}function fo(t,e){const i=t.clientX,s=j.get(Qn.getComputedStyle(e).width,0),n=e.getBoundingClientRect(),o=Math.round(i-n.left),l=o<=2;return{is:l||s-o<=2,isLeft:l,startX:i}}function _o(t,e){const i=t.clientY,s=j.get(Qn.getComputedStyle(e).height,0),n=e.getBoundingClientRect();return{is:Math.ceil(s+n.top-i)<=5,startY:i}}function bo(t){const e="vertical"===t,i=this._tdElement,s=this._trElements,n=this._trElement,o=this._logical_cellIndex,l=this._rowIndex,r=xo(i.nodeName,0,!0);if(e){const t=i.colSpan;if(r.rowSpan=i.rowSpan,t>1)r.colSpan=Math.floor(t/2),i.colSpan=t-r.colSpan,n.insertBefore(r,i.nextElementSibling);else{let e=[],l=[];for(let n,r,a=0,h=this._rowCnt;a<h;a++){n=s[a].cells,r=0;for(let s,h,c,d,u=0,p=n.length;u<p;u++){if(s=n[u],h=s.colSpan-1,c=s.rowSpan-1,d=u+r,l.length>0)for(let t,e=0;e<l.length;e++)t=l[e],t.row>a||(d>=t.index?(r+=t.cs,d+=t.cs,t.rs-=1,t.row=a+1,t.rs<1&&(l.splice(e,1),e--)):u===p-1&&(t.rs-=1,t.row=a+1,t.rs<1&&(l.splice(e,1),e--)));if(d<=o&&c>0&&e.push({index:d,cs:h+1,rs:c,row:-1}),s!==i&&d<=o&&d+h>=o+t-1){s.colSpan+=1;break}if(d>o)break;r+=h}l=l.concat(e).sort((function(t,e){return t.index-e.index})),e=[]}n.insertBefore(r,i.nextElementSibling)}}else{const t=i.rowSpan;if(r.colSpan=i.colSpan,t>1){r.rowSpan=Math.floor(t/2);const e=t-r.rowSpan,l=[],a=X.getArrayIndex(s,n)+e;for(let t,e,i=0;i<a;i++){t=s[i].cells,e=0;for(let s,n,r,h=0,c=t.length;h<c&&(r=h+e,!(r>=o));h++)s=t[h],n=s.rowSpan-1,n>0&&n+i>=a&&r<o&&l.push({index:r,cs:s.colSpan}),e+=s.colSpan-1}const h=s[a],c=h.cells;let d=l.shift();for(let t,e,i,s,n=0,a=c.length,u=0;n<a;n++){if(i=n+u,t=c[n],e=t.colSpan-1,s=i+e+1,d&&s>=d.index&&(u+=d.cs,s+=d.cs,d=l.shift()),s>=o||n===a-1){h.insertBefore(r,t.nextElementSibling);break}u+=e}i.rowSpan=e}else{r.rowSpan=i.rowSpan;const t=X.createElement("TR");t.appendChild(r);for(let t,e=0;e<l;e++){if(t=s[e].cells,0===t.length)return;for(let i=0,s=t.length;i<s;i++)e+t[i].rowSpan-1>=l&&(t[i].rowSpan+=1)}const e=this._physical_cellIndex,o=n.cells;for(let t=0,i=o.length;t<i;t++)t!==e&&(o[t].rowSpan+=1);n.parentNode.insertBefore(t,n.nextElementSibling)}}this.selectMenu_split.close(),this.editor.focusEdge(i),this._deleteStyleSelectedCells(),this.history.push(!1),this.setController(i),this._selectedCell=this._fixedCell=i}function vo(t){switch(t){case"insert-left":this.editTable("cell","left");break;case"insert-right":this.editTable("cell","right");break;case"delete":this.editTable("cell",null)}this._historyPush()}function yo(t){switch(t){case"insert-above":this.editTable("row","up");break;case"insert-below":this.editTable("row","down");break;case"delete":this.editTable("row",null)}this._historyPush()}function wo(t){t.stopPropagation();let e=Math.ceil(t.offsetX/18),i=Math.ceil(t.offsetY/18);e=e<1?1:e,i=i<1?1:i,this.options.get("_rtl")&&(this.tableHighlight.style.left=18*e-13+"px",e=11-e),this.tableHighlight.style.width=e+"em",this.tableHighlight.style.height=i+"em";const s=e<5?5:e>8?10:e+2,n=i<5?5:i>8?10:i+2;this.tableUnHighlight.style.width=s+"em",this.tableUnHighlight.style.height=n+"em",X.changeTxt(this.tableDisplay,e+" x "+i),this._tableXY=[e,i]}function Co(){this.action()}function xo(t,e,i){return t=t.toLowerCase(),i?X.createElement(t,null,"<div><br></div>"):`<${t}><div><br></div></${t}>`.repeat(e)}function So(t){this.editor._antiBlur=!0;const e=X.getParentElement(t.target,X.isTableCell);if(this._shift){if(e===this._fixedCell)return this._shift=!1,this._deleteStyleSelectedCells(),this._toggleEditor(!0),void this.__removeGlobalEvents();this._toggleEditor(!1)}else if(!this._ref){if(e===this._fixedCell)return;this._toggleEditor(!1)}e&&e!==this._selectedCell&&this._fixedCellName===e.nodeName&&this._selectedTable===X.getParentElement(e,"TABLE")&&(this._selectedCell=e,this._setMultiCells(this._fixedCell,e))}function Eo(t){if(t.stopPropagation(),this._shift?this.__globalEvents.touchOff&&(this.__globalEvents.touchOff=this.eventManager.removeGlobalEvent(this.__globalEvents.touchOff)):(this.__removeGlobalEvents(),this._toggleEditor(!0)),!this._fixedCell||!this._selectedTable)return;this.setMergeSplitButton(this._fixedCell,this._selectedCell),this._selectedCells=Array.from(this._selectedTable.querySelectorAll(".se-selected-table-cell"));const e=this._selectedCells?.length>0?this._selectedCell:this._fixedCell;this.setController(e)}function To(){this._ref||this._closeController()}function ko(){this.close()}function No(t){this.propTargets.border_style.textContent=t,this._disableBorderProps(t===oo[0]),this.selectMenu_props_border.close()}function Ho(t,e){const{border_format:i}=this.propTargets;i.setAttribute("se-border-format",e),i.firstElementChild.innerHTML=this.icons[lo[e]],e!==t?X.addClass(i,"active"):X.removeClass(i,"active"),this.selectMenu_props_border_format.close(),this.selectMenu_props_border_format_oneCell.close()}function Lo(t,e,i){const s=[];let n="";for(const o in lo){if(i.includes(o))continue;const l=lo[o];s.push(o),n+=`\n\t\t\t<button type="button" class="se-btn se-tooltip">\n\t\t\t\t${e[l]}\n\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t<span class="se-tooltip-text">${t[l]}</span>\n\t\t\t\t</span>\n\t\t\t</button>`}return{items:s,menus:X.createElement("DIV",null,n).querySelectorAll("button")}}go.key="table",go.type="dropdown-free",go.className="",go.component=function(t){return X.isTable(t)?t:null},go.options={isInputComponent:!0},go.prototype={action(){const t=X.createElement("TABLE"),e=this._tableXY[0],i=this._tableXY[1],s=`<tbody>${`<tr>${xo("td",e,!1)}</tr>`.repeat(i)}</tbody>`,n=`<colgroup>${`<col style="width: ${j.get(100/e,0)}%;">`.repeat(e)}</colgroup>`;t.innerHTML=n+s;const o=X.createElement("FIGURE",{class:"se-flex-component se-input-component"});if(o.appendChild(t),this.component.insert(o,!1,!1)){this._resetTablePicker();const e=t.querySelector("td div");this.selection.setRange(e,0,e,0)}},retainFormat(){return{query:"table",method:t=>{const e=t.querySelector("colgroup");let i=X.isFigure(t.parentNode)?t.parentNode:null;if(!e||!i){if(!e){const e=function(t){let e=0;for(const i of t.rows){let t=0;for(const e of i.cells)t+=e.colSpan;e=Math.max(e,t)}return e}(t),i=X.createElement("colgroup",null,`<col style="width: ${j.get(100/e,0)}%;">`.repeat(e));t.insertBefore(i,t.firstElementChild)}if(i?X.addClass(i,"se-flex-component|se-input-component"):(i=X.createElement("FIGURE",{class:"se-flex-component se-input-component"}),t.parentNode.insertBefore(i,t),i.appendChild(t)),this.figureScroll){const t=`se-scroll-figure-${this.figureScroll}`;X.addClass(i,t),X.removeClass(i,this.figureScrollList.filter((e=>e!==t)).join("|"))}else X.removeClass(i,this.figureScrollList.join("|"))}}}},setDir(t){this.tableHighlight.style.left="rtl"===t?"167px":"",this._resetTablePicker(),this._resetPropsAlign("rtl"===t)},onMouseMove({event:t}){if(this._resizing)return;const e=X.getParentElement(t.target,mo);if(!e||this._fixedCell)return void this.__hideResizeLine();const i=fo(t,e);return i.is?(this._element&&(this._element.style.cursor=""),this.__removeGlobalEvents(),"block"===this._resizeLine?.style.display&&(this._resizeLine.style.display="none"),this._resizeLine=this.editor.frameContext.get("wrapper").querySelector(eo),this._setResizeLinePosition(X.getParentElement(e,X.isTable),e,this._resizeLine,i.isLeft),void(this._resizeLine.style.display="block")):_o(t,e).is?(this.__removeGlobalEvents(),this._element=X.getParentElement(e,X.isTable),this._element.style.cursor="ns-resize","block"===this._resizeLine?.style.display&&(this._resizeLine.style.display="none"),this._resizeLine=this.editor.frameContext.get("wrapper").querySelector(so),this._setResizeRowPosition(X.getParentElement(e,X.isTable),e,this._resizeLine),void(this._resizeLine.style.display="block")):(this._element&&(this._element.style.cursor=""),void this.__hideResizeLine())},onScroll(){"block"===this._resizeLine?.style.display&&(this._element&&(this._element.style.cursor=""),this._resizeLine.style.display="none")},onMouseDown({event:t}){this._ref=null;const e=X.getParentElement(t.target,mo);if(!e)return;const i=fo(t,e);if(i.is){try{this._deleteStyleSelectedCells(),this.setCellInfo(e,!0);const t=this._logical_cellIndex-(i.isLeft?1:0);if(this.editor.enableBackWrapper("ew-resize"),this._resizeLine||(this._resizeLine=this.editor.frameContext.get("wrapper").querySelector(eo)),this._resizeLinePrev=this.editor.frameContext.get("wrapper").querySelector(io),t<0||t===this._logical_cellCnt-1)return void this._startFigureResizing(i.startX,t<0);const s=this._element.querySelector("colgroup").querySelectorAll("col")[t<0?0:t];this._startCellResizing(s,i.startX,j.get(Qn.getComputedStyle(s).width,0),i.isLeft)}catch(t){console.warn("[SUNEDITOR.plugins.table.error]",t),this.__removeGlobalEvents()}return}const s=_o(t,e);if(s.is)try{let t=X.getParentElement(e,X.isTableRow),i=e.rowSpan;if(i>1)for(;X.isTableRow(t)&&i>1;)t=t.nextElementSibling,--i;this._deleteStyleSelectedCells(),this.setRowInfo(t),this.editor.enableBackWrapper("ns-resize"),this._resizeLine||(this._resizeLine=this.editor.frameContext.get("wrapper").querySelector(so)),this._resizeLinePrev=this.editor.frameContext.get("wrapper").querySelector(no),this._startRowResizing(t,s.startY,j.get(Qn.getComputedStyle(t).height,0))}catch(t){console.warn("[SUNEDITOR.plugins.table.error]",t),this.__removeGlobalEvents()}else e===this._fixedCell||this._shift||(this._deleteStyleSelectedCells(),/^TR$/i.test(e.nodeName)||this.selectCells(e,!1))},onMouseUp(){this._shift=!1},onMouseLeave(){this.__hideResizeLine()},onKeyDown({event:t,range:e,line:i}){if(this._ref=null,this.editor.selectMenuOn||this._resizing)return;const s=t.keyCode;if(9===s){const s=X.getParentElement(i,X.isTableCell);if(s&&e.collapsed&&X.isEdgePoint(e.startContainer,e.startOffset)){this._closeController();const e=t.shiftKey,i=X.getParentElement(s,"table"),n=X.getListChildren(i,X.isTableCell),o=e?X.prevIndex(n,s):X.nextIndex(n,s);if(o===n.length&&!e){if(!X.getParentElement(s,"thead")){const t=i.rows,e=this.insertBodyRow(i,t.length,t[t.length-1].cells.length).querySelector("td div");this.selection.setRange(e,0,e,0)}return t.preventDefault(),t.stopPropagation(),!1}if(-1===o&&e)return;let l=n[o];if(!l)return;return l=l.firstElementChild||l,this.selection.setRange(l,0,l,0),t.preventDefault(),t.stopPropagation(),!1}}let n=null;if(!t.shiftKey||16!==s){if(n=X.getParentElement(i,X.isTableCell),!X.hasClass(n,"se-selected-cell-focus"))return;return this._deleteStyleSelectedCells(),this._toggleEditor(!0),this.__removeGlobalEvents(),void this._closeController()}return this._shift||this._ref?void 0:(n=n||X.getParentElement(i,X.isTableCell),n?(this._fixedCell=n,this._closeController(),this.selectCells(n,t.shiftKey),!1):void 0)},onKeyUp({line:t}){this._shift&&X.getParentElement(t,X.isTableCell)===this._fixedCell&&(this._deleteStyleSelectedCells(),this._toggleEditor(!0),this.__removeGlobalEvents()),this._shift=!1},colorPickerAction(t){const e=this.propTargets[`${this.sliderType}_color`];e.style.borderColor=e.value=t,this.controller_colorPicker.close()},controllerAction(t){const e=t.getAttribute("data-command");if(!e)return;const{back_color:i,font_color:s,border_color:n}=this.propTargets,o=t.getAttribute("data-value");switch(e){case"header":this.toggleHeader(),this._historyPush();break;case"caption":this.toggleCaption(),this._historyPush();break;case"onsplit":this.selectMenu_split.open();break;case"oncolumn":this.selectMenu_column.open();break;case"onrow":this.selectMenu_row.menus[0].style.display=this.selectMenu_row.menus[1].style.display=/^TH$/i.test(this._tdElement?.nodeName)?"none":"",this.selectMenu_row.open();break;case"openTableProperties":this.controller_props.currentTarget===t&&"block"===this.controller_props.form?.style.display?this.controller_props.close():(this.controller_props_title.textContent=this.lang.tableProperties,this._setCtrlProps("table"),this.controller_props.open(t,this.controller_table.form,{isWWTarget:!1,initMethod:null,addOffset:null}));break;case"openCellProperties":this.controller_props.currentTarget===t&&"block"===this.controller_props.form?.style.display?this.controller_props.close():(this.controller_props_title.textContent=this.lang.cellProperties,this._setCtrlProps("cell"),this.controller_props.open(t,this.controller_cell.form,{isWWTarget:!1,initMethod:null,addOffset:null}));break;case"props_onborder_format":1===this._propsCache.length?this.selectMenu_props_border_format_oneCell.open():this.selectMenu_props_border_format.open();break;case"props_onborder_style":this.selectMenu_props_border.open();break;case"props_onpalette":this._onColorPalette(t,o,"border"===o?n:"back"===o?i:s);break;case"props_font_style":X.toggleClass(this.propTargets[`font_${o}`],"on");break;case"props_submit":this._submitProps(t);break;case"revert":{const t=this._propsCache;for(let e=0,i=t.length;e<i;e++)t[e][0].style.cssText=t[e][1];this._setAlignProps(this.propTargets.cell_alignment,this._propsAlignCache,!0),this._setAlignProps(this.propTargets.cell_alignment_vertical,this._propsVerticalAlignCache,!0),X.isTable(t[0][0])&&this._figure&&(this._figure.style.float=this._propsAlignCache);break}case"close_props":this.controller_props.close();break;case"props_align":this._setAlignProps(this.propTargets.cell_alignment,t.getAttribute("data-value"),!1);break;case"props_align_vertical":this._setAlignProps(this.propTargets.cell_alignment_vertical,t.getAttribute("data-value"),!1);break;case"merge":this.mergeCells();break;case"resize":this._maxWidth=!this._maxWidth,this.setTableStyle("width",!1),this._historyPush(),this.component.select(this._element,go.key,!0);break;case"layout":this._fixedColumn=!this._fixedColumn,this.setTableStyle("column",!1),this._historyPush(),this.component.select(this._element,go.key,!0);break;case"remove":{const t=this._figure?.parentNode;X.removeItem(this._figure),this._closeController(),t!==this.editor.frameContext.get("wysiwyg")&&this.nodeTransform.removeAllParents(t,(function(t){return 0===t.childNodes.length}),null),this.editor.focus(),this.history.push(!1)}}/(^props_|^revert|Properties$)/.test(e)||(this.controller_props.close(),this.controller_colorPicker.close()),/^(remove|props_|on|open|merge)/.test(e)||this.setCellControllerPosition(this._tdElement,this._shift)},close(){this.__removeGlobalEvents(),this._deleteStyleSelectedCells(),this._toggleEditor(!0),this._figure=null,this._element=null,this._trElement=null,this._trElements=null,this._tableXY=[],this._maxWidth=!1,this._fixedColumn=!1,this._physical_cellCnt=0,this._logical_cellCnt=0,this._rowCnt=0,this._rowIndex=0,this._physical_cellIndex=0,this._logical_cellIndex=0,this._current_colSpan=0,this._current_rowSpan=0,this._shift=!1,this._selectedCells=null,this._selectedTable=null,this._ref=null,this._fixedCell=null,this._selectedCell=null,this._fixedCellName=null;const{border_format:t,border_color:e,border_style:i,border_width:s,back_color:n,font_color:o,cell_alignment:l,cell_alignment_vertical:r,font_bold:a,font_underline:h,font_italic:c,font_strike:d}=this.propTargets;X.removeClass([t,e,i,s,n,o,l,r,a,h,c,d],"on")},selectCells(t,e){this._shift||this._ref||this.__removeGlobalEvents(),this._shift=e,this._fixedCell=t,this._fixedCellName=t.nodeName,this._selectedTable=X.getParentElement(t,"TABLE"),this._deleteStyleSelectedCells(),X.addClass(t,"se-selected-cell-focus"),e?(this.__globalEvents.shiftOff=this.eventManager.addGlobalEvent("keyup",this._bindShiftOff,!1),this.__globalEvents.on=this.eventManager.addGlobalEvent("mousedown",this._bindMultiOn,!1)):this.__globalEvents.on=this.eventManager.addGlobalEvent("mousemove",this._bindMultiOn,!1),this.__globalEvents.off=this.eventManager.addGlobalEvent("mouseup",this._bindMultiOff,!1),this.__globalEvents.touchOff=this.eventManager.addGlobalEvent("touchmove",this._bindTouchOff,!1)},seTableInfo(t){const e=this._element=this._selectedTable||X.getParentElement(t,"TABLE");return this._figure=X.getParentElement(e,X.isFigure)||e,e},setCellInfo(t,e){const i=this.seTableInfo(t);if(this._trElement=t.parentNode,i.querySelector("thead")?X.addClass(this.headerButton,"active"):X.removeClass(this.headerButton,"active"),i.querySelector("caption")?X.addClass(this.captionButton,"active"):X.removeClass(this.captionButton,"active"),e||0===this._physical_cellCnt){this._tdElement!==t&&(this._tdElement=t,this._trElement=t.parentNode),this._selectedCells&&0!==this._selectedCells.length||(this._selectedCells=[t]);const e=this._trElements=i.rows,s=t.cellIndex;let n=0;for(let t=0,i=e[0].cells,s=e[0].cells.length;t<s;t++)n+=i[t].colSpan;const o=this._rowIndex=this._trElement.rowIndex;this._rowCnt=e.length,this._physical_cellCnt=this._trElement.cells.length,this._logical_cellCnt=n,this._physical_cellIndex=s,this._current_colSpan=this._tdElement.colSpan-1,this._current_rowSpan=this._trElement.cells[s].rowSpan-1;let l=[],r=[];for(let t,i,n=0;n<=o;n++){t=e[n].cells,i=0;for(let e,a,h,c,d=0,u=t.length;d<u;d++){if(e=t[d],a=e.colSpan-1,h=e.rowSpan-1,c=d+i,r.length>0)for(let t,e=0;e<r.length;e++)t=r[e],t.row>n||(c>=t.index?(i+=t.cs,c+=t.cs,t.rs-=1,t.row=n+1,t.rs<1&&(r.splice(e,1),e--)):d===u-1&&(t.rs-=1,t.row=n+1,t.rs<1&&(r.splice(e,1),e--)));if(n===o&&d===s){this._logical_cellIndex=c;break}h>0&&l.push({index:c,cs:a+1,rs:h,row:-1}),i+=a}r=r.concat(l).sort((function(t,e){return t.index-e.index})),l=[]}l=null,r=null}},setRowInfo(t){const e=this.seTableInfo(t),i=this._trElements=e.rows;this._rowCnt=i.length,this._rowIndex=t.rowIndex},editTable(t,e){const i=this._element,s="row"===t;if(s){const t=this._trElement.parentNode;if(/^THEAD$/i.test(t.nodeName)){if("up"===e)return;if(!t.nextElementSibling||!/^TBODY$/i.test(t.nextElementSibling.nodeName))return void(e?i.innerHTML+="<tbody><tr>"+xo("td",this._logical_cellCnt,!1)+"</tr></tbody>":(X.removeItem(this._figure),this._closeController()))}}if(this._ref){const t=this._tdElement,i=this._selectedCells;if(s)if(e)this.setCellInfo("up"===e?i[0]:i[i.length-1],!0),this.editRow(e,t);else{let t=i[0].parentNode;const s=[i[0]];for(let e,n=1,o=i.length;n<o;n++)e=i[n],t!==e.parentNode&&(s.push(e),t=e.parentNode);for(let t=0,i=s.length;t<i;t++)this.setCellInfo(s[t],!0),this.editRow(e)}else{const s=i[0].parentNode;if(e){let n=null;for(let t=0,e=i.length-1;t<e;t++)if(s!==i[t+1].parentNode){n=i[t];break}this.setCellInfo("left"===e?i[0]:n||i[0],!0),this.editCell(e,t)}else{const t=[i[0]];for(let e,n=1,o=i.length;n<o&&(e=i[n],s===e.parentNode);n++)t.push(e);for(let i=0,s=t.length;i<s;i++)this.setCellInfo(t[i],!0),this.editCell(e)}}e||this.close()}else this[s?"editRow":"editCell"](e);if(!e){const t=i.children;for(let e=0;e<t.length;e++)0===t[e].children.length&&(X.removeItem(t[e]),e--);0===i.children.length&&X.removeItem(i)}},editRow(t,e){const i=!t,s="up"===t,n=this._rowIndex,o=i||s?n:n+this._current_rowSpan+1,l=i?-1:1,r=this._trElements;let a=this._logical_cellCnt;for(let t,e=0,s=n+(i?-1:0);e<=s;e++){if(t=r[e].cells,0===t.length)return;for(let i,s,n=0,r=t.length;n<r;n++)i=t[n].rowSpan,s=t[n].colSpan,i<2&&s<2||i+e>o&&o>e&&(t[n].rowSpan=i+l,a-=s)}if(i){const t=r[n+1];if(t){const e=[];let i=r[n].cells,s=0;for(let t,n,o=0,l=i.length;o<l;o++)t=i[o],n=o+s,s+=t.colSpan-1,t.rowSpan>1&&(t.rowSpan-=1,e.push({cell:t.cloneNode(!1),index:n}));if(e.length>0){let n=e.shift();i=t.cells,s=0;for(let o,l,r=0,a=i.length;r<a&&(o=i[r],l=r+s,s+=o.colSpan-1,!(l>=n.index)||(r--,s--,s+=n.cell.colSpan-1,t.insertBefore(n.cell,o),n=e.shift(),n));r++);if(n){t.appendChild(n.cell);for(let i=0,s=e.length;i<s;i++)t.appendChild(e[i].cell)}}}this._element.deleteRow(o)}else this.insertBodyRow(this._element,o,a);i?this._closeController():this.setCellControllerPosition(e||this._tdElement,!0)},editCell(t,e){const i=!t,s="left"===t,n=this._current_colSpan,o=i||s?this._logical_cellIndex:this._logical_cellIndex+n+1,l=this._trElements;let r,a=[],h=[],c=0;const d=[],u=[];for(let t,e,s,p,g,m=0,f=this._rowCnt;m<f;m++){t=l[m],r=o,p=!1,e=t.cells,g=0;for(let t,s,l,f,_=0,b=e.length;_<b&&(t=e[_],t);_++)if(s=t.rowSpan-1,l=t.colSpan-1,i){if(f=_+g,h.length>0){const t=!e[_+1];for(let e,i=0;i<h.length;i++)e=h[i],e.row>m||(f>=e.index?(g+=e.cs,f=_+g,e.rs-=1,e.row=m+1,e.rs<1&&(h.splice(i,1),i--)):t&&(e.rs-=1,e.row=m+1,e.rs<1&&(h.splice(i,1),i--)))}s>0&&a.push({rs:s,cs:l+1,index:f,row:-1}),f>=r&&f+l<=r+n?d.push(t):f<=r+n&&f+l>=r?t.colSpan-=j.getOverlapRangeAtIndex(o,o+n,f,f+l):s>0&&(f<r||f+l>r+n)&&u.push({cell:t,i:m,rs:m+s}),g+=l}else{if(_>=r)break;if(l>0){if(c<1&&l+_>=r){t.colSpan+=1,r=null,c=s+1;break}r-=l}if(!p){for(let t,e=0;e<h.length;e++)t=h[e],r-=t.cs,t.rs-=1,t.rs<1&&(h.splice(e,1),e--);p=!0}}if(h=h.concat(a).sort((function(t,e){return t.index-e.index})),a=[],!i){if(c>0){c-=1;continue}null!==r&&e.length>0&&(s=xo(e[0].nodeName,0,!0),s=t.insertBefore(s,e[r]))}}const p=this._element.querySelector("colgroup");if(p){const t=p.querySelectorAll("col");if(i)X.removeItem(t[r]);else{let e=0;for(let i,s=0,n=t.length;s<n;s++)i=j.get(t[s].style.width),i-=Math.round(i*n*.1/2,0),e+=i,t[s].style.width=`${i}%`;const i=X.createElement("col",{style:`width:${100-e}%`});p.insertBefore(i,t[r])}}if(i){let t,e;for(let i,s=0,n=d.length;s<n;s++)i=d[s].parentNode,X.removeItem(d[s]),0===i.cells.length&&(t||(t=X.getArrayIndex(l,i)),e=X.getArrayIndex(l,i),X.removeItem(i));for(let i,s=0,n=u.length;s<n;s++)i=u[s],i.cell.rowSpan=j.getOverlapRangeAtIndex(t,e,i.i,i.rs);this._closeController()}else this.setCellControllerPosition(e||this._tdElement,!0)},insertBodyRow(t,e,i){const s=t.insertRow(e);return s.innerHTML=xo("td",i,!1),s},mergeCells(){const t=this._ref,e=this._selectedCells,i=e[0];let s=null,n=null;const o=t.ce-t.cs+1;let l=t.re-t.rs+1,r="",a=null;for(let t,i,o=1,h=e.length;o<h;o++){t=e[o],a!==t.parentNode&&(a=t.parentNode),i=t.children;for(let t=0,e=i.length;t<e;t++)this.format.isLine(i[t])&&X.isZeroWith(i[t].textContent)&&X.removeItem(i[t]);r+=t.innerHTML,X.removeItem(t),0===a.cells.length&&(s?n=a:s=a,l-=1)}if(s){const t=this._trElements,e=X.getArrayIndex(t,s),i=X.getArrayIndex(t,n||s),o=[];for(let s,n=0;n<=i;n++)if(s=t[n].cells,0!==s.length)for(let t,o,l=0,r=s.length;l<r;l++)t=s[l],o=t.rowSpan-1,o>0&&n+o>=e&&(t.rowSpan-=j.getOverlapRangeAtIndex(e,i,n,n+o));else o.push(t[n]);for(let t=0,e=o.length;t<e;t++)X.removeItem(o[t])}i.innerHTML+=r,i.colSpan=o,i.rowSpan=l,this.setMergeSplitButton(!0,!1),this.setController(i),this.editor.focusEdge(i),this._historyPush()},toggleHeader(){const t=this.headerButton,e=X.hasClass(t,"active"),i=this._element;if(e)X.removeItem(i.querySelector("thead"));else{const t=X.createElement("THEAD");t.innerHTML="<tr>"+xo("th",this._logical_cellCnt,!1)+"</tr>",i.insertBefore(t,i.firstElementChild)}X.toggleClass(t,"active"),/TH/i.test(this._tdElement.nodeName)?this._closeController():this.setCellControllerPosition(this._tdElement,!1)},toggleCaption(){const t=this.captionButton,e=X.hasClass(t,"active"),i=this._element;if(e)X.removeItem(i.querySelector("caption"));else{const t=X.createElement("CAPTION",{class:`se-table-caption-${this.captionPosition}`});t.innerHTML="<div><br></div>",i.insertBefore(t,i.firstElementChild)}X.toggleClass(t,"active"),this.setCellControllerPosition(this._tdElement,!1)},setTableStyle(t,e){if(t.includes("width")){const t=this._figure;if(!t)return;let i,s;this._maxWidth?(i=this.icons.reduction,s=this.minText,e||(t.style.width="100%")):(i=this.icons.expansion,s=this.maxText,e||(t.style.width="min-content")),X.changeElement(this.resizeButton.firstElementChild,i),X.changeTxt(this.resizeText,s)}t.includes("column")&&(this._fixedColumn?(X.removeClass(this._element,"se-table-layout-auto"),X.addClass(this._element,"se-table-layout-fixed"),X.addClass(this.columnFixedButton,"active")):(X.removeClass(this._element,"se-table-layout-fixed"),X.addClass(this._element,"se-table-layout-auto"),X.removeClass(this.columnFixedButton,"active")))},setMergeSplitButton(t,e){e&&e&&t!==e?(this.splitButton.style.display="none",this.mergeButton.style.display="block"):(this.splitButton.style.display="block",this.mergeButton.style.display="none")},select(t){this._figureOpen(t);const e=this._figure?.style.width||"100%";if(this._maxWidth="100%"===e,this._fixedColumn=X.hasClass(t,"se-table-layout-fixed")||"fixed"===t.style.tableLayout,this.setTableStyle(this._maxWidth?"width|column":"width",!0),Lt.get("__overInfo")===to)return;if(!this._tdElement)return;this.setCellInfo(this._tdElement,!0);const i=X.getParentElement(t,X.isFigure);this.controller_table.open(i,null,{isWWTarget:!1,initMethod:null,addOffset:null});const s=this.cellControllerTop&&"block"===this.controller_table.form.style.display?{left:this.controller_table.form.offsetWidth+2}:null;this.controller_cell.open(this._tdElement,this.cellControllerTop?i:null,{isWWTarget:!1,initMethod:null,addOffset:s})},setController(t){if(!this.selection.get().isCollapsed&&!this._selectedCell)return void this._deleteStyleSelectedCells();this._tdElement=t,X.addClass(t,"se-selected-cell-focus");const e=this._element||this._selectedTable||X.getParentElement(t,"TABLE");this.component.select(e,go.key,!0)},setCellControllerPosition(t,e){this.setCellInfo(t,e),this.controller_cell.resetPosition(this.cellControllerTop?X.getParentElement(t,X.isTable):t)},_historyPush(){this._deleteStyleSelectedCells(),this.history.push(!1),this._recallStyleSelectedCells()},_figureOpen(t){this.figure.open(t,{nonResizing:!0,nonSizeInfo:!0,nonBorder:!0,figureTarget:!0,__fileManagerInfo:!1})},_startCellResizing(t,e,i,s){this._setResizeLinePosition(this._figure,this._tdElement,this._resizeLinePrev,s),this._resizeLinePrev.style.display="block";const n=t.style.width,o=t.nextElementSibling,l=o.style.width,r=X.hasClass(this._element,"se-table-layout-fixed")?l:Y.getWidthInPercentage(t);Lt.get("__dragHandler")&&(Lt.get("__dragHandler").style.display="none"),this._addResizeGlobalEvents(this._cellResize.bind(this,t,o,this._figure,this._tdElement,this._resizeLine,s,e,i,j.get(n,0),j.get(r,0),this._element.offsetWidth),(()=>{this.__removeGlobalEvents(),this.history.push(!0),this.component.select(this._element,go.key,!0)}),(e=>{this._stopResize(t,n,"width",e),this._stopResize(o,l,"width",e)}))},_cellResize(t,e,i,s,n,o,l,r,a,h,c,d){const u=(r+(d.clientX-l))/c*100;if(u>0){t.style.width=`${u}%`;const l=a-u;e.style.width=`${h+l}%`,this._setResizeLinePosition(i,s,n,o)}},_startRowResizing(t,e,i){this._setResizeRowPosition(this._figure,t,this._resizeLinePrev),this._resizeLinePrev.style.display="block";const s=t.style.height;this._addResizeGlobalEvents(this._rowResize.bind(this,t,this._figure,this._resizeLine,e,i),(()=>{this.__removeGlobalEvents(this),this.history.push(!0)}),this._stopResize.bind(this,t,s,"height"))},_rowResize(t,e,i,s,n,o){const l=n+(o.clientY-s);t.style.height=`${l}px`,this._setResizeRowPosition(e,t,i)},_startFigureResizing(t,e){const i=this._figure;this._setResizeLinePosition(i,i,this._resizeLinePrev,e),this._resizeLinePrev.style.display="block";const s=Y.getWidthInPercentage(i);Lt.get("__dragHandler")&&(Lt.get("__dragHandler").style.display="none"),this._addResizeGlobalEvents(this._figureResize.bind(this,i,this._resizeLine,e,t,i.offsetWidth,j.get(s,0)),(()=>{this.__removeGlobalEvents(),this.component.select(this._element,go.key,!0)}),this._stopResize.bind(this,i,i.style.width,"width"))},_figureResize(t,e,i,s,n,o,l){const r=(n+(i?s-l.clientX:l.clientX-s))/n*o;r>0&&(t.style.width=`${r}%`,this._setResizeLinePosition(t,t,e,i))},_setResizeLinePosition(t,e,i,s){const n=this.offset.getLocal(e),o=this.offset.getLocal(t);i.style.left=`${n.left+(s?0:e.offsetWidth)}px`,i.style.top=`${o.top}px`,i.style.height=`${t.offsetHeight}px`},_setResizeRowPosition(t,e,i){const s=this.offset.getLocal(e),n=this.offset.getLocal(t);i.style.top=`${s.top+e.offsetHeight}px`,i.style.left=`${n.left}px`,i.style.width=`${t.offsetWidth}px`},_stopResize(t,e,i,s){27===s.keyCode&&(this.__removeGlobalEvents(),t.style[i]=e,"width"===i&&this.component.select(this._element,go.key,!0))},_deleteStyleSelectedCells(){if(X.removeClass([this._fixedCell,this._selectedCell],"se-selected-cell-focus"),this._selectedTable){const t=this._selectedTable.querySelectorAll(".se-selected-table-cell");for(let e=0,i=t.length;e<i;e++)X.removeClass(t[e],"se-selected-table-cell")}},_recallStyleSelectedCells(){if(this._selectedCells){const t=this._selectedCells;for(let e=0,i=t.length;e<i;e++)X.addClass(t[e],"se-selected-table-cell")}},_addResizeGlobalEvents(t,e,i){this.__globalEvents.resize=this.eventManager.addGlobalEvent("mousemove",t,!1),this.__globalEvents.resizeStop=this.eventManager.addGlobalEvent("mouseup",e,!1),this.__globalEvents.resizeKeyDown=this.eventManager.addGlobalEvent("keydown",i,!1),this._resizing=!0},_toggleEditor(t){const e=this.editor.frameContext.get("wysiwyg");e.setAttribute("contenteditable",t),t?X.removeClass(e,"se-disabled"):X.addClass(e,"se-disabled")},_setCtrlProps(t){this._typeCache=t;const e="table"===t,i=e?[this._element]:this._selectedCells;if(!i||0===i.length)return;const{border_format:s,border_color:n,border_style:o,border_width:l,back_color:r,font_color:a,cell_alignment:h,cell_alignment_vertical:c,font_bold:d,font_underline:u,font_italic:p,font_strike:g}=this.propTargets,{border:m,backgroundColor:f,color:_,textAlign:b,verticalAlign:v,fontWeight:y,textDecoration:w,fontStyle:C}=Qn.getComputedStyle(i[0]),x=this._getBorderStyle(m);h.querySelector('[data-value="justify"]').style.display=e?"none":"",c.style.display=e?"none":"";let S=Y.rgb2hex(x.c),E=x.s,T=x.w,k=Y.rgb2hex(f),N=Y.rgb2hex(_),H=/.+/.test(y),L=/underline/i.test(w),M=/line-through/i.test(w),B=/italic/i.test(C),A=e?this._figure?.style.float:b,V=v;this._propsCache=[];for(let t,s,n=0;t=i[n];n++){const{cssText:i,border:n,backgroundColor:o,color:l,textAlign:r,verticalAlign:a,fontWeight:h,textDecoration:c,fontStyle:d}=t.style;if(this._propsCache.push([t,i]),s)continue;const{c:u,s:p,w:g}=this._getBorderStyle(n);S&&x.c!==u&&(S=""),E&&x.s!==p&&(E=""),T&&x.w!==g&&(T=""),k!==Y.rgb2hex(o)&&(k=""),N!==Y.rgb2hex(l)&&(N=""),A!==(e?this._figure?.style.float:r)&&(A=""),V&&V!==a&&(V=""),H&&H!==/.+/.test(h)&&(H=""),L&&L!==/underline/i.test(c)&&(L=!1),M&&M!==/line-through/i.test(c)&&(M=!1),B&&B!==/italic/i.test(d)&&(B=!1),S&&E&&T&&k&&N||(s=!0)}s.firstElementChild.innerHTML=this.icons[lo[1===i.length?"outside":"all"]],s.setAttribute("se-border-format","all"),X.removeClass(s,"active"),E=E||oo[0],o.textContent=E,n.style.borderColor=n.value=S,l.value=T,this._disableBorderProps(E===oo[0]),r.value=r.style.borderColor=k,a.value=a.style.borderColor=N,H&&X.addClass(d,"on"),L&&X.addClass(u,"on"),M&&X.addClass(g,"on"),B&&X.addClass(p,"on"),this._setAlignProps(h,this._propsAlignCache=A,!0),this._setAlignProps(c,this._propsVerticalAlignCache=V,!0)},_setAlignProps(t,e,i){X.removeClass(t.querySelectorAll("button"),"on"),i||t.getAttribute("se-cell-align")!==e?(X.addClass(t.querySelector(`[data-value="${e}"]`),"on"),t.setAttribute("se-cell-align",e)):t.setAttribute("se-cell-align","")},_disableBorderProps(t){const{border_color:e,border_width:i,palette_border_button:s}=this.propTargets;t?(e.setAttribute("disabled",!0),i.setAttribute("disabled",!0),s.setAttribute("disabled",!0),i.setAttribute("disabled",!0)):(e.removeAttribute("disabled"),i.removeAttribute("disabled"),s.removeAttribute("disabled"),i.removeAttribute("disabled"))},_getBorderStyle(t){const e=t.split(/\s(?![^()]*\))/);let i="",s="",n="";return 3===e.length?(i=e[0],s=e[1],n=e[2]):2===e.length?/\d/.test(e[0])?(i=e[0],s=e[1]):(s=e[0],n=e[1]):1===e.length&&(/\d/.test(e[0])?i=e[0]:s=e[0]),{w:i,s,c:Y.rgb2hex(n)}},_submitProps(t){try{t.setAttribute("disabled",!0);const e=this.controller_table.form.contains(this.controller_props.currentTarget),i=e?[this._element]:this._selectedCells,s=i[0],n=Qn.getComputedStyle(s),{border_format:o,border_color:l,border_style:r,border_width:a,back_color:h,font_color:c,cell_alignment:d,cell_alignment_vertical:u}=this.propTargets,p=o.getAttribute("se-border-format")||"",g="all"!==p,m=("none"===r.textContent?"":r.textContent)||"",f="none"===p||!m,_=d.getAttribute("se-cell-align")||"",b=u.getAttribute("se-cell-align")||"",v=f?"":l.value.trim()||n.borderColor;let y=f?"":a.value.trim()||n.borderWidth;y+=j.is(y)?"px":"";const w=h.value.trim(),C=c.value.trim(),x=g&&!f&&y,S=`${y} ${m} ${v}`,E={left:[],top:[],right:[],bottom:[],middle:[]};if(e){const t=s.style;this._figure&&(this._figure.style.float=_,this._figure.style.verticalAlign=b),t.backgroundColor=w,t.color=C,this._setFontStyle(t),x||(t.border=f?t.borderLeft=t.borderTop=t.borderRight=t.borderBottom="":S),E.left=E.top=E.right=E.bottom=i}else{let{rs:t,re:e,cs:n,ce:o}=this._ref||{rs:s.parentElement.rowIndex||0,re:s.parentElement.rowIndex||0,cs:s.cellIndex||0,ce:s.cellIndex||0};const l=new Array(e-t+1).fill(0).map((()=>new Array(o-n+1).fill(0))),r=n;e-=t,t-=t,o-=n,n-=n;let a=s.parentNode;for(let s,h,c,d,u,p=0,g=0,m=i.length,v=0;p<m;p++,g++){s=i[p],d=s.colSpan,u=s.rowSpan,c=s.cellIndex-r,a!==s.parentNode&&(v++,g=0,a=s.parentNode);let m=0;for(;m<=c;)c+=l[v][m]||0,m++;try{if(u>1){const t=u-1;for(let e=v;e<=v+t;e++)l[e][c]+=d-(v===e?1:0)}else d>1&&(l[v][c]+=d-1)}catch(t){}const y=v+u-1===e;v===t&&E.top.push(s),(v===e||y)&&E.bottom.push(s),c===n&&E.left.push(s),c!==o&&c+d-1!==o||E.right.push(s),y||v===t||v===e||c===n||c===o||E.middle.push(s),h=s.style,h.textAlign=_,h.verticalAlign=b,h.backgroundColor=w,h.color=C,this._setFontStyle(h),x||(h.border=f?h.borderLeft=h.borderTop=h.borderRight=h.borderBottom="":S)}0===E.middle.length&&(E.middle=i)}E.all=i,x&&this._setBorderStyles(E,p,S),this._historyPush(),this.controller_props.close(),this._tdElement&&(this._recallStyleSelectedCells(),this.setCellInfo(this._tdElement,!0),X.addClass(this._tdElement,"se-selected-cell-focus"))}catch(t){console.warn("[SUNEDITOR.plugins.table.setProps.error]",t)}finally{t.removeAttribute("disabled")}},_setFontStyle(t){const{font_bold:e,font_italic:i,font_strike:s,font_underline:n}=this.propTargets;t.fontWeight=X.hasClass(e,"on")?"bold":"",t.fontStyle=X.hasClass(i,"on")?"italic":"",t.textDecoration=((X.hasClass(s,"on")?"line-through ":"")+(X.hasClass(n,"on")?"underline":"")).trim()},_setBorderStyles(t,e,i){const{left:s,top:n,right:o,bottom:l,all:r}=t;switch(e){case"inside":if(1===t.length)return;X.setStyle(r.filter((t=>!l.includes(t))),uo,i),X.setStyle(r.filter((t=>!o.includes(t))),co,i);break;case"horizon":if(1===t.length)return;X.setStyle(r.filter((t=>!l.includes(t))),uo,i);break;case"vertical":if(1===t.length)return;X.setStyle(r.filter((t=>!o.includes(t))),co,i);break;case"outside":X.setStyle(s,ao,i),X.setStyle(n,ho,i),X.setStyle(o,co,i),X.setStyle(l,uo,i);break;case"left":X.setStyle(s,ao,i);break;case"top":X.setStyle(n,ho,i);break;case"right":X.setStyle(o,co,i);break;case"bottom":X.setStyle(l,uo,i)}},_setMultiCells(t,e){const i=this._selectedTable.rows;if(this._deleteStyleSelectedCells(),t===e){if(!this._shift)return}else X.addClass(t,"se-selected-table-cell");let s=!0,n=[],o=[];const l=this._ref={_i:0,cs:null,ce:null,rs:null,re:null};for(let r,a,h=0,c=i.length;h<c;h++){r=i[h].cells,a=0;for(let i,c,d,u,p=0,g=r.length;p<g;p++){if(i=r[p],d=i.colSpan-1,u=i.rowSpan-1,c=p+a,n.length>0)for(let t,e=0;e<n.length;e++)t=n[e],t.row>h||(c>=t.index?(a+=t.cs,c+=t.cs,t.rs-=1,t.row=h+1,t.rs<1&&(n.splice(e,1),e--)):p===g-1&&(t.rs-=1,t.row=h+1,t.rs<1&&(n.splice(e,1),e--)));if(s){if(i!==t&&i!==e||(l.cs=null!==l.cs&&l.cs<c?l.cs:c,l.ce=null!==l.ce&&l.ce>c+d?l.ce:c+d,l.rs=null!==l.rs&&l.rs<h?l.rs:h,l.re=null!==l.re&&l.re>h+u?l.re:h+u,l._i+=1),2===l._i){s=!1,n=[],o=[],h=-1;break}}else if(j.getOverlapRangeAtIndex(l.cs,l.ce,c,c+d)&&j.getOverlapRangeAtIndex(l.rs,l.re,h,h+u)){const t=l.cs<c?l.cs:c,e=l.ce>c+d?l.ce:c+d,s=l.rs<h?l.rs:h,r=l.re>h+u?l.re:h+u;if(l.cs!==t||l.ce!==e||l.rs!==s||l.re!==r){l.cs=t,l.ce=e,l.rs=s,l.re=r,h=-1,n=[],o=[];break}X.addClass(i,"se-selected-table-cell")}u>0&&o.push({index:c,cs:d+1,rs:u,row:-1}),a+=i.colSpan-1}n=n.concat(o).sort(((t,e)=>t.index-e.index)),o=[]}},_resetTablePicker(){if(!this.tableHighlight)return;const t=this.tableHighlight.style,e=this.tableUnHighlight.style;t.width="1em",t.height="1em",e.width="10em",e.height="10em",X.changeTxt(this.tableDisplay,"1 x 1"),this.menu.dropdownOff()},_resetPropsAlign(){const{cell_alignment:t}=this.propTargets,e=t.querySelector('[data-value="left"]'),i=t.querySelector('[data-value="right"]'),s=e.parentElement,n=i.parentElement;s.appendChild(i),n.appendChild(e)},_onColorPalette(t,e,i){this.controller_colorPicker.isOpen&&e===this.sliderType?this.controller_colorPicker.close():(this.sliderType=e,X.addClass(t,"on"),this.colorPicker.init(i?.value||"",t),this.controller_colorPicker.open(t,null,{isWWTarget:!1,initMethod:null,addOffset:null}))},_closeController(){this.component.deselect(),this.controller_table.close(),this.controller_cell.close()},__hideResizeLine(){this._resizeLine&&(this._resizeLine.style.display="none",this._resizeLine=null)},__removeGlobalEvents(){this._resizing=!1,this.editor.disableBackWrapper(),this.__hideResizeLine(),this._resizeLinePrev&&(this._resizeLinePrev.style.display="none",this._resizeLinePrev=null);const t=this.__globalEvents;for(const e in t)t[e]&&(t[e]=this.eventManager.removeGlobalEvent(t[e]))},constructor:go};const Mo=go,Bo=function(t,e){He.call(this,t),this.title=this.lang.formats,this.inner='<span class="se-txt">'+this.lang.formats+"</span>"+this.icons.arrow_down;const i=function({lang:t},e){const i=["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],s=e&&0!==e.length?e:i;let n='\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic">';for(let e,o,l,r,a,h,c,d=0,u=s.length;d<u;d++)e=s[d],"string"==typeof e&&i.includes(e)?(o=e.toLowerCase(),l="blockquote"===o?"block":"pre"===o?"br-line":"line",a=/^h/.test(o)?o.match(/\d+/)[0]:"",r=t["tag_"+(a?"h":o)]+a,c="",h=""):(o=e.tag.toLowerCase(),l=e.command,r=e.name||o,c=e.class,h=c?' class="'+c+'"':""),n+=`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list" data-command="${l}" data-value="${o}" data-class="${c}" title="${r}" aria-label="${r}">\n\t\t\t\t\t<${o}${h}>${r}</${o}>\n\t\t\t\t</button>\n\t\t\t</li>`;return n+="\n\t\t</ul>\n\t</div>",X.createElement("DIV",{class:"se-dropdown se-list-layer se-list-format"},n)}(t,e.items);this.formatList=i.querySelectorAll("li button"),this.currentFormat="",this.menu.initDropdownTarget(Bo,i)};Bo.key="formatBlock",Bo.type="dropdown",Bo.className="se-btn-select se-btn-tool-format",Bo.prototype={active(t,e){let i=this.lang.formats;const s=e.querySelector(".se-txt");if(t){if(this.format.isLine(t)){const e=this.formatList,n=t.nodeName.toLowerCase(),o=(t.className.match(/(\s|^)__se__format__[^\s]+/)||[""])[0].trim();for(let t,s=0,l=e.length;s<l;s++)if(t=e[s],n===t.getAttribute("data-value")&&o===t.getAttribute("data-class")){i=t.title;break}return X.changeTxt(s,i),s.setAttribute("data-value",n),s.setAttribute("data-class",o),!0}}else X.changeTxt(s,i);return!1},on(t){const e=this.formatList,i=t.querySelector(".se-txt"),s=(i.getAttribute("data-value")||"")+(i.getAttribute("data-class")||"");if(s!==this.currentFormat){for(let t,i=0,n=e.length;i<n;i++)t=e[i],s===t.getAttribute("data-value")+t.getAttribute("data-class")?X.addClass(t,"active"):X.removeClass(t,"active");this.currentFormat=s}},action(t){const e=t.getAttribute("data-command"),i=t.firstElementChild;"block"===e?this.format.applyBlock(i):"br-line"===e?this.format.setBrLine(i):this.format.setLine(i),this.menu.dropdownOff()},constructor:Bo};const Ao=Bo,Vo=function(t,e){He.call(this,t),this.title=this.lang.layout,this.icon="layout",this.selectedIndex=-1,this.items=e.items;const i=function(t){t&&0!==t.length||console.warn('[SUNEDITOR.plugins.layout.warn] To use the "layout" plugin, please define the "layouts" option.');let e='\n\t<div class="se-dropdown se-list-inner">\n\t\t<ul class="se-list-basic">';for(let i,s=0,n=(t||[]).length;s<n;s++)i=t[s],e+=`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list" data-value="${s}" title="${i.name}" aria-label="${i.name}">\n\t\t\t\t\t${i.name}\n\t\t\t\t</button>\n\t\t\t</li>`;return e+="\n\t\t</ul>\n\t</div>",X.createElement("DIV",{class:"se-list-layer"},e)}(this.items);this.menu.initDropdownTarget(Vo,i)};Vo.key="layout",Vo.type="dropdown",Vo.className="",Vo.prototype={action(t){const e=1*t.getAttribute("data-value"),i=this.items[this.selectedIndex=e];if(!i.html)throw this.menu.dropdownOff(),Error('[SUNEDITOR.layout.fail] cause : "layouts[i].html not found"');this.html.set(i.html),this.menu.dropdownOff()},constructor:Vo};const Io=Vo,Ro=function(t,e){He.call(this,t),this.title=this.lang.lineHeight,this.icon="line_height";const i=function({lang:t},e){const i=e||[{text:"1",value:1},{text:"1.15",value:1.15},{text:"1.5",value:1.5},{text:"2",value:2}];let s=`\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic">\n\t\t\t<li>\n\t\t\t\t<button type="button" class="default_value se-btn-list" title="${t.default}" aria-label="${t.default}">\n\t\t\t\t\t(${t.default})\n\t\t\t\t</button>\n\t\t\t</li>`;for(let t,e=0,n=i.length;e<n;e++)t=i[e],s+=`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list" data-command="${t.value}" title="${t.text}" aria-label="${t.text}">\n\t\t\t\t\t${t.text}\n\t\t\t\t</button>\n\t\t\t</li>`;return s+="\n\t\t</ul>\n\t</div>",X.createElement("DIV",{class:"se-dropdown se-list-layer"},s)}(t,e.items);this.sizeList=i.querySelectorAll("li button"),this.currentSize=-1,this.menu.initDropdownTarget(Ro,i)};Ro.key="lineHeight",Ro.type="dropdown",Ro.className="",Ro.prototype={active:(t,e)=>t?.style?.lineHeight.length>0?(X.addClass(e,"active"),!0):(X.removeClass(e,"active"),!1),on(){const t=this.format.getLine(this.selection.getNode()),e=t?t.style.lineHeight+"":"";if(e!==this.currentSize){const t=this.sizeList;for(let i=0,s=t.length;i<s;i++)e===t[i].getAttribute("data-command")?X.addClass(t[i],"active"):X.removeClass(t[i],"active");this.currentSize=e}},action(t){const e=t.getAttribute("data-command")||"",i=this.format.getLines();for(let t=0,s=i.length;t<s;t++)i[t].style.lineHeight=e;this.menu.dropdownOff(),this.editor.effectNode=null,this.history.push(!1)},constructor:Ro};const zo=Ro,Oo=function(t,e){He.call(this,t),this.title=this.lang.template,this.icon="template",this.selectedIndex=-1,this.items=e.items;const i=function(t){t&&0!==t.length||console.warn('[SUNEDITOR.plugins.template.warn] To use the "template" plugin, please define the "templates" option.');let e='<div class="se-dropdown se-list-inner"><ul class="se-list-basic">';for(let i,s=0,n=(t||[]).length;s<n;s++)i=t[s],e+=`\n\t\t<li>\n\t\t\t<button \n\t\t\t\ttype="button" \n\t\t\t\tclass="se-btn se-btn-list" \n\t\t\t\tdata-value="${s}" \n\t\t\t\ttitle="${i.name}" \n\t\t\t\taria-label="${i.name}"\n\t\t\t>\n\t\t\t\t${i.name}\n\t\t\t</button>\n\t\t</li>`;return e+="</ul></div>",X.createElement("DIV",{class:"se-list-layer"},e)}(this.items);this.menu.initDropdownTarget(Oo,i)};Oo.key="template",Oo.type="dropdown",Oo.className="",Oo.prototype={action(t){const e=1*t.getAttribute("data-value"),i=this.items[this.selectedIndex=e];if(!i.html)throw this.menu.dropdownOff(),Error('[SUNEDITOR.template.fail] cause : "templates[i].html not found"');this.html.insert(i.html),this.menu.dropdownOff()},constructor:Oo};const $o=Oo,Po=function(t,e){He.call(this,t),this.title=this.lang.paragraphStyle,this.icon="paragraph_style";const i=function({lang:t},e){const i={spaced:{name:t.menu_spaced,class:"__se__p-spaced",_class:""},bordered:{name:t.menu_bordered,class:"__se__p-bordered",_class:""},neon:{name:t.menu_neon,class:"__se__p-neon",_class:""}},s=e&&0!==e.length?e:["spaced","bordered","neon"];let n='\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic">';for(let t,e,o,l,r=0,a=s.length;r<a;r++){if(t=s[r],"string"==typeof t){const e=i[t.toLowerCase()];if(!e)continue;t=e}e=t.name,o=t.class?` class="${t.class}"`:"",l=t._class,n+=`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list${l?" "+l:""}" data-command="${t.class}" title="${e}" aria-label="${e}">\n\t\t\t\t\t<div${o}>${e}</div>\n\t\t\t\t</button>\n\t\t\t</li>`}return n+="\n\t\t</ul>\n\t</div>",X.createElement("DIV",{class:"se-dropdown se-list-layer se-list-format"},n)}(t,e.items);this.classList=i.querySelectorAll("li button"),this.menu.initDropdownTarget(Po,i)};Po.key="paragraphStyle",Po.type="dropdown",Po.className="",Po.prototype={on(){const t=this.classList,e=this.format.getLine(this.selection.getNode());for(let i=0,s=t.length;i<s;i++)X.hasClass(e,t[i].getAttribute("data-command"))?X.addClass(t[i],"active"):X.removeClass(t[i],"active")},action(t){const e=t.getAttribute("data-command");let i=this.format.getLines();if(0===i.length&&(this.selection.getRangeAndAddLine(this.selection.getRange(),null),i=this.format.getLines(),0===i.length))return;const s=X.hasClass(t,"active")?X.removeClass:X.addClass;for(let t=0,n=i.length;t<n;t++)s(i[t],e);this.menu.dropdownOff(),this.history.push(!1)},constructor:Po};const Do=Po,Fo=function(t,e){He.call(this,t),this.title=this.lang.textStyle,this.icon="text_style";const i=function({lang:t},e){const i={code:{name:t.menu_code,class:"__se__t-code",tag:"code"},shadow:{name:t.menu_shadow,class:"__se__t-shadow",tag:"span"}},s=e||Object.keys(i);let n='<div class="se-list-inner"><ul class="se-list-basic">';for(let t,e,o,l,r,a,h=0,c=s.length;h<c;h++){if(t=s[h],l="",a="",r=[],"string"==typeof t){const e=i[t.toLowerCase()];if(!e)continue;t=e}o=t.name,e=t.tag||"span",l+=` class="${t.class}"`,a+=`.${t.class.trim().replace(/\s+/g,",.")}`,r.push("class"),a=a.replace(/,$/,""),n+=`\n\t\t<li>\n\t\t\t<button \n\t\t\t\ttype="button" \n\t\t\t\tclass="se-btn se-btn-list" \n\t\t\t\tdata-command="${e}" \n\t\t\t\tdata-value="${a}" \n\t\t\t\ttitle="${o}" \n\t\t\t\taria-label="${o}"\n\t\t\t>\n\t\t\t\t<${e}${l}>${o}</${e}>\n\t\t\t</button>\n\t\t</li>`}return n+="</ul></div>",X.createElement("DIV",{class:"se-dropdown se-list-layer se-list-format"},n)}(t,e.items);this.styleList=i.querySelectorAll("li button"),this.menu.initDropdownTarget(Fo,i)};Fo.key="textStyle",Fo.type="dropdown",Fo.className="",Fo.prototype={on(){const t=this.styleList,e=this.selection.getNode();for(let i,s,n,o=0,l=t.length;o<l;o++){i=t[o],s=i.getAttribute("data-value").split(",");for(let t,o,l=0;l<s.length;l++){for(t=e,n=!1;t&&!this.format.isLine(t)&&!this.component.is(t);){if(t.nodeName.toLowerCase()===i.getAttribute("data-command").toLowerCase()&&(o=s[l],/^\./.test(o)?X.hasClass(t,o.replace(/^\./,"")):t.style[o])){n=!0;break}t=t.parentNode}if(!n)break}n?X.addClass(i,"active"):X.removeClass(i,"active")}},action(t){const e=t.firstElementChild,i=e.style.cssText.replace(/:.+(;|$)/g,",").split(",");i.pop();const s=e.classList;for(let t=0,e=s.length;t<e;t++)i.push("."+s[t]);const n=X.hasClass(t,"active")?null:e.cloneNode(!1),o=n?null:[e.nodeName];this.format.applyTextStyle(n,i,o,!0),this.menu.dropdownOff()},constructor:Fo};const Wo=Fo,{NO_EVENT:Uo}=q,Zo=function(t,e,i){He.call(this,t.editor),this.openNewWindow=!!i.openNewWindow,this.relList=Array.isArray(i.relList)?i.relList:[],this.defaultRel=i.defaultRel||{},this.noAutoPrefix=!!i.noAutoPrefix,i.enableFileUpload&&(this.uploadUrl="string"==typeof i.uploadUrl?i.uploadUrl:null,this.uploadHeaders=i.uploadHeaders||null,this.uploadSizeLimit=/\d+/.test(i.uploadSizeLimit)?j.get(i.uploadSizeLimit,0):null,this.uploadSingleSizeLimit=/\d+/.test(i.uploadSingleSizeLimit)?j.get(i.uploadSingleSizeLimit,0):null,this.input=X.createElement("input",{type:"file",accept:i.acceptedFormats||"*"}),this.eventManager.addEvent(this.input,"change",qo.bind(this)),this.fileManager=new Ms(this,{query:"a[download]:not([data-se-file-download])",loadHandler:this.events.onFileLoad,eventHandler:this.events.onFileAction}));const s=function(t,e,i){const s=t.lang,n=t.icons,o=e.textToDisplay?"":'style="display: none;"',l=e.title?"":'style="display: none;"';let r=`\n\t\t<div class="se-modal-body">\n\t\t\t<div class="se-modal-form">\n\t\t\t\t<label>${s.link_modal_url}</label>\n\t\t\t\t<div class="se-modal-form-files">\n\t\t\t\t\t<input data-focus class="se-input-form se-input-url" type="text" placeholder="${t.options.get("protocol")||""}" />\n\t\t\t\t\t${e.enableFileUpload?`<button type="button" class="se-btn se-tooltip se-modal-files-edge-button _se_upload_button" aria-label="${s.fileUpload}">\n\t\t\t\t\t\t\t\t\t${n.file_upload}\n\t\t\t\t\t\t\t\t\t${Ct(s.fileUpload)}\n\t\t\t\t\t\t\t\t</button>`:""}\n\t\t\t\t\t<button type="button" class="se-btn se-tooltip se-modal-files-edge-button _se_bookmark_button" aria-label="${s.link_modal_bookmark}">\n\t\t\t\t\t\t${n.bookmark}\n\t\t\t\t\t\t${Ct(s.link_modal_bookmark)}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="se-anchor-preview-form">\n\t\t\t\t\t<span class="se-svg se-anchor-preview-icon _se_anchor_bookmark_icon">${n.bookmark}</span>\n\t\t\t\t\t<span class="se-svg se-anchor-preview-icon _se_anchor_download_icon">${n.download}</span>\n\t\t\t\t\t<pre class="se-link-preview"></pre>\n\t\t\t\t</div>\n\t\t\t\t<label ${o}>${s.link_modal_text}</label>\n\t\t\t\t<input class="se-input-form _se_display_text" type="text" ${o} />\n\t\t\t\t<label ${l}>${s.title}</label>\n\t\t\t\t<input class="se-input-form _se_title" type="text" ${l} />\n\t\t\t</div>\n\t\t\t<div class="se-modal-form-footer">\n\t\t\t\t<label><input type="checkbox" class="se-modal-btn-check _se_anchor_check" />&nbsp;${s.link_modal_newWindowCheck}</label>\n\t\t\t\t<label><input type="checkbox" class="se-modal-btn-check _se_anchor_download" />&nbsp;${s.link_modal_downloadLinkCheck}</label>`;return i.length>0&&(r+=`\n\t\t\t<div class="se-anchor-rel">\n\t\t\t\t<button type="button" class="se-btn se-tooltip se-anchor-rel-btn" title="${s.link_modal_relAttribute}" aria-label="${s.link_modal_relAttribute}">\n\t\t\t\t\t${n.link_rel}\n\t\t\t\t\t${Ct(s.link_modal_relAttribute)}\n\t\t\t\t</button>\n\t\t\t\t<div class="se-anchor-rel-wrapper"><pre class="se-link-preview se-anchor-rel-preview"></pre></div>\n\t\t\t</div>\n\t\t</div>`),r+="</div></div>",X.createElement("DIV",null,r)}(t.editor,i,this.relList);if(this.kink=t.constructor.key||t.constructor.name,this.inst=t,this.modalForm=e,this.host=(this._w.location.origin+this._w.location.pathname).replace(/\/$/,""),this.urlInput=s.querySelector(".se-input-url"),this.displayInput=s.querySelector("._se_display_text"),this.titleInput=s.querySelector("._se_title"),this.newWindowCheck=s.querySelector("._se_anchor_check"),this.downloadCheck=s.querySelector("._se_anchor_download"),this.download=s.querySelector("._se_anchor_download_icon"),this.preview=s.querySelector(".se-link-preview"),this.bookmark=s.querySelector("._se_anchor_bookmark_icon"),this.bookmarkButton=s.querySelector("._se_bookmark_button"),this.currentRel=[],this.currentTarget=null,this.linkValue="",this._change=!1,this._isRel=this.relList.length>0,this._isRel){this.relButton=s.querySelector(".se-anchor-rel-btn"),this.relPreview=s.querySelector(".se-anchor-rel-preview");const t=this.relList,e=(this.defaultRel.default||"").split(" "),i=[];for(let s,n=0,o=t.length;n<o;n++)s=t[n],i.push(X.createElement("BUTTON",{type:"button",class:"se-btn-list"+(e.includes(s)?" se-checked":""),"data-command":s,title:s,"aria-label":s},s+'<span class="se-svg">'+this.icons.checked+"</span>"));this.selectMenu_rel=new Ye(this,{checkList:!0,position:"right-middle",dir:"ltr"}),this.selectMenu_rel.on(this.relButton,Xo.bind(this)),this.selectMenu_rel.create(i),this.eventManager.addEvent(this.relButton,"click",Go.bind(this))}e.querySelector(".se-anchor-editor").appendChild(s),this.selectMenu_bookmark=new Ye(this,{checkList:!1,position:"bottom-left",dir:"ltr"}),this.selectMenu_bookmark.on(this.urlInput,Yo.bind(this)),this.eventManager.addEvent(this.newWindowCheck,"change",tl.bind(this)),this.eventManager.addEvent(this.downloadCheck,"change",el.bind(this)),this.eventManager.addEvent(this.displayInput,"input",jo.bind(this)),this.eventManager.addEvent(this.urlInput,"input",Ko.bind(this)),this.eventManager.addEvent(this.urlInput,"focus",Jo.bind(this)),this.eventManager.addEvent(this.bookmarkButton,"click",Qo.bind(this)),this.eventManager.addEvent(s.querySelector("._se_upload_button"),"click",(()=>this.input.click()))};async function qo(t){const e=t.target.files;if(!e[0])return;const i={url:this.uploadUrl,uploadHeaders:this.uploadHeaders,files:e},s=async function(t,e){t=e||t;const i=await this.fileManager.asyncUpload(t.url,t.uploadHeaders,t.files);this._uploadCallBack(i)}.bind(this,i),n=await this.triggerEvent("onFileUploadBefore",{...i,handler:s});return void 0===n||!1!==n&&(null!==n&&"object"==typeof n&&s(n),void(!0!==n&&n!==Uo||s(null)))}function Go(){this.selectMenu_rel.open(this.options.get("_rtl")?"left-middle":"")}function Yo(t){const e=t.id||"h_"+Math.random().toString().replace(/.+\./,"");t.id=e,this.urlInput.value="#"+e,this._setLinkPreview(this.urlInput.value),this.selectMenu_bookmark.close(),this.urlInput.focus()}function Xo(t){const e=t.getAttribute("data-command");if(!e)return;const i=this.currentRel,s=i.indexOf(e);-1===s?i.push(e):i.splice(s,1),this.relPreview.title=this.relPreview.textContent=i.join(", ")}function jo(t){this._change=!!t.target.value.trim()}function Ko(t){const e=t.target.value.trim();this._setLinkPreview(e),this._selfPathBookmark(e)?this._createHeaderList(e):this.selectMenu_bookmark.close()}function Jo(){const t=this.urlInput.value;this._selfPathBookmark(t)&&this._createHeaderList(t)}function Qo(){let t=this.urlInput.value;this._selfPathBookmark(t)?(t=t.substr(1),this.bookmark.style.display="none",X.removeClass(this.bookmarkButton,"active")):(t="#"+t,this.bookmark.style.display="block",X.addClass(this.bookmarkButton,"active"),this.downloadCheck.checked=!1,this.download.style.display="none",this._createHeaderList(t)),this.urlInput.value=t,this._setLinkPreview(t),this.urlInput.focus()}function tl(t){"string"==typeof this.defaultRel.check_new_window&&(t.target.checked?this._setRel(this._relMerge(this.defaultRel.check_new_window)):this._setRel(this._relDelete(this.defaultRel.check_new_window)))}function el(t){t.target.checked?(this.download.style.display="block",this.bookmark.style.display="none",X.removeClass(this.bookmarkButton,"active"),this.linkValue=this.preview.textContent=this.urlInput.value=this.urlInput.value.replace(/^#+/,""),"string"==typeof this.defaultRel.check_bookmark&&this._setRel(this._relMerge(this.defaultRel.check_bookmark))):(this.download.style.display="none","string"==typeof this.defaultRel.check_bookmark&&this._setRel(this._relDelete(this.defaultRel.check_bookmark)))}Zo.prototype={set(t){this.currentTarget=t},on(t){if(t){if(this.currentTarget){const t=this.currentTarget.getAttribute("href");this.linkValue=this.preview.textContent=this.urlInput.value=this._selfPathBookmark(t)?t.substr(t.lastIndexOf("#")):t,this.displayInput.value=this.currentTarget.textContent,this.titleInput.value=this.currentTarget.title,this.newWindowCheck.checked=!!/_blank/i.test(this.currentTarget.target),this.downloadCheck.checked=this.currentTarget.download}}else this.init(),this.displayInput.value=this.selection.get().toString().trim(),this.newWindowCheck.checked=this.openNewWindow,this.titleInput.value="";this._setRel(t&&this.currentTarget?this.currentTarget.rel:this.defaultRel.default||""),this._setLinkPreview(this.linkValue)},create(t){if(0===this.linkValue.length)return null;const e=this.linkValue,i=0===this.displayInput.value.length?e:this.displayInput.value,s=this.currentTarget||X.createElement("A");return this._updateAnchor(s,e,i,this.titleInput.value,t),this.linkValue=this.preview.textContent=this.urlInput.value=this.displayInput.value="",s},init(){this.currentTarget=null,this.linkValue=this.preview.textContent=this.urlInput.value="",this.displayInput.value="",this.newWindowCheck.checked=!1,this.downloadCheck.checked=!1,this._change=!1,this._setRel(this.defaultRel.default||"")},_updateAnchor(t,e,i,s,n){!this._selfPathBookmark(e)&&this.downloadCheck.checked?t.setAttribute("download",i||e):t.removeAttribute("download"),this.newWindowCheck.checked?t.target="_blank":t.removeAttribute("target");const o=this.currentRel.join(" ");o?t.rel=o:t.removeAttribute("rel"),t.href=e,s?t.title=s:t.removeAttribute("title"),n?0===t.children.length&&(t.textContent=""):t.textContent=i},_selfPathBookmark(t){const e=this._w.location.href.replace(/\/$/,"");return 0===t.indexOf("#")||0===t.indexOf(e)&&t.indexOf("#")===(e.includes("#")?e.substr(0,e.indexOf("#")).length:e.length)},_setRel(t){if(!this._isRel)return;const e=this.currentRel=t?t.split(" "):[],i=this.selectMenu_rel.form.querySelectorAll("button");for(let t,s=0,n=i.length;s<n;s++)t=i[s].getAttribute("data-command"),e.includes(t)?X.addClass(i[s],"se-checked"):X.removeClass(i[s],"se-checked");this.relPreview.title=this.relPreview.textContent=e.join(" "),e.length>0?X.addClass(this.relButton,"on"):X.removeClass(this.relButton,"on")},_createHeaderList(t){const e=X.getListChildren(this.editor.frameContext.get("wysiwyg"),(t=>/h[1-6]/i.test(t.nodeName)));if(0===e.length)return;const i=new RegExp(`^${t.replace(/^#/,"")}`,"i"),s=[],n=[];for(let t,o=0,l=e.length;o<l;o++)t=e[o],i.test(t.textContent)&&(s.push(t),n.push('<div style="'+t.style.cssText+'">'+t.textContent+"</div>"));0===s.length?this.selectMenu_bookmark.close():(this.selectMenu_bookmark.create(s,n),this.selectMenu_bookmark.open(this.options.get("_rtl")?"bottom-right":""))},_setLinkPreview(t){const e=this.preview,i=this.options.get("defaultUrlProtocol"),s=this.noAutoPrefix,n=/^(mailto:|tel:|sms:|https*:\/\/|#)/.test(t)||0===t.indexOf(i),o=!!i&&RegExp("^"+G.escapeStringRegexp(t.substr(0,i.length))).test(i);t=this.linkValue=e.textContent=t?s?t:!i||n||o?n?t:/^www\./.test(t)?"http://"+t:this.host+(/^\//.test(t)?"":"/")+t:i+t:"",this._selfPathBookmark(t)?(this.bookmark.style.display="block",X.addClass(this.bookmarkButton,"active")):(this.bookmark.style.display="none",X.removeClass(this.bookmarkButton,"active")),!this._selfPathBookmark(t)&&this.downloadCheck.checked?this.download.style.display="block":this.download.style.display="none"},_relMerge(t){const e=this.currentRel;if(!t)return e.join(" ");if(/^only:/.test(t))return t=t.replace(/^only:/,"").trim(),this.currentRel=t.split(" "),t;const i=t.split(" ");for(let t=0,s=i.length;t<s;t++)e.includes(i[t])||e.push(i[t]);return e.join(" ")},_relDelete(t){if(!t)return this.currentRel.join(" ");/^only:/.test(t)&&(t=t.replace(/^only:/,"").trim());const e=this.currentRel.join(" ").replace(RegExp(t+"\\s*"),"");return this.currentRel=e.split(" "),e},_register(t){const e=t.result[0];this.linkValue=this.preview.textContent=this.urlInput.value=e.url,this.displayInput.value=e.name,this.downloadCheck.checked=!0,this.download.style.display="block"},async _error(t){const e=await this.triggerEvent("onFileUploadError",{error:t});if(!1===e)return;const i=e===Uo?t.errorMessage:e||t.errorMessage;this.notice.open(i),console.error("[SUNEDITOR.plugin.fileUpload.error]",i)},_uploadCallBack(t){const e=JSON.parse(t.responseText);e.errorMessage?this._error(e):this._register(e)},constructor:Zo};const il=Zo,sl=function(t,e){He.call(this,t),this.title=this.lang.link,this.icon="link",e.textToDisplay=!0,e.title=!0;const i=function({lang:t,icons:e}){const i=`\n\t<form>\n\t\t<div class="se-modal-header">\n\t\t\t<button type="button" data-command="close" class="se-btn se-close-btn" title="${t.close}" aria-label="${t.close}">\n\t\t\t\t${e.cancel}\n\t\t\t</button>\n\t\t\t<span class="se-modal-title">${t.link_modal_title}</span>\n\t\t</div>\n\t\t<div class="se-anchor-editor"></div>\n\t\t<div class="se-modal-footer">\n\t\t\t<button type="submit" class="se-btn-primary" title="${t.submitButton}" aria-label="${t.submitButton}">\n\t\t\t\t<span>${t.submitButton}</span>\n\t\t\t</button>\n\t\t</div>\n\t</form>`;return X.createElement("DIV",{class:"se-modal-content"},i)}(t),s=function({lang:t,icons:e}){const i=`\n\t<div class="se-arrow se-arrow-up"></div>\n\t<div class="link-content">\n\t\t<span><a target="_blank" href=""></a>&nbsp;</span>\n\t\t<div class="se-btn-group">\n\t\t\t<button type="button" data-command="update" tabindex="-1" class="se-btn se-tooltip">\n\t\t\t\t${e.edit}\n\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t<span class="se-tooltip-text">${t.edit}</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<button type="button" data-command="unlink" tabindex="-1" class="se-btn se-tooltip se-icon-flip-rtl">\n\t\t\t\t${e.unlink}\n\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t<span class="se-tooltip-text">${t.unlink}</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<button type="button" data-command="delete" tabindex="-1" class="se-btn se-tooltip">\n\t\t\t\t${e.delete}\n\t\t\t\t<span class="se-tooltip-inner">\n\t\t\t\t\t<span class="se-tooltip-text">${t.remove}</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t</div>\n\t</div>`;return X.createElement("DIV",{class:"se-controller se-controller-link"},i)}(t),n="string"==typeof e.uploadUrl?e.uploadUrl:null;this.isUpdateState=!1,this.pluginOptions={...e,uploadUrl:n,uploadHeaders:e.uploadHeaders||null,uploadSizeLimit:/\d+/.test(e.uploadSizeLimit)?j.get(e.uploadSizeLimit,0):null,uploadSingleSizeLimit:/\d+/.test(e.uploadSingleSizeLimit)?j.get(e.uploadSingleSizeLimit,0):null,acceptedFormats:"string"==typeof e.acceptedFormats?e.acceptedFormats.trim():null,enableFileUpload:!!n},this.anchor=new il(this,i,this.pluginOptions),this.modal=new Ji(this,i),this.controller=new $e(this,s,{position:"bottom",disabled:!1})};sl.key="link",sl.type="modal",sl.className="se-icon-flip-rtl",sl.prototype={active(t){if(X.isAnchor(t)&&!t.hasAttribute("data-se-non-link")){const e=this.controller.form.querySelector("a");return e.href=t.href,e.title=t.textContent,e.textContent=t.textContent,X.addClass(t,"on"),this.anchor.set(t),this.controller.open(t,null,{isWWTarget:!1,initMethod:null,addOffset:null}),!0}return this.controller.close(),!1},open(){this.modal.open()},on(t){this.isUpdateState=t,this.anchor.on(t)},modalAction(){const t=this.anchor.create(!1);if(null===t)return!1;if(this.isUpdateState){const t=this.controller.currentTarget.childNodes[0];this.selection.setRange(t,0,t,t.textContent.length)}else{const e=this.format.getLines();if(e.length>1){if(!this.html.insertNode(X.createElement(e[0].nodeName,null,t),null,!1))return!0}else if(!this.html.insertNode(t,null,!1))return!0;this.selection.setRange(t.childNodes[0],0,t.childNodes[0],t.textContent.length)}return!0},init(){this.controller.close(),this.anchor.init()},controllerAction(t){const e=t.getAttribute("data-command");if(/update/.test(e))this.modal.open();else if(/unlink/.test(e)){const t=X.getEdgeChild(this.controller.currentTarget,(function(t){return 0===t.childNodes.length||3===t.nodeType}),!1),e=X.getEdgeChild(this.controller.currentTarget,(function(t){return 0===t.childNodes.length||3===t.nodeType}),!0);this.selection.setRange(t,0,e,e.textContent.length),this.format.applyTextStyle(null,null,["A"],!1)}else X.removeItem(this.controller.currentTarget),this.controller.currentTarget=null,this.editor.focus(),this.history.push(!1)},close(){X.removeClass(this.controller.currentTarget,"on")},constructor:sl};const nl=sl,{NO_EVENT:ol}=q,ll=function(t,e){He.call(this,t),this.title=this.lang.image,this.icon="image",this.pluginOptions={canResize:void 0===e.canResize||e.canResize,showHeightInput:void 0===e.showHeightInput||!!e.showHeightInput,defaultWidth:e.defaultWidth?j.is(e.defaultWidth)?e.defaultWidth+"px":e.defaultWidth:"auto",defaultHeight:e.defaultHeight?j.is(e.defaultHeight)?e.defaultHeight+"px":e.defaultHeight:"auto",percentageOnlySize:!!e.percentageOnlySize,createFileInput:void 0===e.createFileInput||e.createFileInput,createUrlInput:void 0===e.createUrlInput||!e.createFileInput||e.createUrlInput,uploadUrl:"string"==typeof e.uploadUrl?e.uploadUrl:null,uploadHeaders:e.uploadHeaders||null,uploadSizeLimit:/\d+/.test(e.uploadSizeLimit)?j.get(e.uploadSizeLimit,0):null,uploadSingleSizeLimit:/\d+/.test(e.uploadSingleSizeLimit)?j.get(e.uploadSingleSizeLimit,0):null,allowMultiple:!!e.allowMultiple,acceptedFormats:"string"!=typeof e.acceptedFormats||"*"===e.acceptedFormats.trim()?"image/*":e.acceptedFormats.trim()||"image/*"};const i=this.pluginOptions.percentageOnlySize?"%":"px",s=function({lang:t,icons:e,plugins:i},s){const n=s.createFileInput?`\n\t\t<div class="se-modal-form">\n\t\t\t<label>${t.image_modal_file}</label>\n\t\t\t${Ji.CreateFileInput({icons:e,lang:t},s)}\n\t\t</div>`:"",o=s.createUrlInput?`\n\t\t<div class="se-modal-form">\n\t\t\t<label>${t.image_modal_url}</label>\n\t\t\t<div class="se-modal-form-files">\n\t\t\t\t<input class="se-input-form se-input-url _se_image_url" data-focus type="text" />\n\t\t\t\t${i.imageGallery?`<button type="button" class="se-btn se-tooltip se-modal-files-edge-button __se__gallery" aria-label="${t.imageGallery}">\n\t\t\t\t\t\t\t${e.image_gallery}\n\t\t\t\t\t\t\t${Ct(t.imageGallery)}\n\t\t\t\t\t\t\t</button>`:""}\n\t\t\t</div>\n\t\t\t<pre class="se-link-preview"></pre>\n\t\t</div>`:"",l=s.canResize?`\n\t\t<div class="se-modal-form">\n\t\t\t<div class="se-modal-size-text">\n\t\t\t\t<label class="size-w">${t.width}</label>\n\t\t\t\t<label class="se-modal-size-x">&nbsp;</label>\n\t\t\t\t<label class="size-h">${t.height}</label>\n\t\t\t</div>\n\t\t\t<input class="se-input-control _se_image_size_x" placeholder="auto" type="text" />\n\t\t\t<label class="se-modal-size-x">x</label>\n\t\t\t<input type="text" class="se-input-control _se_image_size_y" placeholder="auto" />\n\t\t\t<label><input type="checkbox" class="se-modal-btn-check _se_image_check_proportion" checked/>&nbsp;${t.proportion}</label>\n\t\t\t<button type="button" aria-label="${t.revert}" class="se-btn se-tooltip se-modal-btn-revert">\n\t\t\t\t${e.revert}\n\t\t\t\t${Ct(t.revert)}\n\t\t\t</button>\n\t\t</div>`:"",r=s.useFormatType?`\n\t\t<div class="se-modal-form">\n\t\t\t<div class="se-modal-flex-form">\n\t\t\t\t<button type="button" data-command="asBlock" class="se-btn se-tooltip" aria-label="${t.inlineStyle}">\n\t\t\t\t\t${e.component_outline}\n\t\t\t\t\t${Ct(t.blockStyle)}\n\t\t\t\t</button>\n\t\t\t\t<button type="button" data-command="asInline" class="se-btn se-tooltip" aria-label="${t.inlineStyle}">\n\t\t\t\t\t${e.component_inline}\n\t\t\t\t\t${Ct(t.inlineStyle)}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>`:"",a=`\n\t\t<div class="se-modal-header">\n\t\t\t<button type="button" data-command="close" class="se-btn se-close-btn close" title="${t.close}" aria-label="${t.close}">${e.cancel}</button>\n\t\t\t<span class="se-modal-title">${t.image_modal_title}</span>\n\t\t</div>\n\t\t<div class="se-modal-tabs">\n\t\t\t<button type="button" class="_se_tab_link active" data-tab-link="image">${t.image}</button>\n\t\t\t<button type="button" class="_se_tab_link" data-tab-link="url">${t.link}</button>\n\t\t</div>\n\t\t<form method="post" enctype="multipart/form-data">\n\t\t\t<div class="_se_tab_content _se_tab_content_image">\n\t\t\t\t<div class="se-modal-body">\n\t\t\t\t\t${n}\n\t\t\t\t\t${o}\n\t\t\t\t\t<div style="border-bottom: 1px dashed #ccc;"></div>\n\t\t\t\t\t<div class="se-modal-form">\n\t\t\t\t\t\t<label>${t.image_modal_altText}</label><input class="se-input-form _se_image_alt" type="text" />\n\t\t\t\t\t</div>\n\t\t\t\t\t${l}\n\t\t\t\t\t${r}\n\t\t\t\t\t<div class="se-modal-form se-modal-form-footer">\n\t\t\t\t\t\t<label><input type="checkbox" class="se-modal-btn-check _se_image_check_caption" />&nbsp;${t.caption}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="se-anchor-editor _se_tab_content _se_tab_content_url" style="display: none;">\n\t\t\t</div>\n\t\t\t<div class="se-modal-footer">\n\t\t\t\t<div class="se-figure-align">\n\t\t\t\t\t<label><input type="radio" name="suneditor_image_radio" class="se-modal-btn-radio" value="none" checked>${t.basic}</label>\n\t\t\t\t\t<label><input type="radio" name="suneditor_image_radio" class="se-modal-btn-radio" value="left">${t.left}</label>\n\t\t\t\t\t<label><input type="radio" name="suneditor_image_radio" class="se-modal-btn-radio" value="center">${t.center}</label>\n\t\t\t\t\t<label><input type="radio" name="suneditor_image_radio" class="se-modal-btn-radio" value="right">${t.right}</label>\n\t\t\t\t</div>\n\t\t\t\t<button type="submit" class="se-btn-primary" title="${t.submitButton}" aria-label="${t.submitButton}"><span>${t.submitButton}</span></button>\n\t\t\t</div>\n\t\t</form>`;return X.createElement("DIV",{class:"se-modal-content"},a)}(t,this.pluginOptions),n=e.controls||!this.pluginOptions.canResize?[["mirror_h","mirror_v","align","caption","revert","edit","remove"]]:[["resize_auto,100,75,50","rotate_l","rotate_r","mirror_h","mirror_v"],["edit","align","caption","revert","remove"]];this.alignForm=s.querySelector(".se-figure-align"),n.some((t=>t.includes("align")))||(this.alignForm.style.display="none");const o=this.plugins.link?this.plugins.link.pluginOptions:{};this.anchor=new il(this,s,{textToDisplay:!1,title:!0,openNewWindow:o.openNewWindow,relList:o.relList,defaultRel:o.defaultRel,noAutoPrefix:o.noAutoPrefix,enableFileUpload:e.linkEnableFileUpload}),this.modal=new Ji(this,s),this.figure=new gi(this,n,{sizeUnit:i}),this.fileManager=new Ms(this,{query:"img",loadHandler:this.events.onImageLoad,eventHandler:this.events.onImageAction}),this.fileModalWrapper=s.querySelector(".se-flex-input-wrapper"),this.imgInputFile=s.querySelector(".__se__file_input"),this.imgUrlFile=s.querySelector("._se_image_url"),this.focusElement=this.imgInputFile||this.imgUrlFile,this.altText=s.querySelector("._se_image_alt"),this.captionCheckEl=s.querySelector("._se_image_check_caption"),this.previewSrc=s.querySelector("._se_tab_content_image .se-link-preview"),this.sizeUnit=i,this.proportion={},this.inputX={},this.inputY={},this._linkElement=null,this._linkValue="",this._align="none",this._svgDefaultSize="30%",this._base64RenderIndex=0,this._element=null,this._cover=null,this._container=null,this._caption=null,this._ratio={w:1,h:1},this._origin_w="auto"===this.pluginOptions.defaultWidth?"":this.pluginOptions.defaultWidth,this._origin_h="auto"===this.pluginOptions.defaultHeight?"":this.pluginOptions.defaultHeight,this._resizing=this.pluginOptions.canResize,this._onlyPercentage=this.pluginOptions.percentageOnlySize,this._nonResizing=!this._resizing||!this.pluginOptions.showHeightInput||this._onlyPercentage,s.querySelector(".se-modal-tabs").addEventListener("click",this._openTab.bind(this)),this.imgInputFile&&s.querySelector(".se-file-remove").addEventListener("click",al.bind(this)),this.imgUrlFile&&this.imgUrlFile.addEventListener("input",pl.bind(this)),this.imgInputFile&&this.imgUrlFile&&this.imgInputFile.addEventListener("change",gl.bind(this));const l=s.querySelector(".__se__gallery");if(l&&l.addEventListener("click",ml.bind(this)),this._resizing){this.proportion=s.querySelector("._se_image_check_proportion"),this.inputX=s.querySelector("._se_image_size_x"),this.inputY=s.querySelector("._se_image_size_y"),this.inputX.value=this.pluginOptions.defaultWidth,this.inputY.value=this.pluginOptions.defaultHeight;const t=cl.bind(this);this.eventManager.addEvent(this.inputX,"keyup",hl.bind(this,"x")),this.eventManager.addEvent(this.inputY,"keyup",hl.bind(this,"y")),this.eventManager.addEvent(this.inputX,"change",t),this.eventManager.addEvent(this.inputY,"change",t),this.eventManager.addEvent(this.proportion,"change",t),this.eventManager.addEvent(s.querySelector(".se-modal-btn-revert"),"click",dl.bind(this))}this.pluginOptions.useFormatType&&(this.as=this.pluginOptions.defaultFormatType,this.asBlock=s.querySelector('[data-command="asBlock"]'),this.asInline=s.querySelector('[data-command="asInline"]'),this.eventManager.addEvent([this.asBlock,this.asInline],"click",ul.bind(this)))};async function rl(t,e){if(await this.triggerEvent("imageUploadHandler",{xmlHttp:e,info:t})===ol){const i=JSON.parse(e.responseText);i.errorMessage?this._error(i):this._register(t,i)}}function al(){this.imgInputFile.value="",this.imgUrlFile&&(this.imgUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration=""),Ji.OnChangeFile(this.fileModalWrapper,[])}function hl(t,e){if(32!==e.keyCode){if("x"===t&&this._onlyPercentage&&e.target.value>100)e.target.value=100;else if(this.proportion.checked){const e=gi.CalcRatio(this.inputX.value,this.inputY.value,this.sizeUnit,this._ratio);"x"===t?this.inputY.value=e.h:this.inputX.value=e.w}}else e.preventDefault()}function cl(){this._ratio=this.proportion.checked?gi.GetRatio(this.inputX.value,this.inputY.value,this.sizeUnit):{w:1,h:1}}function dl(){this._onlyPercentage?this.inputX.value=this._origin_w>100?100:this._origin_w:(this.inputX.value=this._origin_w,this.inputY.value=this._origin_h)}function ul({target:t}){this._activeAsInline("asInline"===t.getAttribute("data-command"))}function pl(t){const e=t.target.value.trim();this._linkValue=this.previewSrc.textContent=e?this.options.get("defaultUrlProtocol")&&!e.includes("://")&&0!==e.indexOf("#")?this.options.get("defaultUrlProtocol")+e:e.includes("://")?e:"/"+e:""}function gl({target:t}){this.imgInputFile.value?(this.imgUrlFile.setAttribute("disabled",!0),this.previewSrc.style.textDecoration="line-through"):(this.imgUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration=""),Ji.OnChangeFile(this.fileModalWrapper,t.files)}function ml(){this.plugins.imageGallery.open(fl.bind(this))}function fl(t){this.altText.value=t.getAttribute("data-value")||t.alt,this._linkValue=this.previewSrc.textContent=this.imgUrlFile.value=t.getAttribute("data-command")||t.src,this.imgUrlFile.focus()}function _l(t,e,i){if(0===t.offsetWidth&&this.applySize(e,""),this.options.get("mediaAutoSelect"))this.component.select(t,ll.key,!1);else{const t=this.format.addLine(i,null);t&&this.setRange(t,0,t,0)}delete t.onload}ll.key="image",ll.type="modal",ll.component=function(t){return t=X.isFigure(t)?t.firstElementChild:t,/^IMG$/i.test(t?.nodeName)?t:X.isAnchor(t)&&/^IMG$/i.test(t?.firstElementChild?.nodeName)?t?.firstElementChild:null},ll.className="",ll.prototype={open(){this.modal.open()},edit(){this.modal.open()},on(t){t?this.imgInputFile&&this.pluginOptions.allowMultiple&&this.imgInputFile.removeAttribute("multiple"):(this.inputX.value=this._origin_w="auto"===this.pluginOptions.defaultWidth?"":this.pluginOptions.defaultWidth,this.inputY.value=this._origin_h="auto"===this.pluginOptions.defaultHeight?"":this.pluginOptions.defaultHeight,this.imgInputFile&&this.pluginOptions.allowMultiple&&this.imgInputFile.setAttribute("multiple","multiple")),this.anchor.on(t)},onPastAndDrop({file:t}){if(/^image/.test(t.type))return this.submitFile([t]),this.editor.focus(),!1},async modalAction(){return this._align=this.modal.form.querySelector('input[name="suneditor_image_radio"]:checked').value,this.modal.isUpdate&&(this._update(this.inputX.value,this.inputY.value),this.history.push(!1)),this.imgInputFile&&this.imgInputFile.files.length>0?await this.submitFile(this.imgInputFile.files):!!(this.imgUrlFile&&this._linkValue.length>0)&&await this.submitURL(this._linkValue)},retainFormat(){return{query:"img",method:t=>{const e=gi.GetContainer(t);e&&e.container&&e.cover||(this.ready(t),this._fileCheck(this._origin_w,this._origin_h))}}},init(){Ji.OnChangeFile(this.fileModalWrapper,[]),this.imgInputFile&&(this.imgInputFile.value=""),this.imgUrlFile&&(this._linkValue=this.previewSrc.textContent=this.imgUrlFile.value=""),this.imgInputFile&&this.imgUrlFile&&(this.imgUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration=""),this.altText.value="",this.modal.form.querySelector('input[name="suneditor_image_radio"][value="none"]').checked=!0,this.captionCheckEl.checked=!1,this._element=null,this._ratio={w:1,h:1},this._openTab("init"),this._resizing&&(this.inputX.value="auto"===this.pluginOptions.defaultWidth?"":this.pluginOptions.defaultWidth,this.inputY.value="auto"===this.pluginOptions.defaultHeight?"":this.pluginOptions.defaultHeight,this.proportion.checked=!0),this.pluginOptions.useFormatType&&this._activeAsInline("inline"===this.pluginOptions.defaultFormatType),this.anchor.init()},select(t){this.ready(t)},ready(t){if(!t)return;const e=this.figure.open(t,{nonResizing:this._nonResizing,nonSizeInfo:!1,nonBorder:!1,figureTarget:!1,__fileManagerInfo:!1});if(this.anchor.set(X.isAnchor(t.parentNode)?t.parentNode:null),this._linkElement=this.anchor.currentTarget,this._element=t,this._cover=e.cover,this._container=e.container,this._caption=e.caption,this._align=e.align,t.style.float="",this._origin_w=e.originWidth||e.w||"",this._origin_h=e.originHeight||e.h||"",this.altText.value=this._element.alt,this.imgUrlFile&&(this._linkValue=this.previewSrc.textContent=this.imgUrlFile.value=this._element.src),(this.modal.form.querySelector('input[name="suneditor_image_radio"][value="'+this._align+'"]')||this.modal.form.querySelector('input[name="suneditor_image_radio"][value="none"]')).checked=!0,this.captionCheckEl.checked=!!this._caption,!this._resizing)return;const i=this._onlyPercentage&&this.figure.isVertical;let s=i?"":e.width;if(this._onlyPercentage&&(s=j.get(s,2),s>100&&(s=100)),this.inputX.value="auto"===s?"":s,!this._onlyPercentage){const t=i?"":e.height;this.inputY.value="auto"===t?"":t}this.proportion.checked=!0,this.inputX.disabled=!!i,this.inputY.disabled=!!i,this.proportion.disabled=!!i,this._ratio=this.proportion.checked?e.ratio:{w:1,h:1},this.pluginOptions.useFormatType&&this._activeAsInline(this.component.isInline(e.container))},async destroy(t){const e=t||this._element,i=X.getParentElement(e,gi.__is)||e,s=i.previousElementSibling||i.nextElementSibling,n=i.parentNode;!1!==await this.triggerEvent("onImageDeleteBefore",{target:e,container:i,align:this._align,alt:this.altText.value,url:this._linkValue})&&(X.removeItem(i),this.init(),n!==this.editor.frameContext.get("wysiwyg")&&this.nodeTransform.removeAllParents(n,(function(t){return 0===t.childNodes.length}),null),this.editor.focusEdge(s),this.history.push(!1))},_getInfo(){return{element:this._element,anchor:this.anchor.create(!0),inputWidth:this.inputX.value,inputHeight:this.inputY.value,align:this._align,isUpdate:this.modal.isUpdate,alt:this.altText.value}},_activeAsInline(t){const e=this.figure.controller.form.querySelector('[data-command="onalign"]');t?(X.addClass(this.asInline,"on"),X.removeClass(this.asBlock,"on"),this.as="inline",this.alignForm&&(this.alignForm.style.display="none"),e&&(e.style.display="none")):(X.addClass(this.asBlock,"on"),X.removeClass(this.asInline,"on"),this.as="block",this.alignForm&&(this.alignForm.style.display=""),e&&(e.style.display=""))},async submitFile(t){if(0===t.length)return!1;let e=0;const i=[],s=this.uploadSingleSizeLimit;for(let n,o,l=0,r=t.length;l<r;l++)if(n=t[l],/image/i.test(n.type)){if(o=n.size,s&&s>o){const t="[SUNEDITOR.imageUpload.fail] Size of uploadable single file: "+s/1e3+"KB",e=await this.triggerEvent("onImageUploadError",{error:t,limitSize:s,uploadSize:o,file:n});return this.notice.open(e===ol?t:e||t),!1}i.push(n),e+=o}const n=this.pluginOptions.uploadSizeLimit,o=this.fileManager.getSize();if(n>0&&e+o>n){const t="[SUNEDITOR.imageUpload.fail] Size of uploadable total images: "+n/1e3+"KB",i=await this.triggerEvent("onImageUploadError",{error:t,limitSize:n,currentSize:o,uploadSize:e});return this.notice.open(i===ol?t:i||t),!1}const l={files:i,...this._getInfo()},r=function(t,e){t=e||t,this._serverUpload(t,t.files)}.bind(this,l),a=await this.triggerEvent("onImageUploadBefore",{...l,handler:r});return void 0===a||!1!==a&&(null!==a&&"object"==typeof a&&r(a),void(!0!==a&&a!==ol||r(null)))},async submitURL(t){if(t||(t=this._linkValue),!t)return!1;const e={name:t.split("/").pop(),size:0},i={url:t,files:e,...this._getInfo()},s=function(t,e){const i=(t=e||t).url;this.modal.isUpdate?this._updateSrc(i,t.element,t.files):this.create(i,t.anchor,t.inputWidth,t.inputHeight,t.align,t.files,t.alt)}.bind(this,i),n=await this.triggerEvent("onImageUploadBefore",{...i,handler:s});return void 0===n||!1!==n&&(null!==n&&"object"==typeof n&&s(n),!0!==n&&n!==ol||s(null),!0)},_update(t,e){t||(t=this.inputX.value||"auto"),e||(e=this.inputY.value||"auto");let i=this._element;const s=this._cover,n=this._container===this._cover?null:this._container;let o;const l=j.is(t)?t+this.sizeUnit:t,r=j.is(e)?e+this.sizeUnit:e;o=/%$/.test(i.style.width)?l!==n.style.width||r!==n.style.height:l!==i.style.width||r!==i.style.height,i.alt=this.altText.value;let a=!1;this.captionCheckEl.checked?this._caption||(this._caption=gi.CreateCaption(s,this.lang.caption),a=!0):this._caption&&(X.removeItem(this._caption),this._caption=null,a=!0);let h=!1;const c=this.anchor.create(!0);if(c)this._linkElement===c&&n.contains(c)||(this._linkElement=c.cloneNode(!1),s.insertBefore(this._setAnchor(i,this._linkElement),this._caption),h=!0);else if(null!==this._linkElement&&s.contains(this._linkElement)){const t=i.cloneNode(!0);s.removeChild(this._linkElement),s.insertBefore(t,this._caption),i=t}this._resizing&&o&&this.applySize(t,e),h&&X.removeItem(c),(a||!this._onlyPercentage&&o)&&(/\d+/.test(i.style.height)||this.figure.isVertical&&this.captionCheckEl.checked)&&(/auto|%$/.test(t)||/auto|%$/.test(e)?this.figure.deleteTransform(i):this.figure.setTransform(i,t,e,0)),this.figure.setAlign(i,this._align),i.onload=()=>{this.select(i)}},_fileCheck(t,e){t||(t=this.inputX.value||"auto"),e||(e=this.inputY.value||"auto");let i,s=this._element,n=this._cover,o=this._container===this._cover?null:this._container,l=!1;if(!n||!o){l=!0,s=this._element.cloneNode(!0);const t=gi.CreateContainer(s,"se-image-container");n=t.cover,o=t.container,this.figure.open(s,{nonResizing:!0,nonSizeInfo:!1,nonBorder:!1,figureTarget:!1,__fileManagerInfo:!0})}const r=j.is(t)?t+this.sizeUnit:t,a=j.is(e)?e+this.sizeUnit:e;i=/%$/.test(s.style.width)?r!==o.style.width||a!==o.style.height:r!==s.style.width||a!==s.style.height,s.alt=this.altText.value;let h=!1;this.captionCheckEl.checked?this._caption&&!l||(this._caption=gi.CreateCaption(n,this.lang.caption),h=!0):this._caption&&(X.removeItem(this._caption),this._caption=null,h=!0);let c=null;const d=this.anchor.create(!0);if(d)(this._linkElement!==d||l&&!o.contains(d))&&(this._linkElement=d.cloneNode(!1),n.insertBefore(this._setAnchor(s,this._linkElement),this._caption),c=this._element);else if(null!==this._linkElement&&n.contains(this._linkElement)){const t=s.cloneNode(!0);n.removeChild(this._linkElement),n.insertBefore(t,this._caption),s=t}l&&(s=this._element,this.figure._retainFigureFormat(o,this._element,c?d:null),this._element=s=o.querySelector("img"),this._cover=n,this._container=o),this._resizing&&i&&this.applySize(t,e),c&&(l?(X.removeItem(c),0===X.getListChildren(d,(t=>/IMG/i.test(t.tagName))).length&&X.removeItem(d)):X.removeItem(d)),(h||!this._onlyPercentage&&i)&&(/\d+/.test(s.style.height)||this.figure.isVertical&&this.captionCheckEl.checked)&&(/auto|%$/.test(t)||/auto|%$/.test(e)?this.figure.deleteTransform(s):this.figure.setTransform(s,t,e,0)),this.figure.setAlign(s,this._align)},_openTab(t){const e=this.modal.form,i="init"===t?e.querySelector("._se_tab_link"):t.target;if(!/^BUTTON$/i.test(i.tagName))return!1;const s=i.getAttribute("data-tab-link");let n;const o=e.getElementsByClassName("_se_tab_content");for(n=0;n<o.length;n++)o[n].style.display="none";const l=e.getElementsByClassName("_se_tab_link");for(n=0;n<l.length;n++)X.removeClass(l[n],"active");return e.querySelector("._se_tab_content_"+s).style.display="block",X.addClass(i,"active"),"init"!==t&&("image"===s?this.focusElement.focus():"url"===s&&this.anchor.urlInput.focus()),!1},applySize(t,e){t||(t=this.inputX.value||this.pluginOptions.defaultWidth),e||(e=this.inputY.value||this.pluginOptions.defaultHeight),this._onlyPercentage&&(t?/%$/.test(t)&&(t+="%"):t="100%"),this.figure.setSize(t,e,null)},create(t,e,i,s,n,o,l){const r=X.createElement("IMG");r.src=t,r.alt=l,e=this._setAnchor(r,e?e.cloneNode(!1):null);const a=gi.CreateContainer(e,"se-image-container"),h=a.cover,c=a.container;this.captionCheckEl.checked&&(this._caption=gi.CreateCaption(h,this.lang.caption)),this._element=r,this._cover=h,this._container=c,this.figure.open(r,{nonResizing:this._nonResizing,nonSizeInfo:!1,nonBorder:!1,figureTarget:!1,__fileManagerInfo:!0}),this.applySize(i,s),this.figure.setAlign(r,n),this.fileManager.setFileData(r,o),r.onload=_l.bind(this,r,this._svgDefaultSize,c),this.component.insert(c,!1,!0)},_updateSrc(t,e,i){e.src=t,this.fileManager.setFileData(e,i),this.component.select(e,ll.key,!1)},_register(t,e){const i=e.result;for(let e,s=0,n=i.length;s<n;s++){if(e={name:i[s].name,size:i[s].size},t.isUpdate){this._updateSrc(i[s].url,t.element,e);break}this.create(i[s].url,t.anchor,t.inputWidth,t.inputHeight,t.align,e,t.alt)}},_serverUpload(t,e){if(!e)return;const i=this.pluginOptions.uploadUrl;"string"==typeof i&&i.length>0?this.fileManager.upload(i,this.pluginOptions.uploadHeaders,e,rl.bind(this,t),this._error.bind(this)):this._setBase64(e,t.anchor,t.inputWidth,t.inputHeight,t.align,t.alt,t.isUpdate)},_setBase64(t,e,i,s,n,o,l){try{const r=this.modal.isUpdate?1:t.length;if(0===r)return this.editor.hideLoading(),void console.warn("[SUNEDITOR.image.base64.fail] cause : No applicable files");this._base64RenderIndex=r;const a=[r];this.inputX.value=i,this.inputY.value=s;for(let h,c,d=0;d<r;d++)h=new FileReader,c=t[d],h.onload=function(t,l,r,h,c){a[c]={result:t.result,file:h},0==--this._base64RenderIndex&&(this._onRenderBase64(l,a,r,e,i,s,n,o),this.editor.hideLoading())}.bind(this,h,l,this._element,c,d),h.readAsDataURL(c)}catch(t){throw this.editor.hideLoading(),Error(`[SUNEDITOR.plugins.image._setBase64.fail] ${t.message}`)}},_onRenderBase64(t,e,i,s,n,o,l,r){for(let a=0,h=e.length;a<h;a++)t?this._updateSrc(e[a].result,i,e[a].file):this.create(e[a].result,s,n,o,l,e[a].file,r)},_setAnchor:(t,e)=>e?(e.appendChild(t),e):t,async _error(t){const e=await this.triggerEvent("onImageUploadError",{error:t}),i=e===ol?t.errorMessage:e||t.errorMessage;this.notice.open(i),console.error("[SUNEDITOR.plugin.image.error]",i)},constructor:ll};const bl=ll,{NO_EVENT:vl}=q,yl=function(t,e){He.call(this,t),this.title=this.lang.video,this.icon="video",this.pluginOptions={canResize:void 0===e.canResize||e.canResize,showHeightInput:void 0===e.showHeightInput||!!e.showHeightInput,defaultWidth:e.defaultWidth&&j.get(e.defaultWidth,0)?j.is(e.defaultWidth)?e.defaultWidth+"px":e.defaultWidth:"",defaultHeight:e.defaultHeight&&j.get(e.defaultHeight,0)?j.is(e.defaultHeight)?e.defaultHeight+"px":e.defaultHeight:"",percentageOnlySize:!!e.percentageOnlySize,createFileInput:!!e.createFileInput,createUrlInput:void 0===e.createUrlInput||!e.createFileInput||e.createUrlInput,uploadUrl:"string"==typeof e.uploadUrl?e.uploadUrl:null,uploadHeaders:e.uploadHeaders||null,uploadSizeLimit:/\d+/.test(e.uploadSizeLimit)?j.get(e.uploadSizeLimit,0):null,uploadSingleSizeLimit:/\d+/.test(e.uploadSingleSizeLimit)?j.get(e.uploadSingleSizeLimit,0):null,allowMultiple:!!e.allowMultiple,acceptedFormats:"string"!=typeof e.acceptedFormats||"*"===e.acceptedFormats.trim()?"video/*":e.acceptedFormats.trim()||"video/*",defaultRatio:j.get(e.defaultRatio,4)||.5625,showRatioOption:void 0===e.showRatioOption||!!e.showRatioOption,ratioOptions:e.ratioOptions?e.ratioOptions:null,videoTagAttributes:e.videoTagAttributes||null,iframeTagAttributes:e.iframeTagAttributes||null};const i=this.pluginOptions.percentageOnlySize?"%":"px",s=function({lang:t,icons:e},i){let s=`\n\t<form method="post" enctype="multipart/form-data">\n\t\t<div class="se-modal-header">\n\t\t\t<button type="button" data-command="close" class="se-btn se-close-btn" title="${t.close}" aria-label="${t.close}">\n\t\t\t${e.cancel}\n\t\t\t</button>\n\t\t\t<span class="se-modal-title">${t.video_modal_title}</span>\n\t\t</div>\n\t\t<div class="se-modal-body">`;if(i.createFileInput&&(s+=`\n\t\t\t<div class="se-modal-form">\n\t\t\t\t<label>${t.video_modal_file}</label>\n\t\t\t\t${Ji.CreateFileInput({lang:t,icons:e},i)}\n\t\t\t</div>`),i.createUrlInput&&(s+=`\n\t\t\t<div class="se-modal-form">\n\t\t\t\t<label>${t.video_modal_url}</label>\n\t\t\t\t<input class="se-input-form se-input-url" type="text" data-focus />\n\t\t\t\t<pre class="se-link-preview"></pre>\n\t\t\t</div>`),i.canResize){const n=i.ratioOptions||[{name:"16:9",value:.5625},{name:"4:3",value:.75},{name:"21:9",value:.4285}],o=i.defaultRatio,l=i.percentageOnlySize,r=l?' style="display: none !important;"':"",a=i.showHeightInput?"":' style="display: none !important;"',h=i.showRatioOption?"":' style="display: none !important;"',c=l||i.showHeightInput||i.showRatioOption?"":' style="display: none !important;"';s+=`\n\t\t\t<div class="se-modal-form">\n\t\t\t\t<div class="se-modal-size-text">\n\t\t\t\t\t<label class="size-w">${t.width}</label>\n\t\t\t\t\t<label class="se-modal-size-x">&nbsp;</label>\n\t\t\t\t\t<label class="size-h"${a}>${t.height}</label>\n\t\t\t\t\t<label class="size-h"${h}>(${t.ratio})</label>\n\t\t\t\t</div>\n\t\t\t\t<input class="se-input-control _se_video_size_x" placeholder="100%"${l?' type="number" min="1"':'type="text"'}${l?' max="100"':""}/>\n\t\t\t\t<label class="se-modal-size-x"${c}>${l?"%":"x"}</label>\n\t\t\t\t<input class="se-input-control _se_video_size_y" placeholder="${100*i.defaultRatio}%"\n\t\t\t\t${l?' type="number" min="1"':'type="text"'}${l?' max="100"':""}${a}/>\n\t\t\t\t<select class="se-input-select se-video-ratio" title="${t.ratio}" aria-label="${t.ratio}"${h}>\n\t\t\t\t\t${a?"":'<option value=""> - </option>'} \n\t\t\t\t\t${n.map((t=>`<option value="${t.value}"${o.toString()===t.value.toString()?" selected":""}>${t.name}</option>`)).join("")}\n\t\t\t\t</select>\n\t\t\t\t<button type="button" title="${t.revert}" aria-label="${t.revert}" class="se-btn se-modal-btn-revert">${e.revert}</button>\n\t\t\t</div>\n\t\t\t<div class="se-modal-form se-modal-form-footer"${r}${c}>\n\t\t\t\t<label>\n\t\t\t\t\t<input type="checkbox" class="se-modal-btn-check _se_video_check_proportion" />&nbsp;\n\t\t\t\t\t<span>${t.proportion}</span>\n\t\t\t\t</label>\n\t\t\t</div>`}return s+=`\n\t\t</div>\n\t\t<div class="se-modal-footer">\n\t\t\t<div class="se-figure-align">\n\t\t\t\t<label><input type="radio" name="suneditor_video_radio" class="se-modal-btn-radio" value="none" checked>${t.basic}</label>\n\t\t\t\t<label><input type="radio" name="suneditor_video_radio" class="se-modal-btn-radio" value="left">${t.left}</label>\n\t\t\t\t<label><input type="radio" name="suneditor_video_radio" class="se-modal-btn-radio" value="center">${t.center}</label>\n\t\t\t\t<label><input type="radio" name="suneditor_video_radio" class="se-modal-btn-radio" value="right">${t.right}</label>\n\t\t\t</div>\n\t\t\t<button type="submit" class="se-btn-primary" title="${t.submitButton}" aria-label="${t.submitButton}"><span>${t.submitButton}</span></button>\n\t\t</div>\n\t</form>`,X.createElement("DIV",{class:"se-modal-content"},s)}(t,this.pluginOptions),n=e.controls||!this.pluginOptions.canResize?[["mirror_h","mirror_v","align","revert","edit","remove"]]:[["resize_auto,75,50","rotate_l","rotate_r","mirror_h","mirror_v"],["edit","align","revert","remove"]];n.some((t=>t.includes("align")))||(s.querySelector(".se-figure-align").style.display="none");const o=100*this.pluginOptions.defaultRatio+"%";if(this.modal=new Ji(this,s),this.figure=new gi(this,n,{sizeUnit:i,autoRatio:{current:o,default:o}}),this.fileManager=new Ms(this,{query:"iframe, video",loadHandler:this.events.onVideoLoad,eventHandler:this.events.onVideoAction}),this.fileModalWrapper=s.querySelector(".se-flex-input-wrapper"),this.videoInputFile=s.querySelector(".__se__file_input"),this.videoUrlFile=s.querySelector(".se-input-url"),this.focusElement=this.videoUrlFile||this.videoInputFile,this.previewSrc=s.querySelector(".se-link-preview"),this._linkValue="",this._align="none",this._videoRatio=o,this._defaultRatio=o,this._defaultSizeX="100%",this._defaultSizeY=100*this.pluginOptions.defaultRatio+"%",this.sizeUnit=i,this.proportion={},this.videoRatioOption={},this.inputX={},this.inputY={},this._element=null,this._cover=null,this._container=null,this._ratio={w:1,h:1},this._origin_w="100%"===this.pluginOptions.defaultWidth?"":this.pluginOptions.defaultWidth,this._origin_h=this.pluginOptions.defaultHeight===o?"":this.pluginOptions.defaultHeight,this._resizing=this.pluginOptions.canResize,this._onlyPercentage=this.pluginOptions.percentageOnlySize,this._nonResizing=!this._resizing||!this.pluginOptions.showHeightInput||this._onlyPercentage,this.query={youtube:{pattern:/youtu\.?be/i,action:this.convertUrlYoutube.bind(this),tag:"iframe"},vimeo:{pattern:/vimeo\.com/i,action:this.convertUrlVimeo.bind(this),tag:"iframe"},...e.embedQuery},this.videoInputFile&&s.querySelector(".se-file-remove").addEventListener("click",Cl.bind(this)),this.videoUrlFile&&this.videoUrlFile.addEventListener("input",xl.bind(this)),this.videoInputFile&&this.videoUrlFile&&this.videoInputFile.addEventListener("change",Sl.bind(this)),this._resizing){this.proportion=s.querySelector("._se_video_check_proportion"),this.videoRatioOption=s.querySelector(".se-video-ratio"),this.inputX=s.querySelector("._se_video_size_x"),this.inputY=s.querySelector("._se_video_size_y"),this.inputX.value=this.pluginOptions.defaultWidth,this.inputY.value=this.pluginOptions.defaultHeight;const t=kl.bind(this);this.inputX.addEventListener("keyup",Nl.bind(this,"x")),this.inputY.addEventListener("keyup",Nl.bind(this,"y")),this.inputX.addEventListener("change",t),this.inputY.addEventListener("change",t),this.proportion.addEventListener("change",t),this.videoRatioOption.addEventListener("change",Tl.bind(this)),s.querySelector(".se-modal-btn-revert").addEventListener("click",El.bind(this))}};async function wl(t,e){if(await this.triggerEvent("videoUploadHandler",{xmlHttp:e,info:t})===vl){const i=JSON.parse(e.responseText);i.errorMessage?this._error(i):this._register(t,i)}}function Cl(){this.videoInputFile.value="",this.videoUrlFile&&(this.videoUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration=""),Ji.OnChangeFile(this.fileModalWrapper,[])}function xl(t){const e=t.target.value.trim();/^<iframe.*\/iframe>$/.test(e)?(this._linkValue=e,this.previewSrc.textContent='<IFrame :src=".."></IFrame>'):this._linkValue=this.previewSrc.textContent=e?this.options.get("defaultUrlProtocol")&&!e.includes("://")&&0!==e.indexOf("#")?this.options.get("defaultUrlProtocol")+e:e.includes("://")?e:"/"+e:""}function Sl({target:t}){this.videoInputFile.value?(this.videoUrlFile.setAttribute("disabled",!0),this.previewSrc.style.textDecoration="line-through"):(this.videoUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration=""),Ji.OnChangeFile(this.fileModalWrapper,t.files)}function El(){this._onlyPercentage?this.inputX.value=this._origin_w>100?100:this._origin_w:(this.inputX.value=this._origin_w,this.inputY.value=this._origin_h)}function Tl(t){const e=t.target.options[t.target.selectedIndex].value;this._defaultSizeY=this.figure.autoRatio.current=this._videoRatio=e?100*e+"%":this._defaultSizeY,this.inputY.placeholder=e?100*e+"%":"",this.inputY.value=""}function kl(){this._ratio=this.proportion.checked?gi.GetRatio(this.inputX.value,this.inputY.value,this.sizeUnit):{w:1,h:1}}function Nl(t,e){if(32!==e.keyCode){if("x"===t&&this._onlyPercentage&&e.target.value>100)e.target.value=100;else if(this.proportion.checked){const e=gi.CalcRatio(this.inputX.value,this.inputY.value,this.sizeUnit,this._ratio);"x"===t?this.inputY.value=e.h:this.inputX.value=e.w}"y"===t&&this._setVideoRatioSelect(e.target.value||this._defaultRatio)}else e.preventDefault()}yl.key="video",yl.type="modal",yl.className="",yl.component=function(t){return/^(VIDEO)$/i.test(t?.nodeName)||/^(IFRAME)$/i.test(t?.nodeName)&&this.findProcessUrl(t.src)?t:null},yl.prototype={open(){this.modal.open()},edit(){this.modal.open()},on(t){t?this.videoInputFile&&this.pluginOptions.allowMultiple&&this.videoInputFile.removeAttribute("multiple"):(this.inputX.value=this._origin_w=this.pluginOptions.defaultWidth===this._defaultSizeX?"":this.pluginOptions.defaultWidth,this.inputY.value=this._origin_h=this.pluginOptions.defaultHeight===this._defaultSizeY?"":this.pluginOptions.defaultHeight,this.proportion.disabled=!0,this.videoInputFile&&this.pluginOptions.allowMultiple&&this.videoInputFile.setAttribute("multiple","multiple")),this._resizing&&this._setVideoRatioSelect(this._origin_h||this._defaultRatio)},onPastAndDrop({file:t}){if(/^video/.test(t.type))return this.submitFile([t]),this.editor.focus(),!1},async modalAction(){this._align=this.modal.form.querySelector('input[name="suneditor_video_radio"]:checked').value;let t=!1;return this.videoInputFile&&this.videoInputFile.files.length>0?t=await this.submitFile(this.videoInputFile.files):this.videoUrlFile&&this._linkValue.length>0&&(t=await this.submitURL(this._linkValue)),t&&this._w.setTimeout(this.component.select.bind(this.component,this._element,"video"),0),t},retainFormat(){return{query:"iframe, video",method:t=>{const e=gi.GetContainer(t);if(e&&e.container&&e.cover)return;this.ready(t);const i=this.format.getLine(t);i&&(this._align=i.style.textAlign||i.style.float),this._update(t)}}},init(){Ji.OnChangeFile(this.fileModalWrapper,[]),this.videoInputFile&&(this.videoInputFile.value=""),this.videoUrlFile&&(this._linkValue=this.previewSrc.textContent=this.videoUrlFile.value=""),this.videoInputFile&&this.videoUrlFile&&(this.videoUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration=""),this.modal.form.querySelector('input[name="suneditor_video_radio"][value="none"]').checked=!0,this._ratio={w:1,h:1},this._nonResizing=!1,this._resizing&&(this.inputX.value=this.pluginOptions.defaultWidth===this._defaultSizeX?"":this.pluginOptions.defaultWidth,this.inputY.value=this.pluginOptions.defaultHeight===this._defaultSizeY?"":this.pluginOptions.defaultHeight,this.proportion.checked=!1,this.proportion.disabled=!0,this._setVideoRatioSelect(this._defaultRatio))},select(t){this.ready(t)},ready(t){if(!t)return;const e=this.figure.open(t,{nonResizing:this._nonResizing,nonSizeInfo:!1,nonBorder:!1,figureTarget:!1,__fileManagerInfo:!1});this._element=t,this._cover=e.cover,this._container=e.container,this._align=e.align,t.style.float="",this._origin_w=e.width||e.originWidth||e.w||"",this._origin_h=e.height||e.originHeight||e.h||"";let i=e.width||e.w||this._origin_w||"";const s=e.height||e.h||this._origin_h||"";if(this.videoUrlFile&&(this._linkValue=this.previewSrc.textContent=this.videoUrlFile.value=this._element.src||(this._element.querySelector("source")||"").src||""),(this.modal.form.querySelector('input[name="suneditor_video_radio"][value="'+this._align+'"]')||this.modal.form.querySelector('input[name="suneditor_video_radio"][value="none"]')).checked=!0,!this._resizing)return;const n=this._onlyPercentage&&this.figure.isVertical;if(this._onlyPercentage&&(i=j.get(i,2),i>100&&(i=100)),this.inputX.value="auto"===i?"":i,!this._onlyPercentage){const t=n?"":e.height;this.inputY.value="auto"===t?"":t}this._setVideoRatioSelect(s)||(this.inputY.value=this._onlyPercentage?j.get(s,2):s),this.proportion.checked=!0,this.inputX.disabled=!!n,this.inputY.disabled=!!n,this.proportion.disabled=!!n,this._ratio=this.proportion.checked?e.ratio:{w:1,h:1}},async destroy(t){const e=t||this._element,i=X.getParentElement(e,gi.__is)||e,s=i.previousElementSibling||i.nextElementSibling,n=i.parentNode;!1!==await this.triggerEvent("onVideoDeleteBefore",{target:e,container:i,align:this._align,url:this._linkValue})&&(X.removeItem(i),this.init(),n!==this.editor.frameContext.get("wysiwyg")&&this.nodeTransform.removeAllParents(n,(function(t){return 0===t.childNodes.length}),null),this.editor.focusEdge(s),this.history.push(!1))},findProcessUrl(t){const e=this.query;for(const i in e){const s=e[i];if(s.pattern.test(t))return{origin:t,url:s.action(t),tag:s.tag}}return null},convertUrlYoutube:t=>(/^http/.test(t)||(t="https://"+t),t=t.replace("watch?v=",""),/^\/\/.+\/embed\//.test(t)||(t=t.replace(t.match(/\/\/.+\//)[0],"//www.youtube.com/embed/").replace("&","?&")),t),convertUrlVimeo:t=>(t.endsWith("/")&&(t=t.slice(0,-1)),"https://player.vimeo.com/video/"+t.slice(t.lastIndexOf("/")+1)),applySize(t,e){t||(t=this.inputX.value||this.pluginOptions.defaultWidth),e||(e=this.inputY.value||this.pluginOptions.defaultHeight),this._onlyPercentage&&(t?/%$/.test(t)&&(t+="%"):t="100%"),this.figure.setSize(t,e)},create(t,e,i,s,n,o,l){let r=null,a=null;if(o){if((t=this._element).src!==e){const i=this.findProcessUrl(e);if(/^iframe$/i.test(i?.tag)&&!/^iframe$/i.test(t.nodeName)){const i=this.createIframeTag();i.src=e,t.parentNode.replaceChild(i,t),this._element=t=i}else if(/^video$/i.test(i?.tag)&&!/^video$/i.test(t.nodeName)){const i=this.createVideoTag();i.src=e,t.parentNode.replaceChild(i,t),this._element=t=i}else t.src=e}a=this._container,r=X.getParentElement(t,"FIGURE")}else{t.src=e,this._element=t;const i=gi.CreateContainer(t,"se-video-container");r=i.cover,a=i.container}this._element=t,this._cover=r,this._container=a,this.figure.open(t,{nonResizing:this._nonResizing,nonSizeInfo:!1,nonBorder:!1,figureTarget:!1,__fileManagerInfo:!0}),i=i||this._defaultSizeX,s=s||this._videoRatio;const h=this.figure.getSize(t),c=h.w!==i||h.h!==s,d=!o||c;if(d&&this.applySize(i,s),this.figure.setAlign(t,n),this.fileManager.setFileData(t,l),o)this._resizing&&d&&this.figure.isVertical&&this.figure.setTransform(t,i,s,0),this.history.push(!1);else if(this.component.insert(a,!1,!0),!this.options.get("mediaAutoSelect")){const t=this.format.addLine(a,null);t&&this.selection.setRange(t,0,t,0)}},createIframeTag(){const t=X.createElement("IFRAME");return this._setIframeAttrs(t),t},createVideoTag:function(){const t=X.createElement("VIDEO");return this._setTagAttrs(t),t},_getInfo(){return{inputWidth:this.inputX.value,inputHeight:this.inputY.value,align:this._align,isUpdate:this.modal.isUpdate,element:this._element}},async submitFile(t){if(0===t.length)return;let e=0;const i=[],s=this.uploadSingleSizeLimit;for(let n,o,l=0,r=t.length;l<r;l++)if(n=t[l],/video/i.test(n.type)){if(o=n.size,s&&s>o){const t="[SUNEDITOR.videoUpload.fail] Size of uploadable single file: "+s/1e3+"KB",e=await this.triggerEvent("onVideoUploadError",{error:t,limitSize:s,uploadSize:o,file:n});return this.notice.open(e===vl?t:e||t),!1}i.push(n),e+=o}const n=this.pluginOptions.uploadSizeLimit,o=this.fileManager.getSize();if(n>0&&e+o>n){const t="[SUNEDITOR.videoUpload.fail] Size of uploadable total videos: "+n/1e3+"KB",i=await this.triggerEvent("onVideoUploadError",{error:t,limitSize:n,currentSize:o,uploadSize:e});return this.notice.open(i===vl?t:i||t),!1}const l={url:null,files:i,...this._getInfo()},r=function(t,e){t=e||t,this._serverUpload(t,t.files)}.bind(this,l),a=await this.triggerEvent("onVideoUploadBefore",{...l,handler:r});return void 0===a||!1!==a&&(null!==a&&"object"==typeof a&&r(a),void(!0!==a&&a!==vl||r(null)))},async submitURL(t){if(t||(t=this._linkValue),!t)return!1;if(/^<iframe.*\/iframe>$/.test(t)&&0===(t=(new DOMParser).parseFromString(t,"text/html").querySelector("iframe").src).length)return!1;const e=this.findProcessUrl(t);e&&(t=e.url);const i={name:t.split("/").pop(),size:0},s={url:t,files:i,...this._getInfo(),process:e},n=function(t,e){t=e||t,this.create(this[/^iframe$/i.test(t.process?.tag)?"createIframeTag":"createVideoTag"](),t.url,t.inputWidth,t.inputHeight,t.align,t.isUpdate,t.files)}.bind(this,s),o=await this.triggerEvent("onVideoUploadBefore",{...s,handler:n});return void 0===o||!1!==o&&(null!==o&&"object"==typeof o&&n(o),!0!==o&&o!==vl||n(null),!0)},_update(t){if(!t)return;/^video$/i.test(t.nodeName)?this._setTagAttrs(t):/^iframe$/i.test(t.nodeName)&&this._setIframeAttrs(t);let e=this.format.isBlock(t.parentNode)||X.isWysiwygFrame(t.parentNode)?t:this.format.getLine(t)||t;const i=t;t=t.cloneNode(!0);const s=gi.CreateContainer(t,"se-video-container").container,n=e.querySelector("figcaption");let o=null;n&&(o=X.createElement("DIV"),o.innerHTML=n.innerHTML,X.removeItem(n)),this.figure.open(t,{nonResizing:this._nonResizing,nonSizeInfo:!1,nonBorder:!1,figureTarget:!1,__fileManagerInfo:!0});const l=(t.getAttribute("data-se-size")||",").split(",");this.applySize(l[0]||i.style.width||i.width||"",l[1]||i.style.height||i.height||"");const r=this.format.getLine(i);if(r&&(this._align=r.style.textAlign||r.style.float),this.figure.setAlign(t,this._align),X.getParentElement(i,X.isExcludeFormat))i.parentNode.replaceChild(s,i);else if(X.isListCell(e)){const t=X.getParentElement(i,(t=>t.parentNode===e));e.insertBefore(s,t),X.removeItem(i),this.nodeTransform.removeEmptyNode(t,null,!0)}else if(this.format.isLineOnly(e)){const t=X.getParentElement(i,(t=>t.parentNode===e));e=this.nodeTransform.split(e,t),e.parentNode.insertBefore(s,e),X.removeItem(i),this.nodeTransform.removeEmptyNode(e,null,!0)}else e.parentNode.replaceChild(s,e);return o&&e.parentNode.insertBefore(o,s.nextElementSibling),t},_register(t,e){const i=e.result,s=this.createVideoTag();for(let e=0,n=i.length;e<n;e++)this.create(t.isUpdate?t.element:s.cloneNode(!1),i[e].url,t.inputWidth,t.inputHeight,t.align,t.isUpdate,{name:i[e].name,size:i[e].size})},_serverUpload(t,e){if(!e)return;const i=this.pluginOptions.uploadUrl;"string"==typeof i&&i.length>0&&this.fileManager.upload(i,this.pluginOptions.uploadHeaders,e,wl.bind(this,t),this._error.bind(this))},_setTagAttrs(t){t.setAttribute("controls",!0);const e=this.pluginOptions.videoTagAttributes;if(e)for(const i in e)t.setAttribute(i,e[i])},_setIframeAttrs(t){t.frameBorder="0",t.allowFullscreen=!0;const e=this.pluginOptions.iframeTagAttributes;if(e)for(const i in e)t.setAttribute(i,e[i])},_setVideoRatioSelect(t){let e=!1;const i=this.videoRatioOption.options;/%$/.test(t)||this._onlyPercentage?t=j.get(t,2)/100+"":(!j.is(t)||1*t>=1)&&(t=""),this.inputY.placeholder="";for(let s=0,n=i.length;s<n;s++)i[s].value===t?(e=i[s].selected=!0,this.inputY.placeholder=t?100*t+"%":""):i[s].selected=!1;return e},async _error(t){const e=await this.triggerEvent("onVideoUploadError",{error:t}),i=e===vl?t.errorMessage:e||t.errorMessage;this.notice.open(i),console.error("[SUNEDITOR.plugin.video.error]",e)},constructor:yl};const Hl=yl,{NO_EVENT:Ll,ON_OVER_COMPONENT:Ml}=q,Bl=function(t,e){He.call(this,t),this.title=this.lang.audio,this.icon="audio",this.pluginOptions={defaultWidth:e.defaultWidth?j.is(e.defaultWidth)?e.defaultWidth+"px":e.defaultWidth:"",defaultHeight:e.defaultHeight?j.is(e.defaultHeight)?e.defaultHeight+"px":e.defaultHeight:"",createFileInput:!!e.createFileInput,createUrlInput:void 0===e.createUrlInput||!e.createFileInput||e.createUrlInput,uploadUrl:"string"==typeof e.uploadUrl?e.uploadUrl:null,uploadHeaders:e.uploadHeaders||null,uploadSizeLimit:/\d+/.test(e.uploadSizeLimit)?j.get(e.uploadSizeLimit,0):null,uploadSingleSizeLimit:/\d+/.test(e.uploadSingleSizeLimit)?j.get(e.uploadSingleSizeLimit,0):null,allowMultiple:!!e.allowMultiple,acceptedFormats:"string"!=typeof e.acceptedFormats||"*"===e.acceptedFormats.trim()?"audio/*":e.acceptedFormats.trim()||"audio/*",audioTagAttributes:e.audioTagAttributes||null};const i=function({lang:t,icons:e},i){let s=`\n    <form method="post" enctype="multipart/form-data">\n        <div class="se-modal-header">\n            <button type="button" data-command="close" class="se-btn se-close-btn" title="${t.close}" aria-label="${t.close}">\n                ${e.cancel}\n            </button>\n            <span class="se-modal-title">${t.audio_modal_title}</span>\n        </div>\n        <div class="se-modal-body">`;return i.createFileInput&&(s+=`\n        <div class="se-modal-form">\n            <label>${t.audio_modal_file}</label>\n            ${Ji.CreateFileInput({lang:t,icons:e},i)}\n        </div>`),i.createUrlInput&&(s+=`\n        <div class="se-modal-form">\n            <label>${t.audio_modal_url}</label>\n            <input class="se-input-form se-input-url" data-focus type="text" />\n            <pre class="se-link-preview"></pre>\n        </div>`),s+=`\n        </div>\n        <div class="se-modal-footer">\n            <button type="submit" class="se-btn-primary" title="${t.submitButton}" aria-label="${t.submitButton}">\n                <span>${t.submitButton}</span>\n            </button>\n        </div>\n    </form>`,X.createElement("DIV",{class:"se-modal-content"},s)}(t,this.pluginOptions),s=function({lang:t,icons:e}){const i=`\n    <div class="se-arrow se-arrow-up"></div>\n    <div class="link-content">\n        <div class="se-btn-group">\n            <button type="button" data-command="update" tabindex="-1" class="se-btn se-tooltip">\n                ${e.edit}\n                <span class="se-tooltip-inner">\n                    <span class="se-tooltip-text">${t.edit}</span>\n                </span>\n            </button>\n            <button type="button" data-command="delete" tabindex="-1" class="se-btn se-tooltip">\n                ${e.delete}\n                <span class="se-tooltip-inner">\n                    <span class="se-tooltip-text">${t.remove}</span>\n                </span>\n            </button>\n        </div>\n    </div>`;return X.createElement("DIV",{class:"se-controller"},i)}(t);this.modal=new Ji(this,i),this.controller=new $e(this,s,{position:"bottom",disabled:!0}),this.fileManager=new Ms(this,{query:"audio",loadHandler:this.events.onAudioLoad,eventHandler:this.events.onAudioAction}),this.figure=new gi(this,null,{}),this.fileModalWrapper=i.querySelector(".se-flex-input-wrapper"),this.audioInputFile=i.querySelector(".__se__file_input"),this.audioUrlFile=i.querySelector(".se-input-url"),this.preview=i.querySelector(".se-link-preview"),this.defaultWidth=this.pluginOptions.defaultWidth,this.defaultHeight=this.pluginOptions.defaultHeight,this.urlValue="",this._element=null,this.audioInputFile&&(i.querySelector(".se-modal-files-edge-button").addEventListener("click",Il.bind(this.audioInputFile,this.audioUrlFile,this.preview)),this.audioUrlFile&&this.audioInputFile.addEventListener("change",Rl.bind(this))),this.audioUrlFile&&this.audioUrlFile.addEventListener("input",Vl.bind(this))};async function Al(t,e){if(await this.triggerEvent("audioUploadHandler",{xmlHttp:e,info:t})===Ll){const i=JSON.parse(e.responseText);i.errorMessage?this._error(i):this._register(t,i)}}function Vl(t){const e=t.target.value.trim();this.urlValue=this.preview.textContent=e?this.options.get("defaultUrlProtocol")&&!e.includes("://")&&0!==e.indexOf("#")?this.options.get("defaultUrlProtocol")+e:e.includes("://")?e:"/"+e:""}function Il(t,e){this.value="",t&&(t.removeAttribute("disabled"),e.style.textDecoration=""),Ji.OnChangeFile(this.fileModalWrapper,[])}function Rl({target:t}){this.audioInputFile.value?(this.audioUrlFile.setAttribute("disabled",!0),this.preview.style.textDecoration="line-through"):(this.audioUrlFile.removeAttribute("disabled"),this.preview.style.textDecoration=""),Ji.OnChangeFile(this.fileModalWrapper,t.files)}Bl.key="audio",Bl.type="modal",Bl.className="",Bl.component=function(t){return/^AUDIO$/i.test(t?.nodeName)?t:null},Bl.prototype={open(){this.modal.open()},on(t){t?this._element?(this.urlValue=this.preview.textContent=this.audioUrlFile.value=this._element.src,this.audioInputFile&&this.pluginOptions.allowMultiple&&this.audioInputFile.removeAttribute("multiple")):this.audioInputFile&&this.pluginOptions.allowMultiple&&this.audioInputFile.removeAttribute("multiple"):this.audioInputFile&&this.pluginOptions.allowMultiple&&this.audioInputFile.setAttribute("multiple","multiple")},onPastAndDrop({file:t}){if(/^audio/.test(t.type))return this.submitFile([t]),this.editor.focus(),!1},modalAction(){return this.audioInputFile&&this.audioInputFile?.files.length>0?this.submitFile(this.audioInputFile.files):!!(this.audioUrlFile&&this.urlValue.length>0)&&this.submitURL(this.urlValue)},init(){Ji.OnChangeFile(this.fileModalWrapper,[]),this.audioInputFile&&(this.audioInputFile.value=""),this.audioUrlFile&&(this.urlValue=this.preview.textContent=this.audioUrlFile.value=""),this.audioInputFile&&this.audioUrlFile&&(this.audioUrlFile.removeAttribute("disabled"),this.preview.style.textDecoration="")},controllerAction(t){/update/.test(t.getAttribute("data-command"))?(this.audioUrlFile&&(this.urlValue=this.preview.textContent=this.audioUrlFile.value=this._element.src),this.open()):this.destroy()},retainFormat(){return{query:"audio",method:t=>{const e=gi.GetContainer(t);if(e&&e.container&&e.cover)return;this._setTagAttrs(t);const i=gi.CreateContainer(t.cloneNode(!0),"se-flex-component");this.figure._retainFigureFormat(i.container,t,null)}}},select(t){this.figure.open(t,{nonResizing:!0,nonSizeInfo:!0,nonBorder:!0,figureTarget:!0,__fileManagerInfo:!1}),this.ready(t)},ready(t){Lt.get("__overInfo")!==Ml&&(this._element=t,this.controller.open(t,null,{isWWTarget:!1,addOffset:null}))},async destroy(t){t=t||this._element;const e=gi.GetContainer(t),i=e.container||t,s=i.previousElementSibling||i.nextElementSibling;if(!1===await this.triggerEvent("onAudioDeleteBefore",{target:t,container:e,url:t.getAttribute("src")}))return;const n=i.parentNode;X.removeItem(i),this.init(),this.controller.close(),n!==this.editor.frameContext.get("wysiwyg")&&this.nodeTransform.removeAllParents(n,(function(t){return 0===t.childNodes.length}),null),this.editor.focusEdge(s),this.history.push(!1)},_register(t,e){const i=e.result;for(let e,s,n=0,o=i.length;n<o;n++)s=t.isUpdate?t.element:this._createAudioTag(),e={name:i[n].name,size:i[n].size},this._createComp(s,i[n].url,e,t.isUpdate)},async submitFile(t){if(0===t.length)return!1;let e=0;const i=[],s=this.uploadSingleSizeLimit;for(let n,o,l=0,r=t.length;l<r;l++)if(n=t[l],/audio/i.test(n.type)){if(o=n.size,s&&s>o){const t="[SUNEDITOR.audioUpload.fail] Size of uploadable single file: "+s/1e3+"KB",e=await this.triggerEvent("onAudioUploadError",{error:t,limitSize:s,uploadSize:o,file:n});return this.notice.open(e===Ll?t:e||t),!1}i.push(n),e+=o}const n=this.pluginOptions.uploadSizeLimit;if(n>0&&e+this.fileManager.getSize()>n){const t="[SUNEDITOR.audioUpload.fail] Size of uploadable total audios: "+n/1e3+"KB",i=await this.triggerEvent("onAudioUploadError",{error:t,limitSize:n,currentSize:this.fileManager.getSize(),uploadSize:e});return this.notice.open(i===Ll?t:i||t),!1}const o={files:i,isUpdate:this.modal.isUpdate,element:this._element},l=function(t,e){e=t||e,this._serverUpload(e,e.files)}.bind(this,o),r=await this.triggerEvent("onAudioUploadBefore",{...o,handler:l});return void 0===r||!!r&&(null!==r&&"object"==typeof r&&l(r),!0!==r&&r!==Ll||l(null),!0)},async submitURL(t){if(0===t.length)return!1;const e={name:t.split("/").pop(),size:0},i={url:t,files:e,isUpdate:this.modal.isUpdate,element:this._createAudioTag()},s=function(t,e){e=t||e,this._createComp(e.element,e.url,e.files,e.isUpdate)}.bind(this,i),n=await this.triggerEvent("onAudioUploadBefore",{...i,handler:s});return void 0===n||!!n&&(null!==n&&"object"==typeof n&&s(n),!0!==n&&n!==Ll||s(null),!0)},_createComp(t,e,i,s){if(s){if(this._element&&(t=this._element),this.fileManager.setFileData(t,i),!t||t.src===e)return void this.component.select(t,Bl.key,!1);t.src=e,this.component.select(t,Bl.key,!1)}else{this.fileManager.setFileData(t,i),t.src=e;const s=gi.CreateContainer(t,"se-flex-component");if(!this.component.insert(s.container,!1,!this.options.get("mediaAutoSelect")))return void this.editor.focus();if(!this.options.get("mediaAutoSelect")){const t=this.format.addLine(s.container,null);t&&this.selection.setRange(t,0,t,0)}}s&&this.history.push(!1)},_createAudioTag(){const t=this.defaultWidth,e=this.defaultHeight,i=X.createElement("AUDIO",{style:(t?"width:"+t+"; ":"")+(e?"height:"+e+";":"")});return this._setTagAttrs(i),i},_setTagAttrs(t){t.setAttribute("controls",!0);const e=this.pluginOptions.audioTagAttributes;if(e)for(const i in e)t.setAttribute(i,e[i])},_serverUpload(t,e){if(!e)return;const i=this.modal.isUpdate?[e[0]]:e;this.fileManager.upload(this.pluginOptions.uploadUrl,this.pluginOptions.uploadHeaders,i,Al.bind(this,t),this._error.bind(this))},async _error(t){const e=await this.triggerEvent("onAudioUploadError",{error:t}),i=e===Ll?t.errorMessage:e||t.errorMessage;this.notice.open(i),console.error("[SUNEDITOR.plugin.audio.error]",i)},constructor:Bl};const zl=Bl,Ol=function(t,e){(this.katex=function(t){if(!t)return null;if(!t.src)return console.warn("[SUNEDITOR.math.katex.fail] The katex option is set incorrectly."),null;const e=[{throwOnError:!1},t.options||{}].reduce(((t,e)=>{for(const i in e)t[i]=e[i];return t}),{});return t.options=e,t}(t.options.get("externalLibs").katex))||console.warn('[SUNEDITOR.plugins.math.warn] The math plugin must need the "KaTeX" library, Please add the katex option.'),He.call(this,t),this.title=this.lang.math,this.icon="math";const i=function({lang:t,icons:e},i,s){const n=s||[{text:"1",value:"1em"},{text:"1.5",value:"1.5em"},{text:"2",value:"2em"},{text:"2.5",value:"2.5em"}];let o=n[0].value,l=`\n    <form>\n        <div class="se-modal-header">\n            <button type="button" data-command="close" class="se-btn se-close-btn" title="${t.close}" aria-label="${t.close}">\n                ${e.cancel}\n            </button>\n            <span class="se-modal-title">${t.math_modal_title}</span>\n        </div>\n        <div class="se-modal-body">\n            <div class="se-modal-form">\n                <label>${t.math_modal_inputLabel} (<a href="${q.KATEX_WEBSITE}" target="_blank">KaTeX</a>)</label>\n                <textarea class="se-input-form se-math-exp" type="text" data-focus></textarea>\n            </div>\n            <div class="se-modal-form">\n                <label>${t.math_modal_fontSizeLabel}</label>\n                <select class="se-input-select se-math-size">`;for(let t,e=0,i=n.length;e<i;e++)t=n[e],t.default&&(o=t.value),l+=`<option value="${t.value}"${t.default?" selected":""}>${t.text}</option>`;return l+=`</select>\n            </div>\n            <div class="se-modal-form">\n                <label>${t.math_modal_previewLabel}</label>\n                <p class="se-math-preview"></p>\n            </div>\n        </div>\n        <div class="se-modal-footer">\n            <button type="submit" class="se-btn-primary" title="${t.submitButton}" aria-label="${t.submitButton}">\n                <span>${t.submitButton}</span>\n            </button>\n        </div>\n    </form>`,i.defaultFontSize=o,X.createElement("DIV",{class:"se-modal-content"},l)}(t,this,e.fontSizeList),s=function({lang:t,icons:e}){const i=`\n    <div class="se-arrow se-arrow-up"></div>\n    <div class="link-content">\n        <div class="se-btn-group">\n            <button type="button" data-command="update" tabindex="-1" class="se-btn se-tooltip">\n                ${e.edit}\n                <span class="se-tooltip-inner">\n                    <span class="se-tooltip-text">${t.edit}</span>\n                </span>\n            </button>\n            <button type="button" data-command="copy" tabindex="-1" class="se-btn se-tooltip">\n                ${e.copy}\n                <span class="se-tooltip-inner">\n                    <span class="se-tooltip-text">${t.copy}</span>\n                </span>\n            </button>\n            <button type="button" data-command="delete" tabindex="-1" class="se-btn se-tooltip">\n                ${e.delete}\n                <span class="se-tooltip-inner">\n                    <span class="se-tooltip-text">${t.remove}</span>\n                </span>\n            </button>\n        </div>\n    </div>`;return X.createElement("DIV",{class:"se-controller se-controller-link"},i)}(t);this.modal=new Ji(this,i),this.controller=new $e(this,s,{position:"bottom",disabled:!0}),this.textArea=i.querySelector(".se-math-exp"),this.previewElement=i.querySelector(".se-math-preview"),this.fontSizeElement=i.querySelector(".se-math-size"),this.isUpdateState=!1,this._element=null,this.previewElement.style.fontSize=this.defaultFontSize,this.eventManager.addEvent(this.textArea,"input",$l.bind(this)),this.eventManager.addEvent(this.fontSizeElement,"change",function(t){this.fontSize=t.target.value}.bind(this.previewElement.style))};function $l(t){this.previewElement.innerHTML=this._renderer(t.target.value)}function Pl(t){return t?t.getAttribute("data-se-value"):null}Ol.key="math",Ol.type="modal",Ol.className="",Ol.component=function(t){return X.hasClass(t,"katex|se-component")?t:null},Ol.prototype={select(t){if(X.hasClass(t,"katex")&&Pl(t))return this._element=t,void this.controller.open(t,null,{isWWTarget:!1,initMethod:null,addOffset:null})},close(){this._element=null},retainFormat(){return{query:".katex",method:t=>{if(!this.katex)return;const e=Pl(t);if(!e)return;const i=this._d.createRange().createContextualFragment(this._renderer(Y.entityToHTML(this._escapeBackslashes(e,!0))));t.innerHTML=i.querySelector(".katex").innerHTML,t.setAttribute("contenteditable",!1),X.addClass(t,"se-component|se-inline-component|se-disable-pointer")}}},open(){this.modal.open()},on(t){if(this.isUpdateState=t,t){if(this.controller.currentTarget){const t=this.controller.currentTarget,i=Y.entityToHTML(this._escapeBackslashes(Pl(t),!0)),s=((e=t)?e?.getAttribute("data-se-type"):null)||"1em";this.textArea.value=i,this.fontSizeElement.value=s,this.previewElement.innerHTML=this._renderer(i),this.previewElement.style.fontSize=s}}else this.init();var e},modalAction(){if(0===this.textArea.value.trim().length)return!1;const t=this.textArea.value,e=this.previewElement.querySelector(".katex");if(!e)return!1;if(e.className="se-component se-inline-component __se__katex "+e.className,e.setAttribute("contenteditable",!1),e.setAttribute("data-se-value",Y.htmlToEntity(this._escapeBackslashes(t,!1))),e.setAttribute("data-se-type",this.fontSizeElement.value),e.style.fontSize=this.fontSizeElement.value,this.isUpdateState){const t=X.getParentElement(this.controller.currentTarget,".katex");t.parentNode.replaceChild(e,t);const i=this.component.get(e);this.component.select(i.target,i.pluginName,!1)}else{const t=this.format.getLines();if(t.length>1){const i=X.createElement(t[0].nodeName,null,e);this.component.insert(i,!1,!1)}else this.component.insert(e,!1,!1)}return!0},init(){this.textArea.value="",this.previewElement.innerHTML=""},controllerAction(t){switch(t.getAttribute("data-command")){case"update":this.modal.open();break;case"copy":!async function(t){if(navigator.clipboard&&t)try{const e=Pl(t);await navigator.clipboard.writeText(e),X.addClass(t,"se-copy"),q._w.setTimeout((()=>{X.removeClass(t,"se-copy")}),120)}catch(t){console.error("[SUNEDITOR.math.copy.fail]",t)}}(this._element);break;case"delete":this.destroy(this.controller.currentTarget)}},destroy(t){X.removeItem(t),this.controller.close(),this.editor.focus(),this.history.push(!1)},_renderer(t){let e="";try{X.removeClass(this.textArea,"se-error"),e=this.katex.src.renderToString(t,{throwOnError:!0,displayMode:!0})}catch(t){X.addClass(this.textArea,"se-error"),e='<span class="se-math-katex-error">Katex syntax error. (Refer <a href="'+q.KATEX_WEBSITE+'" target="_blank">KaTeX</a>)</span>',console.warn("[SUNEDITOR.math.Katex.error] ",t.message)}return e},_escapeBackslashes:(t,e)=>t.replace(/\\{2}/g,e?"\\":"\\\\"),constructor:Ol};const Dl=Ol,Fl=function(t,e){Ht.call(this,t.editor);const i=X.createElement("DIV",{class:"se-file-browser sun-editor-common"}),s=X.createElement("DIV",{class:"se-file-browser-inner"},function({lang:t,icons:e}){return`\n\t\t<div class="se-file-browser-content">\n\t\t\t<div class="se-file-browser-header">\n\t\t\t\t<button type="button" data-command="close" class="se-btn se-file-browser-close" class="close" title="${t.close}" aria-label="${t.close}">\n\t\t\t\t\t${e.cancel}\n\t\t\t\t</button>\n\t\t\t\t<span class="se-file-browser-title"></span>\n\t\t\t\t<div class="se-file-browser-tags"></div>\n\t\t\t</div>\n\t\t\t<div class="se-file-browser-body">\n\t\t\t\t<div class="se-loading-box sun-editor-common"><div class="se-loading-effect"></div></div>\n\t\t\t\t<div class="se-file-browser-list"></div>\n\t\t\t</div>\n\t\t</div>`}(t.editor));this.kind=t.constructor.key||t.constructor.name,this.inst=t,this.area=i,this.header=s.querySelector(".se-file-browser-header"),this.titleArea=s.querySelector(".se-file-browser-title"),this.tagArea=s.querySelector(".se-file-browser-tags"),this.body=s.querySelector(".se-file-browser-body"),this.list=s.querySelector(".se-file-browser-list"),this._loading=s.querySelector(".se-loading-box"),this.title=e.title,this.listClass=e.listClass,this.url=e.url,this.urlHeader=e.headers,this.drawItemHandler=e.drawItemHandler,this.selectorHandler=e.selectorHandler,this.columnSize=e.columnSize||4,this.items=[],this.selectedTags=[],this._closeSignal=!1,this._bindClose=null,this.__globalEventHandler=t=>{/27/.test(t.keyCode)&&this.close()},this.apiManager=new Ts(this,{method:"GET"}),i.appendChild(X.createElement("DIV",{class:"se-file-browser-back"})),i.appendChild(s),this.carrierWrapper.appendChild(i),this.eventManager.addEvent(this.tagArea,"click",Zl.bind(this)),this.eventManager.addEvent(this.list,"click",ql.bind(this)),this.eventManager.addEvent(s,"mousedown",Gl.bind(this)),this.eventManager.addEvent(s,"click",Yl.bind(this))};function Wl(t){try{const e=JSON.parse(t.responseText);e.result.length>0?this._drawListItem(e.result,!0):e.nullMessage&&(this.list.innerHTML=e.nullMessage)}catch(t){throw Error(`[SUNEDITOR.fileBrowser.drawList.fail] cause: "${t.message}"`)}finally{this.closeBrowserLoading(),this.body.style.maxHeight=X.getClientSize().h-this.header.offsetHeight-50+"px"}}function Ul(t,e){throw this.closeBrowserLoading(),Error(`[SUNEDITOR.fileBrowser.get.serverException] status: ${e.status}, response: ${t.errorMessage||e.responseText}`)}function Zl(t){const e=t.target;if(!X.isAnchor(e))return;const i=e.textContent,s=this.tagArea.querySelector('a[title="'+i+'"]'),n=this.selectedTags,o=n.indexOf(i);o>-1?(n.splice(o,1),X.removeClass(s,"on")):(n.push(i),X.addClass(s,"on")),this._drawListItem(0===n.length?this.items:this.items.filter((function(t){return t.tag.some((function(t){return n.includes(t)}))})),!1)}function ql(t){if(t.preventDefault(),t.stopPropagation(),t.target===this.list)return;const e=X.getCommandTarget(t.target);e&&(this.close(),this.selectorHandler(e))}function Gl(t){/se-file-browser-inner/.test(t.target.className)?this._closeSignal=!0:this._closeSignal=!1}function Yl(t){t.stopPropagation(),(/close/.test(t.target.getAttribute("data-command"))||this._closeSignal)&&this.close()}Fl.prototype={open(t){t||(t={}),this.__addGlobalEvent();const e=t.listClass||this.listClass;X.hasClass(this.list,e)||(this.list.className="se-file-browser-list "+e),this.titleArea.textContent=t.title||this.title,this.area.style.display="block",this._drawFileList(t.url||this.url,t.urlHeader||this.urlHeader)},close(){this.__removeGlobalEvent(),this.apiManager.cancel(),this.area.style.display="none",this.selectedTags=[],this.items=[],this.list.innerHTML=this.tagArea.innerHTML=this.titleArea.textContent="","function"==typeof this.inst.init&&this.inst.init()},showBrowserLoading(){this._loading.style.display="block"},closeBrowserLoading(){this._loading.style.display="none"},_drawFileList(t,e){this.apiManager.call({method:"GET",url:t,headers:e,callBack:Wl.bind(this),errorCallBack:Ul.bind(this)}),this.showBrowserLoading()},_drawListItem(t,e){const i=[],s=t.length,n=this.columnSize,o=n<=1?1:Math.round(s/n)||1,l=this.drawItemHandler;let r="",a='<div class="se-file-item-column">',h=1;for(let c,d,u=0;u<s;u++)if(c=t[u],d=c.tag?"string"==typeof c.tag?c.tag.split(","):c.tag:[],d=c.tag=d.map((function(t){return t.trim()})),a+=l(c),(u+1)%o==0&&h<n&&u+1<s&&(h++,a+='</div><div class="se-file-item-column">'),e&&d.length>0)for(let t,e=0,s=d.length;e<s;e++)t=d[e],t&&!i.includes(t)&&(i.push(t),r+=`<a title="${t}" aria-label="${t}">${t}</a>`);a+="</div>",this.list.innerHTML=a,e&&(this.items=t,this.tagArea.innerHTML=r)},__addGlobalEvent(){this.__removeGlobalEvent(),this._bindClose=this.eventManager.addGlobalEvent("keydown",this.__globalEventHandler,!0)},__removeGlobalEvent(){this._bindClose&&(this._bindClose=this.eventManager.removeGlobalEvent(this._bindClose))},constructor:Fl};const Xl=Fl,jl=function(t,e){He.call(this,t),this.title=this.lang.imageGallery,this.icon="image_gallery",this.fileBrowser=new Xl(this,{title:this.lang.imageGallery,url:e.url,headers:e.headers,listClass:"se-image-list",drawItemHandler:Kl,selectorHandler:Jl.bind(this),columnSize:4}),this.width="auto"===this.plugins.image.pluginOptions.defaultWidth?"":this.plugins.image.pluginOptions.defaultWidth,this.height="auto"===this.plugins.image.pluginOptions.defaultHeight?"":this.plugins.image.pluginOptions.defaultHeight};function Kl(t){const e=t.src.split("/").pop();return`\n\t\t<div class="se-file-item-img">\n\t\t\t<img \n\t\t\t\tsrc="${t.thumbnail||t.src}" \n\t\t\t\talt="${t.alt||e}" \n\t\t\t\tdata-command="${t.src||t.thumbnail}" \n\t\t\t\tdata-value="${t.name||e}">\n\t\t\t<div class="se-file-name-image se-file-name-back"></div>\n\t\t\t<div class="se-file-name-image">${t.name||e}</div>\n\t\t</div>`}function Jl(t){if(this.inputTarget)this.inputTarget(t);else{const e={name:t.getAttribute("data-value"),size:0};this.plugins.image.init(),this.plugins.image.create(t.getAttribute("data-command"),null,this.width,this.height,"none",e,t.alt)}}jl.key="imageGallery",jl.type="fileBrowser",jl.className="",jl.prototype={open(t){this.inputTarget=t,this.fileBrowser.open()},close(){this.inputTarget=null,this.fileBrowser.close()},constructor:jl};const Ql=jl,tr={text:{default:"13px",list:[{title:"XX-Small",size:"8px"},{title:"X-Small",size:"10px"},{title:"Small",size:"13px"},{title:"Medium",size:"16px"},{title:"Large",size:"18px"},{title:"X-Large",size:"24px"},{title:"XX-Large",size:"32px"}]},px:{default:13,inc:1,min:8,max:72,list:[8,10,13,15,18,20,22,26,28,36,48,72]},pt:{default:10,inc:1,min:6,max:72,list:[6,8,10,12,14,18,22,26,32]},em:{default:1,inc:.1,min:.5,max:5,list:[.5,.75,1,1.25,1.5,1.75,2,2.5,3]},rem:{default:1,inc:.1,min:.5,max:5,list:[.5,.75,1,1.25,1.5,1.75,2,2.5,3]},vw:{inc:.1,min:.5,max:10,list:[2,3.5,4,4.5,6,8]},vh:{default:1.5,inc:.1,min:.5,max:10,list:[1,1.5,2,2.5,3,3.5,4]},"%":{default:100,inc:1,min:50,max:200,list:[50,70,90,100,120,140,160,180,200]}},er=function(t,e){He.call(this,t),this.unitMap={...tr,...e.unitMap||{}},this.sizeUnit=/text/.test(e.sizeUnit)?"":e.sizeUnit||this.options.get("fontSizeUnits")[0];const i=function({lang:t},e,i,s){const n=e.list,o=e.default,l=s?t.default:"";let r='\n\t<div class="se-list-inner">\n\t\t<ul class="se-list-basic">';for(let t,e,s,a,h,c=0,d=n.length;c<d;c++)t=n[c],"object"==typeof t?(e=t.title,s=t.size):e=s=t+i,a=o===s?" default_value":"",h=a&&l||e,r+=`\n\t\t\t<li>\n\t\t\t\t<button type="button" class="se-btn se-btn-list${a}" data-command="${s}" data-value="${e}" title="${h}" aria-label="${h}" style="font-size:${s};">${h}</button>\n\t\t\t</li>`;return r+="\n\t\t</ul>\n\t</div>",X.createElement("DIV",{class:"se-dropdown se-list-layer se-list-font-size"},r)}(t,this.unitMap[this.sizeUnit||"text"],this.sizeUnit,e.showDefaultSizeLabel),s=!!this.sizeUnit&&(e.showIncDecControls??!1),n=!this.sizeUnit||(e.disableInput??!1);this.title=this.lang.fontSize,this.inner=!(n&&!s)&&(n?`<span class="se-txt se-not-arrow-text __se__font_size">${this.lang.fontSize}</span>`:`<input type="text" class="__se__font_size se-not-arrow-text" placeholder="${this.lang.fontSize}" />`),s?(this.beforeButton=X.createElement("button",{class:"se-btn se-tooltip se-sub-btn","data-command":er.key,"data-type":"command","data-value":"dec"},`${this.icons.minus}<span class="se-tooltip-inner"><span class="se-tooltip-text">${this.lang.decrease}</span></span>`),this.afterButton=X.createElement("button",{class:"se-btn se-tooltip se-sub-btn","data-command":er.key,"data-type":"command","data-value":"inc"},`${this.icons.plus}<span class="se-tooltip-inner"><span class="se-tooltip-text">${this.lang.increase}</span></span>`)):n?n&&!s&&(this.replaceButton=X.createElement("button",{class:"se-btn se-tooltip se-btn-select se-btn-tool-font-size","data-command":er.key,"data-type":"dropdown"},`<span class="se-txt __se__font_size">${this.lang.fontSize}</span>${this.icons.arrow_down}<span class="se-tooltip-inner"><span class="se-tooltip-text">${this.lang.fontSize}</span></span>`),this.menu.initDropdownTarget({key:er.key,type:"dropdown"},i)):(this.afterButton=X.createElement("button",{class:"se-btn se-tooltip se-sub-arrow-btn","data-command":er.key,"data-type":"dropdown"},`${this.icons.arrow_down}<span class="se-tooltip-inner"><span class="se-tooltip-text">${this.lang.fontSize}</span></span>`),this.menu.initDropdownTarget({key:er.key,type:"dropdown"},i)),this.currentSize="",this.sizeList=i.querySelectorAll("li button"),this.hasInputFocus=!1,this.isInputActive=!1,this._disableInput=n,this.menu.initDropdownTarget(er,i)};er.key="fontSize",er.type="input",er.className="se-btn-select se-btn-input se-btn-tool-font-size",er.prototype={active(t,e){if(!X.hasClass(e,"__se__font_size"))return!1;if(t){if(t?.style.fontSize.length>0)return this._setSize(e,t.style.fontSize),!0}else this._setSize(e,this._getDefaultSize());return!1},onInputKeyDown({target:t,event:e}){const i=e.keyCode;if(this._disableInput||32===i)return void e.preventDefault();if(!/^(38|40|13)$/.test(i))return;const{value:s,unit:n}=this._getSize(t);if(!s)return;const o=this.unitMap[n];let l=s;switch(i){case 38:l+=o.inc,l>o.max&&(l=s);break;case 40:l-=o.inc,l<o.min&&(l=s)}e.preventDefault();try{this.isInputActive=!0;const e=this._setSize(t,l+n);if(this._disableInput)return;const s=X.createElement("SPAN",{style:"font-size: "+e+";"});this.format.applyTextStyle(s,["font-size"],null,null),13!==i&&t.focus()}finally{this.isInputActive=!1}},onInputChange({target:t,value:e,event:i}){if(!this._disableInput)try{this.isInputActive=!0;let{value:i,unit:s}=this._getSize(e);const{max:n,min:o}=this.unitMap[s];i=i>n?n:i<o?o:i;const l=X.createElement("SPAN",{style:"font-size: "+this._setSize(t,i+s)+";"});this.format.applyTextStyle(l,["font-size"],null,null)}finally{this.isInputActive=!1,i.preventDefault(),this.editor.focus()}},on(t){const{value:e,unit:i}=this._getSize(t),s=e+i;if(s===this.currentSize)return;const n=this.sizeList;for(let t=0,e=n.length;t<e;t++)s===n[t].getAttribute("data-value")?X.addClass(n[t],"active"):X.removeClass(n[t],"active");this.currentSize=s},action(t){const e=t.getAttribute("data-command");if(e===er.key){const{value:e,unit:i}=this._getSize(t);let s=e+("inc"===t.getAttribute("data-value")?1:-1);const{min:n,max:o}=this.unitMap[i];s=s<n?n:s>o?o:s;const l=X.createElement("SPAN",{style:"font-size: "+s+i+";"});this.format.applyTextStyle(l,["font-size"],null,null)}else if(e){const t=X.createElement("SPAN",{style:"font-size: "+e+";"});this.format.applyTextStyle(t,["font-size"],null,null)}else this.format.applyTextStyle(null,["font-size"],["span"],!0);this.menu.dropdownOff()},_getDefaultSize(){return this.editor.frameContext.get("wwComputedStyle").fontSize},_getSize(t){if(!(t="string"==typeof t?t:t.parentElement.querySelector(".__se__font_size")))return{unit:this.sizeUnit,value:this.sizeUnit?0:""};const e="string"==typeof t?t:/^INPUT$/i.test(t.nodeName)?t.value:t.textContent,i=this.sizeUnit?e.split(/(\d+)/):[e,""];let s=(i.pop()||"").trim().toLowerCase();s=this.options.get("fontSizeUnits").includes(s)?s:this.sizeUnit;let n=i.pop();return n=s?1*n:n,{unit:s,value:n}},_setSize(t,e){return(t=t.parentElement.querySelector(".__se__font_size"))?/^INPUT$/i.test(t.nodeName)?t.value=e:t.textContent=this.sizeUnit?e:this.unitMap.text.list.find((t=>t.size===e))?.title||e:0},constructor:er};const ir=He,sr={blockquote:xs,exportPdf:Hs,fileUpload:Is,list_bulleted:zs,list_numbered:Ps,mention:Us,align:qs,font:Ys,fontColor:qn,backgroundColor:Yn,list:Jn,table:Mo,formatBlock:Ao,hr:jn,layout:Io,lineHeight:zo,template:$o,paragraphStyle:Do,textStyle:Wo,link:nl,image:bl,video:Hl,audio:zl,math:Dl,imageGallery:Ql,fontSize:er},nr={_DragHandle:Lt,ApiManager:Ts,ColorPicker:Un,Controller:$e,FileBrowser:Xl,FileManager:Ms,HueSlider:In,Figure:gi,Modal:Ji,ModalAnchorEditor:il,SelectMenu:Ye},or=K,lr={init(t){return{create:(e,i)=>this.create(e,i,t)}},create(t,e,i){if("object"!=typeof e&&(e={}),i&&(e=[i,e].reduce(((t,e)=>(Object.entries(e).forEach((([e,i])=>{if("plugins"===e&&i&&t[e]){const s=Array.isArray(t[e])?t[e]:Object.values(t[e]),n=Array.isArray(i)?i:Object.values(i);t[e]=[...n.filter((t=>!s.includes(t))),...s]}else t[e]=i})),t)),{})),!t)throw Error("[SUNEDITOR.create.fail] suneditor requires textarea's element");const s=[];if(1===t.nodeType)s.push({target:t});else{let e;for(const i in t){if(e=t[i],!e.target||1!==e.target.nodeType)throw Error('[SUNEDITOR.create.fail] suneditor multi root requires textarea\'s element at the "target" property.');e.key=i,s.push(e)}}return new ws(s,e)}};i("+qkj"),i("JybH"),Object.defineProperty(window,"SUNEDITOR",{enumerable:!0,writable:!1,configurable:!1,value:{...lr,editorInjector:ir,plugins:sr,modules:nr,helper:or}})})()})();